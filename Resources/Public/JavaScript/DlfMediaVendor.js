/*! For license information please see DlfMediaVendor.js.LICENSE.txt */
(self.webpackChunkkitodo_presentation=self.webpackChunkkitodo_presentation||[]).push([[951],{715:(e,t,n)=>{var i,r;void 0===(r="function"==typeof(i=function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=r(e);if(t){var a=r(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return o(e)}(this,n)}}function u(){return u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e}(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}},u.apply(this,arguments)}var l=function(){function t(){e(this,t),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return i(t,[{key:"addEventListener",value:function(e,t,n){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push({callback:t,options:n})}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var n=this.listeners[e],i=0,r=n.length;i<r;i++)if(n[i].callback===t)return void n.splice(i,1)}},{key:"dispatchEvent",value:function(e){if(e.type in this.listeners){for(var t=this.listeners[e.type].slice(),n=0,i=t.length;n<i;n++){var r=t[n];try{r.callback.call(this,e)}catch(e){Promise.resolve().then((function(){throw e}))}r.options&&r.options.once&&this.removeEventListener(e.type,r.callback)}return!e.defaultPrevented}}}]),t}(),h=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(h,t);var n=s(h);function h(){var t;return e(this,h),(t=n.call(this)).listeners||l.call(o(t)),Object.defineProperty(o(t),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(o(t),"onabort",{value:null,writable:!0,configurable:!0}),Object.defineProperty(o(t),"reason",{value:void 0,writable:!0,configurable:!0}),t}return i(h,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(e){"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),u(r(h.prototype),"dispatchEvent",this).call(this,e)}}]),h}(l),c=function(){function t(){e(this,t),Object.defineProperty(this,"signal",{value:new h,writable:!0,configurable:!0})}return i(t,[{key:"abort",value:function(e){var t;try{t=new Event("abort")}catch(e){"undefined"!=typeof document?document.createEvent?(t=document.createEvent("Event")).initEvent("abort",!1,!1):(t=document.createEventObject()).type="abort":t={type:"abort",bubbles:!1,cancelable:!1}}var n=e;if(void 0===n)if("undefined"==typeof document)(n=new Error("This operation was aborted")).name="AbortError";else try{n=new DOMException("signal is aborted without reason")}catch(e){(n=new Error("This operation was aborted")).name="AbortError"}this.signal.reason=n,this.signal.dispatchEvent(t)}},{key:"toString",value:function(){return"[object AbortController]"}}]),t}();function d(e){return e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):"function"==typeof e.Request&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController}"undefined"!=typeof Symbol&&Symbol.toStringTag&&(c.prototype[Symbol.toStringTag]="AbortController",h.prototype[Symbol.toStringTag]="AbortSignal"),function(e){if(d(e))if(e.fetch){var t=function(e){"function"==typeof e&&(e={fetch:e});var t=e,n=t.fetch,i=t.Request,r=void 0===i?n.Request:i,a=t.AbortController,o=t.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,s=void 0!==o&&o;if(!d({fetch:n,Request:r,AbortController:a,__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL:s}))return{fetch:n,Request:u};var u=r;(u&&!u.prototype.hasOwnProperty("signal")||s)&&((u=function(e,t){var n;t&&t.signal&&(n=t.signal,delete t.signal);var i=new r(e,t);return n&&Object.defineProperty(i,"signal",{writable:!1,enumerable:!1,configurable:!0,value:n}),i}).prototype=r.prototype);var l=n;return{fetch:function(e,t){var n=u&&u.prototype.isPrototypeOf(e)?e.signal:t?t.signal:void 0;if(n){var i;try{i=new DOMException("Aborted","AbortError")}catch(e){(i=new Error("Aborted")).name="AbortError"}if(n.aborted)return Promise.reject(i);var r=new Promise((function(e,t){n.addEventListener("abort",(function(){return t(i)}),{once:!0})}));return t&&t.signal&&delete t.signal,Promise.race([r,l(e,t)])}return l(e,t)},Request:u}}(e),n=t.fetch,i=t.Request;e.fetch=n,e.Request=i,Object.defineProperty(e,"AbortController",{writable:!0,enumerable:!1,configurable:!0,value:c}),Object.defineProperty(e,"AbortSignal",{writable:!0,enumerable:!1,configurable:!0,value:h})}else console.warn("fetch() is not available, cannot install abortcontroller-polyfill")}("undefined"!=typeof self?self:n.g)})?i.call(t,n,t,e):i)||(e.exports=r)},320:e=>{"use strict";var t={single_source_shortest_paths:function(e,n,i){var r={},a={};a[n]=0;var o,s,u,l,h,c,d,p=t.PriorityQueue.make();for(p.push(n,0);!p.empty();)for(u in s=(o=p.pop()).value,l=o.cost,h=e[s]||{})h.hasOwnProperty(u)&&(c=l+h[u],d=a[u],(void 0===a[u]||d>c)&&(a[u]=c,p.push(u,c),r[u]=s));if(void 0!==i&&void 0===a[i]){var f=["Could not find a path from ",n," to ",i,"."].join("");throw new Error(f)}return r},extract_shortest_path_from_predecessor_list:function(e,t){for(var n=[],i=t;i;)n.push(i),e[i],i=e[i];return n.reverse(),n},find_path:function(e,n,i){var r=t.single_source_shortest_paths(e,n,i);return t.extract_shortest_path_from_predecessor_list(r,i)},PriorityQueue:{make:function(e){var n,i=t.PriorityQueue,r={};for(n in e=e||{},i)i.hasOwnProperty(n)&&(r[n]=i[n]);return r.queue=[],r.sorter=e.sorter||i.default_sorter,r},default_sorter:function(e,t){return e.cost-t.cost},push:function(e,t){var n={value:e,cost:t};this.queue.push(n),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};e.exports=t},49:e=>{"use strict";e.exports=function(e){for(var t=[],n=e.length,i=0;i<n;i++){var r=e.charCodeAt(i);if(r>=55296&&r<=56319&&n>i+1){var a=e.charCodeAt(i+1);a>=56320&&a<=57343&&(r=1024*(r-55296)+a-56320+65536,i+=1)}r<128?t.push(r):r<2048?(t.push(r>>6|192),t.push(63&r|128)):r<55296||r>=57344&&r<65536?(t.push(r>>12|224),t.push(r>>6&63|128),t.push(63&r|128)):r>=65536&&r<=1114111?(t.push(r>>18|240),t.push(r>>12&63|128),t.push(r>>6&63|128),t.push(63&r|128)):t.push(239,191,189)}return new Uint8Array(t).buffer}},7:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,i=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var r=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(n,i){function r(n){e.removeListener(t,a),i(n)}function a(){"function"==typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}g(e,t,a,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&g(e,"error",t,{once:!0})}(e,r)}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var o=10;function s(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function l(e,t,n,i){var r,a,o,l;if(s(n),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),o=a[t]),void 0===o)o=a[t]=n,++e._eventsCount;else if("function"==typeof o?o=a[t]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),(r=u(e))>0&&o.length>r&&!o.warned){o.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=e,h.type=t,h.count=o.length,l=h,console&&console.warn&&console.warn(l)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function c(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=h.bind(i);return r.listener=n,i.wrapFn=r,r}function d(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):f(r,r.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function g(e,t,n,i){if("function"==typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(a){i.once&&e.removeEventListener(t,r),n(a)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return u(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,a=this._events;if(void 0!==a)r=r&&void 0===a.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var u=a[e];if(void 0===u)return!1;if("function"==typeof u)i(u,this,t);else{var l=u.length,h=f(u,l);for(n=0;n<l;++n)i(h[n],this,t)}return!0},a.prototype.addListener=function(e,t){return l(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return l(this,e,t,!0)},a.prototype.once=function(e,t){return s(t),this.on(e,c(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return s(t),this.prependListener(e,c(this,e,t)),this},a.prototype.removeListener=function(e,t){var n,i,r,a,o;if(s(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){o=n[a].listener,r=a;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,o||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,a=Object.keys(n);for(i=0;i<a.length;++i)"removeListener"!==(r=a[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},a.prototype.listeners=function(e){return d(this,e,!0)},a.prototype.rawListeners=function(e){return d(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},a.prototype.listenerCount=p,a.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},511:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>Ie});var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a,o,s,u=function(){return u=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},u.apply(this,arguments)};function l(e,t,n){if(n||2===arguments.length)for(var i,r=0,a=t.length;r<a;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}function h(e){return e.type===o.literal}function c(e){return e.type===o.argument}function d(e){return e.type===o.number}function p(e){return e.type===o.date}function f(e){return e.type===o.time}function g(e){return e.type===o.select}function m(e){return e.type===o.plural}function v(e){return e.type===o.pound}function y(e){return e.type===o.tag}function b(e){return!(!e||"object"!=typeof e||e.type!==s.number)}function _(e){return!(!e||"object"!=typeof e||e.type!==s.dateTime)}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError,function(e){e[e.EXPECT_ARGUMENT_CLOSING_BRACE=1]="EXPECT_ARGUMENT_CLOSING_BRACE",e[e.EMPTY_ARGUMENT=2]="EMPTY_ARGUMENT",e[e.MALFORMED_ARGUMENT=3]="MALFORMED_ARGUMENT",e[e.EXPECT_ARGUMENT_TYPE=4]="EXPECT_ARGUMENT_TYPE",e[e.INVALID_ARGUMENT_TYPE=5]="INVALID_ARGUMENT_TYPE",e[e.EXPECT_ARGUMENT_STYLE=6]="EXPECT_ARGUMENT_STYLE",e[e.INVALID_NUMBER_SKELETON=7]="INVALID_NUMBER_SKELETON",e[e.INVALID_DATE_TIME_SKELETON=8]="INVALID_DATE_TIME_SKELETON",e[e.EXPECT_NUMBER_SKELETON=9]="EXPECT_NUMBER_SKELETON",e[e.EXPECT_DATE_TIME_SKELETON=10]="EXPECT_DATE_TIME_SKELETON",e[e.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE=11]="UNCLOSED_QUOTE_IN_ARGUMENT_STYLE",e[e.EXPECT_SELECT_ARGUMENT_OPTIONS=12]="EXPECT_SELECT_ARGUMENT_OPTIONS",e[e.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE=13]="EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE",e[e.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE=14]="INVALID_PLURAL_ARGUMENT_OFFSET_VALUE",e[e.EXPECT_SELECT_ARGUMENT_SELECTOR=15]="EXPECT_SELECT_ARGUMENT_SELECTOR",e[e.EXPECT_PLURAL_ARGUMENT_SELECTOR=16]="EXPECT_PLURAL_ARGUMENT_SELECTOR",e[e.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT=17]="EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT",e[e.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT=18]="EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT",e[e.INVALID_PLURAL_ARGUMENT_SELECTOR=19]="INVALID_PLURAL_ARGUMENT_SELECTOR",e[e.DUPLICATE_PLURAL_ARGUMENT_SELECTOR=20]="DUPLICATE_PLURAL_ARGUMENT_SELECTOR",e[e.DUPLICATE_SELECT_ARGUMENT_SELECTOR=21]="DUPLICATE_SELECT_ARGUMENT_SELECTOR",e[e.MISSING_OTHER_CLAUSE=22]="MISSING_OTHER_CLAUSE",e[e.INVALID_TAG=23]="INVALID_TAG",e[e.INVALID_TAG_NAME=25]="INVALID_TAG_NAME",e[e.UNMATCHED_CLOSING_TAG=26]="UNMATCHED_CLOSING_TAG",e[e.UNCLOSED_TAG=27]="UNCLOSED_TAG"}(a||(a={})),function(e){e[e.literal=0]="literal",e[e.argument=1]="argument",e[e.number=2]="number",e[e.date=3]="date",e[e.time=4]="time",e[e.select=5]="select",e[e.plural=6]="plural",e[e.pound=7]="pound",e[e.tag=8]="tag"}(o||(o={})),function(e){e[e.number=0]="number",e[e.dateTime=1]="dateTime"}(s||(s={}));var w=/[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,S=/(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvVxX]{1,4})(?=([^']*'[^']*')*[^']*$)/g;function T(e){var t={};return e.replace(S,(function(e){var n=e.length;switch(e[0]){case"G":t.era=4===n?"long":5===n?"narrow":"short";break;case"y":t.year=2===n?"2-digit":"numeric";break;case"Y":case"u":case"U":case"r":throw new RangeError("`Y/u/U/r` (year) patterns are not supported, use `y` instead");case"q":case"Q":throw new RangeError("`q/Q` (quarter) patterns are not supported");case"M":case"L":t.month=["numeric","2-digit","short","long","narrow"][n-1];break;case"w":case"W":throw new RangeError("`w/W` (week) patterns are not supported");case"d":t.day=["numeric","2-digit"][n-1];break;case"D":case"F":case"g":throw new RangeError("`D/F/g` (day) patterns are not supported, use `d` instead");case"E":t.weekday=4===n?"long":5===n?"narrow":"short";break;case"e":if(n<4)throw new RangeError("`e..eee` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][n-4];break;case"c":if(n<4)throw new RangeError("`c..ccc` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][n-4];break;case"a":t.hour12=!0;break;case"b":case"B":throw new RangeError("`b/B` (period) patterns are not supported, use `a` instead");case"h":t.hourCycle="h12",t.hour=["numeric","2-digit"][n-1];break;case"H":t.hourCycle="h23",t.hour=["numeric","2-digit"][n-1];break;case"K":t.hourCycle="h11",t.hour=["numeric","2-digit"][n-1];break;case"k":t.hourCycle="h24",t.hour=["numeric","2-digit"][n-1];break;case"j":case"J":case"C":throw new RangeError("`j/J/C` (hour) patterns are not supported, use `h/H/K/k` instead");case"m":t.minute=["numeric","2-digit"][n-1];break;case"s":t.second=["numeric","2-digit"][n-1];break;case"S":case"A":throw new RangeError("`S/A` (second) patterns are not supported, use `s` instead");case"z":t.timeZoneName=n<4?"short":"long";break;case"Z":case"O":case"v":case"V":case"X":case"x":throw new RangeError("`Z/O/v/V/X/x` (timeZone) patterns are not supported, use `z` instead")}return""})),t}var A=/[\t-\r \x85\u200E\u200F\u2028\u2029]/i,E=/^\.(?:(0+)(\*)?|(#+)|(0+)(#+))$/g,C=/^(@+)?(\+|#+)?[rs]?$/g,x=/(\*)(0+)|(#+)(0+)|(0+)/g,I=/^(0+)$/;function k(e){var t={};return"r"===e[e.length-1]?t.roundingPriority="morePrecision":"s"===e[e.length-1]&&(t.roundingPriority="lessPrecision"),e.replace(C,(function(e,n,i){return"string"!=typeof i?(t.minimumSignificantDigits=n.length,t.maximumSignificantDigits=n.length):"+"===i?t.minimumSignificantDigits=n.length:"#"===n[0]?t.maximumSignificantDigits=n.length:(t.minimumSignificantDigits=n.length,t.maximumSignificantDigits=n.length+("string"==typeof i?i.length:0)),""})),t}function M(e){switch(e){case"sign-auto":return{signDisplay:"auto"};case"sign-accounting":case"()":return{currencySign:"accounting"};case"sign-always":case"+!":return{signDisplay:"always"};case"sign-accounting-always":case"()!":return{signDisplay:"always",currencySign:"accounting"};case"sign-except-zero":case"+?":return{signDisplay:"exceptZero"};case"sign-accounting-except-zero":case"()?":return{signDisplay:"exceptZero",currencySign:"accounting"};case"sign-never":case"+_":return{signDisplay:"never"}}}function P(e){var t;if("E"===e[0]&&"E"===e[1]?(t={notation:"engineering"},e=e.slice(2)):"E"===e[0]&&(t={notation:"scientific"},e=e.slice(1)),t){var n=e.slice(0,2);if("+!"===n?(t.signDisplay="always",e=e.slice(2)):"+?"===n&&(t.signDisplay="exceptZero",e=e.slice(2)),!I.test(e))throw new Error("Malformed concise eng/scientific notation");t.minimumIntegerDigits=e.length}return t}function L(e){return M(e)||{}}function D(e){for(var t={},n=0,i=e;n<i.length;n++){var r=i[n];switch(r.stem){case"percent":case"%":t.style="percent";continue;case"%x100":t.style="percent",t.scale=100;continue;case"currency":t.style="currency",t.currency=r.options[0];continue;case"group-off":case",_":t.useGrouping=!1;continue;case"precision-integer":case".":t.maximumFractionDigits=0;continue;case"measure-unit":case"unit":t.style="unit",t.unit=r.options[0].replace(/^(.*?)-/,"");continue;case"compact-short":case"K":t.notation="compact",t.compactDisplay="short";continue;case"compact-long":case"KK":t.notation="compact",t.compactDisplay="long";continue;case"scientific":t=u(u(u({},t),{notation:"scientific"}),r.options.reduce((function(e,t){return u(u({},e),L(t))}),{}));continue;case"engineering":t=u(u(u({},t),{notation:"engineering"}),r.options.reduce((function(e,t){return u(u({},e),L(t))}),{}));continue;case"notation-simple":t.notation="standard";continue;case"unit-width-narrow":t.currencyDisplay="narrowSymbol",t.unitDisplay="narrow";continue;case"unit-width-short":t.currencyDisplay="code",t.unitDisplay="short";continue;case"unit-width-full-name":t.currencyDisplay="name",t.unitDisplay="long";continue;case"unit-width-iso-code":t.currencyDisplay="symbol";continue;case"scale":t.scale=parseFloat(r.options[0]);continue;case"rounding-mode-floor":t.roundingMode="floor";continue;case"rounding-mode-ceiling":t.roundingMode="ceil";continue;case"rounding-mode-down":t.roundingMode="trunc";continue;case"rounding-mode-up":t.roundingMode="expand";continue;case"rounding-mode-half-even":t.roundingMode="halfEven";continue;case"rounding-mode-half-down":t.roundingMode="halfTrunc";continue;case"rounding-mode-half-up":t.roundingMode="halfExpand";continue;case"integer-width":if(r.options.length>1)throw new RangeError("integer-width stems only accept a single optional option");r.options[0].replace(x,(function(e,n,i,r,a,o){if(n)t.minimumIntegerDigits=i.length;else{if(r&&a)throw new Error("We currently do not support maximum integer digits");if(o)throw new Error("We currently do not support exact integer digits")}return""}));continue}if(I.test(r.stem))t.minimumIntegerDigits=r.stem.length;else if(E.test(r.stem)){if(r.options.length>1)throw new RangeError("Fraction-precision stems only accept a single optional option");r.stem.replace(E,(function(e,n,i,r,a,o){return"*"===i?t.minimumFractionDigits=n.length:r&&"#"===r[0]?t.maximumFractionDigits=r.length:a&&o?(t.minimumFractionDigits=a.length,t.maximumFractionDigits=a.length+o.length):(t.minimumFractionDigits=n.length,t.maximumFractionDigits=n.length),""}));var a=r.options[0];"w"===a?t=u(u({},t),{trailingZeroDisplay:"stripIfInteger"}):a&&(t=u(u({},t),k(a)))}else if(C.test(r.stem))t=u(u({},t),k(r.stem));else{var o=M(r.stem);o&&(t=u(u({},t),o));var s=P(r.stem);s&&(t=u(u({},t),s))}}return t}var R,N={"001":["H","h"],AC:["H","h","hb","hB"],AD:["H","hB"],AE:["h","hB","hb","H"],AF:["H","hb","hB","h"],AG:["h","hb","H","hB"],AI:["H","h","hb","hB"],AL:["h","H","hB"],AM:["H","hB"],AO:["H","hB"],AR:["H","h","hB","hb"],AS:["h","H"],AT:["H","hB"],AU:["h","hb","H","hB"],AW:["H","hB"],AX:["H"],AZ:["H","hB","h"],BA:["H","hB","h"],BB:["h","hb","H","hB"],BD:["h","hB","H"],BE:["H","hB"],BF:["H","hB"],BG:["H","hB","h"],BH:["h","hB","hb","H"],BI:["H","h"],BJ:["H","hB"],BL:["H","hB"],BM:["h","hb","H","hB"],BN:["hb","hB","h","H"],BO:["H","hB","h","hb"],BQ:["H"],BR:["H","hB"],BS:["h","hb","H","hB"],BT:["h","H"],BW:["H","h","hb","hB"],BY:["H","h"],BZ:["H","h","hb","hB"],CA:["h","hb","H","hB"],CC:["H","h","hb","hB"],CD:["hB","H"],CF:["H","h","hB"],CG:["H","hB"],CH:["H","hB","h"],CI:["H","hB"],CK:["H","h","hb","hB"],CL:["H","h","hB","hb"],CM:["H","h","hB"],CN:["H","hB","hb","h"],CO:["h","H","hB","hb"],CP:["H"],CR:["H","h","hB","hb"],CU:["H","h","hB","hb"],CV:["H","hB"],CW:["H","hB"],CX:["H","h","hb","hB"],CY:["h","H","hb","hB"],CZ:["H"],DE:["H","hB"],DG:["H","h","hb","hB"],DJ:["h","H"],DK:["H"],DM:["h","hb","H","hB"],DO:["h","H","hB","hb"],DZ:["h","hB","hb","H"],EA:["H","h","hB","hb"],EC:["H","hB","h","hb"],EE:["H","hB"],EG:["h","hB","hb","H"],EH:["h","hB","hb","H"],ER:["h","H"],ES:["H","hB","h","hb"],ET:["hB","hb","h","H"],FI:["H"],FJ:["h","hb","H","hB"],FK:["H","h","hb","hB"],FM:["h","hb","H","hB"],FO:["H","h"],FR:["H","hB"],GA:["H","hB"],GB:["H","h","hb","hB"],GD:["h","hb","H","hB"],GE:["H","hB","h"],GF:["H","hB"],GG:["H","h","hb","hB"],GH:["h","H"],GI:["H","h","hb","hB"],GL:["H","h"],GM:["h","hb","H","hB"],GN:["H","hB"],GP:["H","hB"],GQ:["H","hB","h","hb"],GR:["h","H","hb","hB"],GT:["H","h","hB","hb"],GU:["h","hb","H","hB"],GW:["H","hB"],GY:["h","hb","H","hB"],HK:["h","hB","hb","H"],HN:["H","h","hB","hb"],HR:["H","hB"],HU:["H","h"],IC:["H","h","hB","hb"],ID:["H"],IE:["H","h","hb","hB"],IL:["H","hB"],IM:["H","h","hb","hB"],IN:["h","H"],IO:["H","h","hb","hB"],IQ:["h","hB","hb","H"],IR:["hB","H"],IS:["H"],IT:["H","hB"],JE:["H","h","hb","hB"],JM:["h","hb","H","hB"],JO:["h","hB","hb","H"],JP:["H","K","h"],KE:["hB","hb","H","h"],KG:["H","h","hB","hb"],KH:["hB","h","H","hb"],KI:["h","hb","H","hB"],KM:["H","h","hB","hb"],KN:["h","hb","H","hB"],KP:["h","H","hB","hb"],KR:["h","H","hB","hb"],KW:["h","hB","hb","H"],KY:["h","hb","H","hB"],KZ:["H","hB"],LA:["H","hb","hB","h"],LB:["h","hB","hb","H"],LC:["h","hb","H","hB"],LI:["H","hB","h"],LK:["H","h","hB","hb"],LR:["h","hb","H","hB"],LS:["h","H"],LT:["H","h","hb","hB"],LU:["H","h","hB"],LV:["H","hB","hb","h"],LY:["h","hB","hb","H"],MA:["H","h","hB","hb"],MC:["H","hB"],MD:["H","hB"],ME:["H","hB","h"],MF:["H","hB"],MG:["H","h"],MH:["h","hb","H","hB"],MK:["H","h","hb","hB"],ML:["H"],MM:["hB","hb","H","h"],MN:["H","h","hb","hB"],MO:["h","hB","hb","H"],MP:["h","hb","H","hB"],MQ:["H","hB"],MR:["h","hB","hb","H"],MS:["H","h","hb","hB"],MT:["H","h"],MU:["H","h"],MV:["H","h"],MW:["h","hb","H","hB"],MX:["H","h","hB","hb"],MY:["hb","hB","h","H"],MZ:["H","hB"],NA:["h","H","hB","hb"],NC:["H","hB"],NE:["H"],NF:["H","h","hb","hB"],NG:["H","h","hb","hB"],NI:["H","h","hB","hb"],NL:["H","hB"],NO:["H","h"],NP:["H","h","hB"],NR:["H","h","hb","hB"],NU:["H","h","hb","hB"],NZ:["h","hb","H","hB"],OM:["h","hB","hb","H"],PA:["h","H","hB","hb"],PE:["H","hB","h","hb"],PF:["H","h","hB"],PG:["h","H"],PH:["h","hB","hb","H"],PK:["h","hB","H"],PL:["H","h"],PM:["H","hB"],PN:["H","h","hb","hB"],PR:["h","H","hB","hb"],PS:["h","hB","hb","H"],PT:["H","hB"],PW:["h","H"],PY:["H","h","hB","hb"],QA:["h","hB","hb","H"],RE:["H","hB"],RO:["H","hB"],RS:["H","hB","h"],RU:["H"],RW:["H","h"],SA:["h","hB","hb","H"],SB:["h","hb","H","hB"],SC:["H","h","hB"],SD:["h","hB","hb","H"],SE:["H"],SG:["h","hb","H","hB"],SH:["H","h","hb","hB"],SI:["H","hB"],SJ:["H"],SK:["H"],SL:["h","hb","H","hB"],SM:["H","h","hB"],SN:["H","h","hB"],SO:["h","H"],SR:["H","hB"],SS:["h","hb","H","hB"],ST:["H","hB"],SV:["H","h","hB","hb"],SX:["H","h","hb","hB"],SY:["h","hB","hb","H"],SZ:["h","hb","H","hB"],TA:["H","h","hb","hB"],TC:["h","hb","H","hB"],TD:["h","H","hB"],TF:["H","h","hB"],TG:["H","hB"],TH:["H","h"],TJ:["H","h"],TL:["H","hB","hb","h"],TM:["H","h"],TN:["h","hB","hb","H"],TO:["h","H"],TR:["H","hB"],TT:["h","hb","H","hB"],TW:["hB","hb","h","H"],TZ:["hB","hb","H","h"],UA:["H","hB","h"],UG:["hB","hb","H","h"],UM:["h","hb","H","hB"],US:["h","hb","H","hB"],UY:["H","h","hB","hb"],UZ:["H","hB","h"],VA:["H","h","hB"],VC:["h","hb","H","hB"],VE:["h","H","hB","hb"],VG:["h","hb","H","hB"],VI:["h","hb","H","hB"],VN:["H","h"],VU:["h","H"],WF:["H","hB"],WS:["h","H"],XK:["H","hB","h"],YE:["h","hB","hb","H"],YT:["H","hB"],ZA:["H","h","hb","hB"],ZM:["h","hb","H","hB"],ZW:["H","h"],"af-ZA":["H","h","hB","hb"],"ar-001":["h","hB","hb","H"],"ca-ES":["H","h","hB"],"en-001":["h","hb","H","hB"],"es-BO":["H","h","hB","hb"],"es-BR":["H","h","hB","hb"],"es-EC":["H","h","hB","hb"],"es-ES":["H","h","hB","hb"],"es-GQ":["H","h","hB","hb"],"es-PE":["H","h","hB","hb"],"fr-CA":["H","h","hB"],"gl-ES":["H","h","hB"],"gu-IN":["hB","hb","h","H"],"hi-IN":["hB","h","H"],"it-CH":["H","h","hB"],"it-IT":["H","h","hB"],"kn-IN":["hB","h","H"],"ml-IN":["hB","h","H"],"mr-IN":["hB","hb","h","H"],"pa-IN":["hB","hb","h","H"],"ta-IN":["hB","h","hb","H"],"te-IN":["hB","h","H"],"zu-ZA":["H","hB","hb","h"]};function O(e){var t=e.hourCycle;if(void 0===t&&e.hourCycles&&e.hourCycles.length&&(t=e.hourCycles[0]),t)switch(t){case"h24":return"k";case"h23":return"H";case"h12":return"h";case"h11":return"K";default:throw new Error("Invalid hourCycle")}var n,i=e.language;return"root"!==i&&(n=e.maximize().region),(N[n||""]||N[i||""]||N["".concat(i,"-001")]||N["001"])[0]}var U=new RegExp("^".concat(w.source,"*")),B=new RegExp("".concat(w.source,"*$"));function F(e,t){return{start:e,end:t}}var G=!!String.prototype.startsWith&&"_a".startsWith("a",1),j=!!String.fromCodePoint,H=!!Object.fromEntries,V=!!String.prototype.codePointAt,W=!!String.prototype.trimStart,z=!!String.prototype.trimEnd,X=Number.isSafeInteger?Number.isSafeInteger:function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e&&Math.abs(e)<=9007199254740991},K=!0;try{K="a"===(null===(R=te("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu").exec("a"))||void 0===R?void 0:R[0])}catch(e){K=!1}var Y,q=G?function(e,t,n){return e.startsWith(t,n)}:function(e,t,n){return e.slice(n,n+t.length)===t},Z=j?String.fromCodePoint:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n,i="",r=e.length,a=0;r>a;){if((n=e[a++])>1114111)throw RangeError(n+" is not a valid code point");i+=n<65536?String.fromCharCode(n):String.fromCharCode(55296+((n-=65536)>>10),n%1024+56320)}return i},J=H?Object.fromEntries:function(e){for(var t={},n=0,i=e;n<i.length;n++){var r=i[n],a=r[0],o=r[1];t[a]=o}return t},Q=V?function(e,t){return e.codePointAt(t)}:function(e,t){var n=e.length;if(!(t<0||t>=n)){var i,r=e.charCodeAt(t);return r<55296||r>56319||t+1===n||(i=e.charCodeAt(t+1))<56320||i>57343?r:i-56320+(r-55296<<10)+65536}},$=W?function(e){return e.trimStart()}:function(e){return e.replace(U,"")},ee=z?function(e){return e.trimEnd()}:function(e){return e.replace(B,"")};function te(e,t){return new RegExp(e,t)}if(K){var ne=te("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu");Y=function(e,t){var n;return ne.lastIndex=t,null!==(n=ne.exec(e)[1])&&void 0!==n?n:""}}else Y=function(e,t){for(var n=[];;){var i=Q(e,t);if(void 0===i||ae(i)||oe(i))break;n.push(i),t+=i>=65536?2:1}return Z.apply(void 0,n)};var ie=function(){function e(e,t){void 0===t&&(t={}),this.message=e,this.position={offset:0,line:1,column:1},this.ignoreTag=!!t.ignoreTag,this.locale=t.locale,this.requiresOtherClause=!!t.requiresOtherClause,this.shouldParseSkeletons=!!t.shouldParseSkeletons}return e.prototype.parse=function(){if(0!==this.offset())throw Error("parser can only be used once");return this.parseMessage(0,"",!1)},e.prototype.parseMessage=function(e,t,n){for(var i=[];!this.isEOF();){var r=this.char();if(123===r){if((s=this.parseArgument(e,n)).err)return s;i.push(s.val)}else{if(125===r&&e>0)break;if(35!==r||"plural"!==t&&"selectordinal"!==t){if(60===r&&!this.ignoreTag&&47===this.peek()){if(n)break;return this.error(a.UNMATCHED_CLOSING_TAG,F(this.clonePosition(),this.clonePosition()))}if(60===r&&!this.ignoreTag&&re(this.peek()||0)){if((s=this.parseTag(e,t)).err)return s;i.push(s.val)}else{var s;if((s=this.parseLiteral(e,t)).err)return s;i.push(s.val)}}else{var u=this.clonePosition();this.bump(),i.push({type:o.pound,location:F(u,this.clonePosition())})}}}return{val:i,err:null}},e.prototype.parseTag=function(e,t){var n=this.clonePosition();this.bump();var i=this.parseTagName();if(this.bumpSpace(),this.bumpIf("/>"))return{val:{type:o.literal,value:"<".concat(i,"/>"),location:F(n,this.clonePosition())},err:null};if(this.bumpIf(">")){var r=this.parseMessage(e+1,t,!0);if(r.err)return r;var s=r.val,u=this.clonePosition();if(this.bumpIf("</")){if(this.isEOF()||!re(this.char()))return this.error(a.INVALID_TAG,F(u,this.clonePosition()));var l=this.clonePosition();return i!==this.parseTagName()?this.error(a.UNMATCHED_CLOSING_TAG,F(l,this.clonePosition())):(this.bumpSpace(),this.bumpIf(">")?{val:{type:o.tag,value:i,children:s,location:F(n,this.clonePosition())},err:null}:this.error(a.INVALID_TAG,F(u,this.clonePosition())))}return this.error(a.UNCLOSED_TAG,F(n,this.clonePosition()))}return this.error(a.INVALID_TAG,F(n,this.clonePosition()))},e.prototype.parseTagName=function(){var e,t=this.offset();for(this.bump();!this.isEOF()&&(45===(e=this.char())||46===e||e>=48&&e<=57||95===e||e>=97&&e<=122||e>=65&&e<=90||183==e||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=893||e>=895&&e<=8191||e>=8204&&e<=8205||e>=8255&&e<=8256||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039);)this.bump();return this.message.slice(t,this.offset())},e.prototype.parseLiteral=function(e,t){for(var n=this.clonePosition(),i="";;){var r=this.tryParseQuote(t);if(r)i+=r;else{var a=this.tryParseUnquoted(e,t);if(a)i+=a;else{var s=this.tryParseLeftAngleBracket();if(!s)break;i+=s}}}var u=F(n,this.clonePosition());return{val:{type:o.literal,value:i,location:u},err:null}},e.prototype.tryParseLeftAngleBracket=function(){return this.isEOF()||60!==this.char()||!this.ignoreTag&&(re(e=this.peek()||0)||47===e)?null:(this.bump(),"<");var e},e.prototype.tryParseQuote=function(e){if(this.isEOF()||39!==this.char())return null;switch(this.peek()){case 39:return this.bump(),this.bump(),"'";case 123:case 60:case 62:case 125:break;case 35:if("plural"===e||"selectordinal"===e)break;return null;default:return null}this.bump();var t=[this.char()];for(this.bump();!this.isEOF();){var n=this.char();if(39===n){if(39!==this.peek()){this.bump();break}t.push(39),this.bump()}else t.push(n);this.bump()}return Z.apply(void 0,t)},e.prototype.tryParseUnquoted=function(e,t){if(this.isEOF())return null;var n=this.char();return 60===n||123===n||35===n&&("plural"===t||"selectordinal"===t)||125===n&&e>0?null:(this.bump(),Z(n))},e.prototype.parseArgument=function(e,t){var n=this.clonePosition();if(this.bump(),this.bumpSpace(),this.isEOF())return this.error(a.EXPECT_ARGUMENT_CLOSING_BRACE,F(n,this.clonePosition()));if(125===this.char())return this.bump(),this.error(a.EMPTY_ARGUMENT,F(n,this.clonePosition()));var i=this.parseIdentifierIfPossible().value;if(!i)return this.error(a.MALFORMED_ARGUMENT,F(n,this.clonePosition()));if(this.bumpSpace(),this.isEOF())return this.error(a.EXPECT_ARGUMENT_CLOSING_BRACE,F(n,this.clonePosition()));switch(this.char()){case 125:return this.bump(),{val:{type:o.argument,value:i,location:F(n,this.clonePosition())},err:null};case 44:return this.bump(),this.bumpSpace(),this.isEOF()?this.error(a.EXPECT_ARGUMENT_CLOSING_BRACE,F(n,this.clonePosition())):this.parseArgumentOptions(e,t,i,n);default:return this.error(a.MALFORMED_ARGUMENT,F(n,this.clonePosition()))}},e.prototype.parseIdentifierIfPossible=function(){var e=this.clonePosition(),t=this.offset(),n=Y(this.message,t),i=t+n.length;return this.bumpTo(i),{value:n,location:F(e,this.clonePosition())}},e.prototype.parseArgumentOptions=function(e,t,n,i){var r,l=this.clonePosition(),h=this.parseIdentifierIfPossible().value,c=this.clonePosition();switch(h){case"":return this.error(a.EXPECT_ARGUMENT_TYPE,F(l,c));case"number":case"date":case"time":this.bumpSpace();var d=null;if(this.bumpIf(",")){this.bumpSpace();var p=this.clonePosition();if((w=this.parseSimpleArgStyleIfPossible()).err)return w;if(0===(v=ee(w.val)).length)return this.error(a.EXPECT_ARGUMENT_STYLE,F(this.clonePosition(),this.clonePosition()));d={style:v,styleLocation:F(p,this.clonePosition())}}if((S=this.tryParseArgumentClose(i)).err)return S;var f=F(i,this.clonePosition());if(d&&q(null==d?void 0:d.style,"::",0)){var g=$(d.style.slice(2));if("number"===h)return(w=this.parseNumberSkeletonFromString(g,d.styleLocation)).err?w:{val:{type:o.number,value:n,location:f,style:w.val},err:null};if(0===g.length)return this.error(a.EXPECT_DATE_TIME_SKELETON,f);var m=g;this.locale&&(m=function(e,t){for(var n="",i=0;i<e.length;i++){var r=e.charAt(i);if("j"===r){for(var a=0;i+1<e.length&&e.charAt(i+1)===r;)a++,i++;var o=1+(1&a),s=a<2?1:3+(a>>1),u=O(t);for("H"!=u&&"k"!=u||(s=0);s-- >0;)n+="a";for(;o-- >0;)n=u+n}else n+="J"===r?"H":r}return n}(g,this.locale));var v={type:s.dateTime,pattern:m,location:d.styleLocation,parsedOptions:this.shouldParseSkeletons?T(m):{}};return{val:{type:"date"===h?o.date:o.time,value:n,location:f,style:v},err:null}}return{val:{type:"number"===h?o.number:"date"===h?o.date:o.time,value:n,location:f,style:null!==(r=null==d?void 0:d.style)&&void 0!==r?r:null},err:null};case"plural":case"selectordinal":case"select":var y=this.clonePosition();if(this.bumpSpace(),!this.bumpIf(","))return this.error(a.EXPECT_SELECT_ARGUMENT_OPTIONS,F(y,u({},y)));this.bumpSpace();var b=this.parseIdentifierIfPossible(),_=0;if("select"!==h&&"offset"===b.value){if(!this.bumpIf(":"))return this.error(a.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,F(this.clonePosition(),this.clonePosition()));var w;if(this.bumpSpace(),(w=this.tryParseDecimalInteger(a.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,a.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE)).err)return w;this.bumpSpace(),b=this.parseIdentifierIfPossible(),_=w.val}var S,A=this.tryParsePluralOrSelectOptions(e,h,t,b);if(A.err)return A;if((S=this.tryParseArgumentClose(i)).err)return S;var E=F(i,this.clonePosition());return"select"===h?{val:{type:o.select,value:n,options:J(A.val),location:E},err:null}:{val:{type:o.plural,value:n,options:J(A.val),offset:_,pluralType:"plural"===h?"cardinal":"ordinal",location:E},err:null};default:return this.error(a.INVALID_ARGUMENT_TYPE,F(l,c))}},e.prototype.tryParseArgumentClose=function(e){return this.isEOF()||125!==this.char()?this.error(a.EXPECT_ARGUMENT_CLOSING_BRACE,F(e,this.clonePosition())):(this.bump(),{val:!0,err:null})},e.prototype.parseSimpleArgStyleIfPossible=function(){for(var e=0,t=this.clonePosition();!this.isEOF();)switch(this.char()){case 39:this.bump();var n=this.clonePosition();if(!this.bumpUntil("'"))return this.error(a.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE,F(n,this.clonePosition()));this.bump();break;case 123:e+=1,this.bump();break;case 125:if(!(e>0))return{val:this.message.slice(t.offset,this.offset()),err:null};e-=1;break;default:this.bump()}return{val:this.message.slice(t.offset,this.offset()),err:null}},e.prototype.parseNumberSkeletonFromString=function(e,t){var n=[];try{n=function(e){if(0===e.length)throw new Error("Number skeleton cannot be empty");for(var t=[],n=0,i=e.split(A).filter((function(e){return e.length>0}));n<i.length;n++){var r=i[n].split("/");if(0===r.length)throw new Error("Invalid number skeleton");for(var a=r[0],o=r.slice(1),s=0,u=o;s<u.length;s++)if(0===u[s].length)throw new Error("Invalid number skeleton");t.push({stem:a,options:o})}return t}(e)}catch(e){return this.error(a.INVALID_NUMBER_SKELETON,t)}return{val:{type:s.number,tokens:n,location:t,parsedOptions:this.shouldParseSkeletons?D(n):{}},err:null}},e.prototype.tryParsePluralOrSelectOptions=function(e,t,n,i){for(var r,o=!1,s=[],u=new Set,l=i.value,h=i.location;;){if(0===l.length){var c=this.clonePosition();if("select"===t||!this.bumpIf("="))break;var d=this.tryParseDecimalInteger(a.EXPECT_PLURAL_ARGUMENT_SELECTOR,a.INVALID_PLURAL_ARGUMENT_SELECTOR);if(d.err)return d;h=F(c,this.clonePosition()),l=this.message.slice(c.offset,this.offset())}if(u.has(l))return this.error("select"===t?a.DUPLICATE_SELECT_ARGUMENT_SELECTOR:a.DUPLICATE_PLURAL_ARGUMENT_SELECTOR,h);"other"===l&&(o=!0),this.bumpSpace();var p=this.clonePosition();if(!this.bumpIf("{"))return this.error("select"===t?a.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT:a.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT,F(this.clonePosition(),this.clonePosition()));var f=this.parseMessage(e+1,t,n);if(f.err)return f;var g=this.tryParseArgumentClose(p);if(g.err)return g;s.push([l,{value:f.val,location:F(p,this.clonePosition())}]),u.add(l),this.bumpSpace(),l=(r=this.parseIdentifierIfPossible()).value,h=r.location}return 0===s.length?this.error("select"===t?a.EXPECT_SELECT_ARGUMENT_SELECTOR:a.EXPECT_PLURAL_ARGUMENT_SELECTOR,F(this.clonePosition(),this.clonePosition())):this.requiresOtherClause&&!o?this.error(a.MISSING_OTHER_CLAUSE,F(this.clonePosition(),this.clonePosition())):{val:s,err:null}},e.prototype.tryParseDecimalInteger=function(e,t){var n=1,i=this.clonePosition();this.bumpIf("+")||this.bumpIf("-")&&(n=-1);for(var r=!1,a=0;!this.isEOF();){var o=this.char();if(!(o>=48&&o<=57))break;r=!0,a=10*a+(o-48),this.bump()}var s=F(i,this.clonePosition());return r?X(a*=n)?{val:a,err:null}:this.error(t,s):this.error(e,s)},e.prototype.offset=function(){return this.position.offset},e.prototype.isEOF=function(){return this.offset()===this.message.length},e.prototype.clonePosition=function(){return{offset:this.position.offset,line:this.position.line,column:this.position.column}},e.prototype.char=function(){var e=this.position.offset;if(e>=this.message.length)throw Error("out of bound");var t=Q(this.message,e);if(void 0===t)throw Error("Offset ".concat(e," is at invalid UTF-16 code unit boundary"));return t},e.prototype.error=function(e,t){return{val:null,err:{kind:e,message:this.message,location:t}}},e.prototype.bump=function(){if(!this.isEOF()){var e=this.char();10===e?(this.position.line+=1,this.position.column=1,this.position.offset+=1):(this.position.column+=1,this.position.offset+=e<65536?1:2)}},e.prototype.bumpIf=function(e){if(q(this.message,e,this.offset())){for(var t=0;t<e.length;t++)this.bump();return!0}return!1},e.prototype.bumpUntil=function(e){var t=this.offset(),n=this.message.indexOf(e,t);return n>=0?(this.bumpTo(n),!0):(this.bumpTo(this.message.length),!1)},e.prototype.bumpTo=function(e){if(this.offset()>e)throw Error("targetOffset ".concat(e," must be greater than or equal to the current offset ").concat(this.offset()));for(e=Math.min(e,this.message.length);;){var t=this.offset();if(t===e)break;if(t>e)throw Error("targetOffset ".concat(e," is at invalid UTF-16 code unit boundary"));if(this.bump(),this.isEOF())break}},e.prototype.bumpSpace=function(){for(;!this.isEOF()&&ae(this.char());)this.bump()},e.prototype.peek=function(){if(this.isEOF())return null;var e=this.char(),t=this.offset(),n=this.message.charCodeAt(t+(e>=65536?2:1));return null!=n?n:null},e}();function re(e){return e>=97&&e<=122||e>=65&&e<=90}function ae(e){return e>=9&&e<=13||32===e||133===e||e>=8206&&e<=8207||8232===e||8233===e}function oe(e){return e>=33&&e<=35||36===e||e>=37&&e<=39||40===e||41===e||42===e||43===e||44===e||45===e||e>=46&&e<=47||e>=58&&e<=59||e>=60&&e<=62||e>=63&&e<=64||91===e||92===e||93===e||94===e||96===e||123===e||124===e||125===e||126===e||161===e||e>=162&&e<=165||166===e||167===e||169===e||171===e||172===e||174===e||176===e||177===e||182===e||187===e||191===e||215===e||247===e||e>=8208&&e<=8213||e>=8214&&e<=8215||8216===e||8217===e||8218===e||e>=8219&&e<=8220||8221===e||8222===e||8223===e||e>=8224&&e<=8231||e>=8240&&e<=8248||8249===e||8250===e||e>=8251&&e<=8254||e>=8257&&e<=8259||8260===e||8261===e||8262===e||e>=8263&&e<=8273||8274===e||8275===e||e>=8277&&e<=8286||e>=8592&&e<=8596||e>=8597&&e<=8601||e>=8602&&e<=8603||e>=8604&&e<=8607||8608===e||e>=8609&&e<=8610||8611===e||e>=8612&&e<=8613||8614===e||e>=8615&&e<=8621||8622===e||e>=8623&&e<=8653||e>=8654&&e<=8655||e>=8656&&e<=8657||8658===e||8659===e||8660===e||e>=8661&&e<=8691||e>=8692&&e<=8959||e>=8960&&e<=8967||8968===e||8969===e||8970===e||8971===e||e>=8972&&e<=8991||e>=8992&&e<=8993||e>=8994&&e<=9e3||9001===e||9002===e||e>=9003&&e<=9083||9084===e||e>=9085&&e<=9114||e>=9115&&e<=9139||e>=9140&&e<=9179||e>=9180&&e<=9185||e>=9186&&e<=9254||e>=9255&&e<=9279||e>=9280&&e<=9290||e>=9291&&e<=9311||e>=9472&&e<=9654||9655===e||e>=9656&&e<=9664||9665===e||e>=9666&&e<=9719||e>=9720&&e<=9727||e>=9728&&e<=9838||9839===e||e>=9840&&e<=10087||10088===e||10089===e||10090===e||10091===e||10092===e||10093===e||10094===e||10095===e||10096===e||10097===e||10098===e||10099===e||10100===e||10101===e||e>=10132&&e<=10175||e>=10176&&e<=10180||10181===e||10182===e||e>=10183&&e<=10213||10214===e||10215===e||10216===e||10217===e||10218===e||10219===e||10220===e||10221===e||10222===e||10223===e||e>=10224&&e<=10239||e>=10240&&e<=10495||e>=10496&&e<=10626||10627===e||10628===e||10629===e||10630===e||10631===e||10632===e||10633===e||10634===e||10635===e||10636===e||10637===e||10638===e||10639===e||10640===e||10641===e||10642===e||10643===e||10644===e||10645===e||10646===e||10647===e||10648===e||e>=10649&&e<=10711||10712===e||10713===e||10714===e||10715===e||e>=10716&&e<=10747||10748===e||10749===e||e>=10750&&e<=11007||e>=11008&&e<=11055||e>=11056&&e<=11076||e>=11077&&e<=11078||e>=11079&&e<=11084||e>=11085&&e<=11123||e>=11124&&e<=11125||e>=11126&&e<=11157||11158===e||e>=11159&&e<=11263||e>=11776&&e<=11777||11778===e||11779===e||11780===e||11781===e||e>=11782&&e<=11784||11785===e||11786===e||11787===e||11788===e||11789===e||e>=11790&&e<=11798||11799===e||e>=11800&&e<=11801||11802===e||11803===e||11804===e||11805===e||e>=11806&&e<=11807||11808===e||11809===e||11810===e||11811===e||11812===e||11813===e||11814===e||11815===e||11816===e||11817===e||e>=11818&&e<=11822||11823===e||e>=11824&&e<=11833||e>=11834&&e<=11835||e>=11836&&e<=11839||11840===e||11841===e||11842===e||e>=11843&&e<=11855||e>=11856&&e<=11857||11858===e||e>=11859&&e<=11903||e>=12289&&e<=12291||12296===e||12297===e||12298===e||12299===e||12300===e||12301===e||12302===e||12303===e||12304===e||12305===e||e>=12306&&e<=12307||12308===e||12309===e||12310===e||12311===e||12312===e||12313===e||12314===e||12315===e||12316===e||12317===e||e>=12318&&e<=12319||12320===e||12336===e||64830===e||64831===e||e>=65093&&e<=65094}function se(e){e.forEach((function(e){if(delete e.location,g(e)||m(e))for(var t in e.options)delete e.options[t].location,se(e.options[t].value);else d(e)&&b(e.style)||(p(e)||f(e))&&_(e.style)?delete e.style.location:y(e)&&se(e.children)}))}function ue(e,t){void 0===t&&(t={}),t=u({shouldParseSkeletons:!0,requiresOtherClause:!0},t);var n=new ie(e,t).parse();if(n.err){var i=SyntaxError(a[n.err.kind]);throw i.location=n.err.location,i.originalMessage=n.err.message,i}return(null==t?void 0:t.captureLocation)||se(n.val),n.val}function le(e,t){var n=t&&t.cache?t.cache:ve,i=t&&t.serializer?t.serializer:fe;return(t&&t.strategy?t.strategy:pe)(e,{cache:n,serializer:i})}function he(e,t,n,i){var r,a=null==(r=i)||"number"==typeof r||"boolean"==typeof r?i:n(i),o=t.get(a);return void 0===o&&(o=e.call(this,i),t.set(a,o)),o}function ce(e,t,n){var i=Array.prototype.slice.call(arguments,3),r=n(i),a=t.get(r);return void 0===a&&(a=e.apply(this,i),t.set(r,a)),a}function de(e,t,n,i,r){return n.bind(t,e,i,r)}function pe(e,t){return de(e,this,1===e.length?he:ce,t.cache.create(),t.serializer)}var fe=function(){return JSON.stringify(arguments)};function ge(){this.cache=Object.create(null)}ge.prototype.get=function(e){return this.cache[e]},ge.prototype.set=function(e,t){this.cache[e]=t};var me,ve={create:function(){return new ge}},ye={variadic:function(e,t){return de(e,this,ce,t.cache.create(),t.serializer)},monadic:function(e,t){return de(e,this,he,t.cache.create(),t.serializer)}};!function(e){e.MISSING_VALUE="MISSING_VALUE",e.INVALID_VALUE="INVALID_VALUE",e.MISSING_INTL_API="MISSING_INTL_API"}(me||(me={}));var be,_e=function(e){function t(t,n,i){var r=e.call(this,t)||this;return r.code=n,r.originalMessage=i,r}return r(t,e),t.prototype.toString=function(){return"[formatjs Error: ".concat(this.code,"] ").concat(this.message)},t}(Error),we=function(e){function t(t,n,i,r){return e.call(this,'Invalid values for "'.concat(t,'": "').concat(n,'". Options are "').concat(Object.keys(i).join('", "'),'"'),me.INVALID_VALUE,r)||this}return r(t,e),t}(_e),Se=function(e){function t(t,n,i){return e.call(this,'Value for "'.concat(t,'" must be of type ').concat(n),me.INVALID_VALUE,i)||this}return r(t,e),t}(_e),Te=function(e){function t(t,n){return e.call(this,'The intl string context variable "'.concat(t,'" was not provided to the string "').concat(n,'"'),me.MISSING_VALUE,n)||this}return r(t,e),t}(_e);function Ae(e){return"function"==typeof e}function Ee(e,t,n,i,r,a,o){if(1===e.length&&h(e[0]))return[{type:be.literal,value:e[0].value}];for(var s=[],u=0,l=e;u<l.length;u++){var w=l[u];if(h(w))s.push({type:be.literal,value:w.value});else if(v(w))"number"==typeof a&&s.push({type:be.literal,value:n.getNumberFormat(t).format(a)});else{var S=w.value;if(!r||!(S in r))throw new Te(S,o);var T=r[S];if(c(w))T&&"string"!=typeof T&&"number"!=typeof T||(T="string"==typeof T||"number"==typeof T?String(T):""),s.push({type:"string"==typeof T?be.literal:be.object,value:T});else if(p(w)){var A="string"==typeof w.style?i.date[w.style]:_(w.style)?w.style.parsedOptions:void 0;s.push({type:be.literal,value:n.getDateTimeFormat(t,A).format(T)})}else if(f(w))A="string"==typeof w.style?i.time[w.style]:_(w.style)?w.style.parsedOptions:i.time.medium,s.push({type:be.literal,value:n.getDateTimeFormat(t,A).format(T)});else if(d(w))(A="string"==typeof w.style?i.number[w.style]:b(w.style)?w.style.parsedOptions:void 0)&&A.scale&&(T*=A.scale||1),s.push({type:be.literal,value:n.getNumberFormat(t,A).format(T)});else{if(y(w)){var E=w.children,C=w.value,x=r[C];if(!Ae(x))throw new Se(C,"function",o);var I=x(Ee(E,t,n,i,r,a).map((function(e){return e.value})));Array.isArray(I)||(I=[I]),s.push.apply(s,I.map((function(e){return{type:"string"==typeof e?be.literal:be.object,value:e}})))}if(g(w)){if(!(k=w.options[T]||w.options.other))throw new we(w.value,T,Object.keys(w.options),o);s.push.apply(s,Ee(k.value,t,n,i,r))}else if(m(w)){var k;if(!(k=w.options["=".concat(T)])){if(!Intl.PluralRules)throw new _e('Intl.PluralRules is not available in this environment.\nTry polyfilling it using "@formatjs/intl-pluralrules"\n',me.MISSING_INTL_API,o);var M=n.getPluralRules(t,{type:w.pluralType}).select(T-(w.offset||0));k=w.options[M]||w.options.other}if(!k)throw new we(w.value,T,Object.keys(w.options),o);s.push.apply(s,Ee(k.value,t,n,i,r,T-(w.offset||0)))}}}}return(P=s).length<2?P:P.reduce((function(e,t){var n=e[e.length-1];return n&&n.type===be.literal&&t.type===be.literal?n.value+=t.value:e.push(t),e}),[]);var P}function Ce(e){return{create:function(){return{get:function(t){return e[t]},set:function(t,n){e[t]=n}}}}}!function(e){e[e.literal=0]="literal",e[e.object=1]="object"}(be||(be={}));var xe=function(){function e(t,n,i,r){var a,o,s,h=this;if(void 0===n&&(n=e.defaultLocale),this.formatterCache={number:{},dateTime:{},pluralRules:{}},this.format=function(e){var t=h.formatToParts(e);if(1===t.length)return t[0].value;var n=t.reduce((function(e,t){return e.length&&t.type===be.literal&&"string"==typeof e[e.length-1]?e[e.length-1]+=t.value:e.push(t.value),e}),[]);return n.length<=1?n[0]||"":n},this.formatToParts=function(e){return Ee(h.ast,h.locales,h.formatters,h.formats,e,void 0,h.message)},this.resolvedOptions=function(){var e;return{locale:(null===(e=h.resolvedLocale)||void 0===e?void 0:e.toString())||Intl.NumberFormat.supportedLocalesOf(h.locales)[0]}},this.getAst=function(){return h.ast},this.locales=n,this.resolvedLocale=e.resolveLocale(n),"string"==typeof t){if(this.message=t,!e.__parse)throw new TypeError("IntlMessageFormat.__parse must be set to process `message` of type `string`");var c=r||{},d=(c.formatters,function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(c,["formatters"]));this.ast=e.__parse(t,u(u({},d),{locale:this.resolvedLocale}))}else this.ast=t;if(!Array.isArray(this.ast))throw new TypeError("A message must be provided as a String or AST.");this.formats=(o=e.formats,(s=i)?Object.keys(o).reduce((function(e,t){var n,i;return e[t]=(n=o[t],(i=s[t])?u(u(u({},n||{}),i||{}),Object.keys(n).reduce((function(e,t){return e[t]=u(u({},n[t]),i[t]||{}),e}),{})):n),e}),u({},o)):o),this.formatters=r&&r.formatters||(void 0===(a=this.formatterCache)&&(a={number:{},dateTime:{},pluralRules:{}}),{getNumberFormat:le((function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.NumberFormat).bind.apply(e,l([void 0],t,!1)))}),{cache:Ce(a.number),strategy:ye.variadic}),getDateTimeFormat:le((function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.DateTimeFormat).bind.apply(e,l([void 0],t,!1)))}),{cache:Ce(a.dateTime),strategy:ye.variadic}),getPluralRules:le((function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.PluralRules).bind.apply(e,l([void 0],t,!1)))}),{cache:Ce(a.pluralRules),strategy:ye.variadic})})}return Object.defineProperty(e,"defaultLocale",{get:function(){return e.memoizedDefaultLocale||(e.memoizedDefaultLocale=(new Intl.NumberFormat).resolvedOptions().locale),e.memoizedDefaultLocale},enumerable:!1,configurable:!0}),e.memoizedDefaultLocale=null,e.resolveLocale=function(e){if(void 0!==Intl.Locale){var t=Intl.NumberFormat.supportedLocalesOf(e);return t.length>0?new Intl.Locale(t[0]):new Intl.Locale("string"==typeof e?e:e[0])}},e.__parse=ue,e.formats={number:{integer:{maximumFractionDigits:0},currency:{style:"currency"},percent:{style:"percent"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}},e}();const Ie=xe},595:(e,t,n)=>{"use strict";n.d(t,{A:()=>jn});var i=Math.PI/180;const r="undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope?self:{},a={_global:r,version:"8.4.3",isBrowser:"undefined"!=typeof window&&("[object Window]"==={}.toString.call(window)||"[object global]"==={}.toString.call(window)),isUnminified:/param/.test(function(e){}.toString()),dblClickWindow:400,getAngle:e=>a.angleDeg?e*i:e,enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging:()=>a.DD.isDragging,isDragReady:()=>!!a.DD.node,releaseCanvasOnDestroy:!0,document:r.document,_injectGlobal(e){r.Konva=e}},o=e=>{a[e.prototype.getClassName()]=e};a._injectGlobal(a);class s{constructor(e=[1,0,0,1,0,0]){this.dirty=!1,this.m=e&&e.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new s(this.m)}copyInto(e){e.m[0]=this.m[0],e.m[1]=this.m[1],e.m[2]=this.m[2],e.m[3]=this.m[3],e.m[4]=this.m[4],e.m[5]=this.m[5]}point(e){var t=this.m;return{x:t[0]*e.x+t[2]*e.y+t[4],y:t[1]*e.x+t[3]*e.y+t[5]}}translate(e,t){return this.m[4]+=this.m[0]*e+this.m[2]*t,this.m[5]+=this.m[1]*e+this.m[3]*t,this}scale(e,t){return this.m[0]*=e,this.m[1]*=e,this.m[2]*=t,this.m[3]*=t,this}rotate(e){var t=Math.cos(e),n=Math.sin(e),i=this.m[0]*t+this.m[2]*n,r=this.m[1]*t+this.m[3]*n,a=this.m[0]*-n+this.m[2]*t,o=this.m[1]*-n+this.m[3]*t;return this.m[0]=i,this.m[1]=r,this.m[2]=a,this.m[3]=o,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(e,t){var n=this.m[0]+this.m[2]*t,i=this.m[1]+this.m[3]*t,r=this.m[2]+this.m[0]*e,a=this.m[3]+this.m[1]*e;return this.m[0]=n,this.m[1]=i,this.m[2]=r,this.m[3]=a,this}multiply(e){var t=this.m[0]*e.m[0]+this.m[2]*e.m[1],n=this.m[1]*e.m[0]+this.m[3]*e.m[1],i=this.m[0]*e.m[2]+this.m[2]*e.m[3],r=this.m[1]*e.m[2]+this.m[3]*e.m[3],a=this.m[0]*e.m[4]+this.m[2]*e.m[5]+this.m[4],o=this.m[1]*e.m[4]+this.m[3]*e.m[5]+this.m[5];return this.m[0]=t,this.m[1]=n,this.m[2]=i,this.m[3]=r,this.m[4]=a,this.m[5]=o,this}invert(){var e=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),t=this.m[3]*e,n=-this.m[1]*e,i=-this.m[2]*e,r=this.m[0]*e,a=e*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),o=e*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=t,this.m[1]=n,this.m[2]=i,this.m[3]=r,this.m[4]=a,this.m[5]=o,this}getMatrix(){return this.m}decompose(){var e=this.m[0],t=this.m[1],n=this.m[2],i=this.m[3],r=e*i-t*n;let a={x:this.m[4],y:this.m[5],rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!=e||0!=t){var o=Math.sqrt(e*e+t*t);a.rotation=t>0?Math.acos(e/o):-Math.acos(e/o),a.scaleX=o,a.scaleY=r/o,a.skewX=(e*n+t*i)/r,a.skewY=0}else if(0!=n||0!=i){var s=Math.sqrt(n*n+i*i);a.rotation=Math.PI/2-(i>0?Math.acos(-n/s):-Math.acos(n/s)),a.scaleX=r/s,a.scaleY=s,a.skewX=0,a.skewY=(e*n+t*i)/r}return a.rotation=g._getRotation(a.rotation),a}}var u=Math.PI/180,l=180/Math.PI,h="Konva error: ",c={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},d=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,p=[];const f="undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||function(e){setTimeout(e,60)},g={_isElement:e=>!(!e||1!=e.nodeType),_isFunction:e=>!!(e&&e.constructor&&e.call&&e.apply),_isPlainObject:e=>!!e&&e.constructor===Object,_isArray:e=>"[object Array]"===Object.prototype.toString.call(e),_isNumber:e=>"[object Number]"===Object.prototype.toString.call(e)&&!isNaN(e)&&isFinite(e),_isString:e=>"[object String]"===Object.prototype.toString.call(e),_isBoolean:e=>"[object Boolean]"===Object.prototype.toString.call(e),isObject:e=>e instanceof Object,isValidSelector(e){if("string"!=typeof e)return!1;var t=e[0];return"#"===t||"."===t||t===t.toUpperCase()},_sign:e=>0===e||e>0?1:-1,requestAnimFrame(e){p.push(e),1===p.length&&f((function(){const e=p;p=[],e.forEach((function(e){e()}))}))},createCanvasElement(){var e=document.createElement("canvas");try{e.style=e.style||{}}catch(e){}return e},createImageElement:()=>document.createElement("img"),_isInDocument(e){for(;e=e.parentNode;)if(e==document)return!0;return!1},_urlToImage(e,t){var n=g.createImageElement();n.onload=function(){t(n)},n.src=e},_rgbToHex:(e,t,n)=>((1<<24)+(e<<16)+(t<<8)+n).toString(16).slice(1),_hexToRgb(e){e=e.replace("#","");var t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:255&t}},getRandomColor(){for(var e=(16777215*Math.random()<<0).toString(16);e.length<6;)e="0"+e;return"#"+e},getRGB(e){var t;return e in c?{r:(t=c[e])[0],g:t[1],b:t[2]}:"#"===e[0]?this._hexToRgb(e.substring(1)):"rgb("===e.substr(0,4)?(t=d.exec(e.replace(/ /g,"")),{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}):{r:0,g:0,b:0}},colorToRGBA:e=>(e=e||"black",g._namedColorToRBA(e)||g._hex3ColorToRGBA(e)||g._hex4ColorToRGBA(e)||g._hex6ColorToRGBA(e)||g._hex8ColorToRGBA(e)||g._rgbColorToRGBA(e)||g._rgbaColorToRGBA(e)||g._hslColorToRGBA(e)),_namedColorToRBA(e){var t=c[e.toLowerCase()];return t?{r:t[0],g:t[1],b:t[2],a:1}:null},_rgbColorToRGBA(e){if(0===e.indexOf("rgb(")){var t=(e=e.match(/rgb\(([^)]+)\)/)[1]).split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:1}}},_rgbaColorToRGBA(e){if(0===e.indexOf("rgba(")){var t=(e=e.match(/rgba\(([^)]+)\)/)[1]).split(/ *, */).map(((e,t)=>"%"===e.slice(-1)?3===t?parseInt(e)/100:parseInt(e)/100*255:Number(e)));return{r:t[0],g:t[1],b:t[2],a:t[3]}}},_hex8ColorToRGBA(e){if("#"===e[0]&&9===e.length)return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:parseInt(e.slice(7,9),16)/255}},_hex6ColorToRGBA(e){if("#"===e[0]&&7===e.length)return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:1}},_hex4ColorToRGBA(e){if("#"===e[0]&&5===e.length)return{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16),a:parseInt(e[4]+e[4],16)/255}},_hex3ColorToRGBA(e){if("#"===e[0]&&4===e.length)return{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16),a:1}},_hslColorToRGBA(e){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(e)){const[t,...n]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e),i=Number(n[0])/360,r=Number(n[1])/100,a=Number(n[2])/100;let o,s,u;if(0===r)return u=255*a,{r:Math.round(u),g:Math.round(u),b:Math.round(u),a:1};o=a<.5?a*(1+r):a+r-a*r;const l=2*a-o,h=[0,0,0];for(let e=0;e<3;e++)s=i+1/3*-(e-1),s<0&&s++,s>1&&s--,u=6*s<1?l+6*(o-l)*s:2*s<1?o:3*s<2?l+(o-l)*(2/3-s)*6:l,h[e]=255*u;return{r:Math.round(h[0]),g:Math.round(h[1]),b:Math.round(h[2]),a:1}}},haveIntersection:(e,t)=>!(t.x>e.x+e.width||t.x+t.width<e.x||t.y>e.y+e.height||t.y+t.height<e.y),cloneObject(e){var t={};for(var n in e)this._isPlainObject(e[n])?t[n]=this.cloneObject(e[n]):this._isArray(e[n])?t[n]=this.cloneArray(e[n]):t[n]=e[n];return t},cloneArray:e=>e.slice(0),degToRad:e=>e*u,radToDeg:e=>e*l,_degToRad:e=>(g.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),g.degToRad(e)),_radToDeg:e=>(g.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),g.radToDeg(e)),_getRotation:e=>a.angleDeg?g.radToDeg(e):e,_capitalize:e=>e.charAt(0).toUpperCase()+e.slice(1),throw(e){throw new Error(h+e)},error(e){console.error(h+e)},warn(e){a.showWarnings&&console.warn("Konva warning: "+e)},each(e,t){for(var n in e)t(n,e[n])},_inRange:(e,t,n)=>t<=e&&e<n,_getProjectionToSegment(e,t,n,i,r,a){var o,s,u,l=(e-n)*(e-n)+(t-i)*(t-i);if(0==l)o=e,s=t,u=(r-n)*(r-n)+(a-i)*(a-i);else{var h=((r-e)*(n-e)+(a-t)*(i-t))/l;h<0?(o=e,s=t,u=(e-r)*(e-r)+(t-a)*(t-a)):h>1?(o=n,s=i,u=(n-r)*(n-r)+(i-a)*(i-a)):u=((o=e+h*(n-e))-r)*(o-r)+((s=t+h*(i-t))-a)*(s-a)}return[o,s,u]},_getProjectionToLine(e,t,n){var i=g.cloneObject(e),r=Number.MAX_VALUE;return t.forEach((function(a,o){if(n||o!==t.length-1){var s=t[(o+1)%t.length],u=g._getProjectionToSegment(a.x,a.y,s.x,s.y,e.x,e.y),l=u[0],h=u[1],c=u[2];c<r&&(i.x=l,i.y=h,r=c)}})),i},_prepareArrayForTween(e,t,n){var i,r=[],a=[];if(e.length>t.length){var o=t;t=e,e=o}for(i=0;i<e.length;i+=2)r.push({x:e[i],y:e[i+1]});for(i=0;i<t.length;i+=2)a.push({x:t[i],y:t[i+1]});var s=[];return a.forEach((function(e){var t=g._getProjectionToLine(e,r,n);s.push(t.x),s.push(t.y)})),s},_prepareToStringify(e){var t;for(var n in e.visitedByCircularReferenceRemoval=!0,e)if(e.hasOwnProperty(n)&&e[n]&&"object"==typeof e[n])if(t=Object.getOwnPropertyDescriptor(e,n),e[n].visitedByCircularReferenceRemoval||g._isElement(e[n])){if(!t.configurable)return null;delete e[n]}else if(null===g._prepareToStringify(e[n])){if(!t.configurable)return null;delete e[n]}return delete e.visitedByCircularReferenceRemoval,e},_assign(e,t){for(var n in t)e[n]=t[n];return e},_getFirstPointerId:e=>e.touches?e.changedTouches[0].identifier:e.pointerId||999,releaseCanvas(...e){a.releaseCanvasOnDestroy&&e.forEach((e=>{e.width=0,e.height=0}))},drawRoundedRectPath(e,t,n,i){let r=0,a=0,o=0,s=0;"number"==typeof i?r=a=o=s=Math.min(i,t/2,n/2):(r=Math.min(i[0]||0,t/2,n/2),a=Math.min(i[1]||0,t/2,n/2),s=Math.min(i[2]||0,t/2,n/2),o=Math.min(i[3]||0,t/2,n/2)),e.moveTo(r,0),e.lineTo(t-a,0),e.arc(t-a,a,a,3*Math.PI/2,0,!1),e.lineTo(t,n-s),e.arc(t-s,n-s,s,0,Math.PI/2,!1),e.lineTo(o,n),e.arc(o,n-o,o,Math.PI/2,Math.PI,!1),e.lineTo(0,r),e.arc(r,r,r,Math.PI,3*Math.PI/2,!1)}};function m(e){return g._isString(e)?'"'+e+'"':"[object Number]"===Object.prototype.toString.call(e)||g._isBoolean(e)?e:Object.prototype.toString.call(e)}function v(){if(a.isUnminified)return function(e,t){return g._isNumber(e)||g.warn(m(e)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),e}}function y(){if(a.isUnminified)return function(e,t){return g._isNumber(e)||"auto"===e||g.warn(m(e)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),e}}function b(){if(a.isUnminified)return function(e,t){return g._isString(e)||g.warn(m(e)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),e}}function _(){if(a.isUnminified)return function(e,t){const n=g._isString(e),i="[object CanvasGradient]"===Object.prototype.toString.call(e)||e&&e.addColorStop;return n||i||g.warn(m(e)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),e}}function w(){if(a.isUnminified)return function(e,t){return!0===e||!1===e||g.warn(m(e)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),e}}var S="get",T="set";const A={addGetterSetter(e,t,n,i,r){A.addGetter(e,t,n),A.addSetter(e,t,i,r),A.addOverloadedGetterSetter(e,t)},addGetter(e,t,n){var i=S+g._capitalize(t);e.prototype[i]=e.prototype[i]||function(){var e=this.attrs[t];return void 0===e?n:e}},addSetter(e,t,n,i){var r=T+g._capitalize(t);e.prototype[r]||A.overWriteSetter(e,t,n,i)},overWriteSetter(e,t,n,i){var r=T+g._capitalize(t);e.prototype[r]=function(e){return n&&null!=e&&(e=n.call(this,e,t)),this._setAttr(t,e),i&&i.call(this),this}},addComponentsGetterSetter(e,t,n,i,r){var o,s,u=n.length,l=g._capitalize,h=S+l(t),c=T+l(t);e.prototype[h]=function(){var e={};for(o=0;o<u;o++)e[s=n[o]]=this.getAttr(t+l(s));return e};var d=function(e){if(a.isUnminified)return function(t,n){return null==t||g.isObject(t)||g.warn(m(t)+' is a not valid value for "'+n+'" attribute. The value should be an object with properties '+e),t}}(n);e.prototype[c]=function(e){var a,o=this.attrs[t];for(a in i&&(e=i.call(this,e)),d&&d.call(this,e,t),e)e.hasOwnProperty(a)&&this._setAttr(t+l(a),e[a]);return e||n.forEach((e=>{this._setAttr(t+l(e),void 0)})),this._fireChangeEvent(t,o,e),r&&r.call(this),this},A.addOverloadedGetterSetter(e,t)},addOverloadedGetterSetter(e,t){var n=g._capitalize(t),i=T+n,r=S+n;e.prototype[t]=function(){return arguments.length?(this[i](arguments[0]),this):this[r]()}},addDeprecatedGetterSetter(e,t,n,i){g.error("Adding deprecated "+t);var r=S+g._capitalize(t),a=t+" property is deprecated and will be removed soon. Look at Konva change log for more information.";e.prototype[r]=function(){g.error(a);var e=this.attrs[t];return void 0===e?n:e},A.addSetter(e,t,i,(function(){g.error(a)})),A.addOverloadedGetterSetter(e,t)},backCompat(e,t){g.each(t,(function(t,n){var i=e.prototype[n],r=S+g._capitalize(t),a=T+g._capitalize(t);function o(){i.apply(this,arguments),g.error('"'+t+'" method is deprecated and will be removed soon. Use ""'+n+'" instead.')}e.prototype[t]=o,e.prototype[r]=o,e.prototype[a]=o}))},afterSetFilter(){this._filterUpToDate=!1}};var E,C=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"];class x{constructor(e){this.canvas=e,a.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,t){var n,i,r,a,o=this.traceArr,s=o.length,u="";for(n=0;n<s;n++)(r=(i=o[n]).method)?(a=i.args,u+=r,e?u+="()":g._isArray(a[0])?u+="(["+a.join(",")+"])":(t&&(a=a.map((e=>"number"==typeof e?Math.floor(e):e))),u+="("+a.join(",")+")")):(u+=i.property,e||(u+="="+i.val)),u+=";";return u}clearTrace(){this.traceArr=[]}_trace(e){var t=this.traceArr;t.push(e),t.length>=100&&t.shift()}reset(){var e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){var t=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,t.getWidth()/t.pixelRatio,t.getHeight()/t.pixelRatio)}_applyLineCap(e){const t=e.attrs.lineCap;t&&this.setAttr("lineCap",t)}_applyOpacity(e){var t=e.getAbsoluteOpacity();1!==t&&this.setAttr("globalAlpha",t)}_applyLineJoin(e){const t=e.attrs.lineJoin;t&&this.setAttr("lineJoin",t)}setAttr(e,t){this._context[e]=t}arc(e,t,n,i,r,a){this._context.arc(e,t,n,i,r,a)}arcTo(e,t,n,i,r){this._context.arcTo(e,t,n,i,r)}beginPath(){this._context.beginPath()}bezierCurveTo(e,t,n,i,r,a){this._context.bezierCurveTo(e,t,n,i,r,a)}clearRect(e,t,n,i){this._context.clearRect(e,t,n,i)}clip(){this._context.clip()}closePath(){this._context.closePath()}createImageData(e,t){var n=arguments;return 2===n.length?this._context.createImageData(e,t):1===n.length?this._context.createImageData(e):void 0}createLinearGradient(e,t,n,i){return this._context.createLinearGradient(e,t,n,i)}createPattern(e,t){return this._context.createPattern(e,t)}createRadialGradient(e,t,n,i,r,a){return this._context.createRadialGradient(e,t,n,i,r,a)}drawImage(e,t,n,i,r,a,o,s,u){var l=arguments,h=this._context;3===l.length?h.drawImage(e,t,n):5===l.length?h.drawImage(e,t,n,i,r):9===l.length&&h.drawImage(e,t,n,i,r,a,o,s,u)}ellipse(e,t,n,i,r,a,o,s){this._context.ellipse(e,t,n,i,r,a,o,s)}isPointInPath(e,t,n,i){return n?this._context.isPointInPath(n,e,t,i):this._context.isPointInPath(e,t,i)}fill(e){e?this._context.fill(e):this._context.fill()}fillRect(e,t,n,i){this._context.fillRect(e,t,n,i)}strokeRect(e,t,n,i){this._context.strokeRect(e,t,n,i)}fillText(e,t,n,i){i?this._context.fillText(e,t,n,i):this._context.fillText(e,t,n)}measureText(e){return this._context.measureText(e)}getImageData(e,t,n,i){return this._context.getImageData(e,t,n,i)}lineTo(e,t){this._context.lineTo(e,t)}moveTo(e,t){this._context.moveTo(e,t)}rect(e,t,n,i){this._context.rect(e,t,n,i)}putImageData(e,t,n){this._context.putImageData(e,t,n)}quadraticCurveTo(e,t,n,i){this._context.quadraticCurveTo(e,t,n,i)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,t){this._context.scale(e,t)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,t,n,i,r,a){this._context.setTransform(e,t,n,i,r,a)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,t,n,i){this._context.strokeText(e,t,n,i)}transform(e,t,n,i,r,a){this._context.transform(e,t,n,i,r,a)}translate(e,t){this._context.translate(e,t)}_enableTrace(){var e,t,n=this,i=C.length,r=this.setAttr,a=function(e){var i,r=n[e];n[e]=function(){return t=function(e){var t,n,i=[],r=e.length,a=g;for(t=0;t<r;t++)n=e[t],a._isNumber(n)?n=Math.round(1e3*n)/1e3:a._isString(n)||(n+=""),i.push(n);return i}(Array.prototype.slice.call(arguments,0)),i=r.apply(n,arguments),n._trace({method:e,args:t}),i}};for(e=0;e<i;e++)a(C[e]);n.setAttr=function(){r.apply(n,arguments);var e=arguments[0],t=arguments[1];"shadowOffsetX"!==e&&"shadowOffsetY"!==e&&"shadowBlur"!==e||(t/=this.canvas.getPixelRatio()),n._trace({property:e,val:t})}}_applyGlobalCompositeOperation(e){const t=e.attrs.globalCompositeOperation;!t||"source-over"===t||this.setAttr("globalCompositeOperation",t)}}["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"].forEach((function(e){Object.defineProperty(x.prototype,e,{get(){return this._context[e]},set(t){this._context[e]=t}})}));class I extends x{constructor(e){super(e),this._context=e._canvas.getContext("2d")}_fillColor(e){var t=e.fill();this.setAttr("fillStyle",t),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){var t=e._getLinearGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fillRadialGradient(e){const t=e._getRadialGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fill(e){const t=e.fill(),n=e.getFillPriority();if(t&&"color"===n)return void this._fillColor(e);const i=e.getFillPatternImage();if(i&&"pattern"===n)return void this._fillPattern(e);const r=e.getFillLinearGradientColorStops();if(r&&"linear-gradient"===n)return void this._fillLinearGradient(e);const a=e.getFillRadialGradientColorStops();a&&"radial-gradient"===n?this._fillRadialGradient(e):t?this._fillColor(e):i?this._fillPattern(e):r?this._fillLinearGradient(e):a&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const t=e.getStrokeLinearGradientStartPoint(),n=e.getStrokeLinearGradientEndPoint(),i=e.getStrokeLinearGradientColorStops(),r=this.createLinearGradient(t.x,t.y,n.x,n.y);if(i){for(var a=0;a<i.length;a+=2)r.addColorStop(i[a],i[a+1]);this.setAttr("strokeStyle",r)}}_stroke(e){var t=e.dash(),n=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!n){this.save();var i=this.getCanvas().getPixelRatio();this.setTransform(i,0,0,i,0,0)}this._applyLineCap(e),t&&e.dashEnabled()&&(this.setLineDash(t),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),e.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),n||this.restore()}}_applyShadow(e){var t,n,i,r=null!==(t=e.getShadowRGBA())&&void 0!==t?t:"black",a=null!==(n=e.getShadowBlur())&&void 0!==n?n:5,o=null!==(i=e.getShadowOffset())&&void 0!==i?i:{x:0,y:0},s=e.getAbsoluteScale(),u=this.canvas.getPixelRatio(),l=s.x*u,h=s.y*u;this.setAttr("shadowColor",r),this.setAttr("shadowBlur",a*Math.min(Math.abs(l),Math.abs(h))),this.setAttr("shadowOffsetX",o.x*l),this.setAttr("shadowOffsetY",o.y*h)}}class k extends x{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const r=e.getStrokeScaleEnabled();if(!r){this.save();var t=this.getCanvas().getPixelRatio();this.setTransform(t,0,0,t,0,0)}this._applyLineCap(e);var n=e.hitStrokeWidth(),i="auto"===n?e.strokeWidth():n;this.setAttr("lineWidth",i),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),r||this.restore()}}}class M{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var t=(e||{}).pixelRatio||a.pixelRatio||function(){if(E)return E;var e=g.createCanvasElement(),t=e.getContext("2d");return E=(a._global.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1),g.releaseCanvas(e),E}();this.pixelRatio=t,this._canvas=g.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){var t=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/t,this.getHeight()/t)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";var t=this.pixelRatio;this.getContext()._context.scale(t,t)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";var t=this.pixelRatio;this.getContext()._context.scale(t,t)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,t){this.setWidth(e||0),this.setHeight(t||0)}toDataURL(e,t){try{return this._canvas.toDataURL(e,t)}catch(e){try{return this._canvas.toDataURL()}catch(e){return g.error("Unable to get data URL. "+e.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}A.addGetterSetter(M,"pixelRatio",void 0,v());class P extends M{constructor(e={width:0,height:0}){super(e),this.context=new I(this),this.setSize(e.width,e.height)}}class L extends M{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new k(this),this.setSize(e.width,e.height)}}const D={get isDragging(){var e=!1;return D._dragElements.forEach((t=>{"dragging"===t.dragStatus&&(e=!0)})),e},justDragged:!1,get node(){var e;return D._dragElements.forEach((t=>{e=t.node})),e},_dragElements:new Map,_drag(e){const t=[];D._dragElements.forEach(((n,i)=>{const{node:r}=n,a=r.getStage();a.setPointersPositions(e),void 0===n.pointerId&&(n.pointerId=g._getFirstPointerId(e));const o=a._changedPointerPositions.find((e=>e.id===n.pointerId));if(o){if("dragging"!==n.dragStatus){var s=r.dragDistance();if(Math.max(Math.abs(o.x-n.startPointerPos.x),Math.abs(o.y-n.startPointerPos.y))<s)return;if(r.startDrag({evt:e}),!r.isDragging())return}r._setDragPosition(e,n),t.push(r)}})),t.forEach((t=>{t.fire("dragmove",{type:"dragmove",target:t,evt:e},!0)}))},_endDragBefore(e){const t=[];D._dragElements.forEach((n=>{const{node:i}=n,r=i.getStage();if(e&&r.setPointersPositions(e),!r._changedPointerPositions.find((e=>e.id===n.pointerId)))return;"dragging"!==n.dragStatus&&"stopped"!==n.dragStatus||(D.justDragged=!0,a._mouseListenClick=!1,a._touchListenClick=!1,a._pointerListenClick=!1,n.dragStatus="stopped");const o=n.node.getLayer()||n.node instanceof a.Stage&&n.node;o&&-1===t.indexOf(o)&&t.push(o)})),t.forEach((e=>{e.draw()}))},_endDragAfter(e){D._dragElements.forEach(((t,n)=>{"stopped"===t.dragStatus&&t.node.fire("dragend",{type:"dragend",target:t.node,evt:e},!0),"dragging"!==t.dragStatus&&D._dragElements.delete(n)}))}};a.isBrowser&&(window.addEventListener("mouseup",D._endDragBefore,!0),window.addEventListener("touchend",D._endDragBefore,!0),window.addEventListener("mousemove",D._drag),window.addEventListener("touchmove",D._drag),window.addEventListener("mouseup",D._endDragAfter,!1),window.addEventListener("touchend",D._endDragAfter,!1));var R="absoluteOpacity",N="allEventListeners",O="absoluteTransform",U="absoluteScale",B="canvas",F="listening",G="mouseenter",j="mouseleave",H="Shape",V=" ",W="stage",z="transform",X="visible",K=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(V);let Y=1;class q{constructor(e){this._id=Y++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){e!==z&&e!==O||!this._cache.get(e)?e?this._cache.delete(e):this._cache.clear():this._cache.get(e).dirty=!0}_getCache(e,t){var n=this._cache.get(e);return(void 0===n||(e===z||e===O)&&!0===n.dirty)&&(n=t.call(this),this._cache.set(e,n)),n}_calculate(e,t,n){if(!this._attachedDepsListeners.get(e)){const n=t.map((e=>e+"Change.konva")).join(V);this.on(n,(()=>{this._clearCache(e)})),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,n)}_getCanvasCache(){return this._cache.get(B)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===O&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(B)){const{scene:e,filter:t,hit:n}=this._cache.get(B);g.releaseCanvas(e,t,n),this._cache.delete(B)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){var t=e||{},n={};void 0!==t.x&&void 0!==t.y&&void 0!==t.width&&void 0!==t.height||(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()}));var i=Math.ceil(t.width||n.width),r=Math.ceil(t.height||n.height),a=t.pixelRatio,o=void 0===t.x?Math.floor(n.x):t.x,s=void 0===t.y?Math.floor(n.y):t.y,u=t.offset||0,l=t.drawBorder||!1,h=t.hitCanvasPixelRatio||1;if(i&&r){o-=u,s-=u;var c=new P({pixelRatio:a,width:i+=2*u+1,height:r+=2*u+1}),d=new P({pixelRatio:a,width:0,height:0}),p=new L({pixelRatio:h,width:i,height:r}),f=c.getContext(),m=p.getContext();return p.isCache=!0,c.isCache=!0,this._cache.delete(B),this._filterUpToDate=!1,!1===t.imageSmoothingEnabled&&(c.getContext()._context.imageSmoothingEnabled=!1,d.getContext()._context.imageSmoothingEnabled=!1),f.save(),m.save(),f.translate(-o,-s),m.translate(-o,-s),this._isUnderCache=!0,this._clearSelfAndDescendantCache(R),this._clearSelfAndDescendantCache(U),this.drawScene(c,this),this.drawHit(p,this),this._isUnderCache=!1,f.restore(),m.restore(),l&&(f.save(),f.beginPath(),f.rect(0,0,i,r),f.closePath(),f.setAttr("strokeStyle","red"),f.setAttr("lineWidth",5),f.stroke(),f.restore()),this._cache.set(B,{scene:c,filter:d,hit:p,x:o,y:s}),this._requestDraw(),this}g.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.")}isCached(){return this._cache.has(B)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,t){var n,i,r,a,o=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],s=this.getAbsoluteTransform(t);return o.forEach((function(e){var t=s.point(e);void 0===n&&(n=r=t.x,i=a=t.y),n=Math.min(n,t.x),i=Math.min(i,t.y),r=Math.max(r,t.x),a=Math.max(a,t.y)})),{x:n,y:i,width:r-n,height:a-i}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const t=this._getCanvasCache();e.translate(t.x,t.y);var n=this._getCachedSceneCanvas(),i=n.pixelRatio;e.drawImage(n._canvas,0,0,n.width/i,n.height/i),e.restore()}_drawCachedHitCanvas(e){var t=this._getCanvasCache(),n=t.hit;e.save(),e.translate(t.x,t.y),e.drawImage(n._canvas,0,0,n.width/n.pixelRatio,n.height/n.pixelRatio),e.restore()}_getCachedSceneCanvas(){var e,t,n,i,r=this.filters(),a=this._getCanvasCache(),o=a.scene,s=a.filter,u=s.getContext();if(r){if(!this._filterUpToDate){var l=o.pixelRatio;s.setSize(o.width/o.pixelRatio,o.height/o.pixelRatio);try{for(e=r.length,u.clear(),u.drawImage(o._canvas,0,0,o.getWidth()/l,o.getHeight()/l),t=u.getImageData(0,0,s.getWidth(),s.getHeight()),n=0;n<e;n++)"function"==typeof(i=r[n])?(i.call(this,t),u.putImageData(t,0,0)):g.error("Filter should be type of function, but got "+typeof i+" instead. Please check correct filters")}catch(e){g.error("Unable to apply filter. "+e.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return s}return o}on(e,t){if(this._cache&&this._cache.delete(N),3===arguments.length)return this._delegate.apply(this,arguments);var n,i,r,a,o=e.split(V),s=o.length;for(n=0;n<s;n++)r=(i=o[n].split("."))[0],a=i[1]||"",this.eventListeners[r]||(this.eventListeners[r]=[]),this.eventListeners[r].push({name:a,handler:t});return this}off(e,t){var n,i,r,a,o,s=(e||"").split(V),u=s.length;if(this._cache&&this._cache.delete(N),!e)for(i in this.eventListeners)this._off(i);for(n=0;n<u;n++)if(a=(r=s[n].split("."))[0],o=r[1],a)this.eventListeners[a]&&this._off(a,o,t);else for(i in this.eventListeners)this._off(i,o,t);return this}dispatchEvent(e){var t={target:this,type:e.type,evt:e};return this.fire(e.type,t),this}addEventListener(e,t){return this.on(e,(function(e){t.call(this,e.evt)})),this}removeEventListener(e){return this.off(e),this}_delegate(e,t,n){var i=this;this.on(e,(function(e){for(var r=e.target.findAncestors(t,!0,i),a=0;a<r.length;a++)(e=g.cloneObject(e)).currentTarget=r[a],n.call(r[a],e)}))}remove(){return this.isDragging()&&this.stopDrag(),D._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(O),this._clearSelfAndDescendantCache(R),this._clearSelfAndDescendantCache(U),this._clearSelfAndDescendantCache(W),this._clearSelfAndDescendantCache(X),this._clearSelfAndDescendantCache(F)}_remove(){this._clearCaches();var e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){var t="get"+g._capitalize(e);return g._isFunction(this[t])?this[t]():this.attrs[e]}getAncestors(){for(var e=this.getParent(),t=[];e;)t.push(e),e=e.getParent();return t}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges((()=>{var t,n;if(!e)return this;for(t in e)"children"!==t&&(n="set"+g._capitalize(t),g._isFunction(this[n])?this[n](e[t]):this._setAttr(t,e[t]))})),this}isListening(){return this._getCache(F,this._isListening)}_isListening(e){if(!this.listening())return!1;const t=this.getParent();return!t||t===e||this===e||t._isListening(e)}isVisible(){return this._getCache(X,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const t=this.getParent();return!t||t===e||this===e||t._isVisible(e)}shouldDrawHit(e,t=!1){if(e)return this._isVisible(e)&&this._isListening(e);var n=this.getLayer(),i=!1;D._dragElements.forEach((e=>{"dragging"===e.dragStatus&&("Stage"===e.node.nodeType||e.node.getLayer()===n)&&(i=!0)}));var r=!t&&!a.hitOnDragEnabled&&i;return this.isListening()&&this.isVisible()&&!r}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){var e,t,n,i,r=this.getDepth(),a=this,o=0;return"Stage"!==a.nodeType&&function s(u){for(e=[],t=u.length,n=0;n<t;n++)i=u[n],o++,i.nodeType!==H&&(e=e.concat(i.getChildren().slice())),i._id===a._id&&(n=t);e.length>0&&e[0].getDepth()<=r&&s(e)}(a.getStage().getChildren()),o}getDepth(){for(var e=0,t=this.parent;t;)e++,t=t.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(z),this._clearSelfAndDescendantCache(O)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges((()=>{this.x(e.x),this.y(e.y)})),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){if(!this.getStage())return null;var e=this.getStage().getPointerPosition();if(!e)return null;var t=this.getAbsoluteTransform().copy();return t.invert(),t.point(e)}getAbsolutePosition(e){let t=!1,n=this.parent;for(;n;){if(n.isCached()){t=!0;break}n=n.parent}t&&!e&&(e=!0);var i=this.getAbsoluteTransform(e).getMatrix(),r=new s,a=this.offset();return r.m=i.slice(),r.translate(a.x,a.y),r.getTranslation()}setAbsolutePosition(e){var t=this._clearTransform();this.attrs.x=t.x,this.attrs.y=t.y,delete t.x,delete t.y,this._clearCache(z);var n=this._getAbsoluteTransform().copy();return n.invert(),n.translate(e.x,e.y),e={x:this.attrs.x+n.getTranslation().x,y:this.attrs.y+n.getTranslation().y},this._setTransform(t),this.setPosition({x:e.x,y:e.y}),this._clearCache(z),this._clearSelfAndDescendantCache(O),this}_setTransform(e){var t;for(t in e)this.attrs[t]=e[t]}_clearTransform(){var e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){var t=e.x,n=e.y,i=this.x(),r=this.y();return void 0!==t&&(i+=t),void 0!==n&&(r+=n),this.setPosition({x:i,y:r}),this}_eachAncestorReverse(e,t){var n,i,r=[],a=this.getParent();if(!t||t._id!==this._id){for(r.unshift(this);a&&(!t||a._id!==t._id);)r.unshift(a),a=a.parent;for(n=r.length,i=0;i<n;i++)e(r[i])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return g.warn("Node has no parent. moveToTop function is ignored."),!1;var e=this.index;return e<this.parent.getChildren().length-1&&(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0)}moveUp(){if(!this.parent)return g.warn("Node has no parent. moveUp function is ignored."),!1;var e=this.index;return e<this.parent.getChildren().length-1&&(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0)}moveDown(){if(!this.parent)return g.warn("Node has no parent. moveDown function is ignored."),!1;var e=this.index;return e>0&&(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0)}moveToBottom(){if(!this.parent)return g.warn("Node has no parent. moveToBottom function is ignored."),!1;var e=this.index;return e>0&&(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0)}setZIndex(e){if(!this.parent)return g.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&g.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var t=this.index;return this.parent.children.splice(t,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(R,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){var e=this.opacity(),t=this.getParent();return t&&!t._isUnderCache&&(e*=t.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){var e,t,n,i,r={},a=this.getAttrs();for(e in r.attrs={},a)t=a[e],g.isObject(t)&&!g._isPlainObject(t)&&!g._isArray(t)||(n="function"==typeof this[e]&&this[e],delete a[e],i=n?n.call(this):null,a[e]=t,i!==t&&(r.attrs[e]=t));return r.className=this.getClassName(),g._prepareToStringify(r)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,t,n){var i=[];t&&this._isMatch(e)&&i.push(this);for(var r=this.parent;r;){if(r===n)return i;r._isMatch(e)&&i.push(r),r=r.parent}return i}isAncestorOf(e){return!1}findAncestor(e,t,n){return this.findAncestors(e,t,n)[0]}_isMatch(e){if(!e)return!1;if("function"==typeof e)return e(this);var t,n,i=e.replace(/ /g,"").split(","),r=i.length;for(t=0;t<r;t++)if(n=i[t],g.isValidSelector(n)||(g.warn('Selector "'+n+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),g.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),g.warn("Konva is awesome, right?")),"#"===n.charAt(0)){if(this.id()===n.slice(1))return!0}else if("."===n.charAt(0)){if(this.hasName(n.slice(1)))return!0}else if(this.className===n||this.nodeType===n)return!0;return!1}getLayer(){var e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(W,this._getStage)}_getStage(){var e=this.getParent();return e?e.getStage():void 0}fire(e,t={},n){return t.target=t.target||this,n?this._fireAndBubble(e,t):this._fire(e,t),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(O,this._getAbsoluteTransform)}_getAbsoluteTransform(e){var t;if(e)return t=new s,this._eachAncestorReverse((function(e){var n=e.transformsEnabled();"all"===n?t.multiply(e.getTransform()):"position"===n&&t.translate(e.x()-e.offsetX(),e.y()-e.offsetY())}),e),t;t=this._cache.get(O)||new s,this.parent?this.parent.getAbsoluteTransform().copyInto(t):t.reset();var n=this.transformsEnabled();if("all"===n)t.multiply(this.getTransform());else if("position"===n){const e=this.attrs.x||0,n=this.attrs.y||0,i=this.attrs.offsetX||0,r=this.attrs.offsetY||0;t.translate(e-i,n-r)}return t.dirty=!1,t}getAbsoluteScale(e){for(var t=this;t;)t._isUnderCache&&(e=t),t=t.getParent();const n=this.getAbsoluteTransform(e).decompose();return{x:n.scaleX,y:n.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(z,this._getTransform)}_getTransform(){var e,t,n=this._cache.get(z)||new s;n.reset();var i=this.x(),r=this.y(),o=a.getAngle(this.rotation()),u=null!==(e=this.attrs.scaleX)&&void 0!==e?e:1,l=null!==(t=this.attrs.scaleY)&&void 0!==t?t:1,h=this.attrs.skewX||0,c=this.attrs.skewY||0,d=this.attrs.offsetX||0,p=this.attrs.offsetY||0;return 0===i&&0===r||n.translate(i,r),0!==o&&n.rotate(o),0===h&&0===c||n.skew(h,c),1===u&&1===l||n.scale(u,l),0===d&&0===p||n.translate(-1*d,-1*p),n.dirty=!1,n}clone(e){var t,n,i,r,a,o=g.cloneObject(this.attrs);for(t in e)o[t]=e[t];var s=new this.constructor(o);for(t in this.eventListeners)for(i=(n=this.eventListeners[t]).length,r=0;r<i;r++)(a=n[r]).name.indexOf("konva")<0&&(s.eventListeners[t]||(s.eventListeners[t]=[]),s.eventListeners[t].push(a));return s}_toKonvaCanvas(e){e=e||{};var t=this.getClientRect(),n=this.getStage(),i=void 0!==e.x?e.x:Math.floor(t.x),r=void 0!==e.y?e.y:Math.floor(t.y),a=e.pixelRatio||1,o=new P({width:e.width||Math.ceil(t.width)||(n?n.width():0),height:e.height||Math.ceil(t.height)||(n?n.height():0),pixelRatio:a}),s=o.getContext();return!1===e.imageSmoothingEnabled&&(s._context.imageSmoothingEnabled=!1),s.save(),(i||r)&&s.translate(-1*i,-1*r),this.drawScene(o),s.restore(),o}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){var t=(e=e||{}).mimeType||null,n=e.quality||null,i=this._toKonvaCanvas(e).toDataURL(t,n);return e.callback&&e.callback(i),i}toImage(e){return new Promise(((t,n)=>{try{const n=null==e?void 0:e.callback;n&&delete e.callback,g._urlToImage(this.toDataURL(e),(function(e){t(e),null==n||n(e)}))}catch(e){n(e)}}))}toBlob(e){return new Promise(((t,n)=>{try{const n=null==e?void 0:e.callback;n&&delete e.callback,this.toCanvas(e).toBlob((e=>{t(e),null==n||n(e)}))}catch(e){n(e)}}))}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return void 0!==this.attrs.dragDistance?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():a.dragDistance}_off(e,t,n){var i,r,a,o=this.eventListeners[e];for(i=0;i<o.length;i++)if(r=o[i].name,a=o[i].handler,!("konva"===r&&"konva"!==t||t&&r!==t||n&&n!==a)){if(o.splice(i,1),0===o.length){delete this.eventListeners[e];break}i--}}_fireChangeEvent(e,t,n){this._fire(e+"Change",{oldVal:t,newVal:n})}addName(e){if(!this.hasName(e)){var t=this.name(),n=t?t+" "+e:e;this.name(n)}return this}hasName(e){if(!e)return!1;const t=this.name();return!!t&&-1!==(t||"").split(/\s/g).indexOf(e)}removeName(e){var t=(this.name()||"").split(/\s/g),n=t.indexOf(e);return-1!==n&&(t.splice(n,1),this.name(t.join(" "))),this}setAttr(e,t){var n=this["set"+g._capitalize(e)];return g._isFunction(n)?n.call(this,t):this._setAttr(e,t),this}_requestDraw(){if(a.autoDrawEnabled){const e=this.getLayer()||this.getStage();null==e||e.batchDraw()}}_setAttr(e,t){var n=this.attrs[e];(n!==t||g.isObject(t))&&(null==t?delete this.attrs[e]:this.attrs[e]=t,this._shouldFireChangeEvents&&this._fireChangeEvent(e,n,t),this._requestDraw())}_setComponentAttr(e,t,n){var i;void 0!==n&&((i=this.attrs[e])||(this.attrs[e]=this.getAttr(e)),this.attrs[e][t]=n,this._fireChangeEvent(e,i,n))}_fireAndBubble(e,t,n){if(t&&this.nodeType===H&&(t.target=this),e!==G&&e!==j||!(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||"Stage"===this.nodeType&&!n)){this._fire(e,t);var i=(e===G||e===j)&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(t&&!t.cancelBubble||!t)&&this.parent&&this.parent.isListening()&&!i&&(n&&n.parent?this._fireAndBubble.call(this.parent,e,t,n):this._fireAndBubble.call(this.parent,e,t))}}_getProtoListeners(e){let t=this._cache.get(N);if(!t){t={};let e=Object.getPrototypeOf(this);for(;e;)if(e.eventListeners){for(var n in e.eventListeners){const i=e.eventListeners[n],r=t[n]||[];t[n]=i.concat(r)}e=Object.getPrototypeOf(e)}else e=Object.getPrototypeOf(e);this._cache.set(N,t)}return t[e]}_fire(e,t){(t=t||{}).currentTarget=this,t.type=e;const n=this._getProtoListeners(e);if(n)for(var i=0;i<n.length;i++)n[i].handler.call(this,t);const r=this.eventListeners[e];if(r)for(i=0;i<r.length;i++)r[i].handler.call(this,t)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){var t=e?e.pointerId:void 0,n=this.getStage(),i=this.getAbsolutePosition(),r=n._getPointerById(t)||n._changedPointerPositions[0]||i;D._dragElements.set(this._id,{node:this,startPointerPos:r,offset:{x:r.x-i.x,y:r.y-i.y},dragStatus:"ready",pointerId:t})}startDrag(e,t=!0){D._dragElements.has(this._id)||this._createDragElement(e),D._dragElements.get(this._id).dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},t)}_setDragPosition(e,t){const n=this.getStage()._getPointerById(t.pointerId);if(n){var i={x:n.x-t.offset.x,y:n.y-t.offset.y},r=this.dragBoundFunc();if(void 0!==r){const t=r.call(this,i,e);t?i=t:g.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}this._lastPos&&this._lastPos.x===i.x&&this._lastPos.y===i.y||(this.setAbsolutePosition(i),this._requestDraw()),this._lastPos=i}}stopDrag(e){const t=D._dragElements.get(this._id);t&&(t.dragStatus="stopped"),D._endDragBefore(e),D._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=D._dragElements.get(this._id);return!!e&&"dragging"===e.dragStatus}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",(function(e){if((void 0===e.evt.button||a.dragButtons.indexOf(e.evt.button)>=0)&&!this.isDragging()){var t=!1;D._dragElements.forEach((e=>{this.isAncestorOf(e.node)&&(t=!0)})),t||this._createDragElement(e)}}))}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const e=D._dragElements.get(this._id),t=e&&"dragging"===e.dragStatus,n=e&&"ready"===e.dragStatus;t?this.stopDrag():n&&D._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const t=this.getStage();if(!t)return!1;const n={x:-e.x,y:-e.y,width:t.width()+2*e.x,height:t.height()+2*e.y};return g.haveIntersection(n,this.getClientRect())}static create(e,t){return g._isString(e)&&(e=JSON.parse(e)),this._createNode(e,t)}static _createNode(e,t){var n,i,r,o=q.prototype.getClassName.call(e),s=e.children;if(t&&(e.attrs.container=t),a[o]||(g.warn('Can not find a node with class name "'+o+'". Fallback to "Shape".'),o="Shape"),n=new(0,a[o])(e.attrs),s)for(i=s.length,r=0;r<i;r++)n.add(q._createNode(s[r]));return n}}q.prototype.nodeType="Node",q.prototype._attrsAffectingSize=[],q.prototype.eventListeners={},q.prototype.on.call(q.prototype,K,(function(){this._batchingTransformChange?this._needClearTransformCache=!0:(this._clearCache(z),this._clearSelfAndDescendantCache(O))})),q.prototype.on.call(q.prototype,"visibleChange.konva",(function(){this._clearSelfAndDescendantCache(X)})),q.prototype.on.call(q.prototype,"listeningChange.konva",(function(){this._clearSelfAndDescendantCache(F)})),q.prototype.on.call(q.prototype,"opacityChange.konva",(function(){this._clearSelfAndDescendantCache(R)}));const Z=A.addGetterSetter;Z(q,"zIndex"),Z(q,"absolutePosition"),Z(q,"position"),Z(q,"x",0,v()),Z(q,"y",0,v()),Z(q,"globalCompositeOperation","source-over",b()),Z(q,"opacity",1,v()),Z(q,"name","",b()),Z(q,"id","",b()),Z(q,"rotation",0,v()),A.addComponentsGetterSetter(q,"scale",["x","y"]),Z(q,"scaleX",1,v()),Z(q,"scaleY",1,v()),A.addComponentsGetterSetter(q,"skew",["x","y"]),Z(q,"skewX",0,v()),Z(q,"skewY",0,v()),A.addComponentsGetterSetter(q,"offset",["x","y"]),Z(q,"offsetX",0,v()),Z(q,"offsetY",0,v()),Z(q,"dragDistance",null,v()),Z(q,"width",0,v()),Z(q,"height",0,v()),Z(q,"listening",!0,w()),Z(q,"preventDefault",!0,w()),Z(q,"filters",null,(function(e){return this._filterUpToDate=!1,e})),Z(q,"visible",!0,w()),Z(q,"transformsEnabled","all",b()),Z(q,"size"),Z(q,"dragBoundFunc"),Z(q,"draggable",!1,w()),A.backCompat(q,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});class J extends q{constructor(){super(...arguments),this.children=[]}getChildren(e){if(!e)return this.children||[];const t=this.children||[];var n=[];return t.forEach((function(t){e(t)&&n.push(t)})),n}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach((e=>{e.parent=null,e.index=0,e.remove()})),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach((e=>{e.parent=null,e.index=0,e.destroy()})),this.children=[],this._requestDraw(),this}add(...e){if(0===e.length)return this;if(e.length>1){for(var t=0;t<e.length;t++)this.add(e[t]);return this}const n=e[0];return n.getParent()?(n.moveTo(this),this):(this._validateAdd(n),n.index=this.getChildren().length,n.parent=this,n._clearCaches(),this.getChildren().push(n),this._fire("add",{child:n}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){var t=this._generalFind(e,!0);return t.length>0?t[0]:void 0}_generalFind(e,t){var n=[];return this._descendants((i=>{const r=i._isMatch(e);return r&&n.push(i),!(!r||!t)})),n}_descendants(e){let t=!1;const n=this.getChildren();for(const i of n){if(t=e(i),t)return!0;if(i.hasChildren()&&(t=i._descendants(e),t))return!0}return!1}toObject(){var e=q.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach((t=>{e.children.push(t.toObject())})),e}isAncestorOf(e){for(var t=e.getParent();t;){if(t._id===this._id)return!0;t=t.getParent()}return!1}clone(e){var t=q.prototype.clone.call(this,e);return this.getChildren().forEach((function(e){t.add(e.clone())})),t}getAllIntersections(e){var t=[];return this.find("Shape").forEach((function(n){n.isVisible()&&n.intersects(e)&&t.push(n)})),t}_clearSelfAndDescendantCache(e){var t;super._clearSelfAndDescendantCache(e),this.isCached()||null===(t=this.children)||void 0===t||t.forEach((function(t){t._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;null===(e=this.children)||void 0===e||e.forEach((function(e,t){e.index=t})),this._requestDraw()}drawScene(e,t){var n=this.getLayer(),i=e||n&&n.getCanvas(),r=i&&i.getContext(),a=this._getCanvasCache(),o=a&&a.scene,s=i&&i.isCache;if(!this.isVisible()&&!s)return this;if(o){r.save();var u=this.getAbsoluteTransform(t).getMatrix();r.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedSceneCanvas(r),r.restore()}else this._drawChildren("drawScene",i,t);return this}drawHit(e,t){if(!this.shouldDrawHit(t))return this;var n=this.getLayer(),i=e||n&&n.hitCanvas,r=i&&i.getContext(),a=this._getCanvasCache();if(a&&a.hit){r.save();var o=this.getAbsoluteTransform(t).getMatrix();r.transform(o[0],o[1],o[2],o[3],o[4],o[5]),this._drawCachedHitCanvas(r),r.restore()}else this._drawChildren("drawHit",i,t);return this}_drawChildren(e,t,n){var i,r=t&&t.getContext(),a=this.clipWidth(),o=this.clipHeight(),s=this.clipFunc(),u=a&&o||s;const l=n===this;if(u){r.save();var h=this.getAbsoluteTransform(n),c=h.getMatrix();if(r.transform(c[0],c[1],c[2],c[3],c[4],c[5]),r.beginPath(),s)s.call(this,r,this);else{var d=this.clipX(),p=this.clipY();r.rect(d,p,a,o)}r.clip(),c=h.copy().invert().getMatrix(),r.transform(c[0],c[1],c[2],c[3],c[4],c[5])}var f=!l&&"source-over"!==this.globalCompositeOperation()&&"drawScene"===e;f&&(r.save(),r._applyGlobalCompositeOperation(this)),null===(i=this.children)||void 0===i||i.forEach((function(i){i[e](t,n)})),f&&r.restore(),u&&r.restore()}getClientRect(e){var t,n,i,r,a,o,s=(e=e||{}).skipTransform,u=e.relativeTo,l=this;null===(t=this.children)||void 0===t||t.forEach((function(t){if(t.visible()){var o=t.getClientRect({relativeTo:l,skipShadow:e.skipShadow,skipStroke:e.skipStroke});0===o.width&&0===o.height||(void 0===n?(n=o.x,i=o.y,r=o.x+o.width,a=o.y+o.height):(n=Math.min(n,o.x),i=Math.min(i,o.y),r=Math.max(r,o.x+o.width),a=Math.max(a,o.y+o.height)))}}));for(var h=this.find("Shape"),c=!1,d=0;d<h.length;d++)if(h[d]._isVisible(this)){c=!0;break}return o=c&&void 0!==n?{x:n,y:i,width:r-n,height:a-i}:{x:0,y:0,width:0,height:0},s?o:this._transformedRect(o,u)}}A.addComponentsGetterSetter(J,"clip",["x","y","width","height"]),A.addGetterSetter(J,"clipX",void 0,v()),A.addGetterSetter(J,"clipY",void 0,v()),A.addGetterSetter(J,"clipWidth",void 0,v()),A.addGetterSetter(J,"clipHeight",void 0,v()),A.addGetterSetter(J,"clipFunc");const Q=new Map,$=void 0!==a._global.PointerEvent;function ee(e){return Q.get(e)}function te(e){return{evt:e,pointerId:e.pointerId}}function ne(e,t){return Q.get(e)===t}function ie(e,t){re(e),t.getStage()&&(Q.set(e,t),$&&t._fire("gotpointercapture",te(new PointerEvent("gotpointercapture"))))}function re(e,t){const n=Q.get(e);if(!n)return;const i=n.getStage();i&&i.content,Q.delete(e),$&&n._fire("lostpointercapture",te(new PointerEvent("lostpointercapture")))}var ae="mouseleave",oe="mouseover",se="mouseenter",ue="mousemove",le="mousedown",he="mouseup",ce="pointermove",de="pointerdown",pe="pointerup",fe="pointercancel",ge="pointerout",me="pointerleave",ve="pointerover",ye="pointerenter",be="contextmenu",_e="touchstart",we="touchend",Se="touchmove",Te="touchcancel",Ae="wheel",Ee=[[se,"_pointerenter"],[le,"_pointerdown"],[ue,"_pointermove"],[he,"_pointerup"],[ae,"_pointerleave"],[_e,"_pointerdown"],[Se,"_pointermove"],[we,"_pointerup"],[Te,"_pointercancel"],[oe,"_pointerover"],[Ae,"_wheel"],[be,"_contextmenu"],[de,"_pointerdown"],[ce,"_pointermove"],[pe,"_pointerup"],[fe,"_pointercancel"],["lostpointercapture","_lostpointercapture"]];const Ce={mouse:{[ge]:"mouseout",[me]:ae,[ve]:oe,[ye]:se,[ce]:ue,[de]:le,[pe]:he,[fe]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[ge]:"touchout",[me]:"touchleave",[ve]:"touchover",[ye]:"touchenter",[ce]:Se,[de]:_e,[pe]:we,[fe]:Te,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[ge]:ge,[me]:me,[ve]:ve,[ye]:ye,[ce]:ce,[de]:de,[pe]:pe,[fe]:fe,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},xe=e=>e.indexOf("pointer")>=0?"pointer":e.indexOf("touch")>=0?"touch":"mouse",Ie=e=>{const t=xe(e);return"pointer"===t?a.pointerEventsEnabled&&Ce.pointer:"touch"===t?Ce.touch:"mouse"===t?Ce.mouse:void 0};function ke(e={}){return(e.clipFunc||e.clipWidth||e.clipHeight)&&g.warn("Stage does not support clipping. Please use clip for Layers or Groups."),e}const Me=[];class Pe extends J{constructor(e){super(ke(e)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),Me.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",(()=>{ke(this.attrs)})),this._checkVisibility()}_validateAdd(e){const t="Layer"===e.getType(),n="FastLayer"===e.getType();t||n||g.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const e=this.visible()?"":"none";this.content.style.display=e}setContainer(e){if("string"==typeof e){if("."===e.charAt(0)){var t=e.slice(1);e=document.getElementsByClassName(t)[0]}else{var n;n="#"!==e.charAt(0)?e:e.slice(1),e=document.getElementById(n)}if(!e)throw"Can not find container in document with id "+n}return this._setAttr("container",e),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),e.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){var e,t=this.children,n=t.length;for(e=0;e<n;e++)t[e].clear();return this}clone(e){return e||(e={}),e.container="undefined"!=typeof document&&document.createElement("div"),J.prototype.clone.call(this,e)}destroy(){super.destroy();var e=this.content;e&&g._isInDocument(e)&&this.container().removeChild(e);var t=Me.indexOf(this);return t>-1&&Me.splice(t,1),g.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const e=this._pointerPositions[0]||this._changedPointerPositions[0];return e?{x:e.x,y:e.y}:(g.warn("Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);"),null)}_getPointerById(e){return this._pointerPositions.find((t=>t.id===e))}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(e){(e=e||{}).x=e.x||0,e.y=e.y||0,e.width=e.width||this.width(),e.height=e.height||this.height();var t=new P({width:e.width,height:e.height,pixelRatio:e.pixelRatio||1}),n=t.getContext()._context,i=this.children;return(e.x||e.y)&&n.translate(-1*e.x,-1*e.y),i.forEach((function(t){if(t.isVisible()){var i=t._toKonvaCanvas(e);n.drawImage(i._canvas,e.x,e.y,i.getWidth()/i.getPixelRatio(),i.getHeight()/i.getPixelRatio())}})),t}getIntersection(e){if(!e)return null;var t,n=this.children;for(t=n.length-1;t>=0;t--){const i=n[t].getIntersection(e);if(i)return i}return null}_resizeDOM(){var e=this.width(),t=this.height();this.content&&(this.content.style.width=e+"px",this.content.style.height=t+"px"),this.bufferCanvas.setSize(e,t),this.bufferHitCanvas.setSize(e,t),this.children.forEach((n=>{n.setSize({width:e,height:t}),n.draw()}))}add(e,...t){if(arguments.length>1){for(var n=0;n<arguments.length;n++)this.add(arguments[n]);return this}super.add(e);var i=this.children.length;return i>5&&g.warn("The stage has "+i+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),e.setSize({width:this.width(),height:this.height()}),e.draw(),a.isBrowser&&this.content.appendChild(e.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(e){return ne(e,this)}setPointerCapture(e){ie(e,this)}releaseCapture(e){re(e)}getLayers(){return this.children}_bindContentEvents(){a.isBrowser&&Ee.forEach((([e,t])=>{this.content.addEventListener(e,(e=>{this[t](e)}),{passive:!1})}))}_pointerenter(e){this.setPointersPositions(e);const t=Ie(e.type);this._fire(t.pointerenter,{evt:e,target:this,currentTarget:this})}_pointerover(e){this.setPointersPositions(e);const t=Ie(e.type);this._fire(t.pointerover,{evt:e,target:this,currentTarget:this})}_getTargetShape(e){let t=this[e+"targetShape"];return t&&!t.getStage()&&(t=null),t}_pointerleave(e){const t=Ie(e.type),n=xe(e.type);if(t){this.setPointersPositions(e);var i=this._getTargetShape(n),r=!D.isDragging||a.hitOnDragEnabled;i&&r?(i._fireAndBubble(t.pointerout,{evt:e}),i._fireAndBubble(t.pointerleave,{evt:e}),this._fire(t.pointerleave,{evt:e,target:this,currentTarget:this}),this[n+"targetShape"]=null):r&&(this._fire(t.pointerleave,{evt:e,target:this,currentTarget:this}),this._fire(t.pointerout,{evt:e,target:this,currentTarget:this})),this.pointerPos=void 0,this._pointerPositions=[]}}_pointerdown(e){const t=Ie(e.type),n=xe(e.type);if(t){this.setPointersPositions(e);var i=!1;this._changedPointerPositions.forEach((r=>{var o=this.getIntersection(r);if(D.justDragged=!1,a["_"+n+"ListenClick"]=!0,!o||!o.isListening())return;a.capturePointerEventsEnabled&&o.setPointerCapture(r.id),this[n+"ClickStartShape"]=o,o._fireAndBubble(t.pointerdown,{evt:e,pointerId:r.id}),i=!0;const s=e.type.indexOf("touch")>=0;o.preventDefault()&&e.cancelable&&s&&e.preventDefault()})),i||this._fire(t.pointerdown,{evt:e,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}}_pointermove(e){const t=Ie(e.type),n=xe(e.type);if(!t)return;if(D.isDragging&&D.node.preventDefault()&&e.cancelable&&e.preventDefault(),this.setPointersPositions(e),D.isDragging&&!a.hitOnDragEnabled)return;var i={};let r=!1;var o=this._getTargetShape(n);this._changedPointerPositions.forEach((a=>{const s=ee(a.id)||this.getIntersection(a),u=a.id,l={evt:e,pointerId:u};var h=o!==s;if(h&&o&&(o._fireAndBubble(t.pointerout,Object.assign({},l),s),o._fireAndBubble(t.pointerleave,Object.assign({},l),s)),s){if(i[s._id])return;i[s._id]=!0}s&&s.isListening()?(r=!0,h&&(s._fireAndBubble(t.pointerover,Object.assign({},l),o),s._fireAndBubble(t.pointerenter,Object.assign({},l),o),this[n+"targetShape"]=s),s._fireAndBubble(t.pointermove,Object.assign({},l))):o&&(this._fire(t.pointerover,{evt:e,target:this,currentTarget:this,pointerId:u}),this[n+"targetShape"]=null)})),r||this._fire(t.pointermove,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(e){const t=Ie(e.type),n=xe(e.type);if(!t)return;this.setPointersPositions(e);const i=this[n+"ClickStartShape"],r=this[n+"ClickEndShape"];var o={};let s=!1;this._changedPointerPositions.forEach((u=>{const l=ee(u.id)||this.getIntersection(u);if(l){if(l.releaseCapture(u.id),o[l._id])return;o[l._id]=!0}const h=u.id,c={evt:e,pointerId:h};let d=!1;a["_"+n+"InDblClickWindow"]?(d=!0,clearTimeout(this[n+"DblTimeout"])):D.justDragged||(a["_"+n+"InDblClickWindow"]=!0,clearTimeout(this[n+"DblTimeout"])),this[n+"DblTimeout"]=setTimeout((function(){a["_"+n+"InDblClickWindow"]=!1}),a.dblClickWindow),l&&l.isListening()?(s=!0,this[n+"ClickEndShape"]=l,l._fireAndBubble(t.pointerup,Object.assign({},c)),a["_"+n+"ListenClick"]&&i&&i===l&&(l._fireAndBubble(t.pointerclick,Object.assign({},c)),d&&r&&r===l&&l._fireAndBubble(t.pointerdblclick,Object.assign({},c)))):(this[n+"ClickEndShape"]=null,a["_"+n+"ListenClick"]&&this._fire(t.pointerclick,{evt:e,target:this,currentTarget:this,pointerId:h}),d&&this._fire(t.pointerdblclick,{evt:e,target:this,currentTarget:this,pointerId:h}))})),s||this._fire(t.pointerup,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),a["_"+n+"ListenClick"]=!1,e.cancelable&&"touch"!==n&&e.preventDefault()}_contextmenu(e){this.setPointersPositions(e);var t=this.getIntersection(this.getPointerPosition());t&&t.isListening()?t._fireAndBubble(be,{evt:e}):this._fire(be,{evt:e,target:this,currentTarget:this})}_wheel(e){this.setPointersPositions(e);var t=this.getIntersection(this.getPointerPosition());t&&t.isListening()?t._fireAndBubble(Ae,{evt:e}):this._fire(Ae,{evt:e,target:this,currentTarget:this})}_pointercancel(e){this.setPointersPositions(e);const t=ee(e.pointerId)||this.getIntersection(this.getPointerPosition());t&&t._fireAndBubble(pe,te(e)),re(e.pointerId)}_lostpointercapture(e){re(e.pointerId)}setPointersPositions(e){var t=this._getContentPosition(),n=null,i=null;void 0!==(e=e||window.event).touches?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(e.touches,(e=>{this._pointerPositions.push({id:e.identifier,x:(e.clientX-t.left)/t.scaleX,y:(e.clientY-t.top)/t.scaleY})})),Array.prototype.forEach.call(e.changedTouches||e.touches,(e=>{this._changedPointerPositions.push({id:e.identifier,x:(e.clientX-t.left)/t.scaleX,y:(e.clientY-t.top)/t.scaleY})}))):(n=(e.clientX-t.left)/t.scaleX,i=(e.clientY-t.top)/t.scaleY,this.pointerPos={x:n,y:i},this._pointerPositions=[{x:n,y:i,id:g._getFirstPointerId(e)}],this._changedPointerPositions=[{x:n,y:i,id:g._getFirstPointerId(e)}])}_setPointerPosition(e){g.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(e)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};var e=this.content.getBoundingClientRect();return{top:e.top,left:e.left,scaleX:e.width/this.content.clientWidth||1,scaleY:e.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new P({width:this.width(),height:this.height()}),this.bufferHitCanvas=new L({pixelRatio:1,width:this.width(),height:this.height()}),a.isBrowser){var e=this.container();if(!e)throw"Stage has no container. A container is required.";e.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),e.appendChild(this.content),this._resizeDOM()}}cache(){return g.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach((function(e){e.batchDraw()})),this}}Pe.prototype.nodeType="Stage",o(Pe),A.addGetterSetter(Pe,"container");var Le="hasShadow",De="shadowRGBA",Re="patternImage",Ne="linearGradient",Oe="radialGradient";let Ue;function Be(){return Ue||(Ue=g.createCanvasElement().getContext("2d"),Ue)}const Fe={};class Ge extends q{constructor(e){let t;for(super(e);t=g.getRandomColor(),!t||t in Fe;);this.colorKey=t,Fe[t]=this}getContext(){return g.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return g.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(Le,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&0!==this.shadowOpacity()&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(Re,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const e=Be().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(e&&e.setTransform){const t=new s;t.translate(this.fillPatternX(),this.fillPatternY()),t.rotate(a.getAngle(this.fillPatternRotation())),t.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),t.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const n=t.getMatrix(),i="undefined"==typeof DOMMatrix?{a:n[0],b:n[1],c:n[2],d:n[3],e:n[4],f:n[5]}:new DOMMatrix(n);e.setTransform(i)}return e}}_getLinearGradient(){return this._getCache(Ne,this.__getLinearGradient)}__getLinearGradient(){var e=this.fillLinearGradientColorStops();if(e){for(var t=Be(),n=this.fillLinearGradientStartPoint(),i=this.fillLinearGradientEndPoint(),r=t.createLinearGradient(n.x,n.y,i.x,i.y),a=0;a<e.length;a+=2)r.addColorStop(e[a],e[a+1]);return r}}_getRadialGradient(){return this._getCache(Oe,this.__getRadialGradient)}__getRadialGradient(){var e=this.fillRadialGradientColorStops();if(e){for(var t=Be(),n=this.fillRadialGradientStartPoint(),i=this.fillRadialGradientEndPoint(),r=t.createRadialGradient(n.x,n.y,this.fillRadialGradientStartRadius(),i.x,i.y,this.fillRadialGradientEndRadius()),a=0;a<e.length;a+=2)r.addColorStop(e[a],e[a+1]);return r}}getShadowRGBA(){return this._getCache(De,this._getShadowRGBA)}_getShadowRGBA(){if(this.hasShadow()){var e=g.colorToRGBA(this.shadowColor());return e?"rgba("+e.r+","+e.g+","+e.b+","+e.a*(this.shadowOpacity()||1)+")":void 0}}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],(()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops())))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],(()=>this.strokeEnabled()&&this.strokeWidth()&&!(!this.stroke()&&!this.strokeLinearGradientColorStops())))}hasHitStroke(){const e=this.hitStrokeWidth();return"auto"===e?this.hasStroke():this.strokeEnabled()&&!!e}intersects(e){var t=this.getStage().bufferHitCanvas;return t.getContext().clear(),this.drawHit(t,null,!0),t.context.getImageData(Math.round(e.x),Math.round(e.y),1,1).data[3]>0}destroy(){return q.prototype.destroy.call(this),delete Fe[this.colorKey],delete this.colorKey,this}_useBufferCanvas(e){var t;if(!this.getStage())return!1;if(null!==(t=this.attrs.perfectDrawEnabled)&&void 0!==t&&!t)return!1;const n=e||this.hasFill(),i=this.hasStroke(),r=1!==this.getAbsoluteOpacity();if(n&&i&&r)return!0;const a=this.hasShadow(),o=this.shadowForStrokeEnabled();return!!(n&&i&&a&&o)}setStrokeHitEnabled(e){g.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),e?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return 0!==this.hitStrokeWidth()}getSelfRect(){var e=this.size();return{x:this._centroid?-e.width/2:0,y:this._centroid?-e.height/2:0,width:e.width,height:e.height}}getClientRect(e={}){const t=e.skipTransform,n=e.relativeTo,i=this.getSelfRect(),r=!e.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,a=i.width+r,o=i.height+r,s=!e.skipShadow&&this.hasShadow(),u=s?this.shadowOffsetX():0,l=s?this.shadowOffsetY():0,h=a+Math.abs(u),c=o+Math.abs(l),d=s&&this.shadowBlur()||0,p={width:h+2*d,height:c+2*d,x:-(r/2+d)+Math.min(u,0)+i.x,y:-(r/2+d)+Math.min(l,0)+i.y};return t?p:this._transformedRect(p,n)}drawScene(e,t){var n,i,r=this.getLayer(),a=e||r.getCanvas(),o=a.getContext(),s=this._getCanvasCache(),u=this.getSceneFunc(),l=this.hasShadow(),h=a.isCache,c=t===this;if(!this.isVisible()&&!c)return this;if(s){o.save();var d=this.getAbsoluteTransform(t).getMatrix();return o.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._drawCachedSceneCanvas(o),o.restore(),this}if(!u)return this;if(o.save(),this._useBufferCanvas()&&!h){(i=(n=this.getStage().bufferCanvas).getContext()).clear(),i.save(),i._applyLineJoin(this);var p=this.getAbsoluteTransform(t).getMatrix();i.transform(p[0],p[1],p[2],p[3],p[4],p[5]),u.call(this,i,this),i.restore();var f=n.pixelRatio;l&&o._applyShadow(this),o._applyOpacity(this),o._applyGlobalCompositeOperation(this),o.drawImage(n._canvas,0,0,n.width/f,n.height/f)}else o._applyLineJoin(this),c||(p=this.getAbsoluteTransform(t).getMatrix(),o.transform(p[0],p[1],p[2],p[3],p[4],p[5]),o._applyOpacity(this),o._applyGlobalCompositeOperation(this)),l&&o._applyShadow(this),u.call(this,o,this);return o.restore(),this}drawHit(e,t,n=!1){if(!this.shouldDrawHit(t,n))return this;var i=this.getLayer(),r=e||i.hitCanvas,a=r&&r.getContext(),o=this.hitFunc()||this.sceneFunc(),s=this._getCanvasCache(),u=s&&s.hit;if(this.colorKey||g.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),u){a.save();var l=this.getAbsoluteTransform(t).getMatrix();return a.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedHitCanvas(a),a.restore(),this}if(!o)return this;if(a.save(),a._applyLineJoin(this),this!==t){var h=this.getAbsoluteTransform(t).getMatrix();a.transform(h[0],h[1],h[2],h[3],h[4],h[5])}return o.call(this,a,this),a.restore(),this}drawHitFromCache(e=0){var t,n,i,r,a,o=this._getCanvasCache(),s=this._getCachedSceneCanvas(),u=o.hit,l=u.getContext(),h=u.getWidth(),c=u.getHeight();l.clear(),l.drawImage(s._canvas,0,0,h,c);try{for(i=(n=(t=l.getImageData(0,0,h,c)).data).length,r=g._hexToRgb(this.colorKey),a=0;a<i;a+=4)n[a+3]>e?(n[a]=r.r,n[a+1]=r.g,n[a+2]=r.b,n[a+3]=255):n[a+3]=0;l.putImageData(t,0,0)}catch(e){g.error("Unable to draw hit graph from cached scene canvas. "+e.message)}return this}hasPointerCapture(e){return ne(e,this)}setPointerCapture(e){ie(e,this)}releaseCapture(e){re(e)}}Ge.prototype._fillFunc=function(e){e.fill()},Ge.prototype._strokeFunc=function(e){e.stroke()},Ge.prototype._fillFuncHit=function(e){e.fill()},Ge.prototype._strokeFuncHit=function(e){e.stroke()},Ge.prototype._centroid=!1,Ge.prototype.nodeType="Shape",o(Ge),Ge.prototype.eventListeners={},Ge.prototype.on.call(Ge.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",(function(){this._clearCache(Le)})),Ge.prototype.on.call(Ge.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",(function(){this._clearCache(De)})),Ge.prototype.on.call(Ge.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",(function(){this._clearCache(Re)})),Ge.prototype.on.call(Ge.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",(function(){this._clearCache(Ne)})),Ge.prototype.on.call(Ge.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",(function(){this._clearCache(Oe)})),A.addGetterSetter(Ge,"stroke",void 0,_()),A.addGetterSetter(Ge,"strokeWidth",2,v()),A.addGetterSetter(Ge,"fillAfterStrokeEnabled",!1),A.addGetterSetter(Ge,"hitStrokeWidth","auto",y()),A.addGetterSetter(Ge,"strokeHitEnabled",!0,w()),A.addGetterSetter(Ge,"perfectDrawEnabled",!0,w()),A.addGetterSetter(Ge,"shadowForStrokeEnabled",!0,w()),A.addGetterSetter(Ge,"lineJoin"),A.addGetterSetter(Ge,"lineCap"),A.addGetterSetter(Ge,"sceneFunc"),A.addGetterSetter(Ge,"hitFunc"),A.addGetterSetter(Ge,"dash"),A.addGetterSetter(Ge,"dashOffset",0,v()),A.addGetterSetter(Ge,"shadowColor",void 0,b()),A.addGetterSetter(Ge,"shadowBlur",0,v()),A.addGetterSetter(Ge,"shadowOpacity",1,v()),A.addComponentsGetterSetter(Ge,"shadowOffset",["x","y"]),A.addGetterSetter(Ge,"shadowOffsetX",0,v()),A.addGetterSetter(Ge,"shadowOffsetY",0,v()),A.addGetterSetter(Ge,"fillPatternImage"),A.addGetterSetter(Ge,"fill",void 0,_()),A.addGetterSetter(Ge,"fillPatternX",0,v()),A.addGetterSetter(Ge,"fillPatternY",0,v()),A.addGetterSetter(Ge,"fillLinearGradientColorStops"),A.addGetterSetter(Ge,"strokeLinearGradientColorStops"),A.addGetterSetter(Ge,"fillRadialGradientStartRadius",0),A.addGetterSetter(Ge,"fillRadialGradientEndRadius",0),A.addGetterSetter(Ge,"fillRadialGradientColorStops"),A.addGetterSetter(Ge,"fillPatternRepeat","repeat"),A.addGetterSetter(Ge,"fillEnabled",!0),A.addGetterSetter(Ge,"strokeEnabled",!0),A.addGetterSetter(Ge,"shadowEnabled",!0),A.addGetterSetter(Ge,"dashEnabled",!0),A.addGetterSetter(Ge,"strokeScaleEnabled",!0),A.addGetterSetter(Ge,"fillPriority","color"),A.addComponentsGetterSetter(Ge,"fillPatternOffset",["x","y"]),A.addGetterSetter(Ge,"fillPatternOffsetX",0,v()),A.addGetterSetter(Ge,"fillPatternOffsetY",0,v()),A.addComponentsGetterSetter(Ge,"fillPatternScale",["x","y"]),A.addGetterSetter(Ge,"fillPatternScaleX",1,v()),A.addGetterSetter(Ge,"fillPatternScaleY",1,v()),A.addComponentsGetterSetter(Ge,"fillLinearGradientStartPoint",["x","y"]),A.addComponentsGetterSetter(Ge,"strokeLinearGradientStartPoint",["x","y"]),A.addGetterSetter(Ge,"fillLinearGradientStartPointX",0),A.addGetterSetter(Ge,"strokeLinearGradientStartPointX",0),A.addGetterSetter(Ge,"fillLinearGradientStartPointY",0),A.addGetterSetter(Ge,"strokeLinearGradientStartPointY",0),A.addComponentsGetterSetter(Ge,"fillLinearGradientEndPoint",["x","y"]),A.addComponentsGetterSetter(Ge,"strokeLinearGradientEndPoint",["x","y"]),A.addGetterSetter(Ge,"fillLinearGradientEndPointX",0),A.addGetterSetter(Ge,"strokeLinearGradientEndPointX",0),A.addGetterSetter(Ge,"fillLinearGradientEndPointY",0),A.addGetterSetter(Ge,"strokeLinearGradientEndPointY",0),A.addComponentsGetterSetter(Ge,"fillRadialGradientStartPoint",["x","y"]),A.addGetterSetter(Ge,"fillRadialGradientStartPointX",0),A.addGetterSetter(Ge,"fillRadialGradientStartPointY",0),A.addComponentsGetterSetter(Ge,"fillRadialGradientEndPoint",["x","y"]),A.addGetterSetter(Ge,"fillRadialGradientEndPointX",0),A.addGetterSetter(Ge,"fillRadialGradientEndPointY",0),A.addGetterSetter(Ge,"fillPatternRotation",0),A.backCompat(Ge,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});var je=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],He=je.length;class Ve extends J{constructor(e){super(e),this.canvas=new P,this.hitCanvas=new L({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);var t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),e<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[e+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){q.prototype.moveToTop.call(this);var e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!q.prototype.moveUp.call(this))return!1;var e=this.getStage();return!(!e||!e.content||(e.content.removeChild(this.getNativeCanvasElement()),this.index<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[this.index+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement()),0))}moveDown(){if(q.prototype.moveDown.call(this)){var e=this.getStage();if(e){var t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(q.prototype.moveToBottom.call(this)){var e=this.getStage();if(e){var t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){var e=this.getNativeCanvasElement();return q.prototype.remove.call(this),e&&e.parentNode&&g._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:t}){return this.canvas.setSize(e,t),this.hitCanvas.setSize(e,t),this._setSmoothEnabled(),this}_validateAdd(e){var t=e.getType();"Group"!==t&&"Shape"!==t&&g.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return(e=e||{}).width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=void 0!==e.x?e.x:this.x(),e.y=void 0!==e.y?e.y:this.y(),q.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){const e=this.visible();this.canvas._canvas.style.display=e?"block":"none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){g.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){g.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,g.requestAnimFrame((()=>{this.draw(),this._waitingForDraw=!1}))),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;for(var t=1,n=!1;;){for(let i=0;i<He;i++){const r=je[i],a=this._getIntersection({x:e.x+r.x*t,y:e.y+r.y*t}),o=a.shape;if(o)return o;if(n=!!a.antialiased,!a.antialiased)break}if(!n)return null;t+=1}}_getIntersection(e){const t=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(e.x*t),Math.round(e.y*t),1,1).data,i=n[3];if(255===i){const e=g._rgbToHex(n[0],n[1],n[2]),t=Fe["#"+e];return t?{shape:t}:{antialiased:!0}}return i>0?{antialiased:!0}:{}}drawScene(e,t){var n=this.getLayer(),i=e||n&&n.getCanvas();return this._fire("beforeDraw",{node:this}),this.clearBeforeDraw()&&i.getContext().clear(),J.prototype.drawScene.call(this,i,t),this._fire("draw",{node:this}),this}drawHit(e,t){var n=this.getLayer(),i=e||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),J.prototype.drawHit.call(this,i,t),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){g.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return g.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(this.parent&&this.parent.content){var e=this.parent;this.hitCanvas._canvas.parentNode?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}}destroy(){return g.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}Ve.prototype.nodeType="Layer",o(Ve),A.addGetterSetter(Ve,"imageSmoothingEnabled",!0),A.addGetterSetter(Ve,"clearBeforeDraw",!0),A.addGetterSetter(Ve,"hitGraphEnabled",!0,w());class We extends Ve{constructor(e){super(e),this.listening(!1),g.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}We.prototype.nodeType="FastLayer",o(We);class ze extends J{_validateAdd(e){var t=e.getType();"Group"!==t&&"Shape"!==t&&g.throw("You may only add groups and shapes to groups.")}}ze.prototype.nodeType="Group",o(ze);var Xe=r.performance&&r.performance.now?function(){return r.performance.now()}:function(){return(new Date).getTime()};class Ke{constructor(e,t){this.id=Ke.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Xe(),frameRate:0},this.func=e,this.setLayers(t)}setLayers(e){var t;return t=e?e.length>0?e:[e]:[],this.layers=t,this}getLayers(){return this.layers}addLayer(e){var t,n=this.layers,i=n.length;for(t=0;t<i;t++)if(n[t]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){var e,t=Ke.animations,n=t.length;for(e=0;e<n;e++)if(t[e].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Xe(),Ke._addAnimation(this),this}stop(){return Ke._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){var t,n=e.id,i=this.animations,r=i.length;for(t=0;t<r;t++)if(i[t].id===n){this.animations.splice(t,1);break}}static _runFrames(){var e,t,n,i,r,a,o,s,u={},l=this.animations;for(i=0;i<l.length;i++)if(t=(e=l[i]).layers,n=e.func,e._updateFrameObject(Xe()),a=t.length,!n||!1!==n.call(e,e.frame))for(r=0;r<a;r++)void 0!==(o=t[r])._id&&(u[o._id]=o);for(s in u)u.hasOwnProperty(s)&&u[s].batchDraw()}static _animationLoop(){var e=Ke;e.animations.length?(e._runFrames(),g.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,g.requestAnimFrame(this._animationLoop))}}Ke.animations=[],Ke.animIdCounter=0,Ke.animRunning=!1;var Ye={node:1,duration:1,easing:1,onFinish:1,yoyo:1},qe=0,Ze=["fill","stroke","shadowColor"];class Je{constructor(e,t,n,i,r,a,o){this.prop=e,this.propFunc=t,this.begin=i,this._pos=i,this.duration=a,this._change=0,this.prevPos=0,this.yoyo=o,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=n,this._change=r-this.begin,this.pause()}fire(e){var t=this[e];t&&t()}setTime(e){e>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():e<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=e,this.update())}getTime(){return this._time}setPosition(e){this.prevPos=this._pos,this.propFunc(e),this._pos=e}getPosition(e){return void 0===e&&(e=this._time),this.func(e,this.begin,this._change,this.duration)}play(){this.state=2,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=3,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(e){this.pause(),this._time=e,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){var e=this.getTimer()-this._startTime;2===this.state?this.setTime(e):3===this.state&&this.setTime(this.duration-e)}pause(){this.state=1,this.fire("onPause")}getTimer(){return(new Date).getTime()}}class Qe{constructor(e){var t,n,i=this,r=e.node,o=r._id,s=e.easing||$e.Linear,u=!!e.yoyo;t=void 0===e.duration?.3:0===e.duration?.001:e.duration,this.node=r,this._id=qe++;var l=r.getLayer()||(r instanceof a.Stage?r.getLayers():null);for(n in l||g.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new Ke((function(){i.tween.onEnterFrame()}),l),this.tween=new Je(n,(function(e){i._tweenFunc(e)}),s,0,1,1e3*t,u),this._addListeners(),Qe.attrs[o]||(Qe.attrs[o]={}),Qe.attrs[o][this._id]||(Qe.attrs[o][this._id]={}),Qe.tweens[o]||(Qe.tweens[o]={}),e)void 0===Ye[n]&&this._addAttr(n,e[n]);this.reset(),this.onFinish=e.onFinish,this.onReset=e.onReset,this.onUpdate=e.onUpdate}_addAttr(e,t){var n,i,r,a,o,s,u,l,h=this.node,c=h._id;if((r=Qe.tweens[c][e])&&delete Qe.attrs[c][r][e],n=h.getAttr(e),g._isArray(t))if(i=[],o=Math.max(t.length,n.length),"points"===e&&t.length!==n.length&&(t.length>n.length?(u=n,n=g._prepareArrayForTween(n,t,h.closed())):(s=t,t=g._prepareArrayForTween(t,n,h.closed()))),0===e.indexOf("fill"))for(a=0;a<o;a++)if(a%2==0)i.push(t[a]-n[a]);else{var d=g.colorToRGBA(n[a]);l=g.colorToRGBA(t[a]),n[a]=d,i.push({r:l.r-d.r,g:l.g-d.g,b:l.b-d.b,a:l.a-d.a})}else for(a=0;a<o;a++)i.push(t[a]-n[a]);else-1!==Ze.indexOf(e)?(n=g.colorToRGBA(n),i={r:(l=g.colorToRGBA(t)).r-n.r,g:l.g-n.g,b:l.b-n.b,a:l.a-n.a}):i=t-n;Qe.attrs[c][this._id][e]={start:n,diff:i,end:t,trueEnd:s,trueStart:u},Qe.tweens[c][e]=this._id}_tweenFunc(e){var t,n,i,r,a,o,s,u,l=this.node,h=Qe.attrs[l._id][this._id];for(t in h){if(i=(n=h[t]).start,r=n.diff,u=n.end,g._isArray(i))if(a=[],s=Math.max(i.length,u.length),0===t.indexOf("fill"))for(o=0;o<s;o++)o%2==0?a.push((i[o]||0)+r[o]*e):a.push("rgba("+Math.round(i[o].r+r[o].r*e)+","+Math.round(i[o].g+r[o].g*e)+","+Math.round(i[o].b+r[o].b*e)+","+(i[o].a+r[o].a*e)+")");else for(o=0;o<s;o++)a.push((i[o]||0)+r[o]*e);else a=-1!==Ze.indexOf(t)?"rgba("+Math.round(i.r+r.r*e)+","+Math.round(i.g+r.g*e)+","+Math.round(i.b+r.b*e)+","+(i.a+r.a*e)+")":i+r*e;l.setAttr(t,a)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{var e=this.node,t=Qe.attrs[e._id][this._id];t.points&&t.points.trueEnd&&e.setAttr("points",t.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{var e=this.node,t=Qe.attrs[e._id][this._id];t.points&&t.points.trueStart&&e.points(t.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(e){return this.tween.seek(1e3*e),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){var e,t=this.node._id,n=this._id,i=Qe.tweens[t];for(e in this.pause(),i)delete Qe.tweens[t][e];delete Qe.attrs[t][n]}}Qe.attrs={},Qe.tweens={},q.prototype.to=function(e){var t=e.onFinish;e.node=this,e.onFinish=function(){this.destroy(),t&&t()},new Qe(e).play()};const $e={BackEaseIn(e,t,n,i){var r=1.70158;return n*(e/=i)*e*((r+1)*e-r)+t},BackEaseOut(e,t,n,i){var r=1.70158;return n*((e=e/i-1)*e*((r+1)*e+r)+1)+t},BackEaseInOut(e,t,n,i){var r=1.70158;return(e/=i/2)<1?n/2*(e*e*((1+(r*=1.525))*e-r))+t:n/2*((e-=2)*e*((1+(r*=1.525))*e+r)+2)+t},ElasticEaseIn(e,t,n,i,r,a){var o=0;return 0===e?t:1==(e/=i)?t+n:(a||(a=.3*i),!r||r<Math.abs(n)?(r=n,o=a/4):o=a/(2*Math.PI)*Math.asin(n/r),-r*Math.pow(2,10*(e-=1))*Math.sin((e*i-o)*(2*Math.PI)/a)+t)},ElasticEaseOut(e,t,n,i,r,a){var o=0;return 0===e?t:1==(e/=i)?t+n:(a||(a=.3*i),!r||r<Math.abs(n)?(r=n,o=a/4):o=a/(2*Math.PI)*Math.asin(n/r),r*Math.pow(2,-10*e)*Math.sin((e*i-o)*(2*Math.PI)/a)+n+t)},ElasticEaseInOut(e,t,n,i,r,a){var o=0;return 0===e?t:2==(e/=i/2)?t+n:(a||(a=i*(.3*1.5)),!r||r<Math.abs(n)?(r=n,o=a/4):o=a/(2*Math.PI)*Math.asin(n/r),e<1?r*Math.pow(2,10*(e-=1))*Math.sin((e*i-o)*(2*Math.PI)/a)*-.5+t:r*Math.pow(2,-10*(e-=1))*Math.sin((e*i-o)*(2*Math.PI)/a)*.5+n+t)},BounceEaseOut:(e,t,n,i)=>(e/=i)<1/2.75?n*(7.5625*e*e)+t:e<2/2.75?n*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?n*(7.5625*(e-=2.25/2.75)*e+.9375)+t:n*(7.5625*(e-=2.625/2.75)*e+.984375)+t,BounceEaseIn:(e,t,n,i)=>n-$e.BounceEaseOut(i-e,0,n,i)+t,BounceEaseInOut:(e,t,n,i)=>e<i/2?.5*$e.BounceEaseIn(2*e,0,n,i)+t:.5*$e.BounceEaseOut(2*e-i,0,n,i)+.5*n+t,EaseIn:(e,t,n,i)=>n*(e/=i)*e+t,EaseOut:(e,t,n,i)=>-n*(e/=i)*(e-2)+t,EaseInOut:(e,t,n,i)=>(e/=i/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t,StrongEaseIn:(e,t,n,i)=>n*(e/=i)*e*e*e*e+t,StrongEaseOut:(e,t,n,i)=>n*((e=e/i-1)*e*e*e*e+1)+t,StrongEaseInOut:(e,t,n,i)=>(e/=i/2)<1?n/2*e*e*e*e*e+t:n/2*((e-=2)*e*e*e*e+2)+t,Linear:(e,t,n,i)=>n*e/i+t},et=g._assign(a,{Util:g,Transform:s,Node:q,Container:J,Stage:Pe,stages:Me,Layer:Ve,FastLayer:We,Group:ze,DD:D,Shape:Ge,shapes:Fe,Animation:Ke,Tween:Qe,Easings:$e,Context:x,Canvas:M});function tt(e,t,n,i,r,a,o){var s=Math.sqrt(Math.pow(n-e,2)+Math.pow(i-t,2)),u=Math.sqrt(Math.pow(r-n,2)+Math.pow(a-i,2)),l=o*s/(s+u),h=o*u/(s+u);return[n-l*(r-e),i-l*(a-t),n+h*(r-e),i+h*(a-t)]}function nt(e,t){var n,i,r=e.length,a=[];for(n=2;n<r-2;n+=2)i=tt(e[n-2],e[n-1],e[n],e[n+1],e[n+2],e[n+3],t),isNaN(i[0])||(a.push(i[0]),a.push(i[1]),a.push(e[n]),a.push(e[n+1]),a.push(i[2]),a.push(i[3]));return a}class it extends Ge{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",(function(){this._clearCache("tensionPoints")}))}_sceneFunc(e){var t,n,i,r=this.points(),a=r.length,o=this.tension(),s=this.closed(),u=this.bezier();if(a){if(e.beginPath(),e.moveTo(r[0],r[1]),0!==o&&a>4){for(n=(t=this.getTensionPoints()).length,i=s?0:4,s||e.quadraticCurveTo(t[0],t[1],t[2],t[3]);i<n-2;)e.bezierCurveTo(t[i++],t[i++],t[i++],t[i++],t[i++],t[i++]);s||e.quadraticCurveTo(t[n-2],t[n-1],r[a-2],r[a-1])}else if(u)for(i=2;i<a;)e.bezierCurveTo(r[i++],r[i++],r[i++],r[i++],r[i++],r[i++]);else for(i=2;i<a;i+=2)e.lineTo(r[i],r[i+1]);s?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():nt(this.points(),this.tension())}_getTensionPointsClosed(){var e=this.points(),t=e.length,n=this.tension(),i=tt(e[t-2],e[t-1],e[0],e[1],e[2],e[3],n),r=tt(e[t-4],e[t-3],e[t-2],e[t-1],e[0],e[1],n),a=nt(e,n);return[i[2],i[3]].concat(a).concat([r[0],r[1],e[t-2],e[t-1],r[2],r[3],i[0],i[1],e[0],e[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){var e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};for(var t,n,i=(e=0!==this.tension()?[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:this.points())[0],r=e[0],a=e[1],o=e[1],s=0;s<e.length/2;s++)t=e[2*s],n=e[2*s+1],i=Math.min(i,t),r=Math.max(r,t),a=Math.min(a,n),o=Math.max(o,n);return{x:i,y:a,width:r-i,height:o-a}}}it.prototype.className="Line",it.prototype._attrsAffectingSize=["points","bezier","tension"],o(it),A.addGetterSetter(it,"closed",!1),A.addGetterSetter(it,"bezier",!1),A.addGetterSetter(it,"tension",0,v()),A.addGetterSetter(it,"points",[],function(){if(a.isUnminified)return function(e,t){const n=Int8Array?Object.getPrototypeOf(Int8Array):null;return n&&e instanceof n||(g._isArray(e)?e.forEach((function(e){g._isNumber(e)||g.warn('"'+t+'" attribute has non numeric element '+e+". Make sure that all elements are numbers.")})):g.warn(m(e)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),e}}());class rt extends Ge{_sceneFunc(e){var t=this.cornerRadius(),n=this.width(),i=this.height();e.beginPath(),t?g.drawRoundedRectPath(e,n,i,t):e.rect(0,0,n,i),e.closePath(),e.fillStrokeShape(this)}}rt.prototype.className="Rect",o(rt),A.addGetterSetter(rt,"cornerRadius",0,function(e){if(a.isUnminified)return function(e,t){let n=g._isNumber(e),i=g._isArray(e)&&4==e.length;return n||i||g.warn(m(e)+' is a not valid value for "'+t+'" attribute. The value should be a number or Array<number>(4)'),e}}());var at,ot="auto",st="justify",ut="left",lt="middle",ht="normal",ct=" ",dt="none",pt=["fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],ft=pt.length;function gt(){return at||(at=g.createCanvasElement().getContext("2d"))}class mt extends Ge{constructor(e){super(function(e){return(e=e||{}).fillLinearGradientColorStops||e.fillRadialGradientColorStops||e.fillPatternImage||(e.fill=e.fill||"black"),e}(e)),this._partialTextX=0,this._partialTextY=0;for(var t=0;t<ft;t++)this.on(pt[t]+"Change.konva",this._setTextData);this._setTextData()}_sceneFunc(e){var t=this.textArr,n=t.length;if(this.text()){var i,r,a=this.padding(),o=this.fontSize(),s=this.lineHeight()*o,u=this.verticalAlign(),l=0,h=this.align(),c=this.getWidth(),d=this.letterSpacing(),p=this.fill(),f=this.textDecoration(),g=-1!==f.indexOf("underline"),m=-1!==f.indexOf("line-through"),v=0,y=(v=s/2,0),b=0;for(e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",lt),e.setAttr("textAlign",ut),u===lt?l=(this.getHeight()-n*s-2*a)/2:"bottom"===u&&(l=this.getHeight()-n*s-2*a),e.translate(a,l+a),i=0;i<n;i++){y=0,b=0;var _,w,S,T=t[i],A=T.text,E=T.width,C=T.lastInParagraph;if(e.save(),"right"===h?y+=c-E-2*a:"center"===h&&(y+=(c-E-2*a)/2),g){e.save(),e.beginPath(),e.moveTo(y,v+b+Math.round(o/2)),w=0==(_=A.split(" ").length-1),S=h!==st||C?E:c-2*a,e.lineTo(y+Math.round(S),v+b+Math.round(o/2)),e.lineWidth=o/15;const t=this._getLinearGradient();e.strokeStyle=t||p,e.stroke(),e.restore()}if(m){e.save(),e.beginPath(),e.moveTo(y,v+b),w=0==(_=A.split(" ").length-1),S=h===st&&C&&!w?c-2*a:E,e.lineTo(y+Math.round(S),v+b),e.lineWidth=o/15;const t=this._getLinearGradient();e.strokeStyle=t||p,e.stroke(),e.restore()}if(0!==d||h===st){_=A.split(" ").length-1;for(var x=(r=A,Array.from(r)),I=0;I<x.length;I++){var k=x[I];" "!==k||C||h!==st||(y+=(c-2*a-E)/_),this._partialTextX=y,this._partialTextY=v+b,this._partialText=k,e.fillStrokeShape(this),y+=this.measureSize(k).width+d}}else this._partialTextX=y,this._partialTextY=v+b,this._partialText=A,e.fillStrokeShape(this);e.restore(),n>1&&(v+=s)}}}_hitFunc(e){var t=this.getWidth(),n=this.getHeight();e.beginPath(),e.rect(0,0,t,n),e.closePath(),e.fillStrokeShape(this)}setText(e){var t=g._isString(e)?e:null==e?"":e+"";return this._setAttr("text",t),this}getWidth(){return this.attrs.width===ot||void 0===this.attrs.width?this.getTextWidth()+2*this.padding():this.attrs.width}getHeight(){return this.attrs.height===ot||void 0===this.attrs.height?this.fontSize()*this.textArr.length*this.lineHeight()+2*this.padding():this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return g.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var t,n=gt(),i=this.fontSize();return n.save(),n.font=this._getContextFont(),t=n.measureText(e),n.restore(),{width:t.width,height:i}}_getContextFont(){return this.fontStyle()+ct+this.fontVariant()+ct+(this.fontSize()+"px ")+this.fontFamily().split(",").map((e=>{const t=(e=e.trim()).indexOf(" ")>=0,n=e.indexOf('"')>=0||e.indexOf("'")>=0;return t&&!n&&(e=`"${e}"`),e})).join(", ")}_addTextLine(e){this.align()===st&&(e=e.trim());var t=this._getTextWidth(e);return this.textArr.push({text:e,width:t,lastInParagraph:!1})}_getTextWidth(e){var t=this.letterSpacing(),n=e.length;return gt().measureText(e).width+(n?t*(n-1):0)}_setTextData(){var e=this.text().split("\n"),t=+this.fontSize(),n=0,i=this.lineHeight()*t,r=this.attrs.width,a=this.attrs.height,o=r!==ot&&void 0!==r,s=a!==ot&&void 0!==a,u=this.padding(),l=r-2*u,h=a-2*u,c=0,d=this.wrap(),p="char"!==d&&d!==dt,f=this.ellipsis();this.textArr=[],gt().font=this._getContextFont();for(var g=f?this._getTextWidth(""):0,m=0,v=e.length;m<v;++m){var y=e[m],b=this._getTextWidth(y);if(o&&b>l)for(;y.length>0;){for(var _=0,w=y.length,S="",T=0;_<w;){var A=_+w>>>1,E=y.slice(0,A+1),C=this._getTextWidth(E)+g;C<=l?(_=A+1,S=E,T=C):w=A}if(!S)break;if(p){var x,I=y[S.length];(x=(I===ct||"-"===I)&&T<=l?S.length:Math.max(S.lastIndexOf(ct),S.lastIndexOf("-"))+1)>0&&(_=x,S=S.slice(0,_),T=this._getTextWidth(S))}if(S=S.trimRight(),this._addTextLine(S),n=Math.max(n,T),c+=i,this._shouldHandleEllipsis(c)){this._tryToAddEllipsisToLastLine();break}if((y=(y=y.slice(_)).trimLeft()).length>0&&(b=this._getTextWidth(y))<=l){this._addTextLine(y),c+=i,n=Math.max(n,b);break}}else this._addTextLine(y),c+=i,n=Math.max(n,b),this._shouldHandleEllipsis(c)&&m<v-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),s&&c+i>h)break}this.textHeight=t,this.textWidth=n}_shouldHandleEllipsis(e){var t=+this.fontSize(),n=this.lineHeight()*t,i=this.attrs.height,r=i!==ot&&void 0!==i,a=i-2*this.padding();return!(this.wrap()!==dt)||r&&e+n>a}_tryToAddEllipsisToLastLine(){var e=this.attrs.width,t=e!==ot&&void 0!==e,n=e-2*this.padding(),i=this.ellipsis(),r=this.textArr[this.textArr.length-1];r&&i&&(t&&(this._getTextWidth(r.text+"")<n||(r.text=r.text.slice(0,r.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(r.text+""))}getStrokeScaleEnabled(){return!0}}mt.prototype._fillFunc=function(e){e.fillText(this._partialText,this._partialTextX,this._partialTextY)},mt.prototype._strokeFunc=function(e){e.strokeText(this._partialText,this._partialTextX,this._partialTextY)},mt.prototype.className="Text",mt.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],o(mt),A.overWriteSetter(mt,"width",y()),A.overWriteSetter(mt,"height",y()),A.addGetterSetter(mt,"fontFamily","Arial"),A.addGetterSetter(mt,"fontSize",12,v()),A.addGetterSetter(mt,"fontStyle",ht),A.addGetterSetter(mt,"fontVariant",ht),A.addGetterSetter(mt,"padding",0,v()),A.addGetterSetter(mt,"align",ut),A.addGetterSetter(mt,"verticalAlign","top"),A.addGetterSetter(mt,"lineHeight",1,v()),A.addGetterSetter(mt,"wrap","word"),A.addGetterSetter(mt,"ellipsis",!1,w()),A.addGetterSetter(mt,"letterSpacing",0,v()),A.addGetterSetter(mt,"text","",b()),A.addGetterSetter(mt,"textDecoration","");var vt=n(317),yt={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function a(e,t,i,a,o){if("function"!=typeof i)throw new TypeError("The listener must be a function");var s=new r(i,a||e,o),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function s(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,i,r=[];if(0===this._eventsCount)return r;for(i in e=this._events)t.call(e,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},s.prototype.listeners=function(e){var t=n?n+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,a=i.length,o=new Array(a);r<a;r++)o[r]=i[r].fn;return o},s.prototype.listenerCount=function(e){var t=n?n+e:e,i=this._events[t];return i?i.fn?1:i.length:0},s.prototype.emit=function(e,t,i,r,a,o){var s=n?n+e:e;if(!this._events[s])return!1;var u,l,h=this._events[s],c=arguments.length;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,void 0,!0),c){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,t),!0;case 3:return h.fn.call(h.context,t,i),!0;case 4:return h.fn.call(h.context,t,i,r),!0;case 5:return h.fn.call(h.context,t,i,r,a),!0;case 6:return h.fn.call(h.context,t,i,r,a,o),!0}for(l=1,u=new Array(c-1);l<c;l++)u[l-1]=arguments[l];h.fn.apply(h.context,u)}else{var d,p=h.length;for(l=0;l<p;l++)switch(h[l].once&&this.removeListener(e,h[l].fn,void 0,!0),c){case 1:h[l].fn.call(h[l].context);break;case 2:h[l].fn.call(h[l].context,t);break;case 3:h[l].fn.call(h[l].context,t,i);break;case 4:h[l].fn.call(h[l].context,t,i,r);break;default:if(!u)for(d=1,u=new Array(c-1);d<c;d++)u[d-1]=arguments[d];h[l].fn.apply(h[l].context,u)}}return!0},s.prototype.on=function(e,t,n){return a(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return a(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,i,r){var a=n?n+e:e;if(!this._events[a])return this;if(!t)return o(this,a),this;var s=this._events[a];if(s.fn)s.fn!==t||r&&!s.once||i&&s.context!==i||o(this,a);else{for(var u=0,l=[],h=s.length;u<h;u++)(s[u].fn!==t||r&&!s[u].once||i&&s[u].context!==i)&&l.push(s[u]);l.length?this._events[a]=1===l.length?l[0]:l:o(this,a)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&o(this,t)):(this._events=new i,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s}(yt);var bt=yt.exports;function _t(e){return _t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_t(e)}function wt(e,t,n){this.time=e,this.type=t,this.id=n}function St(e,t){for(e=e.toString();e.length<t;)e="0"+e;return e}function Tt(e,t){var n=[],i=Math.floor(e%1*Math.pow(10,t)),r=Math.floor(e),a=Math.floor(r/60),o=Math.floor(a/60);o>0&&n.push(o),n.push(a%60),n.push(r%60);for(var s=0;s<n.length;s++)n[s]=St(n[s],2);return n=n.join(":"),t>0&&(n+="."+St(i,t)),n}function At(e,t,n){return e<t?t:e>n?n:e}function Et(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Ct(e,t){for(var n in t)Et(t,n)&&(e[n]=t[n]);return e}function xt(e){return"number"==typeof e}function It(e){return"number"==typeof e&&Number.isFinite(e)}function kt(e){return null!==e&&"object"===_t(e)&&!Array.isArray(e)}function Mt(e){return"string"==typeof e}function Pt(e){return null==e}function Lt(e){return!0===e||!1===e}function Dt(e){return e instanceof HTMLElement}function Rt(e){return kt(e)&&Et(e,"linearGradientStart")&&Et(e,"linearGradientEnd")&&Et(e,"linearGradientColorStops")&&xt(e.linearGradientStart)&&xt(e.linearGradientEnd)&&function(e){return Array.isArray(e)}(e.linearGradientColorStops)&&2===e.linearGradientColorStops.length}function Nt(e){for(;null!==e.parent;){if(e.parent instanceof et.Layer)return e;e=e.parent}return null}wt.POINT=0,wt.SEGMENT_START=1,wt.SEGMENT_END=2,wt.sorter=function(e,t){return e.time-t.time};var Ot=/HeadlessChrome/.test(navigator.userAgent),Ut=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,Bt=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame,Ft={forward:{},reverse:{}};Ft.forward[wt.POINT]=0,Ft.forward[wt.SEGMENT_START]=1,Ft.forward[wt.SEGMENT_END]=2,Ft.reverse[wt.POINT]=0,Ft.reverse[wt.SEGMENT_START]=2,Ft.reverse[wt.SEGMENT_END]=1;var Gt={0:"points.enter",1:"segments.enter",2:"segments.exit"},jt={};function Ht(e,t){switch(t.type){case wt.POINT:return e.points.getPoint(t.id);case wt.SEGMENT_START:case wt.SEGMENT_END:return e.segments.getSegment(t.id);default:throw new Error("getPointOrSegment: id not found?")}}function Vt(e){this._cues=[],this._peaks=e,this._previousTime=-1,this._updateCues=this._updateCues.bind(this),this._onPlaying=this._onPlaying.bind(this),this._onSeeked=this._onSeeked.bind(this),this._onTimeUpdate=this._onTimeUpdate.bind(this),this._onAnimationFrame=this._onAnimationFrame.bind(this),this._rAFHandle=null,this._activeSegments={},this._attachEventHandlers()}function Wt(e){return function(t){return t.id===e}}jt[0]="point",jt[1]="segment",jt[2]="segment",Vt.prototype._updateCues=function(){var e=this,t=e._peaks.points.getPoints(),n=e._peaks.segments.getSegments();e._cues.length=0,t.forEach((function(t){e._cues.push(new wt(t.time,wt.POINT,t.id))})),n.forEach((function(t){e._cues.push(new wt(t.startTime,wt.SEGMENT_START,t.id)),e._cues.push(new wt(t.endTime,wt.SEGMENT_END,t.id))})),e._cues.sort(wt.sorter);var i=e._peaks.player.getCurrentTime();e._updateActiveSegments(i)},Vt.prototype._onUpdate=function(e,t){var n,i,r,a=e>t;a?(n=0,i=this._cues.length,r=1):(n=this._cues.length-1,i=-1,r=-1);for(var o=n;a?o<i:o>i;o+=r){var s=this._cues[o];if(a?s.time>t:s.time<t){if(a?s.time>e:s.time<e)break;var u=Ht(this._peaks,s),l=a?Ft.forward[s.type]:Ft.reverse[s.type];1===l?this._activeSegments[u.id]=u:2===l&&delete this._activeSegments[u.id];var h={time:e};h[jt[l]]=u,this._peaks.emit(Gt[l],h)}}},Vt.prototype._onTimeUpdate=function(e){(Ot||navigator.webdriver||"object"!==("undefined"==typeof document?"undefined":_t(document))||!("visibilityState"in document)||"visible"!==document.visibilityState)&&(this._peaks.player.isPlaying()&&!this._peaks.player.isSeeking()&&this._onUpdate(e,this._previousTime),this._previousTime=e)},Vt.prototype._onAnimationFrame=function(){var e=this._peaks.player.getCurrentTime();this._peaks.player.isSeeking()||this._onUpdate(e,this._previousTime),this._previousTime=e,this._peaks.player.isPlaying()&&(this._rAFHandle=Ut(this._onAnimationFrame))},Vt.prototype._onPlaying=function(){this._previousTime=this._peaks.player.getCurrentTime(),this._rAFHandle=Ut(this._onAnimationFrame)},Vt.prototype._onSeeked=function(e){this._previousTime=e,this._updateActiveSegments(e)},Vt.prototype._updateActiveSegments=function(e){var t=this,n=t._peaks.segments.getSegmentsAtTime(e);for(var i in t._activeSegments)Et(t._activeSegments,i)&&(n.find(Wt(i))||(t._peaks.emit("segments.exit",{segment:t._activeSegments[i],time:e}),delete t._activeSegments[i]));n.forEach((function(n){n.id in t._activeSegments||(t._activeSegments[n.id]=n,t._peaks.emit("segments.enter",{segment:n,time:e}))}))};var zt=["points.update","points.dragmove","points.add","points.remove","points.remove_all","segments.update","segments.dragged","segments.add","segments.remove","segments.remove_all"];Vt.prototype._attachEventHandlers=function(){this._peaks.on("player.timeupdate",this._onTimeUpdate),this._peaks.on("player.playing",this._onPlaying),this._peaks.on("player.seeked",this._onSeeked);for(var e=0;e<zt.length;e++)this._peaks.on(zt[e],this._updateCues);this._updateCues()},Vt.prototype._detachEventHandlers=function(){this._peaks.off("player.timeupdate",this._onTimeUpdate),this._peaks.off("player.playing",this._onPlaying),this._peaks.off("player.seeked",this._onSeeked);for(var e=0;e<zt.length;e++)this._peaks.off(zt[e],this._updateCues)},Vt.prototype.destroy=function(){this._rAFHandle&&(Bt(this._rAFHandle),this._rAFHandle=null),this._detachEventHandlers(),this._previousTime=-1};var Xt=["id","pid","time","labelText","color","editable"],Kt=["update","isVisible","peaks","pid"];function Yt(e,t){var n=t?"update()":"add()";if((!t||t&&Et(e,"time"))&&!It(e.time))throw new TypeError("peaks.points."+n+": time should be a numeric value");if(e.time<0)throw new RangeError("peaks.points."+n+": time should not be negative");if(Et(e,"labelText")&&!Mt(e.labelText))throw new TypeError("peaks.points."+n+": labelText must be a string");if(Et(e,"editable")&&!Lt(e.editable))throw new TypeError("peaks.points."+n+": editable must be true or false");if(Et(e,"color")&&!Mt(e.color)&&!Rt(e.color))throw new TypeError("peaks.points."+n+": color must be a string or a valid linear gradient object");Kt.forEach((function(t){if(Et(e,t))throw new Error("peaks.points."+n+": invalid option name: "+t)})),Xt.forEach((function(t){if(Et(e,"_"+t))throw new Error("peaks.points."+n+": invalid option name: _"+t)}))}function qt(e,t,n){this._peaks=e,this._pid=t,this._setUserData(n)}function Zt(e){this._peaks=e,this._points=[],this._pointsById={},this._pointsByPid={},this._pointIdCounter=0,this._pointPid=0}qt.prototype._setUserData=function(e){for(var t in e)Et(e,t)&&(-1===Xt.indexOf(t)?this[t]=e[t]:this["_"+t]=e[t])},Object.defineProperties(qt.prototype,{id:{enumerable:!0,get:function(){return this._id}},pid:{enumerable:!0,get:function(){return this._pid}},time:{enumerable:!0,get:function(){return this._time}},labelText:{get:function(){return this._labelText}},color:{enumerable:!0,get:function(){return this._color}},editable:{enumerable:!0,get:function(){return this._editable}}}),qt.prototype.update=function(e){if(Yt(e,!0),Et(e,"id")){if(Pt(e.id))throw new TypeError("point.update(): invalid id");this._peaks.points.updatePointId(this,e.id)}this._setUserData(e),this._peaks.emit("points.update",this,e)},qt.prototype.isVisible=function(e,t){return this.time>=e&&this.time<t},qt.prototype._setTime=function(e){this._time=e},Zt.prototype._getNextPointId=function(){return"peaks.point."+this._pointIdCounter++},Zt.prototype._getNextPid=function(){return this._pointPid++},Zt.prototype._addPoint=function(e){this._points.push(e),this._pointsById[e.id]=e,this._pointsByPid[e.pid]=e},Zt.prototype._createPoint=function(e){var t={};Ct(t,e),Pt(t.id)&&(t.id=this._getNextPointId());var n=this._getNextPid();return function(e,t){Pt(e.labelText)&&(e.labelText=""),Pt(e.editable)&&(e.editable=!1),Pt(e.color)&&(e.color=t.pointMarkerColor)}(t,this._peaks.options),Yt(t,!1),new qt(this._peaks,n,t)},Zt.prototype.getPoints=function(){return this._points},Zt.prototype.getPoint=function(e){return this._pointsById[e]},Zt.prototype.find=function(e,t){return this._points.filter((function(n){return n.isVisible(e,t)}))},Zt.prototype.add=function(){var e=this,t=Array.isArray(arguments[0]),n=t?arguments[0]:Array.prototype.slice.call(arguments);return n=n.map((function(t){var n=e._createPoint(t);if(Et(e._pointsById,n.id))throw new Error("peaks.points.add(): duplicate id");return n})),n.forEach((function(t){e._addPoint(t)})),this._peaks.emit("points.add",{points:n}),t?n:n[0]},Zt.prototype.updatePointId=function(e,t){if(this._pointsById[e.id]){if(this._pointsById[t])throw new Error("point.update(): duplicate id");delete this._pointsById[e.id],this._pointsById[t]=e}},Zt.prototype._findPoint=function(e){for(var t=[],n=0,i=this._points.length;n<i;n++)e(this._points[n])&&t.push(n);return t},Zt.prototype._removeIndexes=function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n]-t.length,r=this._points.splice(i,1)[0];delete this._pointsById[r.id],delete this._pointsByPid[r.pid],t.push(r)}return t},Zt.prototype._removePoints=function(e){var t=this._findPoint(e),n=this._removeIndexes(t);return this._peaks.emit("points.remove",{points:n}),n},Zt.prototype.remove=function(e){return this._removePoints((function(t){return t===e}))},Zt.prototype.removeById=function(e){return this._removePoints((function(t){return t.id===e}))},Zt.prototype.removeByTime=function(e){return this._removePoints((function(t){return t.time===e}))},Zt.prototype.removeAll=function(){this._points=[],this._pointsById={},this._pointsByPid={},this._peaks.emit("points.remove_all")};var Jt=["id","pid","startTime","endTime","labelText","color","borderColor","editable"],Qt=["update","isVisible","peaks","pid"];function $t(e,t){var n=t?"update()":"add()";if(Et(e,"startTime")&&!It(e.startTime))throw new TypeError("peaks.segments."+n+": startTime should be a valid number");if(Et(e,"endTime")&&!It(e.endTime))throw new TypeError("peaks.segments."+n+": endTime should be a valid number");if(!(t||Et(e,"startTime")&&Et(e,"endTime")))throw new TypeError("peaks.segments."+n+": missing startTime or endTime");if(e.startTime<0)throw new RangeError("peaks.segments."+n+": startTime should not be negative");if(e.endTime<0)throw new RangeError("peaks.segments."+n+": endTime should not be negative");if(e.endTime<e.startTime)throw new RangeError("peaks.segments."+n+": endTime should not be less than startTime");if(Et(e,"labelText")&&!Mt(e.labelText))throw new TypeError("peaks.segments."+n+": labelText must be a string");if(Et(e,"editable")&&!Lt(e.editable))throw new TypeError("peaks.segments."+n+": editable must be true or false");if(Et(e,"color")&&!Mt(e.color)&&!Rt(e.color))throw new TypeError("peaks.segments."+n+": color must be a string or a valid linear gradient object");if(Et(e,"borderColor")&&!Mt(e.borderColor))throw new TypeError("peaks.segments."+n+": borderColor must be a string");Qt.forEach((function(t){if(Et(e,t))throw new Error("peaks.segments."+n+": invalid option name: "+t)})),Jt.forEach((function(t){if(Et(e,"_"+t))throw new Error("peaks.segments."+n+": invalid option name: _"+t)}))}function en(e,t,n){this._peaks=e,this._pid=t,this._id=n.id,this._startTime=n.startTime,this._endTime=n.endTime,this._labelText=n.labelText,this._color=n.color,this._borderColor=n.borderColor,this._editable=n.editable,this._setUserData(n)}function tn(e){this._peaks=e,this._segments=[],this._segmentsById={},this._segmentsByPid={},this._segmentIdCounter=0,this._segmentPid=0,this._isInserting=!1}en.prototype._setUserData=function(e){for(var t in e)Et(e,t)&&(-1===Jt.indexOf(t)?this[t]=e[t]:this["_"+t]=e[t])},Object.defineProperties(en.prototype,{id:{enumerable:!0,get:function(){return this._id}},pid:{enumerable:!0,get:function(){return this._pid}},startTime:{enumerable:!0,get:function(){return this._startTime}},endTime:{enumerable:!0,get:function(){return this._endTime}},labelText:{enumerable:!0,get:function(){return this._labelText}},color:{enumerable:!0,get:function(){return this._color}},borderColor:{enumerable:!0,get:function(){return this._borderColor}},editable:{enumerable:!0,get:function(){return this._editable}}}),en.prototype.update=function(e){if($t(e,!0),Et(e,"id")){if(Pt(e.id))throw new TypeError("segment.update(): invalid id");this._peaks.segments.updateSegmentId(this,e.id)}this._setUserData(e),this._peaks.emit("segments.update",this,e)},en.prototype.isVisible=function(e,t){return this.startTime<t&&e<this.endTime},en.prototype._setStartTime=function(e){this._startTime=e},en.prototype._setEndTime=function(e){this._endTime=e},tn.prototype._getNextSegmentId=function(){return"peaks.segment."+this._segmentIdCounter++},tn.prototype._getNextPid=function(){return this._segmentPid++},tn.prototype._addSegment=function(e){this._segments.push(e),this._segmentsById[e.id]=e,this._segmentsByPid[e.pid]=e},tn.prototype._createSegment=function(e){var t={};Ct(t,e),Pt(t.id)&&(t.id=this._getNextSegmentId());var n=this._getNextPid();return function(e,t){Pt(e.color)&&(t.overlay?e.color=t.overlayColor:e.color=t.waveformColor),Pt(e.borderColor)&&(e.borderColor=t.overlayBorderColor),Pt(e.labelText)&&(e.labelText=""),Pt(e.editable)&&(e.editable=!1)}(t,this._peaks.options.segmentOptions),$t(t,!1),new en(this._peaks,n,t)},tn.prototype.getSegments=function(){return this._segments},tn.prototype.getSegment=function(e){return this._segmentsById[e]},tn.prototype.getSegmentsAtTime=function(e){return this._segments.filter((function(t){return e>=t.startTime&&e<t.endTime}))},tn.prototype.find=function(e,t){return this._segments.filter((function(n){return n.isVisible(e,t)}))},tn.prototype._getSortedSegments=function(){return this._segments.slice().sort((function(e,t){return e.startTime-t.startTime}))},tn.prototype.findPreviousSegment=function(e){var t=this._getSortedSegments(),n=t.findIndex((function(t){return t.id===e.id}));if(-1!==n)return t[n-1]},tn.prototype.findNextSegment=function(e){var t=this._getSortedSegments(),n=t.findIndex((function(t){return t.id===e.id}));if(-1!==n)return t[n+1]},tn.prototype.add=function(){var e=this,t=Array.isArray(arguments[0]),n=t?arguments[0]:Array.prototype.slice.call(arguments);return n=n.map((function(t){var n=e._createSegment(t);if(Et(e._segmentsById,n.id))throw new Error("peaks.segments.add(): duplicate id");return n})),n.forEach((function(t){e._addSegment(t)})),this._peaks.emit("segments.add",{segments:n,insert:this._isInserting}),t?n:n[0]},tn.prototype.updateSegmentId=function(e,t){if(this._segmentsById[e.id]){if(this._segmentsById[t])throw new Error("segment.update(): duplicate id");delete this._segmentsById[e.id],this._segmentsById[t]=e}},tn.prototype._findSegment=function(e){for(var t=[],n=0,i=this._segments.length;n<i;n++)e(this._segments[n])&&t.push(n);return t},tn.prototype._removeIndexes=function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n]-t.length,r=this._segments.splice(i,1)[0];delete this._segmentsById[r.id],delete this._segmentsByPid[r.pid],t.push(r)}return t},tn.prototype._removeSegments=function(e){var t=this._findSegment(e),n=this._removeIndexes(t);return this._peaks.emit("segments.remove",{segments:n}),n},tn.prototype.remove=function(e){return this._removeSegments((function(t){return t===e}))},tn.prototype.removeById=function(e){return this._removeSegments((function(t){return t.id===e}))},tn.prototype.removeByTime=function(e,t){var n;return n=(t="number"==typeof t?t:0)>0?function(n){return n.startTime===e&&n.endTime===t}:function(t){return t.startTime===e},this._removeSegments(n)},tn.prototype.removeAll=function(){this._segments=[],this._segmentsById={},this._segmentsByPid={},this._peaks.emit("segments.remove_all")},tn.prototype.setInserting=function(e){this._isInserting=e},tn.prototype.isInserting=function(){return this._isInserting};var nn=["OBJECT","TEXTAREA","INPUT","SELECT","OPTION"],rn=[32,9,37,39];function an(e){this.eventEmitter=e,this._handleKeyEvent=this._handleKeyEvent.bind(this),document.addEventListener("keydown",this._handleKeyEvent),document.addEventListener("keypress",this._handleKeyEvent),document.addEventListener("keyup",this._handleKeyEvent)}function on(e){this._mediaElement=e}function sn(e,t){this._eventEmitter=e,this._mediaElement=t,this._playerCanPlayHandler=this._playerCanPlayHandler.bind(this),this._playerErrorHandler=this._playerErrorHandler.bind(this)}function un(e,t){this._peaks=e,this._playingSegment=!1,this._segment=null,this._loop=!1,this._playSegmentTimerCallback=this._playSegmentTimerCallback.bind(this),function(e){var t=function(e){for(var t=[],n=e;n;)Object.getOwnPropertyNames(n).forEach((function(e){t.push(e)})),n=Object.getPrototypeOf(n);return t}(e);["init","destroy","play","pause","isPlaying","isSeeking","getCurrentTime","getDuration","seek"].forEach((function(n){if(!t.includes(n))throw new TypeError("Peaks.init(): Player method "+n+" is undefined");if("function"!=typeof e[n])throw new TypeError("Peaks.init(): Player method "+n+" is not a function")}))}(t),this._adapter=t}function ln(e){this._options=e,this._draggable=e.editable}function hn(e){this._options=e,this._editable=e.editable}function cn(e){return"zoomview"===e.view?new hn(e):null}function dn(e){return new mt({x:12,y:12,text:e.segment.labelText,textAlign:"center",fontFamily:e.fontFamily||"sans-serif",fontSize:e.fontSize||12,fontStyle:e.fontStyle||"normal",fill:"#000"})}function pn(e){return new ln(e)}function fn(e,t){this._view=e,this._offset=t.highlightOffset,this._color=t.highlightColor,this._layer=new et.Layer({listening:!1}),this._highlightRect=null,this._startTime=null,this._endTime=null,this._strokeColor=t.highlightStrokeColor,this._opacity=t.highlightOpacity,this._cornerRadius=t.highlightCornerRadius}function gn(e){this._point=e.point,this._marker=e.marker,this._draggable=e.draggable,this._onDragStart=e.onDragStart,this._onDragMove=e.onDragMove,this._onDragEnd=e.onDragEnd,this._dragBoundFunc=e.dragBoundFunc,this._onMouseEnter=e.onMouseEnter,this._onMouseLeave=e.onMouseLeave,this._group=new et.Group({name:"point-marker",point:this._point,draggable:this._draggable,dragBoundFunc:e.dragBoundFunc}),this._bindDefaultEventHandlers(),this._marker.init(this._group)}function mn(e,t,n){this._peaks=e,this._view=t,this._allowEditing=n,this._pointMarkers={},this._layer=new et.Layer,this._onPointsDrag=this._onPointsDrag.bind(this),this._onPointMarkerDragStart=this._onPointMarkerDragStart.bind(this),this._onPointMarkerDragMove=this._onPointMarkerDragMove.bind(this),this._onPointMarkerDragEnd=this._onPointMarkerDragEnd.bind(this),this._pointMarkerDragBoundFunc=this._pointMarkerDragBoundFunc.bind(this),this._onPointMarkerMouseEnter=this._onPointMarkerMouseEnter.bind(this),this._onPointMarkerMouseLeave=this._onPointMarkerMouseLeave.bind(this),this._onPointsUpdate=this._onPointsUpdate.bind(this),this._onPointsAdd=this._onPointsAdd.bind(this),this._onPointsRemove=this._onPointsRemove.bind(this),this._onPointsRemoveAll=this._onPointsRemoveAll.bind(this),this._peaks.on("points.update",this._onPointsUpdate),this._peaks.on("points.add",this._onPointsAdd),this._peaks.on("points.remove",this._onPointsRemove),this._peaks.on("points.remove_all",this._onPointsRemoveAll),this._peaks.on("points.dragstart",this._onPointsDrag),this._peaks.on("points.dragmove",this._onPointsDrag),this._peaks.on("points.dragend",this._onPointsDrag)}function vn(e){this._player=e.player,this._view=e.view,this._playheadPixel=0,this._playheadLineAnimation=null,this._playheadVisible=!1,this._playheadColor=e.playheadColor,this._playheadTextColor=e.playheadTextColor,this._playheadBackgroundColor=e.playheadBackgroundColor,this._playheadPadding=e.playheadPadding,this._playheadFontFamily=e.playheadFontFamily,this._playheadFontSize=e.playheadFontSize,this._playheadFontStyle=e.playheadFontStyle,this._playheadLayer=new et.Layer,this._createPlayhead(),e.showPlayheadTime&&this._createPlayheadText(),this.fitToView(),this.zoomLevelChanged()}function yn(e){this._options=e}function bn(e){var t=this;t._segment=e.segment,t._marker=e.marker,t._segmentShape=e.segmentShape,t._editable=e.editable,t._startMarker=e.startMarker,t._onDragStart=e.onDragStart,t._onDragMove=e.onDragMove,t._onDragEnd=e.onDragEnd,t._group=new et.Group({name:"segment-marker",segment:t._segment,draggable:t._editable,visible:t._editable,dragBoundFunc:function(n){return e.dragBoundFunc(t,n)}}),t._bindDefaultEventHandlers(),t._marker.init(t._group)}function _n(e){this._color=e.color;var t={};if(Mt(e.color))t.fill=e.color;else{if(!Rt(e.color))throw new TypeError("Unknown type for color property");var n=e.view._height*(e.color.linearGradientStart/100),i=e.view._height*(e.color.linearGradientEnd/100);t.fillLinearGradientStartPointY=n,t.fillLinearGradientEndPointY=i,t.fillLinearGradientColorStops=[0,e.color.linearGradientColorStops[0],1,e.color.linearGradientColorStops[1]]}this._shape=new et.Shape(t),this._view=e.view,this._segment=e.segment,this._shape.sceneFunc(this._sceneFunc.bind(this))}an.prototype._handleKeyEvent=function(e){if(-1===nn.indexOf(e.target.nodeName))if(rn.indexOf(e.type)>-1&&e.preventDefault(),"keydown"===e.type||"keypress"===e.type)switch(e.keyCode){case 32:this.eventEmitter.emit("keyboard.space");break;case 9:this.eventEmitter.emit("keyboard.tab")}else if("keyup"===e.type)switch(e.keyCode){case 37:e.shiftKey?this.eventEmitter.emit("keyboard.shift_left"):this.eventEmitter.emit("keyboard.left");break;case 39:e.shiftKey?this.eventEmitter.emit("keyboard.shift_right"):this.eventEmitter.emit("keyboard.right")}},an.prototype.destroy=function(){document.removeEventListener("keydown",this._handleKeyEvent),document.removeEventListener("keypress",this._handleKeyEvent),document.removeEventListener("keyup",this._handleKeyEvent)},on.prototype._addMediaListener=function(e,t){this._listeners.push({type:e,callback:t}),this._mediaElement.addEventListener(e,t)},on.prototype.init=function(e){var t,n=this;return n._eventEmitter=e,n._listeners=[],n._duration=n.getDuration(),n._addMediaListener("timeupdate",(function(){n._eventEmitter.emit("player.timeupdate",n.getCurrentTime())})),n._addMediaListener("playing",(function(){n._eventEmitter.emit("player.playing",n.getCurrentTime())})),n._addMediaListener("pause",(function(){n._eventEmitter.emit("player.pause",n.getCurrentTime())})),n._addMediaListener("ended",(function(){n._eventEmitter.emit("player.ended")})),n._addMediaListener("seeked",(function(){n._eventEmitter.emit("player.seeked",n.getCurrentTime())})),n._addMediaListener("canplay",(function(){n._eventEmitter.emit("player.canplay")})),n._addMediaListener("error",(function(e){n._eventEmitter.emit("player.error",e.target.error)})),n._interval=null,(t=n._mediaElement).src||t.querySelector("source")?n._mediaElement.error&&n._mediaElement.error.code===MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED?Promise.reject(n._mediaElement.error):new Promise((function(e,t){function i(r){n._mediaElement.removeEventListener("loadedmetadata",i),n._mediaElement.removeEventListener("error",i),"loadedmetadata"===r.type?e():t(r.target.error)}n._mediaElement.readyState===HTMLMediaElement.HAVE_NOTHING?(n._mediaElement.addEventListener("loadedmetadata",i),n._mediaElement.addEventListener("error",i),n._mediaElement.load()):e()})):Promise.resolve()},on.prototype.destroy=function(){for(var e=0;e<this._listeners.length;e++){var t=this._listeners[e];this._mediaElement.removeEventListener(t.type,t.callback)}this._listeners.length=0,this._mediaElement=null},on.prototype.play=function(){return this._mediaElement.play()},on.prototype.pause=function(){this._mediaElement.pause()},on.prototype.isPlaying=function(){return!this._mediaElement.paused},on.prototype.isSeeking=function(){return this._mediaElement.seeking},on.prototype.getCurrentTime=function(){return this._mediaElement.currentTime},on.prototype.getDuration=function(){return this._mediaElement.duration},on.prototype.seek=function(e){this._mediaElement.currentTime=e},sn.prototype.setSource=function(e,t){var n=this;return n._options=e,n._callback=t,n._eventEmitter.on("player.canplay",n._playerCanPlayHandler),n._eventEmitter.on("player.error",n._playerErrorHandler),new Promise((function(t,i){n._resolve=t,n._reject=i,n._eventEmitter.on("player.canplay",n._playerCanPlayHandler),n._eventEmitter.on("player.error",n._playerErrorHandler),n._mediaElement.setAttribute("src",e.mediaUrl),n._mediaElement.readyState===HTMLMediaElement.HAVE_NOTHING&&n._mediaElement.load()}))},sn.prototype._reset=function(){this._eventEmitter.removeListener("player.canplay",this._playerCanPlayHandler),this._eventEmitter.removeListener("player.error",this._playerErrorHandler)},sn.prototype._playerCanPlayHandler=function(){this._reset(),this._resolve()},sn.prototype._playerErrorHandler=function(e){this._reset(),this._reject(e)},on.prototype.setSource=function(e){return e.mediaUrl?new sn(this._eventEmitter,this._mediaElement).setSource(e):Promise.reject(new Error("peaks.setSource(): options must contain a mediaUrl when using mediaElement"))},un.prototype.init=function(){return this._adapter.init(this._peaks)},un.prototype.destroy=function(){this._adapter.destroy()},un.prototype.play=function(){return this._adapter.play()},un.prototype.pause=function(){this._adapter.pause()},un.prototype.isPlaying=function(){return this._adapter.isPlaying()},un.prototype.isSeeking=function(){return this._adapter.isSeeking()},un.prototype.getCurrentTime=function(){return this._adapter.getCurrentTime()},un.prototype.getDuration=function(){return this._adapter.getDuration()},un.prototype.seek=function(e){It(e)?this._adapter.seek(e):this._peaks._logger("peaks.player.seek(): parameter must be a valid time, in seconds")},un.prototype.playSegment=function(e,t){var n=this;return e&&It(e.startTime)&&It(e.endTime)?(n._segment=e,n._loop=t,n.seek(e.startTime),n._peaks.once("player.playing",(function(){n._playingSegment||(n._playingSegment=!0,window.requestAnimationFrame(n._playSegmentTimerCallback))})),n.play()):Promise.reject(new Error("peaks.player.playSegment(): parameter must be a segment object"))},un.prototype._playSegmentTimerCallback=function(){if(this.isPlaying()){if(this.getCurrentTime()>=this._segment.endTime){if(!this._loop)return this.pause(),this._peaks.emit("player.ended"),void(this._playingSegment=!1);this.seek(this._segment.startTime)}window.requestAnimationFrame(this._playSegmentTimerCallback)}else this._playingSegment=!1},un.prototype._setSource=function(e){return this._adapter.setSource(e)},ln.prototype.init=function(e){"zoomview"===this._options.view&&(this._label=new mt({x:2,y:0,text:this._options.point.labelText,textAlign:"left",fontFamily:this._options.fontFamily||"sans-serif",fontSize:this._options.fontSize||10,fontStyle:this._options.fontStyle||"normal",fill:"#000"})),this._handle=new rt({x:-4.5,y:0,width:10,height:20,fill:this._options.color,visible:this._draggable}),this._line=new it({x:0,y:0,stroke:this._options.color,strokeWidth:1}),this._time=new mt({x:-24,y:0,text:this._options.layer.formatTime(this._options.point.time),fontFamily:this._options.fontFamily,fontSize:this._options.fontSize,fontStyle:this._options.fontStyle,fill:"#000",textAlign:"center"}),this._time.hide(),e.add(this._handle),e.add(this._line),this._label&&e.add(this._label),e.add(this._time),this.fitToView(),this.bindEventHandlers(e)},ln.prototype.bindEventHandlers=function(e){var t=this;t._handle.on("mouseover touchstart",(function(){t._draggable&&(t._time.setX(-24-t._time.getWidth()),t._time.show())})),t._handle.on("mouseout touchend",(function(){t._draggable&&t._time.hide()})),e.on("dragstart",(function(){t._time.setX(-24-t._time.getWidth()),t._time.show()})),e.on("dragend",(function(){t._time.hide()}))},ln.prototype.fitToView=function(){var e=this._options.layer.getHeight();this._line.points([.5,0,.5,e]),this._label&&this._label.y(12),this._handle&&this._handle.y(e/2-10.5),this._time&&this._time.y(e/2-5)},ln.prototype.update=function(e){void 0!==e.time&&this._time&&this._time.setText(this._options.layer.formatTime(e.time)),void 0!==e.labelText&&this._label&&this._label.text(e.labelText),void 0!==e.color&&(this._handle&&this._handle.fill(e.color),this._line.stroke(e.color)),void 0!==e.editable&&(this._draggable=e.editable,this._handle.visible(this._draggable))},hn.prototype.init=function(e){var t=this._options.startMarker?-24:24,n=this._options.startMarker?this._options.segment.startTime:this._options.segment.endTime;this._label=new mt({x:t,y:0,text:this._options.layer.formatTime(n),fontFamily:this._options.fontFamily,fontSize:this._options.fontSize,fontStyle:this._options.fontStyle,fill:"#000",textAlign:"center",visible:this._editable}),this._label.hide(),this._handle=new rt({x:-4.5,y:0,width:10,height:20,fill:this._options.color,stroke:this._options.color,strokeWidth:1,visible:this._editable}),this._line=new it({x:0,y:0,stroke:this._options.color,strokeWidth:1,visible:this._editable}),e.add(this._label),e.add(this._line),e.add(this._handle),this.fitToView(),this.bindEventHandlers(e)},hn.prototype.bindEventHandlers=function(e){var t=this,n=t._options.startMarker?-24:24;e.on("dragstart",(function(){t._options.startMarker&&t._label.setX(n-t._label.getWidth()),t._label.show()})),e.on("dragend",(function(){t._label.hide()})),t._handle.on("mouseover touchstart",(function(){t._options.startMarker&&t._label.setX(n-t._label.getWidth()),t._label.show()})),t._handle.on("mouseout touchend",(function(){t._label.hide()}))},hn.prototype.fitToView=function(){var e=this._options.layer.getHeight();this._label.y(e/2-5),this._handle.y(e/2-10.5),this._line.points([.5,0,.5,e])},hn.prototype.update=function(e){void 0!==e.startTime&&this._options.startMarker&&this._label.text(this._options.layer.formatTime(e.startTime)),void 0===e.endTime||this._options.startMarker||this._label.text(this._options.layer.formatTime(e.endTime)),void 0!==e.editable&&(this._editable=e.editable,this._label.visible(this._editable),this._handle.visible(this._editable),this._line.visible(this._editable))},fn.prototype.addToStage=function(e){e.add(this._layer)},fn.prototype.showHighlight=function(e,t){this._highlightRect||this._createHighlightRect(e,t),this._update(e,t)},fn.prototype._update=function(e,t){this._startTime=e,this._endTime=t;var n=this._view.timeToPixels(e),i=this._view.timeToPixels(t);this._highlightRect.setAttrs({x:n,width:i-n})},fn.prototype._createHighlightRect=function(e,t){this._startTime=e,this._endTime=t;var n=this._view.timeToPixels(e),i=this._view.timeToPixels(t);this._highlightRect=new rt({x:n,y:0,width:i-n,height:0,stroke:this._strokeColor,strokeWidth:1,fill:this._color,opacity:this._opacity,cornerRadius:this._cornerRadius}),this.fitToView(),this._layer.add(this._highlightRect)},fn.prototype.removeHighlight=function(){this._highlightRect&&(this._highlightRect.destroy(),this._highlightRect=null)},fn.prototype.updateHighlight=function(){this._highlightRect&&this._update(this._startTime,this._endTime)},fn.prototype.fitToView=function(){if(this._highlightRect){var e=this._view.getHeight(),t=At(this._offset,0,Math.floor(e/2));this._highlightRect.setAttrs({y:t,height:e-2*t})}},gn.prototype._bindDefaultEventHandlers=function(){var e=this;e._group.on("dragstart",(function(t){e._onDragStart(t,e._point)})),e._group.on("dragmove",(function(t){e._onDragMove(t,e._point)})),e._group.on("dragend",(function(t){e._onDragEnd(t,e._point)})),e._group.on("mouseenter",(function(t){e._onMouseEnter(t,e._point)})),e._group.on("mouseleave",(function(t){e._onMouseLeave(t,e._point)}))},gn.prototype.addToLayer=function(e){e.add(this._group)},gn.prototype.fitToView=function(){this._marker.fitToView()},gn.prototype.getPoint=function(){return this._point},gn.prototype.getX=function(){return this._group.getX()},gn.prototype.setX=function(e){this._group.setX(e)},gn.prototype.getWidth=function(){return this._group.getWidth()},gn.prototype.getAbsolutePosition=function(){return this._group.getAbsolutePosition()},gn.prototype.update=function(e){void 0!==e.editable&&this._group.draggable(e.editable),this._marker.update&&this._marker.update(e)},gn.prototype.destroy=function(){this._marker.destroy&&this._marker.destroy(),this._group.destroyChildren(),this._group.destroy()},mn.prototype.addToStage=function(e){e.add(this._layer)},mn.prototype.enableEditing=function(e){this._allowEditing=e},mn.prototype.getPointMarker=function(e){return this._pointMarkers[e.pid]},mn.prototype.formatTime=function(e){return this._view.formatTime(e)},mn.prototype._onPointsUpdate=function(e,t){var n=this._view.getStartTime(),i=this._view.getEndTime(),r=this.getPointMarker(e),a=e.isVisible(n,i);if(r&&!a)this._removePoint(e);else if(!r&&a)this._updatePoint(e);else if(r&&a){if(Et(t,"time")){var o=this._view.timeToPixels(e.time)-this._view.getFrameOffset();r.setX(o)}r.update(t)}},mn.prototype._onPointsAdd=function(e){var t=this,n=t._view.getStartTime(),i=t._view.getEndTime();e.points.forEach((function(e){e.isVisible(n,i)&&t._updatePoint(e)}))},mn.prototype._onPointsRemove=function(e){var t=this;e.points.forEach((function(e){t._removePoint(e)}))},mn.prototype._onPointsRemoveAll=function(){this._layer.removeChildren(),this._pointMarkers={}},mn.prototype._createPointMarker=function(e){var t=this._allowEditing&&e.editable;return new gn({point:e,draggable:t,marker:this._peaks.options.createPointMarker({point:e,editable:t,color:e.color,fontFamily:this._peaks.options.fontFamily||"sans-serif",fontSize:this._peaks.options.fontSize||10,fontStyle:this._peaks.options.fontStyle||"normal",layer:this,view:this._view.getName()}),onDragStart:this._onPointMarkerDragStart,onDragMove:this._onPointMarkerDragMove,onDragEnd:this._onPointMarkerDragEnd,dragBoundFunc:this._pointMarkerDragBoundFunc,onMouseEnter:this._onPointMarkerMouseEnter,onMouseLeave:this._onPointMarkerMouseLeave})},mn.prototype.getHeight=function(){return this._view.getHeight()},mn.prototype._addPointMarker=function(e){var t=this._createPointMarker(e);return this._pointMarkers[e.pid]=t,t.addToLayer(this._layer),t},mn.prototype._onPointsDrag=function(e){this._updatePoint(e.point).update({time:e.point.time})},mn.prototype._onPointMarkerMouseEnter=function(e,t){this._peaks.emit("points.mouseenter",{point:t,evt:e.evt})},mn.prototype._onPointMarkerMouseLeave=function(e,t){this._peaks.emit("points.mouseleave",{point:t,evt:e.evt})},mn.prototype._onPointMarkerDragStart=function(e,t){this._dragPointMarker=this.getPointMarker(t),this._peaks.emit("points.dragstart",{point:t,evt:e.evt})},mn.prototype._onPointMarkerDragMove=function(e,t){var n=this._pointMarkers[t.pid],i=n.getX()+n.getWidth();t._setTime(this._view.pixelOffsetToTime(i)),this._peaks.emit("points.dragmove",{point:t,evt:e.evt})},mn.prototype._onPointMarkerDragEnd=function(e,t){this._dragPointMarker=null,this._peaks.emit("points.dragend",{point:t,evt:e.evt})},mn.prototype._pointMarkerDragBoundFunc=function(e){return{x:At(e.x,0,this._view.getWidth()),y:this._dragPointMarker.getAbsolutePosition().y}},mn.prototype.updatePoints=function(e,t){this._peaks.points.find(e,t).forEach(this._updatePoint.bind(this)),this._removeInvisiblePoints(e,t)},mn.prototype._updatePoint=function(e){var t=this.getPointMarker(e);t||(t=this._addPointMarker(e));var n=this._view.timeToPixels(e.time)-this._view.getFrameOffset();return t.setX(n),t},mn.prototype._removeInvisiblePoints=function(e,t){for(var n in this._pointMarkers)if(Et(this._pointMarkers,n)){var i=this._pointMarkers[n].getPoint();i.isVisible(e,t)||this._removePoint(i)}},mn.prototype._removePoint=function(e){var t=this.getPointMarker(e);t&&(t.destroy(),delete this._pointMarkers[e.pid])},mn.prototype.setVisible=function(e){this._layer.setVisible(e)},mn.prototype.destroy=function(){this._peaks.off("points.update",this._onPointsUpdate),this._peaks.off("points.add",this._onPointsAdd),this._peaks.off("points.remove",this._onPointsRemove),this._peaks.off("points.remove_all",this._onPointsRemoveAll),this._peaks.off("points.dragstart",this._onPointsDrag),this._peaks.off("points.dragmove",this._onPointsDrag),this._peaks.off("points.dragend",this._onPointsDrag)},mn.prototype.fitToView=function(){for(var e in this._pointMarkers)Et(this._pointMarkers,e)&&this._pointMarkers[e].fitToView()},mn.prototype.draw=function(){this._layer.draw()},vn.prototype.addToStage=function(e){e.add(this._playheadLayer)},vn.prototype.zoomLevelChanged=function(){var e=this._view.timeToPixels(1);if(this._useAnimation=e>=5,this._useAnimation)this._player.isPlaying()&&!this._playheadLineAnimation&&this._start();else if(this._playheadLineAnimation){var t=this._player.getCurrentTime();this.stop(t)}},vn.prototype.fitToView=function(){var e=this._view.getHeight();this._playheadLine.points([.5,0,.5,e]),this._playheadText&&this._playheadText.y(12)},vn.prototype._createPlayhead=function(){this._playheadLine=new it({stroke:this._playheadColor,strokeWidth:1}),this._playheadGroup=new et.Group({x:0,y:0}),this._playheadGroup.add(this._playheadLine),this._playheadLayer.add(this._playheadGroup)},vn.prototype._createPlayheadText=function(){var e=this,t=e._player.getCurrentTime(),n=e._view.formatTime(t);e._playheadText=new mt({x:0,y:0,padding:e._playheadPadding,text:n,fontSize:e._playheadFontSize,fontFamily:e._playheadFontFamily,fontStyle:e._playheadFontStyle,fill:e._playheadTextColor,align:"right",sceneFunc:function(t,n){var i=n.width(),r=n.height()+2*e._playheadPadding;t.fillStyle=e._playheadBackgroundColor,t.fillRect(0,-e._playheadPadding,i,r),n._sceneFunc(t)}}),e._playheadGroup.add(e._playheadText)},vn.prototype.updatePlayheadTime=function(e){this._syncPlayhead(e),this._player.isPlaying()&&this._start()},vn.prototype._syncPlayhead=function(e){var t=this._view.timeToPixels(e),n=this._view.getFrameOffset(),i=this._view.getWidth(),r=t>=n&&t<=n+i;if(this._playheadPixel=t,r){var a=this._playheadPixel-n;if(this._playheadVisible||(this._playheadVisible=!0,this._playheadGroup.show()),this._playheadGroup.setX(a),this._playheadText){var o=this._view.formatTime(e),s=this._playheadText.width();this._playheadText.setText(o),s+a>i-2?this._playheadText.setX(-s):s+a<i&&this._playheadText.setX(0)}}else this._playheadVisible&&(this._playheadVisible=!1,this._playheadGroup.hide());this._view.playheadPosChanged&&this._view.playheadPosChanged(e)},vn.prototype._start=function(){var e=this;if(e._playheadLineAnimation&&(e._playheadLineAnimation.stop(),e._playheadLineAnimation=null),e._useAnimation){var t=null;e._playheadLineAnimation=new Ke((function(){var n=e._player.getCurrentTime(),i=e._view.timeToPixels(n);i!==t&&(e._syncPlayhead(n),t=i)}),e._playheadLayer),e._playheadLineAnimation.start()}},vn.prototype.stop=function(e){this._playheadLineAnimation&&(this._playheadLineAnimation.stop(),this._playheadLineAnimation=null),this._syncPlayhead(e)},vn.prototype.getPlayheadPixel=function(){return this._playheadPixel},vn.prototype.showPlayheadTime=function(e){e?this._playheadText||(this._createPlayheadText(this._playheadTextColor,this._playheadBackgroundColor,this._playheadPadding),this.fitToView()):this._playheadText&&(this._playheadText.remove(),this._playheadText.destroy(),this._playheadText=null)},vn.prototype.updatePlayheadText=function(){if(this._playheadText){var e=this._player.getCurrentTime(),t=this._view.formatTime(e);this._playheadText.setText(t)}},vn.prototype.destroy=function(){this._playheadLineAnimation&&(this._playheadLineAnimation.stop(),this._playheadLineAnimation=null)},yn.prototype.init=function(e){var t=this._options.startMarker?-24:24,n=this._options.startMarker?this._options.segment.startTime:this._options.segment.endTime;this._label=new mt({x:t,y:0,text:this._options.layer.formatTime(n),fontFamily:this._options.fontFamily,fontSize:this._options.fontSize,fontStyle:this._options.fontStyle,fill:"#000",textAlign:"center",visible:!1}),this._handle=new rt({x:-4.5,y:0,width:10,height:20}),e.add(this._label),e.add(this._handle),this.fitToView(),this.bindEventHandlers(e)},yn.prototype.bindEventHandlers=function(e){var t=this,n=t._options.startMarker?-24:24;e.on("dragstart",(function(){t._options.startMarker&&t._label.setX(n-t._label.getWidth()),t._label.show()})),e.on("dragend",(function(){t._label.hide()})),t._handle.on("mouseover touchstart",(function(){t._options.startMarker&&t._label.setX(n-t._label.getWidth()),t._label.show(),document.body.style.cursor="ew-resize"})),t._handle.on("mouseout touchend",(function(){t._label.hide(),document.body.style.cursor="default"}))},yn.prototype.fitToView=function(){var e=this._options.layer.getHeight(),t=this._options.segmentOptions.overlayOffset,n=At(0,e-2*t);this._label.y(e/2-5),this._handle.y(t),this._handle.height(n)},yn.prototype.update=function(e){void 0!==e.startTime&&this._options.startMarker&&this._label.text(this._options.layer.formatTime(e.startTime)),void 0===e.endTime||this._options.startMarker||this._label.text(this._options.layer.formatTime(e.endTime))},bn.prototype._bindDefaultEventHandlers=function(){var e=this;e._group.on("dragstart",(function(t){e._onDragStart(e,t)})),e._group.on("dragmove",(function(t){e._onDragMove(e,t)})),e._group.on("dragend",(function(t){e._onDragEnd(e,t)}))},bn.prototype.addToLayer=function(e){e.add(this._group)},bn.prototype.moveToTop=function(){this._group.moveToTop()},bn.prototype.fitToView=function(){this._marker.fitToView()},bn.prototype.getSegment=function(){return this._segment},bn.prototype.getX=function(){return this._group.getX()},bn.prototype.setX=function(e){this._group.setX(e)},bn.prototype.getWidth=function(){return this._group.getWidth()},bn.prototype.getAbsolutePosition=function(){return this._group.getAbsolutePosition()},bn.prototype.isStartMarker=function(){return this._startMarker},bn.prototype.update=function(e){void 0!==e.editable&&(this._group.visible(e.editable),this._group.draggable(e.editable)),this._marker.update&&this._marker.update(e)},bn.prototype.destroy=function(){this._marker.destroy&&this._marker.destroy(),this._group.destroyChildren(),this._group.destroy()},bn.prototype.startDrag=function(){this._group.startDrag()},bn.prototype.stopDrag=function(){this._group.stopDrag()},_n.prototype.getX=function(){return this._shape.getX()},_n.prototype.setX=function(e){return this._shape.setX(e)},_n.prototype.setSegment=function(e){this._segment=e},_n.prototype.setWaveformColor=function(e){if(Mt(e))this._shape.fill(e),this._shape.fillLinearGradientStartPointY(null),this._shape.fillLinearGradientEndPointY(null),this._shape.fillLinearGradientColorStops(null);else{if(!Rt(e))throw new TypeError("Unknown type for color property");this._shape.fill(null);var t=this._view._height*(e.linearGradientStart/100),n=this._view._height*(e.linearGradientEnd/100);this._shape.fillLinearGradientStartPointY(t),this._shape.fillLinearGradientEndPointY(n),this._shape.fillLinearGradientColorStops([0,e.linearGradientColorStops[0],1,e.linearGradientColorStops[1]])}},_n.prototype.fitToView=function(){this.setWaveformColor(this._color)},_n.prototype._sceneFunc=function(e){var t=this._view.getFrameOffset(),n=this._view.getWidth(),i=this._view.getHeight();this._drawWaveform(e,this._view.getWaveformData(),t,this._segment?this._view.timeToPixels(this._segment.startTime):t,this._segment?this._view.timeToPixels(this._segment.endTime):t+n,n,i)},_n.prototype._drawWaveform=function(e,t,n,i,r,a,o){i<n&&(i=n);var s=n+a;r>s&&(r=s),r>t.length-1&&(r=t.length-1);for(var u=t.channels,l=0,h=Math.floor(o/u),c=0;c<u;c++)c===u-1&&(h=o-(u-1)*h),this._drawChannel(e,t.channel(c),n,i,r,l,h),l+=h},_n.prototype._drawChannel=function(e,t,n,i,r,a,o){var s,u,l,h,c=this._view.getAmplitudeScale();for(e.beginPath(),s=i;s<=r;s++)u=t.min_sample(s),l=s-n+.5,h=a+_n.scaleY(u,o,c)+.5,e.lineTo(l,h);for(s=r;s>=i;s--)u=t.max_sample(s),l=s-n+.5,h=a+_n.scaleY(u,o,c)+1,e.lineTo(l,h);e.closePath(),e.fillShape(this._shape)},_n.prototype.addToLayer=function(e){e.add(this._shape)},_n.prototype.destroy=function(){this._shape.destroy(),this._shape=null},_n.prototype.on=function(e,t){this._shape.on(e,t)},_n.prototype.off=function(e,t){this._shape.off(e,t)},_n.scaleY=function(e,t,n){var i=-(t-1)*(e*n+128)/255+(t-1);return At(Math.floor(i),0,t-1)};var wn="sans-serif",Sn="normal";function Tn(e,t,n,i){this._segment=e,this._peaks=t,this._layer=n,this._view=i,this._label=null,this._startMarker=null,this._endMarker=null,this._color=e.color,this._borderColor=e.borderColor,this._draggable=this._segment.editable&&this._view.isSegmentDraggingEnabled(),this._dragging=!1;var r=i.getViewOptions().segmentOptions;this._overlayOffset=r.overlayOffset,r.overlay||(this._waveformShape=new _n({color:e.color,view:i,segment:e})),this._onMouseEnter=this._onMouseEnter.bind(this),this._onMouseLeave=this._onMouseLeave.bind(this),this._onMouseDown=this._onMouseDown.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._dragBoundFunc=this._dragBoundFunc.bind(this),this._onSegmentDragStart=this._onSegmentDragStart.bind(this),this._onSegmentDragMove=this._onSegmentDragMove.bind(this),this._onSegmentDragEnd=this._onSegmentDragEnd.bind(this),this._onSegmentMarkerDragStart=this._onSegmentMarkerDragStart.bind(this),this._onSegmentMarkerDragMove=this._onSegmentMarkerDragMove.bind(this),this._onSegmentMarkerDragEnd=this._onSegmentMarkerDragEnd.bind(this),this._segmentMarkerDragBoundFunc=this._segmentMarkerDragBoundFunc.bind(this),this._label=this._peaks.options.createSegmentLabel({segment:e,view:this._view.getName(),layer:this._layer,fontFamily:this._peaks.options.fontFamily,fontSize:this._peaks.options.fontSize,fontStyle:this._peaks.options.fontStyle}),this._label&&this._label.hide();var a,o,s,u,l,h=this._view.timeToPixelOffset(this._segment.startTime),c=this._view.timeToPixelOffset(this._segment.endTime),d=At(0,this._view.getHeight()-2*this._overlayOffset);this._overlay=new et.Group({name:"segment-overlay",segment:this._segment,x:h,y:0,width:c-h,height:this._view.getHeight(),clipX:0,clipY:this._overlayOffset,clipWidth:c-h,clipHeight:d,draggable:this._draggable,dragBoundFunc:this._dragBoundFunc}),r.overlay&&(a=this._borderColor||r.overlayBorderColor,o=r.overlayBorderWidth,s=this._color||r.overlayColor,u=r.overlayOpacity,l=r.overlayCornerRadius),this._overlayRect=new et.Rect({x:0,y:this._overlayOffset,width:c-h,stroke:a,strokeWidth:o,height:d,fill:s,opacity:u,cornerRadius:l}),this._overlay.add(this._overlayRect),r.overlay&&(this._overlayText=new et.Text({x:0,y:this._overlayOffset,text:this._segment.labelText,fontFamily:r.overlayFontFamily,fontSize:r.overlayFontSize,fontStyle:r.overlayFontStyle,fill:r.overlayLabelColor,listening:!1,align:r.overlayLabelAlign,width:c-h,verticalAlign:r.overlayLabelVerticalAlign,height:d,padding:r.overlayLabelPadding}),this._overlay.add(this._overlayText)),this._overlay.on("mouseenter",this._onMouseEnter),this._overlay.on("mouseleave",this._onMouseLeave),this._overlay.on("mousedown",this._onMouseDown),this._overlay.on("mouseup",this._onMouseUp),this._draggable&&(this._overlay.on("dragstart",this._onSegmentDragStart),this._overlay.on("dragmove",this._onSegmentDragMove),this._overlay.on("dragend",this._onSegmentDragEnd)),this._createMarkers()}function An(e){return new yn(e)}function En(e){return e.endTime-e.startTime}function Cn(e,t,n){this._peaks=e,this._view=t,this._allowEditing=n,this._segmentShapes={},this._layer=new et.Layer,this._onSegmentsUpdate=this._onSegmentsUpdate.bind(this),this._onSegmentsAdd=this._onSegmentsAdd.bind(this),this._onSegmentsRemove=this._onSegmentsRemove.bind(this),this._onSegmentsRemoveAll=this._onSegmentsRemoveAll.bind(this),this._onSegmentsDragged=this._onSegmentsDragged.bind(this),this._peaks.on("segments.update",this._onSegmentsUpdate),this._peaks.on("segments.add",this._onSegmentsAdd),this._peaks.on("segments.remove",this._onSegmentsRemove),this._peaks.on("segments.remove_all",this._onSegmentsRemoveAll),this._peaks.on("segments.dragged",this._onSegmentsDragged)}function xn(e,t){var n=this;n._axisGridlineColor=t.axisGridlineColor,n._axisLabelColor=t.axisLabelColor,n._showAxisLabels=t.showAxisLabels,n._axisTopMarkerHeight=t.axisTopMarkerHeight,n._axisBottomMarkerHeight=t.axisBottomMarkerHeight,t.formatAxisTime?n._formatAxisTime=t.formatAxisTime:n._formatAxisTime=function(e){return Tt(e,0)},n._axisLabelFont=xn._buildFontString(t.fontFamily,t.fontSize,t.fontStyle),n._axisShape=new et.Shape({sceneFunc:function(t){n._drawAxis(t,e)}})}function In(e,t,n,i){var r=this;r._container=t,r._peaks=n,r._options=n.options,r._viewOptions=i,r._originalWaveformData=e,r._data=e,r._frameOffset=0,r._width=t.clientWidth,r._height=t.clientHeight,r._amplitudeScale=1,r._waveformColor=r._viewOptions.waveformColor,r._playedWaveformColor=r._viewOptions.playedWaveformColor,r._timeLabelPrecision=r._viewOptions.timeLabelPrecision,r._viewOptions.formatPlayheadTime?r._formatPlayheadTime=r._viewOptions.formatPlayheadTime:r._formatPlayheadTime=function(e){return Tt(e,r._timeLabelPrecision)},r._enableSeek=!0,r.initWaveform(),et.showWarnings=!1,r._stage=new et.Stage({container:t,width:r._width,height:r._height}),r._createWaveform(),r._viewOptions.enableSegments&&(r._segmentsLayer=new Cn(n,r,r._viewOptions.enableEditing),r._segmentsLayer.addToStage(r._stage)),r._viewOptions.enablePoints&&(r._pointsLayer=new mn(n,r,r._viewOptions.enableEditing),r._pointsLayer.addToStage(r._stage)),r.initHighlightLayer(),r._createAxisLabels(),r._playheadLayer=new vn({player:r._peaks.player,view:r,showPlayheadTime:r._viewOptions.showPlayheadTime,playheadColor:r._viewOptions.playheadColor,playheadTextColor:r._viewOptions.playheadTextColor,playheadBackgroundColor:r._viewOptions.playheadBackgroundColor,playheadPadding:r._viewOptions.playheadPadding,playheadFontFamily:r._viewOptions.fontFamily,playheadFontSize:r._viewOptions.fontSize,playheadFontStyle:r._viewOptions.fontStyle}),r._playheadLayer.addToStage(r._stage),r._onClick=r._onClick.bind(r),r._onDblClick=r._onDblClick.bind(r),r._onContextMenu=r._onContextMenu.bind(r),r._stage.on("click",r._onClick),r._stage.on("dblclick",r._onDblClick),r._stage.on("contextmenu",r._onContextMenu)}function kn(e,t){this._stage=e,this._handlers=t,this._dragging=!1,this._mouseDown=this._mouseDown.bind(this),this._mouseUp=this._mouseUp.bind(this),this._mouseMove=this._mouseMove.bind(this),this._stage.on("mousedown",this._mouseDown),this._stage.on("touchstart",this._mouseDown),this._lastMouseClientX=null}function Mn(e,t){this._peaks=e,this._view=t,this._onMouseDown=this._onMouseDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._mouseDragHandler=new kn(t._stage,{onMouseDown:this._onMouseDown,onMouseMove:this._onMouseMove})}function Pn(e,t,n){var i=this;In.call(i,e,t,n,n.options.overview),i._onTimeUpdate=i._onTimeUpdate.bind(i),i._onPlaying=i._onPlaying.bind(i),i._onPause=i._onPause.bind(i),i._onZoomviewDisplaying=i._onZoomviewDisplaying.bind(i),n.on("player.timeupdate",i._onTimeUpdate),n.on("player.playing",i._onPlaying),n.on("player.pause",i._onPause),n.on("zoomview.displaying",i._onZoomviewDisplaying);var r=i._peaks.player.getCurrentTime();i._playheadLayer.updatePlayheadTime(r),i._mouseDragHandler=new Mn(n,i)}function Ln(e,t){this._peaks=e,this._view=t,this._onMouseDown=this._onMouseDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._mouseDragHandler=new kn(t._stage,{onMouseDown:this._onMouseDown,onMouseMove:this._onMouseMove,onMouseUp:this._onMouseUp})}function Dn(e,t){this._peaks=e,this._view=t,this._onMouseDown=this._onMouseDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._mouseDragHandler=new kn(t._stage,{onMouseDown:this._onMouseDown,onMouseMove:this._onMouseMove,onMouseUp:this._onMouseUp})}function Rn(e,t,n){var i=this;In.call(i,e,t,n,n.options.zoomview),i._onTimeUpdate=i._onTimeUpdate.bind(i),i._onPlaying=i._onPlaying.bind(i),i._onPause=i._onPause.bind(i),i._onKeyboardLeft=i._onKeyboardLeft.bind(i),i._onKeyboardRight=i._onKeyboardRight.bind(i),i._onKeyboardShiftLeft=i._onKeyboardShiftLeft.bind(i),i._onKeyboardShiftRight=i._onKeyboardShiftRight.bind(i),i._peaks.on("player.timeupdate",i._onTimeUpdate),i._peaks.on("player.playing",i._onPlaying),i._peaks.on("player.pause",i._onPause),i._peaks.on("keyboard.left",i._onKeyboardLeft),i._peaks.on("keyboard.right",i._onKeyboardRight),i._peaks.on("keyboard.shift_left",i._onKeyboardShiftLeft),i._peaks.on("keyboard.shift_right",i._onKeyboardShiftRight),i._autoScroll=i._viewOptions.autoScroll,i._autoScrollOffset=i._viewOptions.autoScrollOffset,i._enableSegmentDragging=!1,i._segmentDragMode="overlap",i._minSegmentDragWidth=0,i._insertSegmentShape=null,i._playheadClickTolerance=i._viewOptions.playheadClickTolerance,i._zoomLevelAuto=!1,i._zoomLevelSeconds=null;var r=i._peaks.player.getCurrentTime();i._syncPlayhead(r),i._mouseDragHandler=new Dn(n,i),i._onWheel=i._onWheel.bind(i),i._onWheelCaptureVerticalScroll=i._onWheelCaptureVerticalScroll.bind(i),i.setWheelMode(i._viewOptions.wheelMode),i._peaks.emit("zoomview.displaying",0,i.getEndTime())}function Nn(e,t,n){this._waveformData=e,this._container=t,this._peaks=n,this._options=n.options.scrollbar,this._zoomview=n.views.getView("zoomview"),this._dragBoundFunc=this._dragBoundFunc.bind(this),this._onScrollboxDragStart=this._onScrollboxDragStart.bind(this),this._onScrollboxDragMove=this._onScrollboxDragMove.bind(this),this._onScrollboxDragEnd=this._onScrollboxDragEnd.bind(this),this._onZoomviewDisplaying=this._onZoomviewDisplaying.bind(this),this._onScrollbarClick=this._onScrollbarClick.bind(this),n.on("zoomview.displaying",this._onZoomviewDisplaying),this._width=t.clientWidth,this._height=t.clientHeight,this._stage=new et.Stage({container:t,width:this._width,height:this._height}),this._layer=new et.Layer,this._stage.on("click",this._onScrollbarClick),this._stage.add(this._layer),this._color=this._options.color,this._scrollboxX=0,this._minScrollboxWidth=this._options.minWidth,this._offsetY=0,this._scrollbox=new et.Group({draggable:!0,dragBoundFunc:this._dragBoundFunc}),this._scrollboxRect=new rt({x:this._scrollboxX,y:this._offsetY,width:0,height:this._height,fill:this._color}),this._scrollbox.add(this._scrollboxRect),this._setScrollboxWidth(),this._scrollbox.on("dragstart",this._onScrollboxDragStart),this._scrollbox.on("dragmove",this._onScrollboxDragMove),this._scrollbox.on("dragend",this._onScrollboxDragEnd),this._layer.add(this._scrollbox),this._layer.draw()}function On(e){this._peaks=e,this._overview=null,this._zoomview=null,this._scrollbar=null}function Un(e,t){this._peaks=e,this._zoomLevels=t,this._zoomLevelIndex=0}Tn.prototype._createMarkers=function(){var e=this._layer.isEditingEnabled()&&this._segment.editable,t=this._view.getViewOptions().segmentOptions,n=t.markers?this._peaks.options.createSegmentMarker:An,i=n({segment:this._segment,editable:e,startMarker:!0,color:t.startMarkerColor,fontFamily:this._peaks.options.fontFamily||wn,fontSize:this._peaks.options.fontSize||10,fontStyle:this._peaks.options.fontStyle||Sn,layer:this._layer,view:this._view.getName(),segmentOptions:this._view.getViewOptions().segmentOptions});i&&(this._startMarker=new bn({segment:this._segment,segmentShape:this,editable:e,startMarker:!0,marker:i,onDragStart:this._onSegmentMarkerDragStart,onDragMove:this._onSegmentMarkerDragMove,onDragEnd:this._onSegmentMarkerDragEnd,dragBoundFunc:this._segmentMarkerDragBoundFunc}));var r=n({segment:this._segment,editable:e,startMarker:!1,color:t.endMarkerColor,fontFamily:this._peaks.options.fontFamily||wn,fontSize:this._peaks.options.fontSize||10,fontStyle:this._peaks.options.fontStyle||Sn,layer:this._layer,view:this._view.getName(),segmentOptions:this._view.getViewOptions().segmentOptions});r&&(this._endMarker=new bn({segment:this._segment,segmentShape:this,editable:e,startMarker:!1,marker:r,onDragStart:this._onSegmentMarkerDragStart,onDragMove:this._onSegmentMarkerDragMove,onDragEnd:this._onSegmentMarkerDragEnd,dragBoundFunc:this._segmentMarkerDragBoundFunc}))},Tn.prototype._dragBoundFunc=function(e){return{x:e.x,y:0}},Tn.prototype.update=function(e){var t,n=this._view.timeToPixelOffset(this._segment.startTime),i=this._view.timeToPixelOffset(this._segment.endTime),r=i-n;(t=this.getStartMarker())&&(t.setX(n-t.getWidth()),e&&t.update(e)),(t=this.getEndMarker())&&(t.setX(i),e&&t.update(e)),this._color=this._segment.color,this._borderColor=this._segment.bordercolor,this._overlayText&&this._overlayText.text(this._segment.labelText),this._view.getViewOptions().segmentOptions.overlay?(this._color&&this._overlayRect.fill(this._color),this._borderColor&&this._overlayRect.stroke(this._borderColor)):this._waveformShape.setWaveformColor(this._segment.color),this._dragging||this._overlay&&(this._overlay.setAttrs({x:n,width:r,clipWidth:r<1?1:r}),this._overlayRect.setAttrs({x:0,width:r}),this._overlayText&&this._overlayText.setAttrs({width:r}))},Tn.prototype.getSegment=function(){return this._segment},Tn.prototype.getStartMarker=function(){return this._startMarker},Tn.prototype.getEndMarker=function(){return this._endMarker},Tn.prototype.addToLayer=function(e){this._waveformShape&&this._waveformShape.addToLayer(e),this._label&&e.add(this._label),this._overlay&&e.add(this._overlay),this._startMarker&&this._startMarker.addToLayer(e),this._endMarker&&this._endMarker.addToLayer(e)},Tn.prototype.isDragging=function(){return this._dragging},Tn.prototype._onMouseEnter=function(e){this._label&&(this._label.moveToTop(),this._label.show()),this._peaks.emit("segments.mouseenter",{segment:this._segment,evt:e.evt})},Tn.prototype._onMouseLeave=function(e){this._label&&this._label.hide(),this._peaks.emit("segments.mouseleave",{segment:this._segment,evt:e.evt})},Tn.prototype._onMouseDown=function(e){this._peaks.emit("segments.mousedown",{segment:this._segment,evt:e.evt})},Tn.prototype._onMouseUp=function(e){this._peaks.emit("segments.mouseup",{segment:this._segment,evt:e.evt})},Tn.prototype.segmentClicked=function(e,t){this._moveToTop(),this._peaks.emit("segments."+e,t)},Tn.prototype._moveToTop=function(){this._overlay.moveToTop(),this._layer.moveSegmentMarkersToTop()},Tn.prototype.enableSegmentDragging=function(e){this._segment.editable&&(!this._draggable&&e?(this._overlay.on("dragstart",this._onSegmentDragStart),this._overlay.on("dragmove",this._onSegmentDragMove),this._overlay.on("dragend",this._onSegmentDragEnd)):this._draggable&&!e&&(this._overlay.off("dragstart",this._onSegmentDragStart),this._overlay.off("dragmove",this._onSegmentDragMove),this._overlay.off("dragend",this._onSegmentDragEnd)),this._overlay.draggable(e),this._draggable=e)},Tn.prototype._setPreviousAndNextSegments=function(){"overlap"!==this._view.getSegmentDragMode()?(this._nextSegment=this._peaks.segments.findNextSegment(this._segment),this._previousSegment=this._peaks.segments.findPreviousSegment(this._segment)):(this._nextSegment=null,this._previousSegment=null)},Tn.prototype._onSegmentDragStart=function(e){this._setPreviousAndNextSegments(),this._dragging=!0,this._dragStartX=this._overlay.getX(),this._dragStartTime=this._segment.startTime,this._dragEndTime=this._segment.endTime,this._peaks.emit("segments.dragstart",{segment:this._segment,marker:!1,startMarker:!1,evt:e.evt})},Tn.prototype._onSegmentDragMove=function(e){var t,n=this._overlay.getX()-this._dragStartX,i=this._view.pixelsToTime(n),r=this._dragStartTime+i,a=this._dragEndTime+i,o=this._segment.endTime-this._segment.startTime,s=this._view.getMinSegmentDragWidth(),u=this._view.pixelsToTime(s),l=!1,h=!1;if(r<0&&(r=0,a=o,this._overlay.setX(this._view.timeToPixelOffset(r))),this._previousSegment){var c=this._view.timeToPixelOffset(this._previousSegment.endTime);if(r<this._previousSegment.endTime)if("no-overlap"===(t=this._view.getSegmentDragMode())||"compress"===t&&!this._previousSegment.editable)a=(r=this._previousSegment.endTime)+o,this._overlay.setX(c);else if("compress"===t){var d=r,p=this._previousSegment.startTime+u;d<p&&(d=p,c=this._view.timeToPixelOffset(d),this._overlay.setX(c),a=(r=d)+o),this._previousSegment.update({endTime:d}),l=!0}}if(this._nextSegment){var f=this._view.timeToPixelOffset(this._nextSegment.startTime);if(a>this._nextSegment.startTime)if("no-overlap"===(t=this._view.getSegmentDragMode())||"compress"===t&&!this._nextSegment.editable)r=(a=this._nextSegment.startTime)-o,this._overlay.setX(f-this._overlay.getWidth());else if("compress"===t){var g=a,m=this._nextSegment.endTime-u;g>m&&(g=m,f=this._view.timeToPixelOffset(g),this._overlay.setX(f-this._overlay.getWidth()),r=(a=g)-o),this._nextSegment.update({startTime:g}),h=!0}}this._segment._setStartTime(r),this._segment._setEndTime(a),this._peaks.emit("segments.dragged",{segment:this._segment,marker:!1,startMarker:!1,evt:e.evt}),l?this._peaks.emit("segments.dragged",{segment:this._previousSegment,marker:!1,startMarker:!1,evt:e.evt}):h&&this._peaks.emit("segments.dragged",{segment:this._nextSegment,marker:!1,startMarker:!1,evt:e.evt})},Tn.prototype._onSegmentDragEnd=function(e){this._dragging=!1,this._peaks.emit("segments.dragend",{segment:this._segment,marker:!1,startMarker:!1,evt:e.evt})},Tn.prototype.moveMarkersToTop=function(){this._startMarker&&this._startMarker.moveToTop(),this._endMarker&&this._endMarker.moveToTop()},Tn.prototype.startDrag=function(){this._endMarker&&this._endMarker.startDrag()},Tn.prototype.stopDrag=function(){this._endMarker&&this._endMarker.stopDrag()},Tn.prototype._onSegmentMarkerDragStart=function(e,t){this._setPreviousAndNextSegments(),this._moveToTop(),this._startMarkerX=this._startMarker.getX(),this._endMarkerX=this._endMarker.getX(),this._peaks.emit("segments.dragstart",{segment:this._segment,marker:!0,startMarker:e.isStartMarker(),evt:t.evt})},Tn.prototype._onSegmentMarkerDragMove=function(e,t){e.isStartMarker()?(this._segmentStartMarkerDragMove(e,t),e.update({startTime:this._segment.startTime})):(this._segmentEndMarkerDragMove(e,t),e.update({endTime:this._segment.endTime}))},Tn.prototype._segmentStartMarkerDragMove=function(e,t){var n=this._view.getWidth(),i=this._startMarker.getX(),r=this._endMarker.getX(),a=this._view.pixelsToTime(50),o=this._view.getMinSegmentDragWidth(),s=this._endMarker.getX()-o;s>n&&(s=n);var u,l=!1,h=!1;if(this._previousSegment&&(l=(u=this._view.timeToPixelOffset(this._previousSegment.endTime))>=0),i>s)e.setX(s),this._overlay.clipWidth(s-r),0===o&&s<n?this._segment._setStartTime(this._segment.endTime):this._segment._setStartTime(this._view.pixelOffsetToTime(s));else if(this._previousSegment&&l){var c=this._view.getSegmentDragMode(),d="no-overlap"===c||"compress"===c&&!this._previousSegment.editable,p="compress"===c&&this._previousSegment.editable;if(i<=u){if(d)e.setX(u),this._overlay.clipWidth(u-r),this._segment._setStartTime(this._previousSegment.endTime);else if(p){var f=En(this._previousSegment);f<a&&(a=f);var g=this._view.timeToPixelOffset(this._previousSegment.startTime+a);i<g&&(i=g),e.setX(i),this._overlay.clipWidth(r-i),this._segment._setStartTime(this._view.pixelOffsetToTime(i)),this._previousSegment.update({endTime:this._view.pixelOffsetToTime(i)}),h=!0}}else i<0&&(i=0),e.setX(i),this._overlay.clipWidth(r-i),this._segment._setStartTime(this._view.pixelOffsetToTime(i))}else i<0&&(i=0),e.setX(i),this._overlay.clipWidth(r-i),this._segment._setStartTime(this._view.pixelOffsetToTime(i));this._peaks.emit("segments.dragged",{segment:this._segment,marker:!0,startMarker:!0,evt:t.evt}),h&&this._peaks.emit("segments.dragged",{segment:this._previousSegment,marker:!0,startMarker:!1,evt:t.evt})},Tn.prototype._segmentEndMarkerDragMove=function(e,t){var n=this._view.getWidth(),i=this._startMarker.getX(),r=this._endMarker.getX(),a=this._view.pixelsToTime(50),o=this._view.getMinSegmentDragWidth(),s=this._startMarker.getX()+o;s<0&&(s=0);var u,l=!1,h=!1;if(this._nextSegment&&(l=(u=this._view.timeToPixelOffset(this._nextSegment.startTime))<n),r<s)e.setX(s),this._overlay.clipWidth(s-i),0===o&&s>0?this._segment._setEndTime(this._segment.startTime):this._segment._setEndTime(this._view.pixelOffsetToTime(s));else if(this._nextSegment&&l){var c=this._view.getSegmentDragMode(),d="no-overlap"===c||"compress"===c&&!this._nextSegment.editable,p="compress"===c&&this._nextSegment.editable;if(r>=u){if(d)e.setX(u),this._overlay.clipWidth(u-i),this._segment._setEndTime(this._nextSegment.startTime);else if(p){var f=En(this._nextSegment);f<a&&(a=f);var g=this._view.timeToPixelOffset(this._nextSegment.endTime-a);r>g&&(r=g),e.setX(r),this._overlay.clipWidth(r-i),this._segment._setEndTime(this._view.pixelOffsetToTime(r)),this._nextSegment.update({startTime:this._view.pixelOffsetToTime(r)}),h=!0}}else r>n&&(r=n),e.setX(r),this._overlay.clipWidth(r-i),this._segment._setEndTime(this._view.pixelOffsetToTime(r))}else r>n&&(r=n),e.setX(r),this._overlay.clipWidth(r-i),this._segment._setEndTime(this._view.pixelOffsetToTime(r));this._peaks.emit("segments.dragged",{segment:this._segment,marker:!0,startMarker:!1,evt:t.evt}),h&&this._peaks.emit("segments.dragged",{segment:this._nextSegment,marker:!0,startMarker:!0,evt:t.evt})},Tn.prototype._onSegmentMarkerDragEnd=function(e,t){this._nextSegment=null,this._previousSegment=null;var n=e.isStartMarker();this._peaks.emit("segments.dragend",{segment:this._segment,marker:!0,startMarker:n,evt:t.evt})},Tn.prototype._segmentMarkerDragBoundFunc=function(e,t){return{x:t.x,y:e.getAbsolutePosition().y}},Tn.prototype.fitToView=function(){if(this._startMarker&&this._startMarker.fitToView(),this._endMarker&&this._endMarker.fitToView(),this._overlay){var e=this._view.getHeight(),t=At(0,e-2*this._overlayOffset);this._overlay.setAttrs({y:0,height:e,clipY:this._overlayOffset,clipHeight:t}),this._overlayRect.setAttrs({y:this._overlayOffset,height:t}),this._overlayText&&this._overlayText.setAttrs({y:this._overlayOffset,height:t})}},Tn.prototype.destroy=function(){this._waveformShape&&this._waveformShape.destroy(),this._label&&this._label.destroy(),this._startMarker&&this._startMarker.destroy(),this._endMarker&&this._endMarker.destroy(),this._overlay&&this._overlay.destroy()},Cn.prototype.addToStage=function(e){e.add(this._layer)},Cn.prototype.enableEditing=function(e){this._allowEditing=e},Cn.prototype.isEditingEnabled=function(){return this._allowEditing},Cn.prototype.enableSegmentDragging=function(e){for(var t in this._segmentShapes)Et(this._segmentShapes,t)&&this._segmentShapes[t].enableSegmentDragging(e)},Cn.prototype.getSegmentShape=function(e){return this._segmentShapes[e.pid]},Cn.prototype.formatTime=function(e){return this._view.formatTime(e)},Cn.prototype._onSegmentsUpdate=function(e,t){var n=this._view.getStartTime(),i=this._view.getEndTime(),r=this.getSegmentShape(e),a=e.isVisible(n,i);r&&!a?r.isDragging()||this._removeSegment(e):!r&&a?r=this._updateSegment(e):r&&a&&r.update(t)},Cn.prototype._onSegmentsAdd=function(e){var t=this,n=t._view.getStartTime(),i=t._view.getEndTime();e.segments.forEach((function(e){e.isVisible(n,i)&&t._addSegmentShape(e).update()})),this.moveSegmentMarkersToTop()},Cn.prototype._onSegmentsRemove=function(e){var t=this;e.segments.forEach((function(e){t._removeSegment(e)}))},Cn.prototype._onSegmentsRemoveAll=function(){this._layer.removeChildren(),this._segmentShapes={}},Cn.prototype._onSegmentsDragged=function(e){this._updateSegment(e.segment)},Cn.prototype._createSegmentShape=function(e){return new Tn(e,this._peaks,this,this._view)},Cn.prototype._addSegmentShape=function(e){var t=this._createSegmentShape(e);return t.addToLayer(this._layer),this._segmentShapes[e.pid]=t,t},Cn.prototype.updateSegments=function(e,t){this._peaks.segments.find(e,t).forEach(this._updateSegment.bind(this)),this._removeInvisibleSegments(e,t)},Cn.prototype._updateSegment=function(e){var t=this.getSegmentShape(e);t||(t=this._addSegmentShape(e)),t.update()},Cn.prototype._removeInvisibleSegments=function(e,t){for(var n in this._segmentShapes)if(Et(this._segmentShapes,n)){var i=this._segmentShapes[n].getSegment();i.isVisible(e,t)||this._removeSegment(i)}},Cn.prototype._removeSegment=function(e){var t=this._segmentShapes[e.pid];t&&(t.destroy(),delete this._segmentShapes[e.pid])},Cn.prototype.moveSegmentMarkersToTop=function(){for(var e in this._segmentShapes)Et(this._segmentShapes,e)&&this._segmentShapes[e].moveMarkersToTop()},Cn.prototype.setVisible=function(e){this._layer.setVisible(e)},Cn.prototype.segmentClicked=function(e,t){var n=this._segmentShapes[t.segment.pid];n&&n.segmentClicked(e,t)},Cn.prototype.destroy=function(){this._peaks.off("segments.update",this._onSegmentsUpdate),this._peaks.off("segments.add",this._onSegmentsAdd),this._peaks.off("segments.remove",this._onSegmentsRemove),this._peaks.off("segments.remove_all",this._onSegmentsRemoveAll),this._peaks.off("segments.dragged",this._onSegmentsDragged)},Cn.prototype.fitToView=function(){for(var e in this._segmentShapes)Et(this._segmentShapes,e)&&this._segmentShapes[e].fitToView()},Cn.prototype.draw=function(){this._layer.draw()},Cn.prototype.getHeight=function(){return this._layer.getHeight()},xn._buildFontString=function(e,t,n){return t||(t=11),e||(e="sans-serif"),n||(n="normal"),n+" "+t+"px "+e},xn.prototype.addToLayer=function(e){e.add(this._axisShape)},xn.prototype.showAxisLabels=function(e,t){this._showAxisLabels=e,t&&(Et(t,"topMarkerHeight")&&(this._axisTopMarkerHeight=t.topMarkerHeight),Et(t,"bottomMarkerHeight")&&(this._axisBottomMarkerHeight=t.bottomMarkerHeight))},xn.prototype._getAxisLabelScale=function(e){for(var t,n=1,i=[1,2,5,10,20,30],r=0;t=n*i[r],e.timeToPixels(t)<60;)++r===i.length&&(n*=60,r=0);return t},xn.prototype._drawAxis=function(e,t){var n=t.getStartTime(),i=this._getAxisLabelScale(t),r=function(e,t){if(0===t)return 0;var n=1;return e<0&&(n=-1,e=-e),n*((Math.ceil(e)+t-1)/t|0)*t}(n,i),a=r-n,o=t.timeToPixels(a);e.setAttr("strokeStyle",this._axisGridlineColor),e.setAttr("lineWidth",1),e.setAttr("font",this._axisLabelFont),e.setAttr("fillStyle",this._axisLabelColor),e.setAttr("textAlign","left"),e.setAttr("textBaseline","bottom");for(var s=t.getWidth(),u=t.getHeight(),l=r;;){var h=o+t.timeToPixels(l-r);if(h>=s)break;if(this._axisTopMarkerHeight>0&&(e.beginPath(),e.moveTo(h+.5,0),e.lineTo(h+.5,0+this._axisTopMarkerHeight),e.stroke()),this._axisBottomMarkerHeight&&(e.beginPath(),e.moveTo(h+.5,u),e.lineTo(h+.5,u-this._axisBottomMarkerHeight),e.stroke()),this._showAxisLabels){var c=this._formatAxisTime(l),d=h-e.measureText(c).width/2,p=u-1-this._axisBottomMarkerHeight;d>=0&&e.fillText(c,d,p)}l+=i}},In.prototype.getViewOptions=function(){return this._viewOptions},In.prototype.getWaveformData=function(){return this._data},In.prototype.setWaveformData=function(e){this._data=e},In.prototype.timeToPixels=function(e){return Math.floor(e*this._data.sample_rate/this._data.scale)},In.prototype.pixelsToTime=function(e){return e*this._data.scale/this._data.sample_rate},In.prototype.pixelOffsetToTime=function(e){return(this._frameOffset+e)*this._data.scale/this._data.sample_rate},In.prototype.timeToPixelOffset=function(e){return Math.floor(e*this._data.sample_rate/this._data.scale)-this._frameOffset},In.prototype.getFrameOffset=function(){return this._frameOffset},In.prototype.getWidth=function(){return this._width},In.prototype.getHeight=function(){return this._height},In.prototype.getStartTime=function(){return this.pixelOffsetToTime(0)},In.prototype.getEndTime=function(){return this.pixelOffsetToTime(this._width)},In.prototype._getDuration=function(){return this._peaks.player.getDuration()},In.prototype._createWaveform=function(){this._waveformLayer=new et.Layer({listening:!1}),this._createWaveformShapes(),this._stage.add(this._waveformLayer)},In.prototype._createWaveformShapes=function(){if(this._waveformShape||(this._waveformShape=new _n({color:this._waveformColor,view:this}),this._waveformShape.addToLayer(this._waveformLayer)),this._playedWaveformColor&&!this._playedWaveformShape){var e=this._peaks.player.getCurrentTime();this._playedSegment={startTime:0,endTime:e},this._unplayedSegment={startTime:e,endTime:this._getDuration()},this._waveformShape.setSegment(this._unplayedSegment),this._playedWaveformShape=new _n({color:this._playedWaveformColor,view:this,segment:this._playedSegment}),this._playedWaveformShape.addToLayer(this._waveformLayer)}},In.prototype.setWaveformColor=function(e){this._waveformColor=e,this._waveformShape.setWaveformColor(e)},In.prototype.setPlayedWaveformColor=function(e){this._playedWaveformColor=e,e?(this._playedWaveformShape||this._createWaveformShapes(),this._playedWaveformShape.setWaveformColor(e)):this._playedWaveformShape&&this._destroyPlayedWaveformShape()},In.prototype._destroyPlayedWaveformShape=function(){this._waveformShape.setSegment(null),this._playedWaveformShape.destroy(),this._playedWaveformShape=null,this._playedSegment=null,this._unplayedSegment=null},In.prototype._createAxisLabels=function(){this._axisLayer=new et.Layer({listening:!1}),this._axis=new xn(this,this._viewOptions),this._axis.addToLayer(this._axisLayer),this._stage.add(this._axisLayer)},In.prototype.showAxisLabels=function(e,t){this._axis.showAxisLabels(e,t),this._axisLayer.draw()},In.prototype.showPlayheadTime=function(e){this._playheadLayer.showPlayheadTime(e)},In.prototype.setTimeLabelPrecision=function(e){this._timeLabelPrecision=e,this._playheadLayer.updatePlayheadText()},In.prototype.formatTime=function(e){return this._formatPlayheadTime(e)},In.prototype.setAmplitudeScale=function(e){if(!xt(e)||"number"!=typeof(t=e)||t!=t||t===1/0||t===-1/0)throw new Error("view.setAmplitudeScale(): Scale must be a valid number");var t;this._amplitudeScale=e,this.drawWaveformLayer(),this._segmentsLayer&&this._segmentsLayer.draw()},In.prototype.getAmplitudeScale=function(){return this._amplitudeScale},In.prototype.enableSeek=function(e){this._enableSeek=e},In.prototype.isSeekEnabled=function(){return this._enableSeek},In.prototype._onClick=function(e){this._clickHandler(e,"click")},In.prototype._onDblClick=function(e){this._clickHandler(e,"dblclick")},In.prototype._onContextMenu=function(e){this._clickHandler(e,"contextmenu")},In.prototype._clickHandler=function(e,t){var n=!0;if(e.target!==this._stage){var i=Nt(e.target);if(i)if("point-marker"===i.attrs.name){var r=i.getAttr("point");r&&this._peaks.emit("points."+t,{point:r,evt:e.evt,preventViewEvent:function(){n=!1}})}else if("segment-overlay"===i.attrs.name){var a=i.getAttr("segment");if(a){var o={segment:a,evt:e.evt,preventViewEvent:function(){n=!1}};this._segmentsLayer&&this._segmentsLayer.segmentClicked(t,o)}}}if(n){var s=e.evt.layerX,u=this.pixelOffsetToTime(s),l=this.getName();this._peaks.emit(l+"."+t,{time:u,evt:e.evt})}},In.prototype.updatePlayheadTime=function(e){this._playheadLayer.updatePlayheadTime(e)},In.prototype.playheadPosChanged=function(e){this._playedWaveformShape&&(this._playedSegment.endTime=e,this._unplayedSegment.startTime=e,this.drawWaveformLayer())},In.prototype.drawWaveformLayer=function(){this._waveformLayer.draw()},In.prototype.enableMarkerEditing=function(e){this._segmentsLayer&&this._segmentsLayer.enableEditing(e),this._pointsLayer&&this._pointsLayer.enableEditing(e)},In.prototype.fitToContainer=function(){if(0!==this._container.clientWidth||0!==this._container.clientHeight){var e=!1;this._container.clientWidth!==this._width&&(this._width=this._container.clientWidth,this._stage.setWidth(this._width),e=this.containerWidthChange()),this._container.clientHeight!==this._height&&(this._height=this._container.clientHeight,this._stage.height(this._height),this._waveformShape.fitToView(),this._playheadLayer.fitToView(),this._segmentsLayer&&this._segmentsLayer.fitToView(),this._pointsLayer&&this._pointsLayer.fitToView(),this.containerHeightChange()),e&&this.updateWaveform(this._frameOffset)}},In.prototype.destroy=function(){this._playheadLayer.destroy(),this._segmentsLayer&&this._segmentsLayer.destroy(),this._pointsLayer&&this._pointsLayer.destroy(),this._stage&&(this._stage.destroy(),this._stage=null)},kn.prototype._mouseDown=function(e){var t=null;if("mousedown"!==e.type||0===e.evt.button){var n=Nt(e.target);if(n){if("point-marker"===n.attrs.name||"segment-marker"===n.attrs.name)return;"segment-overlay"===n.attrs.name&&(t=n)}if(this._lastMouseClientX=Math.floor("touchstart"===e.type?e.evt.touches[0].clientX:e.evt.clientX),this._handlers.onMouseDown){var i=this._getMousePosX(this._lastMouseClientX);this._handlers.onMouseDown(i,t)}window.addEventListener("mousemove",this._mouseMove,{capture:!1,passive:!0}),window.addEventListener("touchmove",this._mouseMove,{capture:!1,passive:!0}),window.addEventListener("mouseup",this._mouseUp,{capture:!1,passive:!0}),window.addEventListener("touchend",this._mouseUp,{capture:!1,passive:!0}),window.addEventListener("blur",this._mouseUp,{capture:!1,passive:!0})}},kn.prototype._mouseMove=function(e){var t=Math.floor("touchmove"===e.type?e.changedTouches[0].clientX:e.clientX);if(t!==this._lastMouseClientX&&(this._lastMouseClientX=t,this._dragging=!0,this._handlers.onMouseMove)){var n=this._getMousePosX(t);this._handlers.onMouseMove(n)}},kn.prototype._mouseUp=function(e){var t;if("touchend"===e.type?(t=Math.floor(e.changedTouches[0].clientX),e.cancelable&&e.preventDefault()):t=Math.floor(e.clientX),this._handlers.onMouseUp){var n=this._getMousePosX(t);this._handlers.onMouseUp(n)}window.removeEventListener("mousemove",this._mouseMove,{capture:!1}),window.removeEventListener("touchmove",this._mouseMove,{capture:!1}),window.removeEventListener("mouseup",this._mouseUp,{capture:!1}),window.removeEventListener("touchend",this._mouseUp,{capture:!1}),window.removeEventListener("blur",this._mouseUp,{capture:!1}),this._dragging=!1},kn.prototype._getMousePosX=function(e){return e-this._stage.getContainer().getBoundingClientRect().left},kn.prototype.isDragging=function(){return this._dragging},kn.prototype.destroy=function(){this._stage.off("mousedown",this._mouseDown),this._stage.off("touchstart",this._mouseDown)},Mn.prototype._onMouseDown=function(e){this._seek(e)},Mn.prototype._onMouseMove=function(e){this._seek(e)},Mn.prototype._seek=function(e){if(this._view.isSeekEnabled()){e=At(e,0,this._width);var t=this._view.pixelsToTime(e),n=this._peaks.player.getDuration();t>n&&(t=n),this._view.updatePlayheadTime(t),this._peaks.player.seek(t)}},Mn.prototype.destroy=function(){this._mouseDragHandler.destroy()},Pn.prototype=Object.create(In.prototype),Pn.prototype.initWaveform=function(){0!==this._width&&this._resampleAndSetWaveformData(this._originalWaveformData,this._width)},Pn.prototype.initHighlightLayer=function(){this._highlightLayer=new fn(this,this._viewOptions),this._highlightLayer.addToStage(this._stage)},Pn.prototype.isSegmentDraggingEnabled=function(){return!1},Pn.prototype.getName=function(){return"overview"},Pn.prototype._onTimeUpdate=function(e){this._playheadLayer.updatePlayheadTime(e)},Pn.prototype._onPlaying=function(e){this._playheadLayer.updatePlayheadTime(e)},Pn.prototype._onPause=function(e){this._playheadLayer.stop(e)},Pn.prototype._onZoomviewDisplaying=function(e,t){this.showHighlight(e,t)},Pn.prototype.showHighlight=function(e,t){this._highlightLayer.showHighlight(e,t)},Pn.prototype.setWaveformData=function(e){this._originalWaveformData=e,0!==this._width?this._resampleAndSetWaveformData(e,this._width):this._data=e,this.updateWaveform()},Pn.prototype._resampleAndSetWaveformData=function(e,t){try{return this._data=e.resample({width:t}),!0}catch(t){return this._data=e,!1}},Pn.prototype.removeHighlightRect=function(){this._highlightLayer.removeHighlight()},Pn.prototype.updateWaveform=function(){this._waveformLayer.draw(),this._axisLayer.draw();var e=this._peaks.player.getCurrentTime();this._playheadLayer.updatePlayheadTime(e),this._highlightLayer.updateHighlight();var t=this.pixelsToTime(this._width);this._pointsLayer&&this._pointsLayer.updatePoints(0,t),this._segmentsLayer&&this._segmentsLayer.updateSegments(0,t)},Pn.prototype.containerWidthChange=function(){return this._resampleAndSetWaveformData(this._originalWaveformData,this._width)},Pn.prototype.containerHeightChange=function(){this._highlightLayer.fitToView()},Pn.prototype.destroy=function(){this._peaks.off("player.playing",this._onPlaying),this._peaks.off("player.pause",this._onPause),this._peaks.off("player.timeupdate",this._onTimeUpdate),this._peaks.off("zoomview.displaying",this._onZoomviewDisplaying),this._mouseDragHandler.destroy(),In.prototype.destroy.call(this)},Ln.prototype.isDragging=function(){return this._mouseDragHandler.isDragging()},Ln.prototype._reset=function(){this._insertSegment=null,this._insertSegmentShape=null,this._segmentIsDraggable=!1,this._peaks.segments.setInserting(!1)},Ln.prototype._onMouseDown=function(e,t){if(this._reset(),this._segment=t,this._segment){if("overlap"!==this._view.getSegmentDragMode())return;this._segmentIsDraggable=this._segment.draggable(),this._segment.draggable(!1)}var n=this._view.pixelsToTime(e+this._view.getFrameOffset());this._peaks.segments.setInserting(!0),this._insertSegment=this._peaks.segments.add({startTime:n,endTime:n,editable:!0}),this._insertSegmentShape=this._view._segmentsLayer.getSegmentShape(this._insertSegment),this._insertSegmentShape&&(this._insertSegmentShape.moveMarkersToTop(),this._insertSegmentShape.startDrag())},Ln.prototype._onMouseMove=function(){},Ln.prototype._onMouseUp=function(){this._insertSegment&&(this._insertSegmentShape&&(this._insertSegmentShape.stopDrag(),this._insertSegmentShape=null),this._segment&&this._segmentIsDraggable&&this._segment.draggable(!0),this._peaks.emit("segments.insert",{segment:this._insertSegment}),this._peaks.segments.setInserting(!1))},Ln.prototype.destroy=function(){this._mouseDragHandler.destroy()},Dn.prototype.isDragging=function(){return this._mouseDragHandler.isDragging()},Dn.prototype._onMouseDown=function(e,t){this._seeking=!1,t&&!t.attrs.draggable?this._segment=null:this._segment=t;var n=this._view.getPlayheadOffset();if(this._view.isSeekEnabled()&&Math.abs(e-n)<=this._view.getPlayheadClickTolerance()&&(this._seeking=!0,this._segment&&(this._segmentIsDraggable=this._segment.draggable(),this._segment.draggable(!1))),this._seeking){e=At(e,0,this._view.getWidth());var i=this._view.pixelsToTime(e+this._view.getFrameOffset());this._seek(i)}else this._initialFrameOffset=this._view.getFrameOffset(),this._mouseDownX=e},Dn.prototype._onMouseMove=function(e){if(!this._segment||this._seeking)if(this._seeking){e=At(e,0,this._view.getWidth());var t=this._view.pixelsToTime(e+this._view.getFrameOffset());this._seek(t)}else{var n=this._mouseDownX-e,i=this._initialFrameOffset+n;i!==this._initialFrameOffset&&this._view.updateWaveform(i)}},Dn.prototype._onMouseUp=function(){if(!this._seeking&&this._view._enableSeek&&!this._mouseDragHandler.isDragging()){var e=this._view.pixelOffsetToTime(this._mouseDownX);this._seek(e)}this._segment&&this._seeking&&this._segmentIsDraggable&&this._segment.draggable(!0)},Dn.prototype._seek=function(e){var t=this._peaks.player.getDuration();e>t&&(e=t),this._view.updatePlayheadTime(e),this._peaks.player.seek(e)},Dn.prototype.destroy=function(){this._mouseDragHandler.destroy()},Rn.prototype=Object.create(In.prototype),Rn.prototype.initWaveform=function(){this._enableWaveformCache=this._options.waveformCache,this._initWaveformCache();var e=this._peaks.zoom.getZoomLevel();this._resampleData({scale:e})},Rn.prototype._initWaveformCache=function(){this._enableWaveformCache&&(this._waveformData=new Map,this._waveformData.set(this._originalWaveformData.scale,this._originalWaveformData),this._waveformScales=[this._originalWaveformData.scale])},Rn.prototype.initHighlightLayer=function(){},Rn.prototype.setWheelMode=function(e,t){t||(t={}),e===this._wheelMode&&t.captureVerticalScroll===this._captureVerticalScroll||(this._stage.off("wheel"),this._wheelMode=e,this._captureVerticalScroll=t.captureVerticalScroll,"scroll"!==e)||(t.captureVerticalScroll?this._stage.on("wheel",this._onWheelCaptureVerticalScroll):this._stage.on("wheel",this._onWheel))},Rn.prototype._onWheel=function(e){var t,n=e.evt;if(n.shiftKey)if(0!==n.deltaY)t=n.deltaY;else{if(0===n.deltaX)return;t=n.deltaX}else{if(Math.abs(n.deltaX)<Math.abs(n.deltaY))return;t=n.deltaX}n.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=this._width),n.preventDefault();var i=At(this._frameOffset+Math.floor(t),0,this._pixelLength-this._width);this.updateWaveform(i)},Rn.prototype._onWheelCaptureVerticalScroll=function(e){var t=e.evt,n=Math.abs(t.deltaX)<Math.abs(t.deltaY)?t.deltaY:t.deltaX;t.preventDefault();var i=At(this._frameOffset+Math.floor(n),0,this._pixelLength-this._width);this.updateWaveform(i)},Rn.prototype.setWaveformDragMode=function(e){this._viewOptions.enableSegments&&(this._mouseDragHandler.destroy(),this._mouseDragHandler="insert-segment"===e?new Ln(this._peaks,this):new Dn(this._peaks,this))},Rn.prototype.enableSegmentDragging=function(e){this._enableSegmentDragging=e,this._segmentsLayer&&this._segmentsLayer.enableSegmentDragging(e)},Rn.prototype.isSegmentDraggingEnabled=function(){return this._enableSegmentDragging},Rn.prototype.setSegmentDragMode=function(e){this._segmentDragMode=e},Rn.prototype.getSegmentDragMode=function(){return this._segmentDragMode},Rn.prototype.getName=function(){return"zoomview"},Rn.prototype._onTimeUpdate=function(e){this._mouseDragHandler.isDragging()||this._syncPlayhead(e)},Rn.prototype._onPlaying=function(e){this._playheadLayer.updatePlayheadTime(e)},Rn.prototype._onPause=function(e){this._playheadLayer.stop(e)},Rn.prototype._onKeyboardLeft=function(){this._keyboardScroll(-1,!1)},Rn.prototype._onKeyboardRight=function(){this._keyboardScroll(1,!1)},Rn.prototype._onKeyboardShiftLeft=function(){this._keyboardScroll(-1,!0)},Rn.prototype._onKeyboardShiftRight=function(){this._keyboardScroll(1,!0)},Rn.prototype._keyboardScroll=function(e,t){var n;n=t?e*this._width:e*this.timeToPixels(this._options.nudgeIncrement),this.scrollWaveform({pixels:n})},Rn.prototype.setWaveformData=function(e){this._originalWaveformData=e,this._initWaveformCache()},Rn.prototype.getPlayheadOffset=function(){return this._playheadLayer.getPlayheadPixel()-this._frameOffset},Rn.prototype.getPlayheadClickTolerance=function(){return this._playheadClickTolerance},Rn.prototype._syncPlayhead=function(e){if(this._playheadLayer.updatePlayheadTime(e),this._autoScroll){var t=this.timeToPixels(e);(t>=this._frameOffset+this._width-this._autoScrollOffset||t<this._frameOffset)&&(this._frameOffset=t-this._autoScrollOffset,this._frameOffset<0&&(this._frameOffset=0),this.updateWaveform(this._frameOffset))}},Rn.prototype._getScale=function(e){return Math.floor(e*this._data.sample_rate/this._width)},Rn.prototype.setZoom=function(e){var t;if(function(e){return Et(e,"scale")&&"auto"===e.scale||Et(e,"seconds")&&"auto"===e.seconds}(e)){var n=this._peaks.player.getDuration();if(!It(n))return!1;this._zoomLevelAuto=!0,this._zoomLevelSeconds=null,t=this._getScale(n)}else{if(Et(e,"scale"))this._zoomLevelSeconds=null,t=Math.floor(e.scale);else if(Et(e,"seconds")){if(!It(e.seconds))return!1;this._zoomLevelSeconds=e.seconds,t=this._getScale(e.seconds)}this._zoomLevelAuto=!1}t<this._originalWaveformData.scale&&(this._peaks._logger("peaks.zoomview.setZoom(): zoom level must be at least "+this._originalWaveformData.scale),t=this._originalWaveformData.scale);var i,r=this._peaks.player.getCurrentTime(),a=this.getPlayheadOffset();a>=0&&a<this._width?i=r:(a=Math.floor(this._width/2),i=this.pixelOffsetToTime(a));var o=this._scale;this._resampleData({scale:t});var s=this.timeToPixels(i);return this._frameOffset=s-a,this.updateWaveform(this._frameOffset),this._playheadLayer.zoomLevelChanged(),this._playheadLayer.updatePlayheadTime(r),this._peaks.emit("zoom.update",{currentZoom:t,previousZoom:o}),!0},Rn.prototype._resampleData=function(e){var t=e.scale;if(this._enableWaveformCache){if(!this._waveformData.has(t)){for(var n=this._originalWaveformData,i=0;i<this._waveformScales.length&&this._waveformScales[i]<t;i++)n=this._waveformData.get(this._waveformScales[i]);this._waveformData.set(t,n.resample(e)),this._waveformScales.push(t),this._waveformScales.sort((function(e,t){return e-t}))}this._data=this._waveformData.get(t)}else this._data=this._originalWaveformData.resample(e);this._scale=this._data.scale,this._pixelLength=this._data.length},Rn.prototype.setStartTime=function(e){e<0&&(e=0),this._zoomLevelAuto&&(e=0),this.updateWaveform(this.timeToPixels(e))},Rn.prototype.getPixelLength=function(){return this._pixelLength},Rn.prototype.scrollWaveform=function(e){var t;if(Et(e,"pixels"))t=Math.floor(e.pixels);else{if(!Et(e,"seconds"))throw new TypeError("view.scrollWaveform(): Missing umber of pixels or seconds");t=this.timeToPixels(e.seconds)}this.updateWaveform(this._frameOffset+t)},Rn.prototype.updateWaveform=function(e){var t;this._pixelLength<this._width?(e=0,t=this._width):t=this._pixelLength-this._width,e=At(e,0,t),this._frameOffset=e;var n=this._playheadLayer.getPlayheadPixel();this._playheadLayer.updatePlayheadTime(this.pixelsToTime(n)),this.drawWaveformLayer(),this._axisLayer.draw();var i=this.getStartTime(),r=this.getEndTime();this._pointsLayer&&this._pointsLayer.updatePoints(i,r),this._segmentsLayer&&this._segmentsLayer.updateSegments(i,r),this._peaks.emit("zoomview.displaying",i,r)},Rn.prototype.enableAutoScroll=function(e,t){this._autoScroll=e,Et(t,"offset")&&(this._autoScrollOffset=t.offset)},Rn.prototype.getMinSegmentDragWidth=function(){return this._insertSegmentShape?0:this._minSegmentDragWidth},Rn.prototype.setMinSegmentDragWidth=function(e){this._minSegmentDragWidth=e},Rn.prototype.containerWidthChange=function(){var e,t=!1,n=!1;if(this._zoomLevelAuto?(n=!0,e={width:this._width}):null!==this._zoomLevelSeconds&&(n=!0,e={scale:this._getScale(this._zoomLevelSeconds)}),n)try{this._resampleData(e),t=!0}catch(e){}return t},Rn.prototype.containerHeightChange=function(){},Rn.prototype.getStage=function(){return this._stage},Rn.prototype.getSegmentsLayer=function(){return this._segmentsLayer},Rn.prototype.destroy=function(){this._peaks.off("player.playing",this._onPlaying),this._peaks.off("player.pause",this._onPause),this._peaks.off("player.timeupdate",this._onTimeUpdate),this._peaks.off("keyboard.left",this._onKeyboardLeft),this._peaks.off("keyboard.right",this._onKeyboardRight),this._peaks.off("keyboard.shift_left",this._onKeyboardShiftLeft),this._peaks.off("keyboard.shift_right",this._onKeyboardShiftRight),this._mouseDragHandler.destroy(),In.prototype.destroy.call(this)},Nn.prototype.setZoomview=function(e){this._zoomview=e,this._updateScrollbarWidthAndPosition()},Nn.prototype._setScrollboxWidth=function(){this._zoomview?(this._scrollboxWidth=Math.floor(this._width*this._zoomview.pixelsToTime(this._zoomview.getWidth())/this._peaks.player.getDuration()),this._scrollboxWidth<this._minScrollboxWidth&&(this._scrollboxWidth=this._minScrollboxWidth)):this._scrollboxWidth=this._width,this._scrollboxRect.width(this._scrollboxWidth)},Nn.prototype._getScrollbarRange=function(){return this._width-this._scrollboxWidth},Nn.prototype._dragBoundFunc=function(e){return{x:e.x,y:0}},Nn.prototype._onScrollboxDragStart=function(){this._dragging=!0},Nn.prototype._onScrollboxDragEnd=function(){this._dragging=!1},Nn.prototype._onScrollboxDragMove=function(){var e=this._getScrollbarRange(),t=At(this._scrollbox.x(),0,e);this._scrollbox.x(t),t!==this._scrollboxX&&(this._scrollboxX=t,this._zoomview&&this._updateWaveform(t))},Nn.prototype._onZoomviewDisplaying=function(){this._dragging||this._updateScrollbarWidthAndPosition()},Nn.prototype._updateScrollbarWidthAndPosition=function(){if(this._setScrollboxWidth(),this._zoomview){var e=this._zoomview.getStartTime(),t=this._zoomview.getPixelLength()-this._zoomview.getWidth(),n=Math.floor(this._zoomview.timeToPixels(e)*this._getScrollbarRange()/t);this._scrollbox.x(n),this._layer.draw()}},Nn.prototype._onScrollbarClick=function(e){if(e.target===this._stage&&this._zoomview){var t=Math.floor(e.evt.layerX-this._scrollboxWidth/2);t<0&&(t=0),this._updateWaveform(t)}},Nn.prototype._updateWaveform=function(e){var t=Math.floor((this._zoomview.getPixelLength()-this._zoomview.getWidth())*e/this._getScrollbarRange());this._zoomview.updateWaveform(t)},Nn.prototype.fitToContainer=function(){0===this._container.clientWidth&&0===this._container.clientHeight||(this._container.clientWidth!==this._width&&(this._width=this._container.clientWidth,this._stage.width(this._width),this._updateScrollbarWidthAndPosition()),this._height=this._container.clientHeight,this._stage.height(this._height))},Nn.prototype.destroy=function(){this._layer.destroy(),this._stage.destroy(),this._stage=null},On.prototype.createOverview=function(e){if(this._overview)return this._overview;var t=this._peaks.getWaveformData();return this._overview=new Pn(t,e,this._peaks),this._zoomview&&this._overview.showHighlight(this._zoomview.getStartTime(),this._zoomview.getEndTime()),this._overview},On.prototype.createZoomview=function(e){if(this._zoomview)return this._zoomview;var t=this._peaks.getWaveformData();return this._zoomview=new Rn(t,e,this._peaks),this._scrollbar&&this._scrollbar.setZoomview(this._zoomview),this._zoomview},On.prototype.createScrollbar=function(e){var t=this._peaks.getWaveformData();return this._scrollbar=new Nn(t,e,this._peaks),this._scrollbar},On.prototype.destroyOverview=function(){this._overview&&this._zoomview&&(this._overview.destroy(),this._overview=null)},On.prototype.destroyZoomview=function(){this._zoomview&&this._overview&&(this._zoomview.destroy(),this._zoomview=null,this._overview.removeHighlightRect())},On.prototype.destroy=function(){this._overview&&(this._overview.destroy(),this._overview=null),this._zoomview&&(this._zoomview.destroy(),this._zoomview=null),this._scrollbar&&(this._scrollbar.destroy(),this._scrollbar=null)},On.prototype.getView=function(e){if(Pt(e))return this._overview&&this._zoomview?null:this._overview?this._overview:this._zoomview?this._zoomview:null;switch(e){case"overview":return this._overview;case"zoomview":return this._zoomview;default:return null}},On.prototype.getScrollbar=function(){return this._scrollbar},Un.prototype.setZoomLevels=function(e){this._zoomLevels=e,this.setZoom(0,!0)},Un.prototype.zoomIn=function(){this.setZoom(this._zoomLevelIndex-1)},Un.prototype.zoomOut=function(){this.setZoom(this._zoomLevelIndex+1)},Un.prototype.setZoom=function(e,t){if(e>=this._zoomLevels.length&&(e=this._zoomLevels.length-1),e<0&&(e=0),t||e!==this._zoomLevelIndex){this._zoomLevelIndex=e;var n=this._peaks.views.getView("zoomview");n&&n.setZoom({scale:this._zoomLevels[e]})}},Un.prototype.getZoom=function(){return this._zoomLevelIndex},Un.prototype.getZoomLevel=function(){return this._zoomLevels[this._zoomLevelIndex]};var Bn="withCredentials"in new XMLHttpRequest;function Fn(e){this._peaks=e}function Gn(e){var t=e.getResponseHeader("content-range");if(!t)return!1;var n=t.match(/^bytes (\d+)-(\d+)\/(\d+)$/);if(n&&4===n.length){var i=parseInt(n[1],10),r=parseInt(n[2],10),a=parseInt(n[3],10);return 0===i&&r+1===a}return!1}function jn(){return bt.call(this),this.options={zoomLevels:[512,1024,2048,4096],waveformCache:!0,mediaElement:null,mediaUrl:null,dataUri:null,withCredentials:!1,waveformData:null,webAudio:null,nudgeIncrement:1,pointMarkerColor:"#39cccc",createSegmentMarker:cn,createSegmentLabel:dn,createPointMarker:pn,logger:console.error.bind(console)},this}Fn.prototype.init=function(e,t){if(!(e.dataUri&&(e.webAudio||e.audioContext)||e.waveformData&&(e.webAudio||e.audioContext)||e.dataUri&&e.waveformData))return e.audioContext&&(this._peaks._logger("Peaks.init(): The audioContext option is deprecated, please pass a webAudio object instead"),e.webAudio={audioContext:e.audioContext}),e.dataUri?this._getRemoteWaveformData(e,t):e.waveformData?this._buildWaveformFromLocalData(e,t):e.webAudio?e.webAudio.audioBuffer?this._buildWaveformDataFromAudioBuffer(e,t):this._buildWaveformDataUsingWebAudio(e,t):void t(new Error("Peaks.init(): You must pass an audioContext, or dataUri, or waveformData to render waveform data"));t(new TypeError("Peaks.init(): You may only pass one source (webAudio, dataUri, or waveformData) to render waveform data."))},Fn.prototype._getRemoteWaveformData=function(e,t){var n,i=this,r=null,a=null;kt(e.dataUri)?(r=e.dataUri,["ArrayBuffer","JSON"].some((function(e){if(window[e])return a=e.toLowerCase(),n=r[a],Boolean(n)})),n?(i._xhr=i._createXHR(n,a,e.withCredentials,(function(e){if(4===this.readyState)if(200===this.status||206===this.status&&Gn(this)){i._xhr=null;var n=vt.A.create(e.target.response);1===n.channels||2===n.channels?8===n.bits?t(null,n):t(new Error("Peaks.init(): 16-bit waveform data is not supported")):t(new Error("Peaks.init(): Only mono or stereo waveforms are currently supported"))}else t(new Error("Unable to fetch remote data. HTTP status "+this.status))}),(function(){t(new Error("XHR failed"))}),(function(){t(new Error("XHR aborted"))})),i._xhr.send()):t(new Error("Peaks.init(): Unable to determine a compatible dataUri format for this browser"))):t(new TypeError("Peaks.init(): The dataUri option must be an object"))},Fn.prototype._buildWaveformFromLocalData=function(e,t){var n,i=null,r=null;if(kt(e.waveformData))if(kt((i=e.waveformData).json)?r=i.json:(n=i.arraybuffer,Object.prototype.toString.call(n).includes("ArrayBuffer")&&(r=i.arraybuffer)),r)try{var a=vt.A.create(r);if(1!==a.channels&&2!==a.channels)return void t(new Error("Peaks.init(): Only mono or stereo waveforms are currently supported"));if(8!==a.bits)return void t(new Error("Peaks.init(): 16-bit waveform data is not supported"));t(null,a)}catch(e){t(e)}else t(new Error("Peaks.init(): Unable to determine a compatible waveformData format"));else t(new Error("Peaks.init(): The waveformData option must be an object"))},Fn.prototype._buildWaveformDataUsingWebAudio=function(e,t){var n=this,i=window.AudioContext||window.webkitAudioContext;if(e.webAudio.audioContext instanceof i){var r=e.webAudio;r.scale!==e.zoomLevels[0]&&(r.scale=e.zoomLevels[0]);var a=n._peaks.options.mediaElement.currentSrc;a?n._requestAudioAndBuildWaveformData(a,r,e.withCredentials,t):n._peaks.once("player.canplay",(function(){n._requestAudioAndBuildWaveformData(n._peaks.options.mediaElement.currentSrc,r,e.withCredentials,t)}))}else t(new TypeError("Peaks.init(): The webAudio.audioContext option must be a valid AudioContext"))},Fn.prototype._buildWaveformDataFromAudioBuffer=function(e,t){var n=e.webAudio;n.scale!==e.zoomLevels[0]&&(n.scale=e.zoomLevels[0]);var i={audio_buffer:n.audioBuffer,split_channels:n.multiChannel,scale:n.scale,disable_worker:!0};vt.A.createFromAudio(i,t)},Fn.prototype._requestAudioAndBuildWaveformData=function(e,t,n,i){var r=this;e?(r._xhr=r._createXHR(e,"arraybuffer",n,(function(e){if(4===this.readyState)if(200===this.status||206===this.status&&Gn(this)){r._xhr=null;var n={audio_context:t.audioContext,array_buffer:e.target.response,split_channels:t.multiChannel,scale:t.scale};vt.A.createFromAudio(n,i)}else i(new Error("Unable to fetch remote data. HTTP status "+this.status))}),(function(){i(new Error("XHR failed"))}),(function(){i(new Error("XHR aborted"))})),r._xhr.send()):r._peaks._logger("Peaks.init(): The mediaElement src is invalid")},Fn.prototype.abort=function(){this._xhr&&this._xhr.abort()},Fn.prototype._createXHR=function(e,t,n,i,r,a){var o=new XMLHttpRequest;if(o.open("GET",e,!0),Bn)try{o.responseType=t}catch(e){}return o.onload=i,o.onerror=r,Bn&&n&&(o.withCredentials=!0),o.addEventListener("abort",a),o},jn.prototype=Object.create(bt.prototype);var Hn={playheadColor:"#111111",playheadTextColor:"#aaaaaa",playheadBackgroundColor:"transparent",playheadPadding:2,axisGridlineColor:"#cccccc",showAxisLabels:!0,axisTopMarkerHeight:10,axisBottomMarkerHeight:10,axisLabelColor:"#aaaaaa",fontFamily:"sans-serif",fontSize:11,fontStyle:"normal",timeLabelPrecision:2,enablePoints:!0,enableSegments:!0},Vn={playheadClickTolerance:3,waveformColor:"rgba(0, 225, 128, 1)",wheelMode:"none",autoScroll:!0,autoScrollOffset:100,enableEditing:!0},Wn={waveformColor:"rgba(0, 0, 0, 0.2)",highlightColor:"#aaaaaa",highlightStrokeColor:"transparent",highlightOpacity:.3,highlightOffset:11,highlightCornerRadius:2,enableEditing:!1},zn={overlay:!1,markers:!0,startMarkerColor:"#aaaaaa",endMarkerColor:"#aaaaaa",waveformColor:"#0074d9",overlayColor:"#ff0000",overlayOpacity:.3,overlayBorderColor:"#ff0000",overlayBorderWidth:2,overlayCornerRadius:5,overlayOffset:25,overlayLabelAlign:"left",overlayLabelVerticalAlign:"top",overlayLabelPadding:8,overlayLabelColor:"#000000",overlayFontFamily:"sans-serif",overlayFontSize:12,overlayFontStyle:"normal"},Xn={color:"#888888",minWidth:50};function Kn(e,t){for(var n in t)Et(t,n)&&Et(e,n)&&(e[n]=t[n]);return e}function Yn(e){var t=e.zoomview.container,n=e.overview.container;return Dt(t)||Dt(n)?t&&(t.clientWidth<=0||t.clientHeight<=0)?new Error("Peaks.init(): The zoomview container must be visible and have non-zero width and height"):n&&(n.clientWidth<=0||n.clientHeight<=0)?new Error("Peaks.init(): The overview container must be visible and have non-zero width and height"):void 0:new TypeError("Peaks.init(): The zoomview and/or overview container options must be valid HTML elements")}jn.init=function(e,t){var n=new jn,i=n._setOptions(e);if(i||(i=Yn(n.options)),!i){var r=null;if(n.options.scrollbar){if(!Dt(r=n.options.scrollbar.container))return void t(new TypeError("Peaks.init(): The scrollbar container option must be a valid HTML element"));if(r.clientWidth<=0)return void t(new TypeError("Peaks.init(): The scrollbar container must be visible and have non-zero width"))}e.keyboard&&(n._keyboardHandler=new an(n));var a=e.player?e.player:new on(n.options.mediaElement);return n.player=new un(n,a),n.segments=new tn(n),n.points=new Zt(n),n.zoom=new Un(n,n.options.zoomLevels),n.views=new On(n),n._waveformBuilder=new Fn(n),n.player.init(n).then((function(){n._waveformBuilder.init(n.options,(function(i,a){if(i)t&&t(i);else if(i=Yn(n.options))t&&t(i);else{n._waveformBuilder=null,n._waveformData=a;var o=n.options.zoomview.container,s=n.options.overview.container;s&&n.views.createOverview(s),o&&n.views.createZoomview(o),r&&n.views.createScrollbar(r),e.segments&&n.segments.add(e.segments),e.points&&n.points.add(e.points),e.emitCueEvents&&(n._cueEmitter=new Vt(n)),setTimeout((function(){n.emit("peaks.ready")}),0),t(null,n)}}))})).catch((function(e){t&&t(e)})),n}t(i)},jn.prototype._setOptions=function(e){if(!kt(e))return new TypeError("Peaks.init(): The options parameter should be an object");if(!e.player){if(!e.mediaElement)return new Error("Peaks.init(): Missing mediaElement option");if(!(e.mediaElement instanceof HTMLMediaElement))return new TypeError("Peaks.init(): The mediaElement option should be an HTMLMediaElement")}return e.logger&&"function"!=typeof e.logger?new TypeError("Peaks.init(): The logger option should be a function"):e.segments&&!Array.isArray(e.segments)?new TypeError("Peaks.init(): options.segments must be an array of segment objects"):e.points&&!Array.isArray(e.points)?new TypeError("Peaks.init(): options.points must be an array of point objects"):(Kn(this.options,e),this.options.overview=function(e){var t={};return e.overview&&e.overview.showPlayheadTime&&(t.showPlayheadTime=e.overview.showPlayheadTime),["container","waveformColor","playedWaveformColor","playheadColor","playheadTextColor","playheadBackgroundColor","playheadPadding","formatPlayheadTime","timeLabelPrecision","axisGridlineColor","showAxisLabels","axisTopMarkerHeight","axisBottomMarkerHeight","axisLabelColor","formatAxisTime","fontFamily","fontSize","fontStyle","highlightColor","highlightStrokeColor","highlightOpacity","highlightCornerRadius","highlightOffset","enablePoints","enableSegments","enableEditing"].forEach((function(n){e.overview&&Et(e.overview,n)?t[n]=e.overview[n]:Et(e,n)?t[n]=e[n]:Et(t,n)||(Et(Wn,n)?t[n]=Wn[n]:Et(Hn,n)&&(t[n]=Hn[n]))})),t}(e),this.options.zoomview=function(e){var t={};return e.showPlayheadTime?t.showPlayheadTime=e.showPlayheadTime:e.zoomview&&e.zoomview.showPlayheadTime&&(t.showPlayheadTime=e.zoomview.showPlayheadTime),["container","waveformColor","playedWaveformColor","playheadColor","playheadTextColor","playheadBackgroundColor","playheadPadding","formatPlayheadTime","playheadClickTolerance","timeLabelPrecision","axisGridlineColor","showAxisLabels","axisTopMarkerHeight","axisBottomMarkerHeight","axisLabelColor","formatAxisTime","fontFamily","fontSize","fontStyle","wheelMode","autoScroll","autoScrollOffset","enablePoints","enableSegments","enableEditing"].forEach((function(n){e.zoomview&&Et(e.zoomview,n)?t[n]=e.zoomview[n]:Et(e,n)?t[n]=e[n]:Et(t,n)||(Et(Vn,n)?t[n]=Vn[n]:Et(Hn,n)&&(t[n]=Hn[n]))})),t}(e),this.options.scrollbar=function(e){if(!Et(e,"scrollbar"))return null;var t={};return["container","color","minWidth"].forEach((function(n){Et(e.scrollbar,n)?t[n]=e.scrollbar[n]:t[n]=Xn[n]})),t}(e),function(e,t){e.segmentOptions={},Ct(e.segmentOptions,zn),t.segmentOptions&&Kn(e.segmentOptions,t.segmentOptions),e.zoomview.segmentOptions={},Ct(e.zoomview.segmentOptions,e.segmentOptions),t.zoomview&&t.zoomview.segmentOptions&&Kn(e.zoomview.segmentOptions,t.zoomview.segmentOptions),e.overview.segmentOptions={},Ct(e.overview.segmentOptions,e.segmentOptions),t.overview&&t.overview.segmentOptions&&Kn(e.overview.segmentOptions,t.overview.segmentOptions)}(this.options,e),Array.isArray(this.options.zoomLevels)?0===this.options.zoomLevels.length?new Error("Peaks.init(): The zoomLevels array must not be empty"):function(e){if(0===e.length)return!0;for(var t=e[0],n=1;n<e.length;n++){if(t>=e[n])return!1;t=e[n]}return!0}(this.options.zoomLevels)?void(this._logger=this.options.logger):new Error("Peaks.init(): The zoomLevels array must be sorted in ascending order"):new TypeError("Peaks.init(): The zoomLevels option should be an array"))},jn.prototype.setSource=function(e,t){var n=this;n.player._setSource(e).then((function(){e.zoomLevels||(e.zoomLevels=n.options.zoomLevels),n._waveformBuilder=new Fn(n),n._waveformBuilder.init(e,(function(i,r){i?t(i):(n._waveformBuilder=null,n._waveformData=r,["overview","zoomview"].forEach((function(e){var t=n.views.getView(e);t&&t.setWaveformData(r)})),n.zoom.setZoomLevels(e.zoomLevels),t())}))})).catch((function(e){t(e)}))},jn.prototype.getWaveformData=function(){return this._waveformData},jn.prototype.destroy=function(){this._waveformBuilder&&this._waveformBuilder.abort(),this._keyboardHandler&&this._keyboardHandler.destroy(),this.views&&this.views.destroy(),this.player&&this.player.destroy(),this._cueEmitter&&this._cueEmitter.destroy()}},318:(e,t)=>{!function(){"use strict";var n={};function i(e){return c(">"+p("B",e.length),e)}function r(e){return c(">"+p("H",e.length),e)}function a(e){return c(">"+p("L",e.length),e)}function o(e,t,n){var o,s,u,l,h="",d="";if("Byte"==t)(o=e.length)<=4?d=i(e)+p("\0",4-o):(d=c(">L",[n]),h=i(e));else if("Short"==t)(o=e.length)<=2?d=r(e)+p("\0\0",2-o):(d=c(">L",[n]),h=r(e));else if("Long"==t)(o=e.length)<=1?d=a(e):(d=c(">L",[n]),h=a(e));else if("Ascii"==t)(o=(s=e+"\0").length)>4?(d=c(">L",[n]),h=s):d=s+p("\0",4-o);else if("Rational"==t){if("number"==typeof e[0])o=1,u=e[0],l=e[1],s=c(">L",[u])+c(">L",[l]);else{o=e.length,s="";for(var f=0;f<o;f++)u=e[f][0],l=e[f][1],s+=c(">L",[u])+c(">L",[l])}d=c(">L",[n]),h=s}else if("SRational"==t){if("number"==typeof e[0])o=1,u=e[0],l=e[1],s=c(">l",[u])+c(">l",[l]);else for(o=e.length,s="",f=0;f<o;f++)u=e[f][0],l=e[f][1],s+=c(">l",[u])+c(">l",[l]);d=c(">L",[n]),h=s}else"Undefined"==t&&((o=e.length)>4?(d=c(">L",[n]),h=e):d=e+p("\0",4-o));return[c(">L",[o]),d,h]}function s(e,t,n){var i,r=Object.keys(e).length,a=c(">H",[r]);i=["0th","1st"].indexOf(t)>-1?2+12*r+4:2+12*r;var s="",u="";for(var l in e)if("string"==typeof l&&(l=parseInt(l)),!("0th"==t&&[34665,34853].indexOf(l)>-1||"Exif"==t&&40965==l||"1st"==t&&[513,514].indexOf(l)>-1)){var h=e[l],d=c(">H",[l]),p=m[t][l].type,f=c(">H",[g[p]]);"number"==typeof h&&(h=[h]);var v=o(h,p,8+i+n+u.length);s+=d+f+v[0]+v[1],u+=v[2]}return[a+s,u]}function u(e){var t;if(""==e.slice(0,2))t=function(e){for(var t,n=0;n<e.length;n++)if(""==(t=e[n]).slice(0,2)&&"Exif\0\0"==t.slice(4,10))return t;return null}(f(e)),this.tiftag=t?t.slice(10):null;else if(["II","MM"].indexOf(e.slice(0,2))>-1)this.tiftag=e;else{if("Exif"!=e.slice(0,4))throw new Error("Given file is neither JPEG nor TIFF.");this.tiftag=e.slice(6)}}if(n.version="1.0.4",n.remove=function(e){var t=!1;if(""==e.slice(0,2));else{if("data:image/jpeg;base64,"!=e.slice(0,23)&&"data:image/jpg;base64,"!=e.slice(0,22))throw new Error("Given data is not jpeg.");e=h(e.split(",")[1]),t=!0}var n=f(e).filter((function(e){return!(""==e.slice(0,2)&&"Exif\0\0"==e.slice(4,10))})).join("");return t&&(n="data:image/jpeg;base64,"+l(n)),n},n.insert=function(e,t){var n=!1;if("Exif\0\0"!=e.slice(0,6))throw new Error("Given data is not exif.");if(""==t.slice(0,2));else{if("data:image/jpeg;base64,"!=t.slice(0,23)&&"data:image/jpg;base64,"!=t.slice(0,22))throw new Error("Given data is not jpeg.");t=h(t.split(",")[1]),n=!0}var i=""+c(">H",[e.length+2])+e,r=function(e,t){var n=!1,i=[];return e.forEach((function(r,a){""==r.slice(0,2)&&"Exif\0\0"==r.slice(4,10)&&(n?i.unshift(a):(e[a]=t,n=!0))})),i.forEach((function(t){e.splice(t,1)})),!n&&t&&(e=[e[0],t].concat(e.slice(1))),e.join("")}(f(t),i);return n&&(r="data:image/jpeg;base64,"+l(r)),r},n.load=function(e){var t;if("string"!=typeof e)throw new Error("'load' gots invalid type argument.");if(""==e.slice(0,2))t=e;else if("data:image/jpeg;base64,"==e.slice(0,23)||"data:image/jpg;base64,"==e.slice(0,22))t=h(e.split(",")[1]);else{if("Exif"!=e.slice(0,4))throw new Error("'load' gots invalid file data.");t=e.slice(6)}var n={"0th":{},Exif:{},GPS:{},Interop:{},"1st":{},thumbnail:null},i=new u(t);if(null===i.tiftag)return n;"II"==i.tiftag.slice(0,2)?i.endian_mark="<":i.endian_mark=">";var r=d(i.endian_mark+"L",i.tiftag.slice(4,8))[0];n["0th"]=i.get_ifd(r,"0th");var a=n["0th"].first_ifd_pointer;if(delete n["0th"].first_ifd_pointer,34665 in n["0th"]&&(r=n["0th"][34665],n.Exif=i.get_ifd(r,"Exif")),34853 in n["0th"]&&(r=n["0th"][34853],n.GPS=i.get_ifd(r,"GPS")),40965 in n.Exif&&(r=n.Exif[40965],n.Interop=i.get_ifd(r,"Interop")),"\0\0\0\0"!=a&&(r=d(i.endian_mark+"L",a)[0],n["1st"]=i.get_ifd(r,"1st"),513 in n["1st"]&&514 in n["1st"])){var o=n["1st"][513]+n["1st"][514],s=i.tiftag.slice(n["1st"][513],o);n.thumbnail=s}return n},n.dump=function(e){var t,i,r,a,o,u,l=(t=e,JSON.parse(JSON.stringify(t))),h=!1,d=!1,p=!1,m=!1;i="0th"in l?l["0th"]:{},"Exif"in l&&Object.keys(l.Exif).length||"Interop"in l&&Object.keys(l.Interop).length?(i[34665]=1,h=!0,r=l.Exif,"Interop"in l&&Object.keys(l.Interop).length?(r[40965]=1,p=!0,a=l.Interop):Object.keys(r).indexOf(n.ExifIFD.InteroperabilityTag.toString())>-1&&delete r[40965]):Object.keys(i).indexOf(n.ImageIFD.ExifTag.toString())>-1&&delete i[34665],"GPS"in l&&Object.keys(l.GPS).length?(i[n.ImageIFD.GPSTag]=1,d=!0,o=l.GPS):Object.keys(i).indexOf(n.ImageIFD.GPSTag.toString())>-1&&delete i[n.ImageIFD.GPSTag],"1st"in l&&"thumbnail"in l&&null!=l.thumbnail&&(m=!0,l["1st"][513]=1,l["1st"][514]=1,u=l["1st"]);var v,y,b,_=s(i,"0th",0),w=_[0].length+12*h+12*d+4+_[1].length,S="",T=0,A="",E=0,C="",x=0,I="";if(h&&(T=(v=s(r,"Exif",w))[0].length+12*p+v[1].length),d&&(E=(A=s(o,"GPS",w+T).join("")).length),p&&(x=(C=s(a,"Interop",w+T+E).join("")).length),m&&(y=s(u,"1st",w+T+E+x),(b=function(e){for(var t=f(e);""<=t[1].slice(0,2)&&t[1].slice(0,2)<="";)t=[t[0]].concat(t.slice(2));return t.join("")}(l.thumbnail)).length>64e3))throw new Error("Given thumbnail is too large. max 64kB");var k="",M="",P="",L="\0\0\0\0";if(h){var D=c(">L",[R=8+w]);k=c(">H",[34665])+c(">H",[g.Long])+c(">L",[1])+D}if(d&&(D=c(">L",[R=8+w+T]),M=c(">H",[34853])+c(">H",[g.Long])+c(">L",[1])+D),p&&(D=c(">L",[R=8+w+T+E]),P=c(">H",[40965])+c(">H",[g.Long])+c(">L",[1])+D),m){var R;L=c(">L",[R=8+w+T+E+x]);var N="\0\0\0\0"+c(">L",[R+y[0].length+24+4+y[1].length]),O="\0\0\0\0"+c(">L",[b.length]);I=y[0]+N+O+"\0\0\0\0"+y[1]+b}var U=_[0]+k+M+L+_[1];return h&&(S=v[0]+P+v[1]),"Exif\0\0MM\0*\0\0\0\b"+U+S+A+C+I},u.prototype={get_ifd:function(e,t){var n,i={},r=d(this.endian_mark+"H",this.tiftag.slice(e,e+2))[0],a=e+2;n=["0th","1st"].indexOf(t)>-1?"Image":t;for(var o=0;o<r;o++){e=a+12*o;var s=d(this.endian_mark+"H",this.tiftag.slice(e,e+2))[0],u=[d(this.endian_mark+"H",this.tiftag.slice(e+2,e+4))[0],d(this.endian_mark+"L",this.tiftag.slice(e+4,e+8))[0],this.tiftag.slice(e+8,e+12)];s in m[n]&&(i[s]=this.convert_value(u))}return"0th"==t&&(e=a+12*r,i.first_ifd_pointer=this.tiftag.slice(e,e+4)),i},convert_value:function(e){var t,n=null,i=e[0],r=e[1],a=e[2];if(1==i)r>4?(t=d(this.endian_mark+"L",a)[0],n=d(this.endian_mark+p("B",r),this.tiftag.slice(t,t+r))):n=d(this.endian_mark+p("B",r),a.slice(0,r));else if(2==i)r>4?(t=d(this.endian_mark+"L",a)[0],n=this.tiftag.slice(t,t+r-1)):n=a.slice(0,r-1);else if(3==i)r>2?(t=d(this.endian_mark+"L",a)[0],n=d(this.endian_mark+p("H",r),this.tiftag.slice(t,t+2*r))):n=d(this.endian_mark+p("H",r),a.slice(0,2*r));else if(4==i)r>1?(t=d(this.endian_mark+"L",a)[0],n=d(this.endian_mark+p("L",r),this.tiftag.slice(t,t+4*r))):n=d(this.endian_mark+p("L",r),a);else if(5==i)if(t=d(this.endian_mark+"L",a)[0],r>1){n=[];for(var o=0;o<r;o++)n.push([d(this.endian_mark+"L",this.tiftag.slice(t+8*o,t+4+8*o))[0],d(this.endian_mark+"L",this.tiftag.slice(t+4+8*o,t+8+8*o))[0]])}else n=[d(this.endian_mark+"L",this.tiftag.slice(t,t+4))[0],d(this.endian_mark+"L",this.tiftag.slice(t+4,t+8))[0]];else if(7==i)r>4?(t=d(this.endian_mark+"L",a)[0],n=this.tiftag.slice(t,t+r)):n=a.slice(0,r);else if(9==i)r>1?(t=d(this.endian_mark+"L",a)[0],n=d(this.endian_mark+p("l",r),this.tiftag.slice(t,t+4*r))):n=d(this.endian_mark+p("l",r),a);else{if(10!=i)throw new Error("Exif might be wrong. Got incorrect value type to decode. type:"+i);if(t=d(this.endian_mark+"L",a)[0],r>1)for(n=[],o=0;o<r;o++)n.push([d(this.endian_mark+"l",this.tiftag.slice(t+8*o,t+4+8*o))[0],d(this.endian_mark+"l",this.tiftag.slice(t+4+8*o,t+8+8*o))[0]]);else n=[d(this.endian_mark+"l",this.tiftag.slice(t,t+4))[0],d(this.endian_mark+"l",this.tiftag.slice(t+4,t+8))[0]]}return n instanceof Array&&1==n.length?n[0]:n}},"undefined"!=typeof window&&"function"==typeof window.btoa)var l=window.btoa;if(void 0===l&&(l=function(e){for(var t,n,i,r,a,o,s,u="",l=0,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";l<e.length;)r=(t=e.charCodeAt(l++))>>2,a=(3&t)<<4|(n=e.charCodeAt(l++))>>4,o=(15&n)<<2|(i=e.charCodeAt(l++))>>6,s=63&i,isNaN(n)?o=s=64:isNaN(i)&&(s=64),u=u+h.charAt(r)+h.charAt(a)+h.charAt(o)+h.charAt(s);return u}),"undefined"!=typeof window&&"function"==typeof window.atob)var h=window.atob;function c(e,t){if(!(t instanceof Array))throw new Error("'pack' error. Got invalid type argument.");if(e.length-1!=t.length)throw new Error("'pack' error. "+(e.length-1)+" marks, "+t.length+" elements.");var n;if("<"==e[0])n=!0;else{if(">"!=e[0])throw new Error("");n=!1}for(var i="",r=1,a=null,o=null,s=null;o=e[r];){if("b"==o.toLowerCase()){if(a=t[r-1],"b"==o&&a<0&&(a+=256),a>255||a<0)throw new Error("'pack' error.");s=String.fromCharCode(a)}else if("H"==o){if((a=t[r-1])>65535||a<0)throw new Error("'pack' error.");s=String.fromCharCode(Math.floor(a%65536/256))+String.fromCharCode(a%256),n&&(s=s.split("").reverse().join(""))}else{if("l"!=o.toLowerCase())throw new Error("'pack' error.");if(a=t[r-1],"l"==o&&a<0&&(a+=4294967296),a>4294967295||a<0)throw new Error("'pack' error.");s=String.fromCharCode(Math.floor(a/16777216))+String.fromCharCode(Math.floor(a%16777216/65536))+String.fromCharCode(Math.floor(a%65536/256))+String.fromCharCode(a%256),n&&(s=s.split("").reverse().join(""))}i+=s,r+=1}return i}function d(e,t){if("string"!=typeof t)throw new Error("'unpack' error. Got invalid type argument.");for(var n,i=0,r=1;r<e.length;r++)if("b"==e[r].toLowerCase())i+=1;else if("h"==e[r].toLowerCase())i+=2;else{if("l"!=e[r].toLowerCase())throw new Error("'unpack' error. Got invalid mark.");i+=4}if(i!=t.length)throw new Error("'unpack' error. Mismatch between symbol and string length. "+i+":"+t.length);if("<"==e[0])n=!0;else{if(">"!=e[0])throw new Error("'unpack' error.");n=!1}for(var a=[],o=0,s=1,u=null,l=null,h=null,c="";l=e[s];){if("b"==l.toLowerCase())h=1,u=(c=t.slice(o,o+h)).charCodeAt(0),"b"==l&&u>=128&&(u-=256);else if("H"==l)h=2,c=t.slice(o,o+h),n&&(c=c.split("").reverse().join("")),u=256*c.charCodeAt(0)+c.charCodeAt(1);else{if("l"!=l.toLowerCase())throw new Error("'unpack' error. "+l);h=4,c=t.slice(o,o+h),n&&(c=c.split("").reverse().join("")),u=16777216*c.charCodeAt(0)+65536*c.charCodeAt(1)+256*c.charCodeAt(2)+c.charCodeAt(3),"l"==l&&u>=2147483648&&(u-=4294967296)}a.push(u),o+=h,s+=1}return a}function p(e,t){for(var n="",i=0;i<t;i++)n+=e;return n}function f(e){if(""!=e.slice(0,2))throw new Error("Given data isn't JPEG.");for(var t=2,n=[""];;){if(""==e.slice(t,t+2)){n.push(e.slice(t));break}var i=t+d(">H",e.slice(t+2,t+4))[0]+2;if(n.push(e.slice(t,i)),(t=i)>=e.length)throw new Error("Wrong JPEG data.")}return n}void 0===h&&(h=function(e){var t,n,i,r,a,o,s="",u=0,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<e.length;)t=l.indexOf(e.charAt(u++))<<2|(r=l.indexOf(e.charAt(u++)))>>4,n=(15&r)<<4|(a=l.indexOf(e.charAt(u++)))>>2,i=(3&a)<<6|(o=l.indexOf(e.charAt(u++))),s+=String.fromCharCode(t),64!=a&&(s+=String.fromCharCode(n)),64!=o&&(s+=String.fromCharCode(i));return s});var g={Byte:1,Ascii:2,Short:3,Long:4,Rational:5,Undefined:7,SLong:9,SRational:10},m={Image:{11:{name:"ProcessingSoftware",type:"Ascii"},254:{name:"NewSubfileType",type:"Long"},255:{name:"SubfileType",type:"Short"},256:{name:"ImageWidth",type:"Long"},257:{name:"ImageLength",type:"Long"},258:{name:"BitsPerSample",type:"Short"},259:{name:"Compression",type:"Short"},262:{name:"PhotometricInterpretation",type:"Short"},263:{name:"Threshholding",type:"Short"},264:{name:"CellWidth",type:"Short"},265:{name:"CellLength",type:"Short"},266:{name:"FillOrder",type:"Short"},269:{name:"DocumentName",type:"Ascii"},270:{name:"ImageDescription",type:"Ascii"},271:{name:"Make",type:"Ascii"},272:{name:"Model",type:"Ascii"},273:{name:"StripOffsets",type:"Long"},274:{name:"Orientation",type:"Short"},277:{name:"SamplesPerPixel",type:"Short"},278:{name:"RowsPerStrip",type:"Long"},279:{name:"StripByteCounts",type:"Long"},282:{name:"XResolution",type:"Rational"},283:{name:"YResolution",type:"Rational"},284:{name:"PlanarConfiguration",type:"Short"},290:{name:"GrayResponseUnit",type:"Short"},291:{name:"GrayResponseCurve",type:"Short"},292:{name:"T4Options",type:"Long"},293:{name:"T6Options",type:"Long"},296:{name:"ResolutionUnit",type:"Short"},301:{name:"TransferFunction",type:"Short"},305:{name:"Software",type:"Ascii"},306:{name:"DateTime",type:"Ascii"},315:{name:"Artist",type:"Ascii"},316:{name:"HostComputer",type:"Ascii"},317:{name:"Predictor",type:"Short"},318:{name:"WhitePoint",type:"Rational"},319:{name:"PrimaryChromaticities",type:"Rational"},320:{name:"ColorMap",type:"Short"},321:{name:"HalftoneHints",type:"Short"},322:{name:"TileWidth",type:"Short"},323:{name:"TileLength",type:"Short"},324:{name:"TileOffsets",type:"Short"},325:{name:"TileByteCounts",type:"Short"},330:{name:"SubIFDs",type:"Long"},332:{name:"InkSet",type:"Short"},333:{name:"InkNames",type:"Ascii"},334:{name:"NumberOfInks",type:"Short"},336:{name:"DotRange",type:"Byte"},337:{name:"TargetPrinter",type:"Ascii"},338:{name:"ExtraSamples",type:"Short"},339:{name:"SampleFormat",type:"Short"},340:{name:"SMinSampleValue",type:"Short"},341:{name:"SMaxSampleValue",type:"Short"},342:{name:"TransferRange",type:"Short"},343:{name:"ClipPath",type:"Byte"},344:{name:"XClipPathUnits",type:"Long"},345:{name:"YClipPathUnits",type:"Long"},346:{name:"Indexed",type:"Short"},347:{name:"JPEGTables",type:"Undefined"},351:{name:"OPIProxy",type:"Short"},512:{name:"JPEGProc",type:"Long"},513:{name:"JPEGInterchangeFormat",type:"Long"},514:{name:"JPEGInterchangeFormatLength",type:"Long"},515:{name:"JPEGRestartInterval",type:"Short"},517:{name:"JPEGLosslessPredictors",type:"Short"},518:{name:"JPEGPointTransforms",type:"Short"},519:{name:"JPEGQTables",type:"Long"},520:{name:"JPEGDCTables",type:"Long"},521:{name:"JPEGACTables",type:"Long"},529:{name:"YCbCrCoefficients",type:"Rational"},530:{name:"YCbCrSubSampling",type:"Short"},531:{name:"YCbCrPositioning",type:"Short"},532:{name:"ReferenceBlackWhite",type:"Rational"},700:{name:"XMLPacket",type:"Byte"},18246:{name:"Rating",type:"Short"},18249:{name:"RatingPercent",type:"Short"},32781:{name:"ImageID",type:"Ascii"},33421:{name:"CFARepeatPatternDim",type:"Short"},33422:{name:"CFAPattern",type:"Byte"},33423:{name:"BatteryLevel",type:"Rational"},33432:{name:"Copyright",type:"Ascii"},33434:{name:"ExposureTime",type:"Rational"},34377:{name:"ImageResources",type:"Byte"},34665:{name:"ExifTag",type:"Long"},34675:{name:"InterColorProfile",type:"Undefined"},34853:{name:"GPSTag",type:"Long"},34857:{name:"Interlace",type:"Short"},34858:{name:"TimeZoneOffset",type:"Long"},34859:{name:"SelfTimerMode",type:"Short"},37387:{name:"FlashEnergy",type:"Rational"},37388:{name:"SpatialFrequencyResponse",type:"Undefined"},37389:{name:"Noise",type:"Undefined"},37390:{name:"FocalPlaneXResolution",type:"Rational"},37391:{name:"FocalPlaneYResolution",type:"Rational"},37392:{name:"FocalPlaneResolutionUnit",type:"Short"},37393:{name:"ImageNumber",type:"Long"},37394:{name:"SecurityClassification",type:"Ascii"},37395:{name:"ImageHistory",type:"Ascii"},37397:{name:"ExposureIndex",type:"Rational"},37398:{name:"TIFFEPStandardID",type:"Byte"},37399:{name:"SensingMethod",type:"Short"},40091:{name:"XPTitle",type:"Byte"},40092:{name:"XPComment",type:"Byte"},40093:{name:"XPAuthor",type:"Byte"},40094:{name:"XPKeywords",type:"Byte"},40095:{name:"XPSubject",type:"Byte"},50341:{name:"PrintImageMatching",type:"Undefined"},50706:{name:"DNGVersion",type:"Byte"},50707:{name:"DNGBackwardVersion",type:"Byte"},50708:{name:"UniqueCameraModel",type:"Ascii"},50709:{name:"LocalizedCameraModel",type:"Byte"},50710:{name:"CFAPlaneColor",type:"Byte"},50711:{name:"CFALayout",type:"Short"},50712:{name:"LinearizationTable",type:"Short"},50713:{name:"BlackLevelRepeatDim",type:"Short"},50714:{name:"BlackLevel",type:"Rational"},50715:{name:"BlackLevelDeltaH",type:"SRational"},50716:{name:"BlackLevelDeltaV",type:"SRational"},50717:{name:"WhiteLevel",type:"Short"},50718:{name:"DefaultScale",type:"Rational"},50719:{name:"DefaultCropOrigin",type:"Short"},50720:{name:"DefaultCropSize",type:"Short"},50721:{name:"ColorMatrix1",type:"SRational"},50722:{name:"ColorMatrix2",type:"SRational"},50723:{name:"CameraCalibration1",type:"SRational"},50724:{name:"CameraCalibration2",type:"SRational"},50725:{name:"ReductionMatrix1",type:"SRational"},50726:{name:"ReductionMatrix2",type:"SRational"},50727:{name:"AnalogBalance",type:"Rational"},50728:{name:"AsShotNeutral",type:"Short"},50729:{name:"AsShotWhiteXY",type:"Rational"},50730:{name:"BaselineExposure",type:"SRational"},50731:{name:"BaselineNoise",type:"Rational"},50732:{name:"BaselineSharpness",type:"Rational"},50733:{name:"BayerGreenSplit",type:"Long"},50734:{name:"LinearResponseLimit",type:"Rational"},50735:{name:"CameraSerialNumber",type:"Ascii"},50736:{name:"LensInfo",type:"Rational"},50737:{name:"ChromaBlurRadius",type:"Rational"},50738:{name:"AntiAliasStrength",type:"Rational"},50739:{name:"ShadowScale",type:"SRational"},50740:{name:"DNGPrivateData",type:"Byte"},50741:{name:"MakerNoteSafety",type:"Short"},50778:{name:"CalibrationIlluminant1",type:"Short"},50779:{name:"CalibrationIlluminant2",type:"Short"},50780:{name:"BestQualityScale",type:"Rational"},50781:{name:"RawDataUniqueID",type:"Byte"},50827:{name:"OriginalRawFileName",type:"Byte"},50828:{name:"OriginalRawFileData",type:"Undefined"},50829:{name:"ActiveArea",type:"Short"},50830:{name:"MaskedAreas",type:"Short"},50831:{name:"AsShotICCProfile",type:"Undefined"},50832:{name:"AsShotPreProfileMatrix",type:"SRational"},50833:{name:"CurrentICCProfile",type:"Undefined"},50834:{name:"CurrentPreProfileMatrix",type:"SRational"},50879:{name:"ColorimetricReference",type:"Short"},50931:{name:"CameraCalibrationSignature",type:"Byte"},50932:{name:"ProfileCalibrationSignature",type:"Byte"},50934:{name:"AsShotProfileName",type:"Byte"},50935:{name:"NoiseReductionApplied",type:"Rational"},50936:{name:"ProfileName",type:"Byte"},50937:{name:"ProfileHueSatMapDims",type:"Long"},50938:{name:"ProfileHueSatMapData1",type:"Float"},50939:{name:"ProfileHueSatMapData2",type:"Float"},50940:{name:"ProfileToneCurve",type:"Float"},50941:{name:"ProfileEmbedPolicy",type:"Long"},50942:{name:"ProfileCopyright",type:"Byte"},50964:{name:"ForwardMatrix1",type:"SRational"},50965:{name:"ForwardMatrix2",type:"SRational"},50966:{name:"PreviewApplicationName",type:"Byte"},50967:{name:"PreviewApplicationVersion",type:"Byte"},50968:{name:"PreviewSettingsName",type:"Byte"},50969:{name:"PreviewSettingsDigest",type:"Byte"},50970:{name:"PreviewColorSpace",type:"Long"},50971:{name:"PreviewDateTime",type:"Ascii"},50972:{name:"RawImageDigest",type:"Undefined"},50973:{name:"OriginalRawFileDigest",type:"Undefined"},50974:{name:"SubTileBlockSize",type:"Long"},50975:{name:"RowInterleaveFactor",type:"Long"},50981:{name:"ProfileLookTableDims",type:"Long"},50982:{name:"ProfileLookTableData",type:"Float"},51008:{name:"OpcodeList1",type:"Undefined"},51009:{name:"OpcodeList2",type:"Undefined"},51022:{name:"OpcodeList3",type:"Undefined"}},Exif:{33434:{name:"ExposureTime",type:"Rational"},33437:{name:"FNumber",type:"Rational"},34850:{name:"ExposureProgram",type:"Short"},34852:{name:"SpectralSensitivity",type:"Ascii"},34855:{name:"ISOSpeedRatings",type:"Short"},34856:{name:"OECF",type:"Undefined"},34864:{name:"SensitivityType",type:"Short"},34865:{name:"StandardOutputSensitivity",type:"Long"},34866:{name:"RecommendedExposureIndex",type:"Long"},34867:{name:"ISOSpeed",type:"Long"},34868:{name:"ISOSpeedLatitudeyyy",type:"Long"},34869:{name:"ISOSpeedLatitudezzz",type:"Long"},36864:{name:"ExifVersion",type:"Undefined"},36867:{name:"DateTimeOriginal",type:"Ascii"},36868:{name:"DateTimeDigitized",type:"Ascii"},37121:{name:"ComponentsConfiguration",type:"Undefined"},37122:{name:"CompressedBitsPerPixel",type:"Rational"},37377:{name:"ShutterSpeedValue",type:"SRational"},37378:{name:"ApertureValue",type:"Rational"},37379:{name:"BrightnessValue",type:"SRational"},37380:{name:"ExposureBiasValue",type:"SRational"},37381:{name:"MaxApertureValue",type:"Rational"},37382:{name:"SubjectDistance",type:"Rational"},37383:{name:"MeteringMode",type:"Short"},37384:{name:"LightSource",type:"Short"},37385:{name:"Flash",type:"Short"},37386:{name:"FocalLength",type:"Rational"},37396:{name:"SubjectArea",type:"Short"},37500:{name:"MakerNote",type:"Undefined"},37510:{name:"UserComment",type:"Ascii"},37520:{name:"SubSecTime",type:"Ascii"},37521:{name:"SubSecTimeOriginal",type:"Ascii"},37522:{name:"SubSecTimeDigitized",type:"Ascii"},40960:{name:"FlashpixVersion",type:"Undefined"},40961:{name:"ColorSpace",type:"Short"},40962:{name:"PixelXDimension",type:"Long"},40963:{name:"PixelYDimension",type:"Long"},40964:{name:"RelatedSoundFile",type:"Ascii"},40965:{name:"InteroperabilityTag",type:"Long"},41483:{name:"FlashEnergy",type:"Rational"},41484:{name:"SpatialFrequencyResponse",type:"Undefined"},41486:{name:"FocalPlaneXResolution",type:"Rational"},41487:{name:"FocalPlaneYResolution",type:"Rational"},41488:{name:"FocalPlaneResolutionUnit",type:"Short"},41492:{name:"SubjectLocation",type:"Short"},41493:{name:"ExposureIndex",type:"Rational"},41495:{name:"SensingMethod",type:"Short"},41728:{name:"FileSource",type:"Undefined"},41729:{name:"SceneType",type:"Undefined"},41730:{name:"CFAPattern",type:"Undefined"},41985:{name:"CustomRendered",type:"Short"},41986:{name:"ExposureMode",type:"Short"},41987:{name:"WhiteBalance",type:"Short"},41988:{name:"DigitalZoomRatio",type:"Rational"},41989:{name:"FocalLengthIn35mmFilm",type:"Short"},41990:{name:"SceneCaptureType",type:"Short"},41991:{name:"GainControl",type:"Short"},41992:{name:"Contrast",type:"Short"},41993:{name:"Saturation",type:"Short"},41994:{name:"Sharpness",type:"Short"},41995:{name:"DeviceSettingDescription",type:"Undefined"},41996:{name:"SubjectDistanceRange",type:"Short"},42016:{name:"ImageUniqueID",type:"Ascii"},42032:{name:"CameraOwnerName",type:"Ascii"},42033:{name:"BodySerialNumber",type:"Ascii"},42034:{name:"LensSpecification",type:"Rational"},42035:{name:"LensMake",type:"Ascii"},42036:{name:"LensModel",type:"Ascii"},42037:{name:"LensSerialNumber",type:"Ascii"},42240:{name:"Gamma",type:"Rational"}},GPS:{0:{name:"GPSVersionID",type:"Byte"},1:{name:"GPSLatitudeRef",type:"Ascii"},2:{name:"GPSLatitude",type:"Rational"},3:{name:"GPSLongitudeRef",type:"Ascii"},4:{name:"GPSLongitude",type:"Rational"},5:{name:"GPSAltitudeRef",type:"Byte"},6:{name:"GPSAltitude",type:"Rational"},7:{name:"GPSTimeStamp",type:"Rational"},8:{name:"GPSSatellites",type:"Ascii"},9:{name:"GPSStatus",type:"Ascii"},10:{name:"GPSMeasureMode",type:"Ascii"},11:{name:"GPSDOP",type:"Rational"},12:{name:"GPSSpeedRef",type:"Ascii"},13:{name:"GPSSpeed",type:"Rational"},14:{name:"GPSTrackRef",type:"Ascii"},15:{name:"GPSTrack",type:"Rational"},16:{name:"GPSImgDirectionRef",type:"Ascii"},17:{name:"GPSImgDirection",type:"Rational"},18:{name:"GPSMapDatum",type:"Ascii"},19:{name:"GPSDestLatitudeRef",type:"Ascii"},20:{name:"GPSDestLatitude",type:"Rational"},21:{name:"GPSDestLongitudeRef",type:"Ascii"},22:{name:"GPSDestLongitude",type:"Rational"},23:{name:"GPSDestBearingRef",type:"Ascii"},24:{name:"GPSDestBearing",type:"Rational"},25:{name:"GPSDestDistanceRef",type:"Ascii"},26:{name:"GPSDestDistance",type:"Rational"},27:{name:"GPSProcessingMethod",type:"Undefined"},28:{name:"GPSAreaInformation",type:"Undefined"},29:{name:"GPSDateStamp",type:"Ascii"},30:{name:"GPSDifferential",type:"Short"},31:{name:"GPSHPositioningError",type:"Rational"}},Interop:{1:{name:"InteroperabilityIndex",type:"Ascii"}}};m["0th"]=m.Image,m["1st"]=m.Image,n.TAGS=m,n.ImageIFD={ProcessingSoftware:11,NewSubfileType:254,SubfileType:255,ImageWidth:256,ImageLength:257,BitsPerSample:258,Compression:259,PhotometricInterpretation:262,Threshholding:263,CellWidth:264,CellLength:265,FillOrder:266,DocumentName:269,ImageDescription:270,Make:271,Model:272,StripOffsets:273,Orientation:274,SamplesPerPixel:277,RowsPerStrip:278,StripByteCounts:279,XResolution:282,YResolution:283,PlanarConfiguration:284,GrayResponseUnit:290,GrayResponseCurve:291,T4Options:292,T6Options:293,ResolutionUnit:296,TransferFunction:301,Software:305,DateTime:306,Artist:315,HostComputer:316,Predictor:317,WhitePoint:318,PrimaryChromaticities:319,ColorMap:320,HalftoneHints:321,TileWidth:322,TileLength:323,TileOffsets:324,TileByteCounts:325,SubIFDs:330,InkSet:332,InkNames:333,NumberOfInks:334,DotRange:336,TargetPrinter:337,ExtraSamples:338,SampleFormat:339,SMinSampleValue:340,SMaxSampleValue:341,TransferRange:342,ClipPath:343,XClipPathUnits:344,YClipPathUnits:345,Indexed:346,JPEGTables:347,OPIProxy:351,JPEGProc:512,JPEGInterchangeFormat:513,JPEGInterchangeFormatLength:514,JPEGRestartInterval:515,JPEGLosslessPredictors:517,JPEGPointTransforms:518,JPEGQTables:519,JPEGDCTables:520,JPEGACTables:521,YCbCrCoefficients:529,YCbCrSubSampling:530,YCbCrPositioning:531,ReferenceBlackWhite:532,XMLPacket:700,Rating:18246,RatingPercent:18249,ImageID:32781,CFARepeatPatternDim:33421,CFAPattern:33422,BatteryLevel:33423,Copyright:33432,ExposureTime:33434,ImageResources:34377,ExifTag:34665,InterColorProfile:34675,GPSTag:34853,Interlace:34857,TimeZoneOffset:34858,SelfTimerMode:34859,FlashEnergy:37387,SpatialFrequencyResponse:37388,Noise:37389,FocalPlaneXResolution:37390,FocalPlaneYResolution:37391,FocalPlaneResolutionUnit:37392,ImageNumber:37393,SecurityClassification:37394,ImageHistory:37395,ExposureIndex:37397,TIFFEPStandardID:37398,SensingMethod:37399,XPTitle:40091,XPComment:40092,XPAuthor:40093,XPKeywords:40094,XPSubject:40095,PrintImageMatching:50341,DNGVersion:50706,DNGBackwardVersion:50707,UniqueCameraModel:50708,LocalizedCameraModel:50709,CFAPlaneColor:50710,CFALayout:50711,LinearizationTable:50712,BlackLevelRepeatDim:50713,BlackLevel:50714,BlackLevelDeltaH:50715,BlackLevelDeltaV:50716,WhiteLevel:50717,DefaultScale:50718,DefaultCropOrigin:50719,DefaultCropSize:50720,ColorMatrix1:50721,ColorMatrix2:50722,CameraCalibration1:50723,CameraCalibration2:50724,ReductionMatrix1:50725,ReductionMatrix2:50726,AnalogBalance:50727,AsShotNeutral:50728,AsShotWhiteXY:50729,BaselineExposure:50730,BaselineNoise:50731,BaselineSharpness:50732,BayerGreenSplit:50733,LinearResponseLimit:50734,CameraSerialNumber:50735,LensInfo:50736,ChromaBlurRadius:50737,AntiAliasStrength:50738,ShadowScale:50739,DNGPrivateData:50740,MakerNoteSafety:50741,CalibrationIlluminant1:50778,CalibrationIlluminant2:50779,BestQualityScale:50780,RawDataUniqueID:50781,OriginalRawFileName:50827,OriginalRawFileData:50828,ActiveArea:50829,MaskedAreas:50830,AsShotICCProfile:50831,AsShotPreProfileMatrix:50832,CurrentICCProfile:50833,CurrentPreProfileMatrix:50834,ColorimetricReference:50879,CameraCalibrationSignature:50931,ProfileCalibrationSignature:50932,AsShotProfileName:50934,NoiseReductionApplied:50935,ProfileName:50936,ProfileHueSatMapDims:50937,ProfileHueSatMapData1:50938,ProfileHueSatMapData2:50939,ProfileToneCurve:50940,ProfileEmbedPolicy:50941,ProfileCopyright:50942,ForwardMatrix1:50964,ForwardMatrix2:50965,PreviewApplicationName:50966,PreviewApplicationVersion:50967,PreviewSettingsName:50968,PreviewSettingsDigest:50969,PreviewColorSpace:50970,PreviewDateTime:50971,RawImageDigest:50972,OriginalRawFileDigest:50973,SubTileBlockSize:50974,RowInterleaveFactor:50975,ProfileLookTableDims:50981,ProfileLookTableData:50982,OpcodeList1:51008,OpcodeList2:51009,OpcodeList3:51022,NoiseProfile:51041},n.ExifIFD={ExposureTime:33434,FNumber:33437,ExposureProgram:34850,SpectralSensitivity:34852,ISOSpeedRatings:34855,OECF:34856,SensitivityType:34864,StandardOutputSensitivity:34865,RecommendedExposureIndex:34866,ISOSpeed:34867,ISOSpeedLatitudeyyy:34868,ISOSpeedLatitudezzz:34869,ExifVersion:36864,DateTimeOriginal:36867,DateTimeDigitized:36868,ComponentsConfiguration:37121,CompressedBitsPerPixel:37122,ShutterSpeedValue:37377,ApertureValue:37378,BrightnessValue:37379,ExposureBiasValue:37380,MaxApertureValue:37381,SubjectDistance:37382,MeteringMode:37383,LightSource:37384,Flash:37385,FocalLength:37386,SubjectArea:37396,MakerNote:37500,UserComment:37510,SubSecTime:37520,SubSecTimeOriginal:37521,SubSecTimeDigitized:37522,FlashpixVersion:40960,ColorSpace:40961,PixelXDimension:40962,PixelYDimension:40963,RelatedSoundFile:40964,InteroperabilityTag:40965,FlashEnergy:41483,SpatialFrequencyResponse:41484,FocalPlaneXResolution:41486,FocalPlaneYResolution:41487,FocalPlaneResolutionUnit:41488,SubjectLocation:41492,ExposureIndex:41493,SensingMethod:41495,FileSource:41728,SceneType:41729,CFAPattern:41730,CustomRendered:41985,ExposureMode:41986,WhiteBalance:41987,DigitalZoomRatio:41988,FocalLengthIn35mmFilm:41989,SceneCaptureType:41990,GainControl:41991,Contrast:41992,Saturation:41993,Sharpness:41994,DeviceSettingDescription:41995,SubjectDistanceRange:41996,ImageUniqueID:42016,CameraOwnerName:42032,BodySerialNumber:42033,LensSpecification:42034,LensMake:42035,LensModel:42036,LensSerialNumber:42037,Gamma:42240},n.GPSIFD={GPSVersionID:0,GPSLatitudeRef:1,GPSLatitude:2,GPSLongitudeRef:3,GPSLongitude:4,GPSAltitudeRef:5,GPSAltitude:6,GPSTimeStamp:7,GPSSatellites:8,GPSStatus:9,GPSMeasureMode:10,GPSDOP:11,GPSSpeedRef:12,GPSSpeed:13,GPSTrackRef:14,GPSTrack:15,GPSImgDirectionRef:16,GPSImgDirection:17,GPSMapDatum:18,GPSDestLatitudeRef:19,GPSDestLatitude:20,GPSDestLongitudeRef:21,GPSDestLongitude:22,GPSDestBearingRef:23,GPSDestBearing:24,GPSDestDistanceRef:25,GPSDestDistance:26,GPSProcessingMethod:27,GPSAreaInformation:28,GPSDateStamp:29,GPSDifferential:30,GPSHPositioningError:31},n.InteropIFD={InteroperabilityIndex:1},n.GPSHelper={degToDmsRational:function(e){var t=Math.abs(e),n=t%1*60,i=n%1*60;return[[Math.floor(t),1],[Math.floor(n),1],[Math.round(100*i),100]]},dmsRationalToDeg:function(e,t){var n="S"===t||"W"===t?-1:1;return(e[0][0]/e[0][1]+e[1][0]/e[1][1]/60+e[2][0]/e[2][1]/3600)*n}},e.exports&&(t=e.exports=n),t.piexif=n}()},583:(e,t,n)=>{const i=n(333),r=n(157),a=n(280),o=n(375);function s(e,t,n,a,o){const s=[].slice.call(arguments,1),u=s.length,l="function"==typeof s[u-1];if(!l&&!i())throw new Error("Callback required as last argument");if(!l){if(u<1)throw new Error("Too few arguments provided");return 1===u?(n=t,t=a=void 0):2!==u||t.getContext||(a=n,n=t,t=void 0),new Promise((function(i,o){try{const o=r.create(n,a);i(e(o,t,a))}catch(e){o(e)}}))}if(u<2)throw new Error("Too few arguments provided");2===u?(o=n,n=t,t=a=void 0):3===u&&(t.getContext&&void 0===o?(o=a,a=void 0):(o=a,a=n,n=t,t=void 0));try{const i=r.create(n,a);o(null,e(i,t,a))}catch(e){o(e)}}t.create=r.create,t.toCanvas=s.bind(null,a.render),t.toDataURL=s.bind(null,a.renderToDataURL),t.toString=s.bind(null,(function(e,t,n){return o.render(e,n)}))},333:e=>{e.exports=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then}},421:(e,t,n)=>{const i=n(886).getSymbolSize;t.getRowColCoords=function(e){if(1===e)return[];const t=Math.floor(e/7)+2,n=i(e),r=145===n?26:2*Math.ceil((n-13)/(2*t-2)),a=[n-7];for(let e=1;e<t-1;e++)a[e]=a[e-1]-r;return a.push(6),a.reverse()},t.getPositions=function(e){const n=[],i=t.getRowColCoords(e),r=i.length;for(let e=0;e<r;e++)for(let t=0;t<r;t++)0===e&&0===t||0===e&&t===r-1||e===r-1&&0===t||n.push([i[e],i[t]]);return n}},433:(e,t,n)=>{const i=n(208),r=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function a(e){this.mode=i.ALPHANUMERIC,this.data=e}a.getBitsLength=function(e){return 11*Math.floor(e/2)+e%2*6},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let n=45*r.indexOf(this.data[t]);n+=r.indexOf(this.data[t+1]),e.put(n,11)}this.data.length%2&&e.put(r.indexOf(this.data[t]),6)},e.exports=a},899:e=>{function t(){this.buffer=[],this.length=0}t.prototype={get:function(e){const t=Math.floor(e/8);return 1==(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(let n=0;n<t;n++)this.putBit(1==(e>>>t-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},e.exports=t},820:e=>{function t(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}t.prototype.set=function(e,t,n,i){const r=e*this.size+t;this.data[r]=n,i&&(this.reservedBit[r]=!0)},t.prototype.get=function(e,t){return this.data[e*this.size+t]},t.prototype.xor=function(e,t,n){this.data[e*this.size+t]^=n},t.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]},e.exports=t},822:(e,t,n)=>{const i=n(49),r=n(208);function a(e){this.mode=r.BYTE,"string"==typeof e&&(e=i(e)),this.data=new Uint8Array(e)}a.getBitsLength=function(e){return 8*e},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(e){for(let t=0,n=this.data.length;t<n;t++)e.put(this.data[t],8)},e.exports=a},518:(e,t,n)=>{const i=n(953),r=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],a=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];t.getBlocksCount=function(e,t){switch(t){case i.L:return r[4*(e-1)+0];case i.M:return r[4*(e-1)+1];case i.Q:return r[4*(e-1)+2];case i.H:return r[4*(e-1)+3];default:return}},t.getTotalCodewordsCount=function(e,t){switch(t){case i.L:return a[4*(e-1)+0];case i.M:return a[4*(e-1)+1];case i.Q:return a[4*(e-1)+2];case i.H:return a[4*(e-1)+3];default:return}}},953:(e,t)=>{t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2},t.isValid=function(e){return e&&void 0!==e.bit&&e.bit>=0&&e.bit<4},t.from=function(e,n){if(t.isValid(e))return e;try{return function(e){if("string"!=typeof e)throw new Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+e)}}(e)}catch(e){return n}}},756:(e,t,n)=>{const i=n(886).getSymbolSize;t.getPositions=function(e){const t=i(e);return[[0,0],[t-7,0],[0,t-7]]}},565:(e,t,n)=>{const i=n(886),r=i.getBCHDigit(1335);t.getEncodedBits=function(e,t){const n=e.bit<<3|t;let a=n<<10;for(;i.getBCHDigit(a)-r>=0;)a^=1335<<i.getBCHDigit(a)-r;return 21522^(n<<10|a)}},731:(e,t)=>{const n=new Uint8Array(512),i=new Uint8Array(256);!function(){let e=1;for(let t=0;t<255;t++)n[t]=e,i[e]=t,e<<=1,256&e&&(e^=285);for(let e=255;e<512;e++)n[e]=n[e-255]}(),t.log=function(e){if(e<1)throw new Error("log("+e+")");return i[e]},t.exp=function(e){return n[e]},t.mul=function(e,t){return 0===e||0===t?0:n[i[e]+i[t]]}},861:(e,t,n)=>{const i=n(208),r=n(886);function a(e){this.mode=i.KANJI,this.data=e}a.getBitsLength=function(e){return 13*e},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let n=r.toSJIS(this.data[t]);if(n>=33088&&n<=40956)n-=33088;else{if(!(n>=57408&&n<=60351))throw new Error("Invalid SJIS character: "+this.data[t]+"\nMake sure your charset is UTF-8");n-=49472}n=192*(n>>>8&255)+(255&n),e.put(n,13)}},e.exports=a},332:(e,t)=>{t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};function n(e,n,i){switch(e){case t.Patterns.PATTERN000:return(n+i)%2==0;case t.Patterns.PATTERN001:return n%2==0;case t.Patterns.PATTERN010:return i%3==0;case t.Patterns.PATTERN011:return(n+i)%3==0;case t.Patterns.PATTERN100:return(Math.floor(n/2)+Math.floor(i/3))%2==0;case t.Patterns.PATTERN101:return n*i%2+n*i%3==0;case t.Patterns.PATTERN110:return(n*i%2+n*i%3)%2==0;case t.Patterns.PATTERN111:return(n*i%3+(n+i)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}}t.isValid=function(e){return null!=e&&""!==e&&!isNaN(e)&&e>=0&&e<=7},t.from=function(e){return t.isValid(e)?parseInt(e,10):void 0},t.getPenaltyN1=function(e){const t=e.size;let n=0,i=0,r=0,a=null,o=null;for(let s=0;s<t;s++){i=r=0,a=o=null;for(let u=0;u<t;u++){let t=e.get(s,u);t===a?i++:(i>=5&&(n+=i-5+3),a=t,i=1),t=e.get(u,s),t===o?r++:(r>=5&&(n+=r-5+3),o=t,r=1)}i>=5&&(n+=i-5+3),r>=5&&(n+=r-5+3)}return n},t.getPenaltyN2=function(e){const t=e.size;let n=0;for(let i=0;i<t-1;i++)for(let r=0;r<t-1;r++){const t=e.get(i,r)+e.get(i,r+1)+e.get(i+1,r)+e.get(i+1,r+1);4!==t&&0!==t||n++}return 3*n},t.getPenaltyN3=function(e){const t=e.size;let n=0,i=0,r=0;for(let a=0;a<t;a++){i=r=0;for(let o=0;o<t;o++)i=i<<1&2047|e.get(a,o),o>=10&&(1488===i||93===i)&&n++,r=r<<1&2047|e.get(o,a),o>=10&&(1488===r||93===r)&&n++}return 40*n},t.getPenaltyN4=function(e){let t=0;const n=e.data.length;for(let i=0;i<n;i++)t+=e.data[i];return 10*Math.abs(Math.ceil(100*t/n/5)-10)},t.applyMask=function(e,t){const i=t.size;for(let r=0;r<i;r++)for(let a=0;a<i;a++)t.isReserved(a,r)||t.xor(a,r,n(e,a,r))},t.getBestMask=function(e,n){const i=Object.keys(t.Patterns).length;let r=0,a=1/0;for(let o=0;o<i;o++){n(o),t.applyMask(o,e);const i=t.getPenaltyN1(e)+t.getPenaltyN2(e)+t.getPenaltyN3(e)+t.getPenaltyN4(e);t.applyMask(o,e),i<a&&(a=i,r=o)}return r}},208:(e,t,n)=>{const i=n(878),r=n(44);t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(e,t){if(!e.ccBits)throw new Error("Invalid mode: "+e);if(!i.isValid(t))throw new Error("Invalid version: "+t);return t>=1&&t<10?e.ccBits[0]:t<27?e.ccBits[1]:e.ccBits[2]},t.getBestModeForData=function(e){return r.testNumeric(e)?t.NUMERIC:r.testAlphanumeric(e)?t.ALPHANUMERIC:r.testKanji(e)?t.KANJI:t.BYTE},t.toString=function(e){if(e&&e.id)return e.id;throw new Error("Invalid mode")},t.isValid=function(e){return e&&e.bit&&e.ccBits},t.from=function(e,n){if(t.isValid(e))return e;try{return function(e){if("string"!=typeof e)throw new Error("Param is not a string");switch(e.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+e)}}(e)}catch(e){return n}}},357:(e,t,n)=>{const i=n(208);function r(e){this.mode=i.NUMERIC,this.data=e.toString()}r.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)},r.prototype.getLength=function(){return this.data.length},r.prototype.getBitsLength=function(){return r.getBitsLength(this.data.length)},r.prototype.write=function(e){let t,n,i;for(t=0;t+3<=this.data.length;t+=3)n=this.data.substr(t,3),i=parseInt(n,10),e.put(i,10);const r=this.data.length-t;r>0&&(n=this.data.substr(t),i=parseInt(n,10),e.put(i,3*r+1))},e.exports=r},713:(e,t,n)=>{const i=n(731);t.mul=function(e,t){const n=new Uint8Array(e.length+t.length-1);for(let r=0;r<e.length;r++)for(let a=0;a<t.length;a++)n[r+a]^=i.mul(e[r],t[a]);return n},t.mod=function(e,t){let n=new Uint8Array(e);for(;n.length-t.length>=0;){const e=n[0];for(let r=0;r<t.length;r++)n[r]^=i.mul(t[r],e);let r=0;for(;r<n.length&&0===n[r];)r++;n=n.slice(r)}return n},t.generateECPolynomial=function(e){let n=new Uint8Array([1]);for(let r=0;r<e;r++)n=t.mul(n,new Uint8Array([1,i.exp(r)]));return n}},157:(e,t,n)=>{const i=n(886),r=n(953),a=n(899),o=n(820),s=n(421),u=n(756),l=n(332),h=n(518),c=n(764),d=n(427),p=n(565),f=n(208),g=n(801);function m(e,t,n){const i=e.size,r=p.getEncodedBits(t,n);let a,o;for(a=0;a<15;a++)o=1==(r>>a&1),a<6?e.set(a,8,o,!0):a<8?e.set(a+1,8,o,!0):e.set(i-15+a,8,o,!0),a<8?e.set(8,i-a-1,o,!0):a<9?e.set(8,15-a-1+1,o,!0):e.set(8,15-a-1,o,!0);e.set(i-8,8,1,!0)}function v(e,t,n,r){let p;if(Array.isArray(e))p=g.fromArray(e);else{if("string"!=typeof e)throw new Error("Invalid data");{let i=t;if(!i){const t=g.rawSplit(e);i=d.getBestVersionForData(t,n)}p=g.fromString(e,i||40)}}const v=d.getBestVersionForData(p,n);if(!v)throw new Error("The amount of data is too big to be stored in a QR Code");if(t){if(t<v)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+v+".\n")}else t=v;const y=function(e,t,n){const r=new a;n.forEach((function(t){r.put(t.mode.bit,4),r.put(t.getLength(),f.getCharCountIndicator(t.mode,e)),t.write(r)}));const o=8*(i.getSymbolTotalCodewords(e)-h.getTotalCodewordsCount(e,t));for(r.getLengthInBits()+4<=o&&r.put(0,4);r.getLengthInBits()%8!=0;)r.putBit(0);const s=(o-r.getLengthInBits())/8;for(let e=0;e<s;e++)r.put(e%2?17:236,8);return function(e,t,n){const r=i.getSymbolTotalCodewords(t),a=r-h.getTotalCodewordsCount(t,n),o=h.getBlocksCount(t,n),s=o-r%o,u=Math.floor(r/o),l=Math.floor(a/o),d=l+1,p=u-l,f=new c(p);let g=0;const m=new Array(o),v=new Array(o);let y=0;const b=new Uint8Array(e.buffer);for(let e=0;e<o;e++){const t=e<s?l:d;m[e]=b.slice(g,g+t),v[e]=f.encode(m[e]),g+=t,y=Math.max(y,t)}const _=new Uint8Array(r);let w,S,T=0;for(w=0;w<y;w++)for(S=0;S<o;S++)w<m[S].length&&(_[T++]=m[S][w]);for(w=0;w<p;w++)for(S=0;S<o;S++)_[T++]=v[S][w];return _}(r,e,t)}(t,n,p),b=i.getSymbolSize(t),_=new o(b);return function(e,t){const n=e.size,i=u.getPositions(t);for(let t=0;t<i.length;t++){const r=i[t][0],a=i[t][1];for(let t=-1;t<=7;t++)if(!(r+t<=-1||n<=r+t))for(let i=-1;i<=7;i++)a+i<=-1||n<=a+i||(t>=0&&t<=6&&(0===i||6===i)||i>=0&&i<=6&&(0===t||6===t)||t>=2&&t<=4&&i>=2&&i<=4?e.set(r+t,a+i,!0,!0):e.set(r+t,a+i,!1,!0))}}(_,t),function(e){const t=e.size;for(let n=8;n<t-8;n++){const t=n%2==0;e.set(n,6,t,!0),e.set(6,n,t,!0)}}(_),function(e,t){const n=s.getPositions(t);for(let t=0;t<n.length;t++){const i=n[t][0],r=n[t][1];for(let t=-2;t<=2;t++)for(let n=-2;n<=2;n++)-2===t||2===t||-2===n||2===n||0===t&&0===n?e.set(i+t,r+n,!0,!0):e.set(i+t,r+n,!1,!0)}}(_,t),m(_,n,0),t>=7&&function(e,t){const n=e.size,i=d.getEncodedBits(t);let r,a,o;for(let t=0;t<18;t++)r=Math.floor(t/3),a=t%3+n-8-3,o=1==(i>>t&1),e.set(r,a,o,!0),e.set(a,r,o,!0)}(_,t),function(e,t){const n=e.size;let i=-1,r=n-1,a=7,o=0;for(let s=n-1;s>0;s-=2)for(6===s&&s--;;){for(let n=0;n<2;n++)if(!e.isReserved(r,s-n)){let i=!1;o<t.length&&(i=1==(t[o]>>>a&1)),e.set(r,s-n,i),a--,-1===a&&(o++,a=7)}if(r+=i,r<0||n<=r){r-=i,i=-i;break}}}(_,y),isNaN(r)&&(r=l.getBestMask(_,m.bind(null,_,n))),l.applyMask(r,_),m(_,n,r),{modules:_,version:t,errorCorrectionLevel:n,maskPattern:r,segments:p}}t.create=function(e,t){if(void 0===e||""===e)throw new Error("No input text");let n,a,o=r.M;return void 0!==t&&(o=r.from(t.errorCorrectionLevel,r.M),n=d.from(t.version),a=l.from(t.maskPattern),t.toSJISFunc&&i.setToSJISFunction(t.toSJISFunc)),v(e,n,o,a)}},764:(e,t,n)=>{const i=n(713);function r(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}r.prototype.initialize=function(e){this.degree=e,this.genPoly=i.generateECPolynomial(this.degree)},r.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const t=new Uint8Array(e.length+this.degree);t.set(e);const n=i.mod(t,this.genPoly),r=this.degree-n.length;if(r>0){const e=new Uint8Array(this.degree);return e.set(n,r),e}return n},e.exports=r},44:(e,t)=>{const n="[0-9]+";let i="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";i=i.replace(/u/g,"\\u");const r="(?:(?![A-Z0-9 $%*+\\-./:]|"+i+")(?:.|[\r\n]))+";t.KANJI=new RegExp(i,"g"),t.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),t.BYTE=new RegExp(r,"g"),t.NUMERIC=new RegExp(n,"g"),t.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");const a=new RegExp("^"+i+"$"),o=new RegExp("^"+n+"$"),s=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");t.testKanji=function(e){return a.test(e)},t.testNumeric=function(e){return o.test(e)},t.testAlphanumeric=function(e){return s.test(e)}},801:(e,t,n)=>{const i=n(208),r=n(357),a=n(433),o=n(822),s=n(861),u=n(44),l=n(886),h=n(320);function c(e){return unescape(encodeURIComponent(e)).length}function d(e,t,n){const i=[];let r;for(;null!==(r=e.exec(n));)i.push({data:r[0],index:r.index,mode:t,length:r[0].length});return i}function p(e){const t=d(u.NUMERIC,i.NUMERIC,e),n=d(u.ALPHANUMERIC,i.ALPHANUMERIC,e);let r,a;return l.isKanjiModeEnabled()?(r=d(u.BYTE,i.BYTE,e),a=d(u.KANJI,i.KANJI,e)):(r=d(u.BYTE_KANJI,i.BYTE,e),a=[]),t.concat(n,r,a).sort((function(e,t){return e.index-t.index})).map((function(e){return{data:e.data,mode:e.mode,length:e.length}}))}function f(e,t){switch(t){case i.NUMERIC:return r.getBitsLength(e);case i.ALPHANUMERIC:return a.getBitsLength(e);case i.KANJI:return s.getBitsLength(e);case i.BYTE:return o.getBitsLength(e)}}function g(e,t){let n;const u=i.getBestModeForData(e);if(n=i.from(t,u),n!==i.BYTE&&n.bit<u.bit)throw new Error('"'+e+'" cannot be encoded with mode '+i.toString(n)+".\n Suggested mode is: "+i.toString(u));switch(n!==i.KANJI||l.isKanjiModeEnabled()||(n=i.BYTE),n){case i.NUMERIC:return new r(e);case i.ALPHANUMERIC:return new a(e);case i.KANJI:return new s(e);case i.BYTE:return new o(e)}}t.fromArray=function(e){return e.reduce((function(e,t){return"string"==typeof t?e.push(g(t,null)):t.data&&e.push(g(t.data,t.mode)),e}),[])},t.fromString=function(e,n){const r=function(e){const t=[];for(let n=0;n<e.length;n++){const r=e[n];switch(r.mode){case i.NUMERIC:t.push([r,{data:r.data,mode:i.ALPHANUMERIC,length:r.length},{data:r.data,mode:i.BYTE,length:r.length}]);break;case i.ALPHANUMERIC:t.push([r,{data:r.data,mode:i.BYTE,length:r.length}]);break;case i.KANJI:t.push([r,{data:r.data,mode:i.BYTE,length:c(r.data)}]);break;case i.BYTE:t.push([{data:r.data,mode:i.BYTE,length:c(r.data)}])}}return t}(p(e,l.isKanjiModeEnabled())),a=function(e,t){const n={},r={start:{}};let a=["start"];for(let o=0;o<e.length;o++){const s=e[o],u=[];for(let e=0;e<s.length;e++){const l=s[e],h=""+o+e;u.push(h),n[h]={node:l,lastCount:0},r[h]={};for(let e=0;e<a.length;e++){const o=a[e];n[o]&&n[o].node.mode===l.mode?(r[o][h]=f(n[o].lastCount+l.length,l.mode)-f(n[o].lastCount,l.mode),n[o].lastCount+=l.length):(n[o]&&(n[o].lastCount=l.length),r[o][h]=f(l.length,l.mode)+4+i.getCharCountIndicator(l.mode,t))}}a=u}for(let e=0;e<a.length;e++)r[a[e]].end=0;return{map:r,table:n}}(r,n),o=h.find_path(a.map,"start","end"),s=[];for(let e=1;e<o.length-1;e++)s.push(a.table[o[e]].node);return t.fromArray(s.reduce((function(e,t){const n=e.length-1>=0?e[e.length-1]:null;return n&&n.mode===t.mode?(e[e.length-1].data+=t.data,e):(e.push(t),e)}),[]))},t.rawSplit=function(e){return t.fromArray(p(e,l.isKanjiModeEnabled()))}},886:(e,t)=>{let n;const i=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];t.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return 4*e+17},t.getSymbolTotalCodewords=function(e){return i[e]},t.getBCHDigit=function(e){let t=0;for(;0!==e;)t++,e>>>=1;return t},t.setToSJISFunction=function(e){if("function"!=typeof e)throw new Error('"toSJISFunc" is not a valid function.');n=e},t.isKanjiModeEnabled=function(){return void 0!==n},t.toSJIS=function(e){return n(e)}},878:(e,t)=>{t.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}},427:(e,t,n)=>{const i=n(886),r=n(518),a=n(953),o=n(208),s=n(878),u=i.getBCHDigit(7973);function l(e,t){return o.getCharCountIndicator(e,t)+4}function h(e,t){let n=0;return e.forEach((function(e){const i=l(e.mode,t);n+=i+e.getBitsLength()})),n}t.from=function(e,t){return s.isValid(e)?parseInt(e,10):t},t.getCapacity=function(e,t,n){if(!s.isValid(e))throw new Error("Invalid QR Code version");void 0===n&&(n=o.BYTE);const a=8*(i.getSymbolTotalCodewords(e)-r.getTotalCodewordsCount(e,t));if(n===o.MIXED)return a;const u=a-l(n,e);switch(n){case o.NUMERIC:return Math.floor(u/10*3);case o.ALPHANUMERIC:return Math.floor(u/11*2);case o.KANJI:return Math.floor(u/13);case o.BYTE:default:return Math.floor(u/8)}},t.getBestVersionForData=function(e,n){let i;const r=a.from(n,a.M);if(Array.isArray(e)){if(e.length>1)return function(e,n){for(let i=1;i<=40;i++)if(h(e,i)<=t.getCapacity(i,n,o.MIXED))return i}(e,r);if(0===e.length)return 1;i=e[0]}else i=e;return function(e,n,i){for(let r=1;r<=40;r++)if(n<=t.getCapacity(r,i,e))return r}(i.mode,i.getLength(),r)},t.getEncodedBits=function(e){if(!s.isValid(e)||e<7)throw new Error("Invalid QR Code version");let t=e<<12;for(;i.getBCHDigit(t)-u>=0;)t^=7973<<i.getBCHDigit(t)-u;return e<<12|t}},280:(e,t,n)=>{const i=n(726);t.render=function(e,t,n){let r=n,a=t;void 0!==r||t&&t.getContext||(r=t,t=void 0),t||(a=function(){try{return document.createElement("canvas")}catch(e){throw new Error("You need to specify a canvas element")}}()),r=i.getOptions(r);const o=i.getImageWidth(e.modules.size,r),s=a.getContext("2d"),u=s.createImageData(o,o);return i.qrToImageData(u.data,e,r),function(e,t,n){e.clearRect(0,0,t.width,t.height),t.style||(t.style={}),t.height=n,t.width=n,t.style.height=n+"px",t.style.width=n+"px"}(s,a,o),s.putImageData(u,0,0),a},t.renderToDataURL=function(e,n,i){let r=i;void 0!==r||n&&n.getContext||(r=n,n=void 0),r||(r={});const a=t.render(e,n,r),o=r.type||"image/png",s=r.rendererOpts||{};return a.toDataURL(o,s.quality)}},375:(e,t,n)=>{const i=n(726);function r(e,t){const n=e.a/255,i=t+'="'+e.hex+'"';return n<1?i+" "+t+'-opacity="'+n.toFixed(2).slice(1)+'"':i}function a(e,t,n){let i=e+t;return void 0!==n&&(i+=" "+n),i}t.render=function(e,t,n){const o=i.getOptions(t),s=e.modules.size,u=e.modules.data,l=s+2*o.margin,h=o.color.light.a?"<path "+r(o.color.light,"fill")+' d="M0 0h'+l+"v"+l+'H0z"/>':"",c="<path "+r(o.color.dark,"stroke")+' d="'+function(e,t,n){let i="",r=0,o=!1,s=0;for(let u=0;u<e.length;u++){const l=Math.floor(u%t),h=Math.floor(u/t);l||o||(o=!0),e[u]?(s++,u>0&&l>0&&e[u-1]||(i+=o?a("M",l+n,.5+h+n):a("m",r,0),r=0,o=!1),l+1<t&&e[u+1]||(i+=a("h",s),s=0)):r++}return i}(u,s,o.margin)+'"/>',d='viewBox="0 0 '+l+" "+l+'"',p='<svg xmlns="http://www.w3.org/2000/svg" '+(o.width?'width="'+o.width+'" height="'+o.width+'" ':"")+d+' shape-rendering="crispEdges">'+h+c+"</svg>\n";return"function"==typeof n&&n(null,p),p}},726:(e,t)=>{function n(e){if("number"==typeof e&&(e=e.toString()),"string"!=typeof e)throw new Error("Color should be defined as hex string");let t=e.slice().replace("#","").split("");if(t.length<3||5===t.length||t.length>8)throw new Error("Invalid hex color: "+e);3!==t.length&&4!==t.length||(t=Array.prototype.concat.apply([],t.map((function(e){return[e,e]})))),6===t.length&&t.push("F","F");const n=parseInt(t.join(""),16);return{r:n>>24&255,g:n>>16&255,b:n>>8&255,a:255&n,hex:"#"+t.slice(0,6).join("")}}t.getOptions=function(e){e||(e={}),e.color||(e.color={});const t=void 0===e.margin||null===e.margin||e.margin<0?4:e.margin,i=e.width&&e.width>=21?e.width:void 0,r=e.scale||4;return{width:i,scale:i?4:r,margin:t,color:{dark:n(e.color.dark||"#000000ff"),light:n(e.color.light||"#ffffffff")},type:e.type,rendererOpts:e.rendererOpts||{}}},t.getScale=function(e,t){return t.width&&t.width>=e+2*t.margin?t.width/(e+2*t.margin):t.scale},t.getImageWidth=function(e,n){const i=t.getScale(e,n);return Math.floor((e+2*n.margin)*i)},t.qrToImageData=function(e,n,i){const r=n.modules.size,a=n.modules.data,o=t.getScale(r,i),s=Math.floor((r+2*i.margin)*o),u=i.margin*o,l=[i.color.light,i.color.dark];for(let t=0;t<s;t++)for(let n=0;n<s;n++){let h=4*(t*s+n),c=i.color.light;t>=u&&n>=u&&t<s-u&&n<s-u&&(c=l[a[Math.floor((t-u)/o)*r+Math.floor((n-u)/o)]?1:0]),e[h++]=c.r,e[h++]=c.g,e[h++]=c.b,e[h]=c.a}}},838:(e,t,n)=>{!function(){var e="undefined"!=typeof window?window:n.g,i={};for(var r in function(e,t,n){var i;function r(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var a="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},o=function(n){n=["object"==typeof globalThis&&globalThis,n,"object"==typeof e&&e,"object"==typeof self&&self,"object"==typeof t&&t];for(var i=0;i<n.length;++i){var r=n[i];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);function s(e,t){if(t)e:{var n=o;e=e.split(".");for(var i=0;i<e.length-1;i++){var r=e[i];if(!(r in n))break e;n=n[r]}(t=t(i=n[e=e[e.length-1]]))!=i&&null!=t&&a(n,e,{configurable:!0,writable:!0,value:t})}}function u(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function l(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:r(e)}}function h(e){if(!(e instanceof Array)){e=l(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}s("Symbol",(function(e){function t(e,t){this.g=e,a(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.g};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",i=0;return function e(r){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(r||"")+"_"+i++,r)}})),s("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),n=0;n<t.length;n++){var i=o[t[n]];"function"==typeof i&&"function"!=typeof i.prototype[e]&&a(i.prototype,e,{configurable:!0,writable:!0,value:function(){return u(r(this))}})}return e}));var c,d="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)c=Object.setPrototypeOf;else{var p;e:{var f={};try{f.__proto__={a:!0},p=f.a;break e}catch(e){}p=!1}c=p?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var g=c;function m(e,t){if(e.prototype=d(t.prototype),e.prototype.constructor=e,g)g(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var i=Object.getOwnPropertyDescriptor(t,n);i&&Object.defineProperty(e,n,i)}else e[n]=t[n];e.Bk=t.prototype}function v(){this.s=!1,this.l=null,this.h=void 0,this.g=1,this.j=this.m=0,this.C=this.i=null}function y(e){if(e.s)throw new TypeError("Generator is already running");e.s=!0}function b(e,t){e.i={Qg:t,$g:!0},e.g=e.m||e.j}function _(e,t,n){return e.g=n,{value:t}}function w(e){e.g=0}function S(e,t,n){e.m=t,null!=n&&(e.j=n)}function T(e,t){e.m=0,e.j=t||0}function A(e,t,n){e.g=t,e.m=n||0}function E(e,t){return e.m=t||0,t=e.i.Qg,e.i=null,t}function C(e){e.C=[e.i],e.m=0,e.j=0}function x(e,t){var n=e.C.splice(0)[0];(n=e.i=e.i||n)?n.$g?e.g=e.m||e.j:null!=n.F&&e.j<n.F?(e.g=n.F,e.i=null):e.g=e.j:e.g=t}function I(e){this.g=new v,this.h=e}function k(e,t,n,i){try{var r=t.call(e.g.l,n);if(!(r instanceof Object))throw new TypeError("Iterator result "+r+" is not an object");if(!r.done)return e.g.s=!1,r;var a=r.value}catch(t){return e.g.l=null,b(e.g,t),M(e)}return e.g.l=null,i.call(e.g,a),M(e)}function M(e){for(;e.g.g;)try{var t=e.h(e.g);if(t)return e.g.s=!1,{value:t.value,done:!1}}catch(t){e.g.h=void 0,b(e.g,t)}if(e.g.s=!1,e.g.i){if(t=e.g.i,e.g.i=null,t.$g)throw t.Qg;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function P(e){this.next=function(t){return y(e.g),e.g.l?t=k(e,e.g.l.next,t,e.g.u):(e.g.u(t),t=M(e)),t},this.throw=function(t){return y(e.g),e.g.l?t=k(e,e.g.l.throw,t,e.g.u):(b(e.g,t),t=M(e)),t},this.return=function(t){return function(e,t){y(e.g);var n=e.g.l;return n?k(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),M(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function L(e){return function(e){function t(t){return e.next(t)}function n(t){return e.throw(t)}return new Promise((function(i,r){!function e(a){a.done?i(a.value):Promise.resolve(a.value).then(t,n).then(e,r)}(e.next())}))}(new P(new I(e)))}function D(){for(var e=Number(this),t=[],n=e;n<arguments.length;n++)t[n-e]=arguments[n];return t}function R(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function N(e,t){e instanceof String&&(e+="");var n=0,i=!1,r={next:function(){if(!i&&n<e.length){var r=n++;return{value:t(r,e[r]),done:!1}}return i=!0,{done:!0,value:void 0}}};return r[Symbol.iterator]=function(){return r},r}function O(e,t,n){e instanceof String&&(e=String(e));for(var i=e.length,r=0;r<i;r++){var a=e[r];if(t.call(n,a,r,e))return{Xg:r,v:a}}return{Xg:-1,v:void 0}}function U(e,t,n){if(null==e)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return e+""}v.prototype.u=function(e){this.h=e},v.prototype.return=function(e){this.i={return:e},this.g=this.j},v.prototype.F=function(e){this.g=e},s("Promise",(function(e){function t(e){this.h=0,this.i=void 0,this.g=[],this.s=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function n(){this.g=null}function i(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.h=function(e){if(null==this.g){this.g=[];var t=this;this.i((function(){t.l()}))}this.g.push(e)};var r=o.setTimeout;n.prototype.i=function(e){r(e,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.j(e)}}}this.g=null},n.prototype.j=function(e){this.i((function(){throw e}))},t.prototype.j=function(){function e(e){return function(i){n||(n=!0,e.call(t,i))}}var t=this,n=!1;return{resolve:e(this.H),reject:e(this.l)}},t.prototype.H=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.J(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.G(e):this.m(e)}},t.prototype.G=function(e){var t=void 0;try{t=e.then}catch(e){return void this.l(e)}"function"==typeof t?this.K(t,e):this.m(e)},t.prototype.l=function(e){this.u(2,e)},t.prototype.m=function(e){this.u(1,e)},t.prototype.u=function(e,t){if(0!=this.h)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.h);this.h=e,this.i=t,2===this.h&&this.I(),this.C()},t.prototype.I=function(){var e=this;r((function(){if(e.D()){var t=o.console;void 0!==t&&t.error(e.i)}}),1)},t.prototype.D=function(){if(this.s)return!1;var e=o.CustomEvent,t=o.Event,n=o.dispatchEvent;return void 0===n||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=o.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.i,n(e))},t.prototype.C=function(){if(null!=this.g){for(var e=0;e<this.g.length;++e)a.h(this.g[e]);this.g=null}};var a=new n;return t.prototype.J=function(e){var t=this.j();e.Zd(t.resolve,t.reject)},t.prototype.K=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function i(e,t){return"function"==typeof e?function(t){try{r(e(t))}catch(e){a(e)}}:t}var r,a,o=new t((function(e,t){r=e,a=t}));return this.Zd(i(e,r),i(n,a)),o},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.Zd=function(e,t){function n(){switch(i.h){case 1:e(i.i);break;case 2:t(i.i);break;default:throw Error("Unexpected state: "+i.h)}}var i=this;null==this.g?a.h(n):this.g.push(n),this.s=!0},t.resolve=i,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var r=l(e),a=r.next();!a.done;a=r.next())i(a.value).Zd(t,n)}))},t.all=function(e){var n=l(e),r=n.next();return r.done?i([]):new t((function(e,t){function a(t){return function(n){o[t]=n,0==--s&&e(o)}}var o=[],s=0;do{o.push(void 0),s++,i(r.value).Zd(a(o.length-1),t),r=n.next()}while(!r.done)}))},t})),s("WeakMap",(function(e){function t(e){if(this.g=(u+=Math.random()+1).toString(),e){e=l(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function n(){}function i(e){var t=typeof e;return"object"===t&&null!==e||"function"===t}function r(e){if(!R(e,s)){var t=new n;a(e,s,{value:t})}}function o(e){var t=Object[e];t&&(Object[e]=function(e){return e instanceof n?e:(Object.isExtensible(e)&&r(e),t(e))})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),i=new e([[t,2],[n,3]]);return 2==i.get(t)&&3==i.get(n)&&(i.delete(t),i.set(n,4),!i.has(t)&&4==i.get(n))}catch(e){return!1}}())return e;var s="$jscomp_hidden_"+Math.random();o("freeze"),o("preventExtensions"),o("seal");var u=0;return t.prototype.set=function(e,t){if(!i(e))throw Error("Invalid WeakMap key");if(r(e),!R(e,s))throw Error("WeakMap key fail: "+e);return e[s][this.g]=t,this},t.prototype.get=function(e){return i(e)&&R(e,s)?e[s][this.g]:void 0},t.prototype.has=function(e){return i(e)&&R(e,s)&&R(e[s],this.g)},t.prototype.delete=function(e){return!!(i(e)&&R(e,s)&&R(e[s],this.g))&&delete e[s][this.g]},t})),s("Map",(function(e){function t(){var e={};return e.Pb=e.next=e.head=e}function n(e,t){var n=e.g;return u((function(){if(n){for(;n.head!=e.g;)n=n.Pb;for(;n.next!=n.head;)return n=n.next,{done:!1,value:t(n)};n=null}return{done:!0,value:void 0}}))}function i(e,t){var n=t&&typeof t;"object"==n||"function"==n?a.has(t)?n=a.get(t):(n=""+ ++o,a.set(t,n)):n="p_"+t;var i=e.h[n];if(i&&R(e.h,n))for(e=0;e<i.length;e++){var r=i[e];if(t!=t&&r.key!=r.key||t===r.key)return{id:n,list:i,index:e,entry:r}}return{id:n,list:i,index:-1,entry:void 0}}function r(e){if(this.h={},this.g=t(),this.size=0,e){e=l(e);for(var n;!(n=e.next()).done;)n=n.value,this.set(n[0],n[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(l([[t,"s"]]));if("s"!=n.get(t)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var i=n.entries(),r=i.next();return!r.done&&r.value[0]==t&&"s"==r.value[1]&&!((r=i.next()).done||4!=r.value[0].x||"t"!=r.value[1]||!i.next().done)}catch(e){return!1}}())return e;var a=new WeakMap;r.prototype.set=function(e,t){var n=i(this,e=0===e?0:e);return n.list||(n.list=this.h[n.id]=[]),n.entry?n.entry.value=t:(n.entry={next:this.g,Pb:this.g.Pb,head:this.g,key:e,value:t},n.list.push(n.entry),this.g.Pb.next=n.entry,this.g.Pb=n.entry,this.size++),this},r.prototype.delete=function(e){return!(!(e=i(this,e)).entry||!e.list||(e.list.splice(e.index,1),e.list.length||delete this.h[e.id],e.entry.Pb.next=e.entry.next,e.entry.next.Pb=e.entry.Pb,e.entry.head=null,this.size--,0))},r.prototype.clear=function(){this.h={},this.g=this.g.Pb=t(),this.size=0},r.prototype.has=function(e){return!!i(this,e).entry},r.prototype.get=function(e){return(e=i(this,e).entry)&&e.value},r.prototype.entries=function(){return n(this,(function(e){return[e.key,e.value]}))},r.prototype.keys=function(){return n(this,(function(e){return e.key}))},r.prototype.values=function(){return n(this,(function(e){return e.value}))},r.prototype.forEach=function(e,t){for(var n,i=this.entries();!(n=i.next()).done;)n=n.value,e.call(t,n[1],n[0],this)},r.prototype[Symbol.iterator]=r.prototype.entries;var o=0;return r})),s("Array.prototype.keys",(function(e){return e||function(){return N(this,(function(e){return e}))}})),s("Set",(function(e){function t(e){if(this.g=new Map,e){e=l(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.g.size}return function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(l([t]));if(!n.has(t)||1!=n.size||n.add(t)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var i=n.entries(),r=i.next();return!r.done&&r.value[0]==t&&r.value[1]==t&&!(r=i.next()).done&&r.value[0]!=t&&4==r.value[0].x&&r.value[1]==r.value[0]&&i.next().done}catch(e){return!1}}()?e:(t.prototype.add=function(e){return e=0===e?0:e,this.g.set(e,e),this.size=this.g.size,this},t.prototype.delete=function(e){return e=this.g.delete(e),this.size=this.g.size,e},t.prototype.clear=function(){this.g.clear(),this.size=0},t.prototype.has=function(e){return this.g.has(e)},t.prototype.entries=function(){return this.g.entries()},t.prototype.values=function(){return this.g.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var n=this;this.g.forEach((function(i){return e.call(t,i,i,n)}))},t)})),s("Array.from",(function(e){return e||function(e,t,n){t=null!=t?t:function(e){return e};var i=[],r="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if("function"==typeof r){e=r.call(e);for(var a=0;!(r=e.next()).done;)i.push(t.call(n,r.value,a++))}else for(r=e.length,a=0;a<r;a++)i.push(t.call(n,e[a],a));return i}})),s("Array.prototype.findIndex",(function(e){return e||function(e,t){return O(this,e,t).Xg}})),s("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}})),s("Array.prototype.includes",(function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var i=n.length;for(0>(t=t||0)&&(t=Math.max(t+i,0));t<i;t++){var r=n[t];if(r===e||Object.is(r,e))return!0}return!1}})),s("String.prototype.includes",(function(e){return e||function(e,t){return-1!==U(this,e,"includes").indexOf(e,t||0)}})),s("Array.prototype.find",(function(e){return e||function(e,t){return O(this,e,t).v}})),s("String.prototype.startsWith",(function(e){return e||function(e,t){var n=U(this,e,"startsWith"),i=n.length,r=e.length;t=Math.max(0,Math.min(0|t,n.length));for(var a=0;a<r&&t<i;)if(n[t++]!=e[a++])return!1;return a>=r}})),s("WeakSet",(function(e){function t(e){if(this.g=new WeakMap,e){e=l(e);for(var t;!(t=e.next()).done;)this.add(t.value)}}return function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),i=new e([t]);return!(!i.has(t)||i.has(n))&&(i.delete(t),i.add(n),!i.has(t)&&i.has(n))}catch(e){return!1}}()?e:(t.prototype.add=function(e){return this.g.set(e,!0),this},t.prototype.has=function(e){return this.g.has(e)},t.prototype.delete=function(e){return this.g.delete(e)},t)}));var B="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i)for(var r in i)R(i,r)&&(e[r]=i[r])}return e};s("Object.assign",(function(e){return e||B})),s("Array.prototype.values",(function(e){return e||function(){return N(this,(function(e,t){return t}))}})),s("Promise.prototype.finally",(function(e){return e||function(e){return this.then((function(t){return Promise.resolve(e()).then((function(){return t}))}),(function(t){return Promise.resolve(e()).then((function(){throw t}))}))}})),s("Array.prototype.entries",(function(e){return e||function(){return N(this,(function(e,t){return[e,t]}))}})),s("String.prototype.repeat",(function(e){return e||function(e){var t=U(this,null,"repeat");if(0>e||1342177279<e)throw new RangeError("Invalid count value");e|=0;for(var n="";e;)1&e&&(n+=t),(e>>>=1)&&(t+=t);return n}})),s("Number.isNaN",(function(e){return e||function(e){return"number"==typeof e&&isNaN(e)}})),s("Number.isFinite",(function(e){return e||function(e){return"number"==typeof e&&!isNaN(e)&&1/0!==e&&-1/0!==e}})),s("Object.values",(function(e){return e||function(e){var t,n=[];for(t in e)R(e,t)&&n.push(e[t]);return n}})),s("Math.log2",(function(e){return e||function(e){return Math.log(e)/Math.LN2}})),s("Number.MAX_SAFE_INTEGER",(function(){return 9007199254740991})),s("Math.trunc",(function(e){return e||function(e){if(e=Number(e),isNaN(e)||1/0===e||-1/0===e||0===e)return e;var t=Math.floor(Math.abs(e));return 0>e?-t:t}})),s("Object.entries",(function(e){return e||function(e){var t,n=[];for(t in e)R(e,t)&&n.push([t,e[t]]);return n}}));var F=this||self;function G(e,t){e=e.split(".");var n,i=F;e[0]in i||void 0===i.execScript||i.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?i=i[n]&&i[n]!==Object.prototype[n]?i[n]:i[n]={}:i[n]=t}function j(t,n){if(n)if(n instanceof Map)for(var i=l(n.keys()),r=i.next();!r.done;r=i.next())r=r.value,Object.defineProperty(this,r,{value:n.get(r),writable:!0,enumerable:!0});else for(i in n)Object.defineProperty(this,i,{value:n[i],writable:!0,enumerable:!0});this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=e.performance&&e.performance.now?e.performance.now():Date.now(),this.type=t,this.isTrusted=!1,this.target=this.currentTarget=null,this.g=!1}function H(e){var t,n=new j(e.type);for(t in e)Object.defineProperty(n,t,{value:e[t],writable:!0,enumerable:!0});return n}j.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},j.prototype.stopImmediatePropagation=function(){this.g=!0},j.prototype.stopPropagation=function(){},G("shaka.util.FakeEvent",j);var V={Aj:"abrstatuschanged",Bj:"adaptation",Cj:"buffering",Dj:"complete",Ej:"downloadfailed",Fj:"downloadheadersreceived",Gj:"drmsessionupdate",Ij:"emsg",Yj:"prft",Error:"error",Jj:"expirationupdated",Kj:"firstquartile",Lj:"gapjumped",Oj:"keystatuschanged",Qj:"loaded",Rj:"loading",Tj:"manifestparsed",Uj:"manifestupdated",Vj:"mediaqualitychanged",Metadata:"metadata",Wj:"midpoint",Xj:"onstatechange",$j:"ratechange",bk:"segmentappended",ck:"sessiondata",dk:"stalldetected",ek:"started",fk:"statechanged",gk:"streaming",hk:"textchanged",ik:"texttrackvisibility",jk:"thirdquartile",kk:"timelineregionadded",lk:"timelineregionenter",nk:"timelineregionexit",pk:"trackschanged",rk:"unloading",vk:"variantchanged"};function W(){}function z(){}function X(){}function K(e){var t=D.apply(1,arguments);q.has(e)||(q.add(e),X.apply(W,h(t)))}function Y(){}var q=new Set;function Z(){this.g={}}function J(){this.Aa=new Z,this.we=this}function Q(e,t){for(var n=[],i=(e=l(e)).next();!i.done;i=e.next())n.push(t(i.value));return n}function $(e,t){for(var n=(e=l(e)).next();!n.done;n=e.next())if(t(n.value))return!0;return!1}function ee(e,t){for(var n=[],i=(e=l(e)).next();!i.done;i=e.next())t(i=i.value)&&n.push(i);return n}e.console&&(X=function(){return console.warn.apply(console,h(D.apply(0,arguments)))},z=function(){console.error.apply(console,h(D.apply(0,arguments)))}),(i=Z.prototype).push=function(e,t){this.g.hasOwnProperty(e)?this.g[e].push(t):this.g[e]=[t]},i.get=function(e){return(e=this.g[e])?e.slice():null},i.remove=function(e,t){e in this.g&&(this.g[e]=this.g[e].filter((function(e){return e!=t})),0==this.g[e].length&&delete this.g[e])},i.forEach=function(e){for(var t in this.g)e(t,this.g[t])},i.size=function(){return Object.keys(this.g).length},i.keys=function(){return Object.keys(this.g)},J.prototype.addEventListener=function(e,t){this.Aa&&this.Aa.push(e,t)},J.prototype.removeEventListener=function(e,t){this.Aa&&this.Aa.remove(e,t)},J.prototype.dispatchEvent=function(e){if(!this.Aa)return!0;var t=this.Aa.get(e.type)||[],n=this.Aa.get("All");for(n&&(t=t.concat(n)),n=(t=l(t)).next();!n.done;n=t.next()){n=n.value,e.target=this.we,e.currentTarget=this.we;try{n.handleEvent?n.handleEvent(e):n.call(this,e)}catch(e){}if(e.g)break}return e.defaultPrevented},J.prototype.release=function(){this.Aa=null};var te=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");function ne(e){var t;e instanceof ne?(ie(this,e.wb),this.Bc=e.Bc,re(this,e.Kb),ae(this,e.Tc),this.Ya=e.Ya,oe(this,e.g.clone()),this.pc=e.pc):e&&(t=String(e).match(te))?(ie(this,t[1]||"",!0),this.Bc=se(t[2]||""),re(this,t[3]||"",!0),ae(this,t[4]),this.Ya=se(t[5]||"",!0),oe(this,t[6]||"",!0),this.pc=se(t[7]||"")):this.g=new ge(null)}function ie(e,t,n){e.wb=n?se(t,!0):t,e.wb&&(e.wb=e.wb.replace(/:$/,""))}function re(e,t,n){e.Kb=n?se(t,!0):t}function ae(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.Tc=t}else e.Tc=null}function oe(e,t,n){t instanceof ge?e.g=t:(n||(t=ue(t,pe)),e.g=new ge(t))}function se(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""}function ue(e,t,n){return null!=e?(e=encodeURI(e).replace(t,le),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function le(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}(i=ne.prototype).wb="",i.Bc="",i.Kb="",i.Tc=null,i.Ya="",i.pc="",i.toString=function(){var e=[],t=this.wb;if(t&&e.push(ue(t,he,!0),":"),t=this.Kb){e.push("//");var n=this.Bc;n&&e.push(ue(n,he,!0),"@"),e.push(encodeURIComponent(t).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.Tc)&&e.push(":",String(t))}return(t=this.Ya)&&(this.Kb&&"/"!=t.charAt(0)&&e.push("/"),e.push(ue(t,"/"==t.charAt(0)?de:ce,!0))),(t=this.g.toString())&&e.push("?",t),(t=this.pc)&&e.push("#",ue(t,fe)),e.join("")},i.resolve=function(e){var t=this.clone();"data"===t.wb&&(t=new ne);var n=!!e.wb;n?ie(t,e.wb):n=!!e.Bc,n?t.Bc=e.Bc:n=!!e.Kb,n?re(t,e.Kb):n=null!=e.Tc;var i=e.Ya;if(n)ae(t,e.Tc);else if(n=!!e.Ya){if("/"!=i.charAt(0))if(this.Kb&&!this.Ya)i="/"+i;else{var r=t.Ya.lastIndexOf("/");-1!=r&&(i=t.Ya.substr(0,r+1)+i)}if(".."==i||"."==i)i="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var a=[],o=0;o<i.length;){var s=i[o++];"."==s?r&&o==i.length&&a.push(""):".."==s?((1<a.length||1==a.length&&""!=a[0])&&a.pop(),r&&o==i.length&&a.push("")):(a.push(s),r=!0)}i=a.join("/")}}return n?t.Ya=i:n=""!==e.g.toString(),n?oe(t,e.g.clone()):n=!!e.pc,n&&(t.pc=e.pc),t},i.clone=function(){return new ne(this)};var he=/[#\/\?@]/g,ce=/[#\?:]/g,de=/[#\?]/g,pe=/[#\?@]/g,fe=/#/g;function ge(e){this.g=e||null}function me(e){if(!e.Oa&&(e.Oa={},e.rd=0,e.g))for(var t=e.g.split("&"),n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var a=t[n].substring(0,i);r=t[n].substring(i+1)}else a=t[n];a=decodeURIComponent(a.replace(/\+/g," ")),r=r||"",e.add(a,decodeURIComponent(r.replace(/\+/g," ")))}}function ve(e){return me(e),e.rd}function ye(e,t,n){var i=D.apply(3,arguments);if(this.severity=e,this.category=t,this.code=n,this.data=i,this.handled=!1,this.message="Shaka Error "+this.code,be)try{throw Error(this.message||"Shaka Error")}catch(e){this.stack=e.stack}}(i=ge.prototype).Oa=null,i.rd=null,i.add=function(e,t){me(this),this.g=null;var n=this.Oa.hasOwnProperty(e)?this.Oa[e]:null;return n||(this.Oa[e]=n=[]),n.push(t),this.rd++,this},i.set=function(e,t){return me(this),this.g=null,this.Oa.hasOwnProperty(e)?this.Oa[e]=[t]:this.add(e,t),this},i.get=function(e){return me(this),this.Oa[e]||[]},i.toString=function(){if(this.g)return this.g;if(!this.Oa)return"";var e,t=[];for(e in this.Oa)for(var n=encodeURIComponent(e),i=this.Oa[e],r=0;r<i.length;r++){var a=n;""!==i[r]&&(a+="="+encodeURIComponent(i[r])),t.push(a)}return this.g=t.join("&")},i.clone=function(){var e=new ge;if(e.g=this.g,this.Oa){var t,n={};for(t in this.Oa)n[t]=this.Oa[t].concat();e.Oa=n,e.rd=this.rd}return e},ye.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},G("shaka.util.Error",ye);var be=!0;function _e(e,t){if(0==t.length)return e;if(1==e.length&&1==t.length){var n=new ne(e[0]);return t=new ne(t[0]),[n.resolve(t).toString()]}t=t.map((function(e){return new ne(e)})),n=[];for(var i=(e=l(e)).next();!i.done;i=e.next()){i=new ne(i.value);for(var r=l(t),a=r.next();!a.done;a=r.next())n.push(i.resolve(a.value).toString())}return n}function we(e,t){return{keySystem:e,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:t||[],keyIds:new Set}}function Se(e,t){if(1==t.length)return t[0];if(null!=(e=Te(e,t)))return e;throw new ye(2,4,4025,t)}function Te(e,t){for(var n=l(Ce[e]),i=n.next();!i.done;i=n.next()){i=i.value;for(var r=l(t),a=r.next();!a.done;a=r.next())if(a=a.value,i.test(a.trim()))return a.trim()}return e==Ae?"":null}ye.Severity={RECOVERABLE:1,CRITICAL:2},ye.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9,ADS:10},ye.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,ATTEMPTS_EXHAUSTED:1010,SEGMENT_MISSING:1011,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,INVALID_MP4_CEA:2010,TEXT_COULD_NOT_GUESS_MIME_TYPE:2011,CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS:2012,TEXT_ONLY_WEBVTT_SRC_EQUALS:2013,MISSING_TEXT_PLUGIN:2014,CHAPTERS_TRACK_FAILED:2015,UNSUPPORTED_EXTERNAL_THUMBNAILS_URI:2017,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,CONTENT_TRANSFORMATION_FAILED:3019,MSS_MISSING_DATA_FOR_TRANSMUXING:3020,MSS_TRANSMUXING_CODEC_UNKNOWN:3021,MSS_TRANSMUXING_FAILED:3022,TRANSMUXING_NO_VIDEO_DATA:3023,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,RESTRICTIONS_CANNOT_BE_MET:4012,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,NO_VARIANTS:4036,PERIOD_FLATTENING_FAILED:4037,INCONSISTENT_DRM_ACROSS_PERIODS:4038,HLS_VARIABLE_NOT_FOUND:4039,HLS_MSE_ENCRYPTED_MP2T_NOT_SUPPORTED:4040,HLS_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED:4041,NO_WEB_CRYPTO_API:4042,CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_LIVE_STREAM:4045,MSS_INVALID_XML:4046,MSS_LIVE_CONTENT_NOT_SUPPORTED:4047,AES_128_INVALID_IV_LENGTH:4048,AES_128_INVALID_KEY_LENGTH:4049,DASH_CONFLICTING_AES_128:4050,DASH_UNSUPPORTED_AES_128:4051,STREAMING_ENGINE_STARTUP_INVALID_STATE:5006,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,SERVER_CERTIFICATE_REQUEST_FAILED:6017,MIN_HDCP_VERSION_NOT_MATCH:6018,ERROR_CHECKING_HDCP_VERSION:6019,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,OBJECT_DESTROYED:7003,CONTENT_NOT_LOADED:7004,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013,STORAGE_LIMIT_REACHED:9014,DOWNLOAD_SIZE_CALLBACK_ERROR:9015,MODIFY_OPERATION_NOT_SUPPORTED:9016,INDEXED_DB_INIT_TIMED_OUT:9017,CS_IMA_SDK_MISSING:1e4,CS_AD_MANAGER_NOT_INITIALIZED:10001,SS_IMA_SDK_MISSING:10002,SS_AD_MANAGER_NOT_INITIALIZED:10003,CURRENT_DAI_REQUEST_NOT_FINISHED:10004,MT_AD_MANAGER_NOT_INITIALIZED:10005};var Ae="text",Ee={ia:"video",U:"audio",Da:Ae,cf:"image",yj:"application"},Ce={audio:[/^vorbis$/,/^Opus$/,/^opus$/,/^fLaC$/,/^flac$/,/^mp4a/,/^[ae]c-3$/,/^ac-4$/,/^dts[cex]$/],video:[/^avc/,/^hev/,/^hvc/,/^vvc/,/^vvi/,/^vp0?[89]/,/^av01/,/^dvh/],text:[/^vtt$/,/^wvtt/,/^stpp/]};function xe(){}function Ie(e,t){return e=Pe(e),t=Pe(t),e.split("-")[0]==t.split("-")[0]}function ke(e,t){return e=Pe(e),t=Pe(t),e=e.split("-"),t=t.split("-"),e[0]==t[0]&&1==e.length&&2==t.length}function Me(e,t){return e=Pe(e),t=Pe(t),e=e.split("-"),t=t.split("-"),2==e.length&&2==t.length&&e[0]==t[0]}function Pe(e){var t=(e=l(e.split("-x-"))).next().value;t=void 0===t?"":t,e=void 0===(e=e.next().value)?"":e;var n=l(t.split("-"));return t=void 0===(t=n.next().value)?"":t,n=void 0===(n=n.next().value)?"":n,e=e?"x-"+e:"",t=t.toLowerCase(),t=Ue.get(t)||t,((n=n.toUpperCase())?t+"-"+n:t)+(e?"-"+e:"")}function Le(e,t){var n=Re(e),i=Re(t);return e!=n&&t!=i&&n==i}function De(e,t){return e=Pe(e),(t=Pe(t))==e?4:ke(t,e)?3:Me(t,e)?2:ke(e,t)?1:0}function Re(e){var t=e.indexOf("-");return e=(e=0<=t?e.substring(0,t):e).toLowerCase(),Ue.get(e)||e}function Ne(e){return e.language?Pe(e.language):e.audio&&e.audio.language?Pe(e.audio.language):e.video&&e.video.language?Pe(e.video.language):"und"}function Oe(e,t){e=Pe(e);var n=new Set,i=l(t);for(t=i.next();!t.done;t=i.next())n.add(Pe(t.value));for(t=(i=l(n)).next();!t.done;t=i.next())if((t=t.value)==e)return t;for(t=(i=l(n)).next();!t.done;t=i.next())if(ke(t=t.value,e))return t;for(t=(i=l(n)).next();!t.done;t=i.next())if(Me(t=t.value,e))return t;for(t=(n=l(n)).next();!t.done;t=n.next())if(ke(e,t=t.value))return t;return null}G("shaka.util.LanguageUtils",xe),xe.findClosestLocale=Oe,xe.getLocaleForVariant=Ne,xe.getLocaleForText=function(e){return Pe(e.language||"und")},xe.getBase=Re,xe.relatedness=De,xe.areSiblings=Le,xe.normalize=Pe,xe.isSiblingOf=Me,xe.isParentOf=ke,xe.areLanguageCompatible=Ie,xe.areLocaleCompatible=function(e,t){return(e=Pe(e))==Pe(t)};var Ue=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function Be(e){J.call(this),this.j=Pe(e),this.i=new Map,this.g=new Set,this.h=new Map}function Fe(e){for(var t=e.h,n=e.j,i=e.g,r=new Set,a={},o=l(i),s=o.next();!s.done;a={Fc:a.Fc},s=o.next()){a.Fc=s.value,r.add(a.Fc),r.add(Re(a.Fc)),(s=ee(t.keys(),function(e){return function(t){return Le(t,e.Fc)}}(a))).sort();var u=l(s);for(s=u.next();!s.done;s=u.next())r.add(s.value);for((s=ee(t.keys(),function(e){return function(t){return Re(t)==e.Fc}}(a))).sort(),s=(u=l(s)).next();!s.done;s=u.next())r.add(s.value)}for(r.add(n),n=[],s=(r=l(r)).next();!s.done;s=r.next())(s=t.get(s.value))&&n.push(s);for(n.reverse(),e.i.clear(),s=(t=l(n)).next();!s.done;s=t.next())s.value.forEach((function(t,n){e.i.set(n,t)}));for(t=e.i.keys(),r=new Set,s=(n=l(e.g)).next();!s.done;s=n.next())Ge(s=e.h.get(s.value)||new Map,t,r);0<r.size&&(i=(new Map).set("locales",Array.from(i)).set("missing",Array.from(r)),e.dispatchEvent(new j("missing-localizations",i)))}function Ge(e,t,n){for(var i=(t=l(t)).next();!i.done;i=t.next())i=i.value,e.get(i)||n.add(i)}m(Be,J),(i=Be.prototype).release=function(){J.prototype.release.call(this)},i.Ig=function(e){var t=this;this.g.clear();for(var n=(e=l(e)).next();!n.done;n=e.next())this.g.add(Pe(n.value));Fe(this),(e=ee(this.g,(function(e){return!t.h.has(e)}))).length&&this.dispatchEvent(new j("unknown-locales",(new Map).set("locales",e))),e=ee(this.g,(function(e){return t.h.has(e)})),e=(new Map).set("locales",e.length?e:[this.j]),this.dispatchEvent(new j("locale-changed",e))},i.ya=function(e,t,n){e=Pe(e),void 0===n&&(n=je);var i=this.h.get(e)||new Map;return t.forEach((function(e,t){i.has(t)&&n!=je||i.set(t,e)})),this.h.set(e,i),Fe(this),this.dispatchEvent(new j("locale-updated")),this},i.ij=function(e){for(var t=l(e.keys()),n=t.next();!n.done;n=t.next())n=n.value,e.set(n,this.resolve(n))},i.resolve=function(e){return this.i.get(e)||(e=(new Map).set("locales",Array.from(this.g)).set("missing",e),this.dispatchEvent(new j("unknown-localization",e)),"")},i.bi=function(){return this.g},G("shaka.ui.Localization",Be),Be.prototype.getCurrentLocales=Be.prototype.bi,Be.prototype.resolve=Be.prototype.resolve,Be.prototype.resolveDictionary=Be.prototype.ij,Be.prototype.insert=Be.prototype.ya,Be.prototype.changeLocale=Be.prototype.Ig,Be.prototype.release=Be.prototype.release;var je=1;function He(e){this.g=Math.exp(Math.log(.5)/e),this.i=this.h=0}function Ve(e){return e.h/(1-Math.pow(e.g,e.i))}function We(){this.h=new He(2),this.j=new He(5),this.g=0,this.i=128e3,this.l=16e3}function ze(t){if(Ke.has(t))return Ke.get(t);if(e.ManagedMediaSource){var n=ManagedMediaSource.isTypeSupported(t);return Ke.set(t,n),n}return!!e.MediaSource&&(n=MediaSource.isTypeSupported(t),Ke.set(t,n),n)}function Xe(){return!!e.SourceBuffer&&!!SourceBuffer.prototype&&!!SourceBuffer.prototype.changeType}Be.ConflictResolution={USE_OLD:0,USE_NEW:je},Be.UNKNOWN_LOCALES="unknown-locales",Be.UNKNOWN_LOCALIZATION="unknown-localization",Be.MISSING_LOCALIZATIONS="missing-localizations",Be.LOCALE_CHANGED="locale-changed",Be.LOCALE_UPDATED="locale-updated",He.prototype.sample=function(e,t){var n=Math.pow(this.g,e);t=t*(1-n)+n*this.h,isNaN(t)||(this.h=t,this.i+=e)},We.prototype.configure=function(e){this.i=e.minTotalBytes,this.l=e.minBytes,this.h.g=Math.exp(Math.log(.5)/e.fastHalfLife),this.j.g=Math.exp(Math.log(.5)/e.slowHalfLife)},We.prototype.sample=function(e,t){if(!(t<this.l)){var n=8e3*t/e;e/=1e3,this.g+=t,this.h.sample(e,n),this.j.sample(e,n)}},We.prototype.getBandwidthEstimate=function(e){return this.g<this.i?e:Math.min(Ve(this.h),Ve(this.j))};var Ke=new Map;function Ye(){}function qe(){}function Ze(){}function Je(e,t){if(!e&&!t)return!0;if(!e||!t||e.byteLength!=t.byteLength)return!1;if(Qe(e)==Qe(t)&&(e.byteOffset||0)==(t.byteOffset||0))return!0;var n=et(e);t=et(t);for(var i=0;i<e.byteLength;i++)if(n[i]!=t[i])return!1;return!0}function Qe(e){return e instanceof ArrayBuffer?e:e.buffer}function $e(e){return e instanceof ArrayBuffer?e:0==e.byteOffset&&e.byteLength==e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer}function et(e,t,n){return it(e,void 0===t?0:t,n=void 0===n?1/0:n,Uint8Array)}function tt(e,t,n){return it(e,void 0===t?0:t,n=void 0===n?1/0:n,Uint16Array)}function nt(e,t,n){return it(e,void 0===t?0:t,n=void 0===n?1/0:n,DataView)}function it(e,t,n,i){var r=Qe(e),a=1;"BYTES_PER_ELEMENT"in i&&(a=i.BYTES_PER_ELEMENT);var o=((e.byteOffset||0)+e.byteLength)/a;return new i(r,e=Math.floor(Math.max(0,Math.min(((e.byteOffset||0)+t)/a,o))),Math.floor(Math.min(e+Math.max(n,0),o))-e)}function rt(){}function at(e){this.l=new qe,(e=ot[e.toLowerCase()])&&(this.l=e()),this.g=new Ye,(e=st)&&(this.g=e())}Ye.prototype.extract=function(){},Ye.prototype.decode=function(){return[]},Ye.prototype.clear=function(){},Ye.prototype.getStreams=function(){return[]},qe.prototype.init=function(){},qe.prototype.parse=function(){return[]},G("shaka.util.BufferUtils",Ze),Ze.toDataView=nt,Ze.toUint16=tt,Ze.toUint8=et,Ze.toArrayBuffer=$e,Ze.equal=Je,rt.prototype.init=function(){},rt.prototype.i=function(){},rt.prototype.h=function(){},rt.prototype.j=function(){},G("shaka.media.IClosedCaptionParser",rt),at.prototype.init=function(e){this.l.init(e)},at.prototype.i=function(e){for(var t=(e=l(e=this.l.parse(e))).next();!t.done;t=e.next()){var n=et((t=t.value).packet);0<n.length&&this.g.extract(n,t.pts)}return this.g.decode()},at.prototype.h=function(){this.g.clear()},at.prototype.j=function(){return this.g.getStreams()},G("shaka.media.ClosedCaptionParser",at),at.findDecoder=function(){return st},at.unregisterDecoder=function(){st=null},at.registerDecoder=function(e){st=e},at.findParser=function(e){return ot[e]},at.unregisterParser=function(e){delete ot[e]},at.registerParser=function(e,t){ot[e]=t};var ot={},st=null;function ut(e,t){return!("number"!=typeof e||"number"!=typeof t||!isNaN(e)||!isNaN(t))||e===t}function lt(e,t){-1<(t=e.indexOf(t))&&e.splice(t,1)}function ht(e,t,n){if(n||(n=ut),e.length!=t.length)return!1;t=t.slice();for(var i={},r=(e=l(e)).next();!r.done;i={Ue:i.Ue},r=e.next()){if(i.Ue=r.value,-1==(r=t.findIndex(function(e){return function(t){return n(e.Ue,t)}}(i))))return!1;t[r]=t[t.length-1],t.pop()}return 0==t.length}function ct(e,t,n){if(n||(n=ut),e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(!n(e[i],t[i]))return!1;return!0}function dt(e,t,n){this.startTime=e,this.endTime=t,this.payload=n,this.region=new Mt,this.position=null,this.positionAlign=gt,this.size=0,this.textAlign=mt,this.direction=_t,this.writingMode=wt,this.lineInterpretation=St,this.line=null,this.lineHeight="",this.lineAlign=Tt,this.displayAlign=yt,this.fontSize=this.border=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=xt,this.fontStyle=It,this.linePadding=this.letterSpacing=this.fontFamily="",this.opacity=1,this.textCombineUpright="",this.textDecoration=[],this.textStrokeWidth=this.textStrokeColor=this.textShadow="",this.wrapLine=!0,this.id="",this.nestedCues=[],this.lineBreak=this.isContainer=!1,this.rubyTag=null,this.cellResolution={mc:32,rows:15}}function pt(e,t){return(e=new dt(e,t,"")).lineBreak=!0,e}function ft(e,t){if(e.startTime!=t.startTime||e.endTime!=t.endTime||e.payload!=t.payload)return!1;for(var n in e)if("startTime"!=n&&"endTime"!=n&&"payload"!=n)if("nestedCues"==n){if(!ct(e.nestedCues,t.nestedCues,ft))return!1}else if("region"==n||"cellResolution"==n){for(var i in e[n])if(e[n][i]!=t[n][i])return!1}else if(Array.isArray(e[n])){if(!ct(e[n],t[n]))return!1}else if(e[n]!=t[n])return!1;return!0}dt.prototype.clone=function(){var e,t=new dt(0,0,"");for(e in this)t[e]=this[e],t[e]&&t[e].constructor==Array&&(t[e]=t[e].slice());return t},G("shaka.text.Cue",dt),dt.equal=ft,dt.prototype.clone=dt.prototype.clone;var gt="auto";dt.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:gt};var mt="center",vt={LEFT:"left",RIGHT:"right",CENTER:mt,START:"start",END:"end"};dt.textAlign=vt;var yt="after",bt={BEFORE:"before",CENTER:"center",AFTER:yt};dt.displayAlign=bt;var _t="ltr";dt.direction={HORIZONTAL_LEFT_TO_RIGHT:_t,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var wt="horizontal-tb";dt.writingMode={HORIZONTAL_TOP_TO_BOTTOM:wt,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var St=0;dt.lineInterpretation={LINE_NUMBER:St,PERCENTAGE:1};var Tt="start",At={CENTER:"center",START:Tt,END:"end"};dt.lineAlign=At;var Et={white:"white",lime:"lime",cyan:"cyan",red:"red",yellow:"yellow",magenta:"magenta",blue:"blue",black:"black"};dt.defaultTextColor=Et;var Ct={bg_white:"white",bg_lime:"lime",bg_cyan:"cyan",bg_red:"red",bg_yellow:"yellow",bg_magenta:"magenta",bg_blue:"blue",bg_black:"black"};dt.defaultTextBackgroundColor=Ct;var xt=400;dt.fontWeight={NORMAL:xt,BOLD:700};var It="normal",kt={NORMAL:It,ITALIC:"italic",OBLIQUE:"oblique"};function Mt(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=Pt,this.scroll=Lt}dt.fontStyle=kt,dt.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"},G("shaka.text.CueRegion",Mt);var Pt=1;Mt.units={PX:0,PERCENTAGE:Pt,LINES:2};var Lt="";function Dt(){}function Rt(e,t,n){Ot[e.toLowerCase().split(";")[0]+"-"+n]={priority:n,Ge:t}}function Nt(e,t){for(var n=e.toLowerCase().split(";")[0],i=l([Gt,Ft,Bt,Ut]),r=i.next();!r.done;r=i.next())if(r=Ot[n+"-"+r.value]){var a=r.Ge(),o=a.isSupported(e,t);if(a.destroy(),o)return r.Ge}return null}Mt.scrollMode={NONE:Lt,UP:"up"},Dt.prototype.destroy=function(){},G("shaka.transmuxer.TransmuxerEngine",Dt),Dt.findTransmuxer=Nt,Dt.unregisterTransmuxer=function(e,t){delete Ot[e.toLowerCase().split(";")[0]+"-"+t]},Dt.registerTransmuxer=Rt,Dt.prototype.destroy=Dt.prototype.destroy;var Ot={},Ut=1,Bt=2,Ft=3,Gt=4;function jt(){}function Ht(e,t){var n=e;return t&&!Zt.includes(e)&&(n+='; codecs="'+t+'"'),n}function Vt(e,t){return t&&(e+='; codecs="'+t+'"'),e}function Wt(e,t,n){var i=Ht(e,t);return Nt(t=Vt(e,t))?(e=Nt(t))?(n=(e=e()).convertCodecs(n,t),e.destroy()):n=t:n="video/mp2t"!=e&&"audio"==n?i.replace("video","audio"):i,n}function zt(e){var t=qt(e);switch(e=t[0],t=t[1].toLowerCase(),!0){case"mp4a"===e&&"69"===t:case"mp4a"===e&&"6b"===t:case"mp4a"===e&&"40.34"===t:return"mp3";case"mp4a"===e&&"66"===t:case"mp4a"===e&&"67"===t:case"mp4a"===e&&"68"===t:case"mp4a"===e&&"40.2"===t:case"mp4a"===e&&"40.02"===t:case"mp4a"===e&&"40.5"===t:case"mp4a"===e&&"40.05"===t:case"mp4a"===e&&"40.29"===t:case"mp4a"===e&&"40.42"===t:return"aac";case"mp4a"===e&&"a5"===t:return"ac-3";case"mp4a"===e&&"a6"===t:return"ec-3";case"mp4a"===e&&"b2"===t:return"dtsx";case"mp4a"===e&&"a9"===t:return"dtsc";case"avc1"===e:case"avc3"===e:return"avc";case"hvc1"===e:case"hev1"===e:return"hevc";case"dvh1"===e:case"dvhe"===e:return"dovi"}return e}function Xt(e){for(var t=[],n=(e=l(e.split(","))).next();!n.done;n=e.next())n=qt(n.value),t.push(n[0]);return t.sort().join(",")}function Kt(e){return e.split(";")[0]}function Yt(e){return(e=e.split(/ *; */)).shift(),(e=e.find((function(e){return e.startsWith("codecs=")})))?e.split("=")[1].replace(/^"|"$/g,""):""}function qt(e){var t=(e=e.split("."))[0];return e.shift(),[t,e.join(".")]}Dt.PluginPriority={FALLBACK:Ut,PREFERRED_SECONDARY:Bt,PREFERRED:Ft,APPLICATION:Gt},G("shaka.util.MimeUtils",jt),jt.getFullTypeWithAllCodecs=Vt,jt.getFullType=Ht,(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");var Zt=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"];function Jt(e){this.i=null,this.j=e,this.C=!1,this.l=this.u=0,this.m=1/0,this.h=this.g=null,this.D="",this.s=new Map}function Qt(e){return!!tn[e]||("application/cea-608"==e||"application/cea-708"==e)&&!!st}function $t(e,t,n){if(e.D=t,t=e.s.get(t))for(var i=l(t.keys()),r=i.next();!r.done;r=i.next())(r=t.get(r.value).filter((function(e){return e.endTime<=n})))&&e.j.append(r)}function en(e,t,n){t.startTime+=n,t.endTime+=n;for(var i=(t=l(t.nestedCues)).next();!i.done;i=t.next())en(e,i.value,n)}Jt.prototype.destroy=function(){return this.j=this.i=null,this.s.clear(),Promise.resolve()},Jt.prototype.remove=function(e,t){var n=this;return L((function(i){if(1==i.g)return _(i,Promise.resolve(),2);!n.j||!n.j.remove(e,t)||null==n.g||t<=n.g||e>=n.h||(e<=n.g&&t>=n.h?n.g=n.h=null:e<=n.g&&t<n.h?n.g=t:e>n.g&&t>=n.h&&(n.h=e)),w(i)}))},G("shaka.text.TextEngine",Jt),Jt.prototype.destroy=Jt.prototype.destroy,Jt.findParser=function(e){return tn[e]},Jt.unregisterParser=function(e){delete tn[e]},Jt.registerParser=function(e,t){tn[e]=t};var tn={};function nn(e,t){return e.concat(t)}function rn(){}function an(e){return null!=e}function on(e){var t=new WeakSet;return function e(n){switch(typeof n){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return n;default:if(!n||n.buffer&&n.buffer.constructor==ArrayBuffer)return n;if(t.has(n))return null;var i=n.constructor==Array;if(n.constructor!=Object&&!i)return null;t.add(n);var r,a=i?[]:{};for(r in n)a[r]=e(n[r]);return i&&(a.length=n.length),a}}(e)}function sn(e){var t,n={};for(t in e)n[t]=e[t];return n}function un(e){this.h=e,this.g=null}function ln(e){this.h=e,this.g=null}function hn(){var t=e.ManagedMediaSource||e.MediaSource;return!(!t||!t.isTypeSupported)}function cn(e){return""!=Tn().canPlayType(e)}function dn(){return!!navigator.userAgent.match(/Edge?\//)}function pn(){return Sn("Xbox One")}function fn(){return Sn("Tizen")}function gn(){return Sn("Tizen 3")}function mn(){return Sn("Tizen 2")}function vn(){return Sn("Web0S")&&Sn("Chrome/38.0.2125.122 Safari/537.36")}function yn(){return Sn("CrKey")}function bn(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!fn()&&!Sn("PC=EOS")&&!Sn("PC=APL")&&!Sn("VirginMedia")&&!Sn("SOPOpenBrowser")&&!_n()&&!Sn("AFT")&&!Sn("WPE")}function _n(){return Sn("PlayStation 4")}function wn(){if(!bn())return null;var e=navigator.userAgent.match(/Version\/(\d+)/);return e||(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null}function Sn(e){return(navigator.userAgent||"").includes(e)}function Tn(){return En||(An||(An=new ln((function(){En=null}))),(En=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(En=document.createElement("video")),An.S(1),En)}un.prototype.S=function(t){var n=this;this.stop();var i=!0,r=null;return this.g=function(){e.clearTimeout(r),i=!1},r=e.setTimeout((function(){i&&n.h()}),1e3*t),this},un.prototype.stop=function(){this.g&&(this.g(),this.g=null)},ln.prototype.Qa=function(){return this.stop(),this.h(),this},ln.prototype.S=function(e){var t=this;return this.stop(),this.g=new un((function(){t.h()})).S(e),this},ln.prototype.za=function(e){var t=this;return this.stop(),this.g=new un((function(){t.g.S(e),t.h()})).S(e),this},ln.prototype.stop=function(){this.g&&(this.g.stop(),this.g=null)},G("shaka.util.Timer",ln),ln.prototype.stop=ln.prototype.stop,ln.prototype.tickEvery=ln.prototype.za,ln.prototype.tickAfter=ln.prototype.S,ln.prototype.tickNow=ln.prototype.Qa;var An=null,En=null;function Cn(){}function xn(e,t,n,i){var r=e.variants;if((t.length||n.length)&&(r=function(e,t,n){for(var i={},r=(t=l(t)).next();!r.done;i={bf:i.bf},r=t.next())if(i.bf=r.value,r=e.filter(function(e){return function(t){return t.video&&t.video.codecs.startsWith(e.bf)}}(i)),r.length){e=r;break}for(i={},t=(n=l(n)).next();!t.done;i={Se:i.Se},t=n.next())if(i.Se=t.value,t=e.filter(function(e){return function(t){return t.audio&&t.audio.codecs.startsWith(e.Se)}}(i)),t.length){e=t;break}return e}(r,t,n)),i.length){for(t=new Z,r=(n=l(r)).next();!r.done;r=n.next())r=r.value,t.push(String(r.video.width||0),r);var a=[];t.forEach((function(e,t){e=0;for(var n=[],r={},o=(t=l(t)).next();!o.done;r={md:r.md},o=t.next())r.md=o.value,(o=i.filter(function(e){return function(t){return e.md.decodingInfos[0][t]}}(r)).length)>e?(e=o,n=[r.md]):o==e&&n.push(r.md);a.push.apply(a,h(n))})),r=a}n=new Set,t=new Set;var o=l(r);for(r=o.next();!r.done;r=o.next())(r=r.value).audio&&n.add(r.audio),r.video&&t.add(r.video);n=Array.from(n).sort((function(e,t){return e.bandwidth-t.bandwidth}));var s=[];for(r=new Map,o=(n=l(n)).next();!o.done;o=n.next()){var u=(o=o.value).language+(o.channelsCount||0)+(o.audioSamplingRate||0)+o.roles.join(",")+o.label+o.groupId+o.fastSwitching,c=r.get(u)||[];if(c.length){var d=c[c.length-1],p=zt(d.codecs),f=zt(o.codecs);p==f&&o.bandwidth>d.bandwidth&&(c.push(o),s.push(o.id))}else c.push(o),s.push(o.id);r.set(u,c)}n=Array.from(t).sort((function(e,t){return e.bandwidth&&t.bandwidth?e.bandwidth-t.bandwidth:e.width-t.width})),t=Xe();var g=[];for(r=new Map,o=(n=l(n)).next();!o.done;o=n.next()){if(o=o.value,u=Math.round(o.frameRate||0)+(o.hdr||"")+o.fastSwitching,(c=r.get(u)||[]).length){if(d=c[c.length-1],!t&&(p=zt(d.codecs))!==(f=zt(o.codecs)))continue;(o.width>d.width||o.height>d.height||o.width==d.width&&o.height==d.height&&(p=zt(d.codecs))==(f=zt(o.codecs))&&o.bandwidth>d.bandwidth)&&(c.push(o),g.push(o.id))}else c.push(o),g.push(o.id);r.set(u,c)}e.variants=e.variants.filter((function(e){var t=e.audio;return e=e.video,!(t&&!s.includes(t.id)||e&&!g.includes(e.id))}))}function In(e,t,n){function i(e,t,n){return e>=t&&e<=n}var r=e.video;return!(r&&r.width&&r.height&&(!i(r.width,t.minWidth,Math.min(t.maxWidth,n.width))||!i(r.height,t.minHeight,Math.min(t.maxHeight,n.height))||!i(r.width*r.height,t.minPixels,t.maxPixels))||e&&e.video&&e.video.frameRate&&!i(e.video.frameRate,t.minFrameRate,t.maxFrameRate)||!i(e.bandwidth,t.minBandwidth,t.maxBandwidth))}function kn(e,t,n){for(var i=!1,r=(e=l(e)).next();!r.done;r=e.next()){var a=(r=r.value).allowedByApplication;r.allowedByApplication=In(r,t,n),a!=r.allowedByApplication&&(i=!0)}return i}function Mn(e,t,n){var i,r,a,o,s;return L((function(u){if(1==u.g)return _(u,Dn(t.variants,n,!1,[]),2);i=null,e&&(r=e.g)&&(i=r.keySystem),a=Ee,o=pn(),s=Sn("Firefox")&&Sn("Android"),t.variants=t.variants.filter((function(e){var t=e.video,n=t&&t.width||0,r=t&&t.height||0;if(o&&t&&(1920<n||1080<r)&&(t.codecs.includes("avc1.")||t.codecs.includes("avc3.")))return Yn(e),!1;if(t){if(n=On(t.codecs),t.codecs.includes(",")){if(r=t.codecs.split(","),n=On(n=Se(a.ia,r)),r=Nn(r=Se(a.U,r)),!ze(Wt(t.mimeType,r,a.U)))return!1;n=[n,r].join()}if(!ze(r=Wt(t.mimeType,n,a.ia)))return!1;t.codecs=n}if(t=e.audio,s&&t&&t.encrypted&&t.codecs.toLowerCase().includes("opus"))return Yn(e),!1;if(t){if(n=Nn(t.codecs),!ze(r=Wt(t.mimeType,n,a.U)))return!1;t.codecs=n}return(t=e.decodingInfos.some((function(e){return!(!e.supported||i&&(e=e.keySystemAccess)&&e.keySystem!=i)})))||Yn(e),t})),w(u)}))}function Pn(e){var t=[];for(n in e)t.push(n);t.sort();for(var n=[],i=(t=l(t)).next();!i.done;i=t.next()){var r=i.value;i=JSON.stringify(r),(r=e[r])instanceof Object?(r=Pn(r),n.push(i+":"+r)):(r=JSON.stringify(r),n.push(i+":"+r))}return"{"+n.join(",")+"}"}function Ln(e,t){var n,i,r,a,o,s,u;return L((function(h){if(1==h.g)return n=Pn(t),(i=Zn)[n]?(e.decodingInfos.push(i[n]),h.F(0)):_(h,function(e){var t=[""];e.video&&(t=Yt(e.video.contentType).split(","));var n=[""];e.audio&&(n=Yt(e.audio.contentType).split(","));for(var i=[],r=(t=l(t)).next();!r.done;r=t.next()){r=r.value;for(var a={},o=l(n),s=o.next();!s.done;a={ic:a.ic},s=o.next())s=s.value,a.ic=on(e),e.video&&(a.ic.video.contentType=Ht(Kt(a.ic.video.contentType),r)),e.audio&&(a.ic.audio.contentType=Ht(Kt(a.ic.audio.contentType),s)),i.push(new Promise(function(e){return function(t,n){navigator.mediaCapabilities.decodingInfo(e.ic).then((function(e){t(e)})).catch(n)}}(a)))}return Promise.all(i).catch((function(){return JSON.stringify(e),null}))}(t),3);if((r=h.h)&&r.length){for(a=null,o=l(r),s=o.next();!s.done;s=o.next())u=s.value,a?(a.supported=a.supported&&u.supported,a.powerEfficient=a.powerEfficient&&u.powerEfficient,a.smooth=a.smooth&&u.smooth,u.keySystemAccess||(a.keySystemAccess=null)):a=u;a&&(i[n]=a,e.decodingInfos.push(a))}w(h)}))}function Dn(e,t,n,i){var r,a,o,s,u,h,c,d,p,f,g,m,v,y,b,w;return L((function(S){switch(S.g){case 1:if(e.some((function(e){return e.decodingInfos.length})))return S.return();r={},a=l(i),o=a.next();case 2:if(o.done){S.F(4);break}r.We=o.value,s=!1,u=l(e),h=u.next();case 5:if(h.done){S.F(7);break}c=h.value,d=Rn(c,t,n).filter((T=r,function(e){return(e.keySystemConfiguration&&e.keySystemConfiguration.keySystem)===T.We})),p=l(d),f=p.next();case 8:if(f.done){S.F(10);break}return g=f.value,_(S,Ln(c,g),9);case 9:f=p.next(),S.F(8);break;case 10:c.decodingInfos.length&&(s=!0),h=u.next(),S.F(5);break;case 7:if(s)return S.return();r={We:r.We},o=a.next(),S.F(2);break;case 4:m=l(e),h=m.next();case 12:if(h.done){S.F(0);break}v=h.value,y=Rn(v,t,n).filter((function(e){return!(e=e.keySystemConfiguration&&e.keySystemConfiguration.keySystem)||!i.includes(e)})),b=l(y),f=b.next();case 15:if(f.done){h=m.next(),S.F(12);break}return w=f.value,_(S,Ln(v,w),16);case 16:f=b.next(),S.F(15)}var T}))}function Rn(e,t,n){var i=e.audio,r=e.video;if(n={type:n?"file":"media-source"},r){var a=r.codecs;if(r.codecs.includes(",")){var o=r.codecs.split(",");a=On(a=Se("video",o)),o=Nn(o=Se("audio",o)),o=Wt(r.mimeType,o,"audio"),n.audio={contentType:o,channels:2,bitrate:e.bandwidth||1,samplerate:1,spatialRendering:!1}}if(a=On(a),a=Wt(r.mimeType,a,"video"),n.video={contentType:a,width:r.width||64,height:r.height||64,bitrate:r.bandwidth||e.bandwidth||1,framerate:r.frameRate||1},r.hdr)switch(r.hdr){case"SDR":n.video.transferFunction="srgb";break;case"PQ":n.video.transferFunction="pq";break;case"HLG":n.video.transferFunction="hlg"}}if(i&&(a=Nn(i.codecs),a=Wt(i.mimeType,a,"audio"),n.audio={contentType:a,channels:i.channelsCount||2,bitrate:i.bandwidth||e.bandwidth||1,samplerate:i.audioSamplingRate||1,spatialRendering:i.spatialAudio}),!(o=(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])).length)return[n];e=[],a=new Map;for(var s=(o=l(o)).next();!s.done;s=o.next()){var u=s.value;a.get(u.keySystem)||a.set(u.keySystem,[]),a.get(u.keySystem).push(u)}o=t?"required":"optional",t=t?["persistent-license"]:["temporary"];for(var h=(u=l(a.keys())).next();!h.done;h=u.next()){var c=h.value;h=Object.assign({},n);var d=a.get(c);for(c={keySystem:c,initDataType:"cenc",persistentState:o,distinctiveIdentifier:"optional",sessionTypes:t},s=(d=l(d)).next();!s.done;s=d.next()){if((s=s.value).initData&&s.initData.length){for(var p=new Set,f=l(s.initData),g=f.next();!g.done;g=f.next())p.add(g.value.initDataType);c.initDataType=s.initData[0].initDataType}s.distinctiveIdentifierRequired&&(c.distinctiveIdentifier="required"),s.persistentStateRequired&&(c.persistentState="required"),s.sessionType&&(c.sessionTypes=[s.sessionType]),i&&(""!=s.audioRobustness?c.audio?c.audio.robustness=c.audio.robustness||s.audioRobustness:c.audio={robustness:s.audioRobustness}:c.audio||(c.audio={})),r&&(""!=s.videoRobustness?c.video?c.video.robustness=c.video.robustness||s.videoRobustness:c.video={robustness:s.videoRobustness}:c.video||(c.video={}))}h.keySystemConfiguration=c,e.push(h)}return e}function Nn(e){return"fLaC"!==e||wn()?"Opus"===e?"opus":e:"flac"}function On(e){if(e.includes("avc1")){var t=e.split(".");if(3==t.length)return e=t.shift()+".",(e+=parseInt(t.shift(),10).toString(16))+("000"+parseInt(t.shift(),10).toString(16)).slice(-4)}else if("vp9"==e)return"vp09.00.41.08";return e}function Un(e){var t=e.audio,n=e.video,i=t?t.mimeType:null,r=n?n.mimeType:null,a=t?t.codecs:null,o=n?n.codecs:null,s=[];o&&s.push(o),a&&s.push(a);var u=[];n&&u.push(n.mimeType),t&&u.push(t.mimeType),u=u[0]||null;var h=[];t&&h.push(t.kind),n&&h.push(n.kind),h=h[0]||null;var c=new Set;if(t)for(var d=l(t.roles),p=d.next();!p.done;p=d.next())c.add(p.value);if(n)for(p=(d=l(n.roles)).next();!p.done;p=d.next())c.add(p.value);return e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:h,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,videoLayout:null,mimeType:u,audioMimeType:i,videoMimeType:r,codecs:s.join(", "),audioCodec:a,videoCodec:o,primary:e.primary,roles:Array.from(c),audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:null},n&&(e.videoId=n.id,e.originalVideoId=n.originalId,e.width=n.width||null,e.height=n.height||null,e.frameRate=n.frameRate||null,e.pixelAspectRatio=n.pixelAspectRatio||null,e.videoBandwidth=n.bandwidth||null,e.hdr=n.hdr||null,e.videoLayout=n.videoLayout||null),t&&(e.audioId=t.id,e.originalAudioId=t.originalId,e.channelsCount=t.channelsCount,e.audioSamplingRate=t.audioSamplingRate,e.audioBandwidth=t.bandwidth||null,e.spatialAudio=t.spatialAudio,e.label=t.label,e.audioRoles=t.roles,e.accessibilityPurpose=t.accessibilityPurpose,e.originalLanguage=t.originalLanguage),e}function Bn(e){return{id:e.id,active:!1,type:Ae,bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,videoLayout:null,mimeType:e.mimeType,audioMimeType:null,videoMimeType:null,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,audioRoles:null,forced:e.forced,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:e.originalId,originalImageId:null,accessibilityPurpose:e.accessibilityPurpose,originalLanguage:e.originalLanguage}}function Fn(e){var t=e.width||null,n=e.height||null,i=null;e.segmentIndex&&(i=e.segmentIndex.get(0));var r=e.tilesLayout;return i&&(r=i.tilesLayout||r),r&&null!=t&&(t/=Number(r.split("x")[0])),r&&null!=n&&(n/=Number(r.split("x")[1])),{id:e.id,active:!1,type:"image",bandwidth:e.bandwidth||0,language:"",label:null,kind:null,width:t,height:n,frameRate:null,pixelAspectRatio:null,hdr:null,videoLayout:null,mimeType:e.mimeType,audioMimeType:null,videoMimeType:null,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:r||null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:e.originalId,accessibilityPurpose:null,originalLanguage:null}}function Gn(e){return e.__shaka_id||(e.__shaka_id=Jn++),e.__shaka_id}function jn(e){var t=Vn(e);return t.active="disabled"!=e.mode,t.type="text",t.originalTextId=e.id,"captions"==e.kind&&(t.mimeType="application/cea-608"),"subtitles"==e.kind&&(t.mimeType="text/vtt"),e.kind&&(t.roles=[e.kind]),"forced"==e.kind&&(t.forced=!0),t}function Hn(e){var t=Vn(e);return t.active=e.enabled,t.type="variant",t.originalAudioId=e.id,"main"==e.kind&&(t.primary=!0),e.kind&&(t.roles=[e.kind],t.audioRoles=[e.kind],t.label=e.label),t}function Vn(e){var t=e.language;return{id:Gn(e),active:!1,type:"",bandwidth:0,language:Pe(t||"und"),label:e.label,kind:e.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,videoLayout:null,mimeType:null,audioMimeType:null,videoMimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],forced:!1,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:t}}function Wn(e){return e.allowedByApplication&&e.allowedByKeySystem&&0==e.disabledUntilTime}function zn(e){return e.filter((function(e){return Wn(e)}))}function Xn(e,t,n,i){var r=e,a=e.filter((function(e){return e.primary}));a.length&&(r=a);var o=r.length?r[0].language:"";if(r=r.filter((function(e){return e.language==o})),t){var s=Oe(Pe(t),e.map((function(e){return e.language})));s&&(r=e.filter((function(e){return Pe(e.language)==s})))}if(r=r.filter((function(e){return e.forced==i})),n){if((e=Kn(r,n)).length)return e}else if(e=r.filter((function(e){return 0==e.roles.length})),e.length)return e;return e=r.map((function(e){return e.roles})).reduce(nn,[]),e.length?Kn(r,e[0]):r}function Kn(e,t){return e.filter((function(e){return e.roles.includes(t)}))}function Yn(e){var t=[];return e.audio&&t.push(qn(e.audio)),e.video&&t.push(qn(e.video)),t.join(", ")}function qn(e){return"audio"==e.type?"type=audio codecs="+e.codecs+" bandwidth="+e.bandwidth+" channelsCount="+e.channelsCount+" audioSamplingRate="+e.audioSamplingRate:"video"==e.type?"type=video codecs="+e.codecs+" bandwidth="+e.bandwidth+" frameRate="+e.frameRate+" width="+e.width+" height="+e.height:"unexpected stream type"}G("shaka.util.StreamUtils",Cn),Cn.meetsRestrictions=In;var Zn={},Jn=0,Qn=(new Map).set("image/svg+xml",!0).set("image/png",!0).set("image/jpeg",!0).set("image/jpg",!0),$n=(new Map).set("image/webp","data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA").set("image/avif","data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=");function ei(){var e=this;this.u=null,this.l=!1,this.i=new We,this.D=null,navigator.connection&&navigator.connection.addEventListener&&(this.D=function(){if(e.l&&e.g.useNetworkInformation){e.i=new We,e.g&&e.i.configure(e.g.advanced);var t=e.chooseVariant();t&&navigator.onLine&&e.u(t,e.g.clearBufferSwitch,e.g.safeMarginSwitch)}},navigator.connection.addEventListener("change",this.D)),this.s=[],this.G=1,this.I=!1,this.h=this.m=this.g=this.C=null,this.H=new ln((function(){if(e.g.restrictToElementSize){var t=e.chooseVariant();t&&e.u(t,e.g.clearBufferSwitch,e.g.safeMarginSwitch)}})),this.j=null}function ti(e){if(e.I){if(Date.now()-e.C<1e3*e.g.switchInterval)return}else{var t=e.i;if(!(t.g>=t.i))return;e.I=!0}t=e.chooseVariant(),e.getBandwidthEstimate(),t&&e.u(t,e.g.clearBufferSwitch,e.g.safeMarginSwitch)}function ni(e,t,n,i,r){if(e.j){var a=e.j.Ug();a&&(n=n.filter((function(e){return!e.bandwidth||!a||e.bandwidth<=a})))}return t&&(n=n.filter((function(e){return In(e,t,{width:r,height:i})}))),n.sort((function(e,t){return e.bandwidth-t.bandwidth}))}(i=ei.prototype).stop=function(){this.u=null,this.l=!1,this.s=[],this.G=1,this.m=this.C=null,this.h&&(this.h.disconnect(),this.h=null),this.H.stop(),this.j=null},i.release=function(){navigator.connection&&navigator.connection.removeEventListener&&(navigator.connection.removeEventListener("change",this.D),this.D=null),this.H=null},i.init=function(e){this.u=e},i.chooseVariant=function(t){t=void 0!==t&&t;var n=1/0,i=1/0;if(this.g.restrictToScreenSize&&(i=this.g.ignoreDevicePixelRatio?1:e.devicePixelRatio,n=e.screen.height*i,i*=e.screen.width),this.h&&this.g.restrictToElementSize){var r=this.g.ignoreDevicePixelRatio?1:e.devicePixelRatio;n=Math.min(n,this.m.clientHeight*r),i=Math.min(i,this.m.clientWidth*r)}var a=this.s.filter((function(e){return!(e.audio&&e.audio.fastSwitching||e.video&&e.video.fastSwitching)}));if(a.length||(a=this.s),r=a,t&&a.length!=this.s.length&&(r=this.s.filter((function(e){return!!(e.audio&&e.audio.fastSwitching||e.video&&e.video.fastSwitching)}))),t=ni(this,this.g.restrictions,r,1/0,1/0),1/0!=n||1/0!=i){for(t=function(e){for(var t=[],n=(e=l(e)).next();!n.done;n=e.next())(n=n.value.video)&&n.height&&n.width&&t.push({height:n.height,width:n.width});return t.sort((function(e,t){return e.width-t.width}))}(t),a=(t=l(t)).next();!a.done;a=t.next())if((a=a.value).height>=n&&a.width>=i){n=a.height,i=a.width;break}t=ni(this,this.g.restrictions,r,n,i)}for(n=this.getBandwidthEstimate(),r.length&&!t.length&&(t=[(t=ni(this,null,r,1/0,1/0))[0]]),i=t[0]||null,r=0;r<t.length;r++){a=t[r];for(var o=isNaN(this.G)?1:Math.abs(this.G),s=o*a.bandwidth/this.g.bandwidthDowngradeTarget,u={bandwidth:1/0},h=r+1;h<t.length;h++)if(a.bandwidth!=t[h].bandwidth){u=t[h];break}o=o*u.bandwidth/this.g.bandwidthUpgradeTarget,n>=s&&n<=o&&i.bandwidth!=a.bandwidth&&(i=a)}return this.C=Date.now(),i},i.enable=function(){this.l=!0},i.disable=function(){this.l=!1},i.segmentDownloaded=function(e,t,n){this.i.sample(e,t),n&&null!=this.C&&this.l&&ti(this)},i.trySuggestStreams=function(){null!=this.C&&this.l&&ti(this)},i.getBandwidthEstimate=function(){var e=this.g.defaultBandwidthEstimate;return navigator.connection&&navigator.connection.downlink&&this.g.useNetworkInformation&&(e=1e6*navigator.connection.downlink),e=this.i.getBandwidthEstimate(e),this.j?this.j.getBandwidthEstimate(e):e},i.setVariants=function(e){this.s=e},i.playbackRateChanged=function(e){this.G=e},i.setMediaElement=function(t){var n=this;this.m=t,this.h&&(this.h.disconnect(),this.h=null),this.m&&"ResizeObserver"in e&&(this.h=new ResizeObserver((function(){n.H.S(ii)})),this.h.observe(this.m))},i.setCmsdManager=function(e){this.j=e},i.configure=function(e){this.g=e,this.i&&this.g&&this.i.configure(this.g.advanced)},G("shaka.abr.SimpleAbrManager",ei),ei.prototype.configure=ei.prototype.configure,ei.prototype.setCmsdManager=ei.prototype.setCmsdManager,ei.prototype.setMediaElement=ei.prototype.setMediaElement,ei.prototype.playbackRateChanged=ei.prototype.playbackRateChanged,ei.prototype.setVariants=ei.prototype.setVariants,ei.prototype.getBandwidthEstimate=ei.prototype.getBandwidthEstimate,ei.prototype.trySuggestStreams=ei.prototype.trySuggestStreams,ei.prototype.segmentDownloaded=ei.prototype.segmentDownloaded,ei.prototype.disable=ei.prototype.disable,ei.prototype.enable=ei.prototype.enable,ei.prototype.chooseVariant=ei.prototype.chooseVariant,ei.prototype.init=ei.prototype.init,ei.prototype.release=ei.prototype.release,ei.prototype.stop=ei.prototype.stop;var ii=1;function ri(e,t){this.g=e,this.h=t}function ai(e,t){var n=new ri(5,0),i=ui,r=i.g,a=n.h-r.h;(0<(n.g-r.g||a)?i.i:i.h)(i.g,n,e,t)}function oi(e,t,n,i){X([n,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",i].join(" "))}function si(e,t,n,i){z([n,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",i].join(""))}ri.prototype.toString=function(){return"v"+this.g+"."+this.h};var ui=null;function li(e,t,n,i){for(n=void 0===n||n,i=void 0!==i&&i,this.h=e,this.g=new Set([e]),t=(e=l(t=t||[])).next();!t.done;t=e.next())this.add(t.value,n,i)}function hi(e,t,n,i){var r;if(!(r=!!e.audio!=!!t.audio||!!e.video!=!!t.video||e.language!=t.language)&&(r=e.audio&&t.audio)){r=e.audio;var a=t.audio;r=!!((!r.channelsCount||!a.channelsCount||2<r.channelsCount||2<a.channelsCount)&&r.channelsCount!=a.channelsCount||n&&!ci(r,a)||!di(r.roles,a.roles)||i&&r.groupId!==a.groupId)}return!(i=r)&&(i=e.video&&t.video)&&(e=e.video,t=t.video,i=!((!n||ci(e,t))&&di(e.roles,t.roles))),!i}function ci(e,t){if(e.mimeType!=t.mimeType)return!1;if(e=e.codecs.split(",").map((function(e){return Xt(e)})),t=t.codecs.split(",").map((function(e){return Xt(e)})),e.length!=t.length)return!1;e.sort(),t.sort();for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function di(e,t){if(e=new Set(e),t=new Set(t),e.delete("main"),t.delete("main"),e.size!=t.size)return!1;for(var n=(e=l(e)).next();!n.done;n=e.next())if(!t.has(n.value))return!1;return!0}function pi(e,t,n){t=void 0===t?"reload":t,n=void 0!==n&&n,this.i=e,this.h=t,this.g=n,this.j=new fi(e.language,"",e.audio&&e.audio.channelsCount?e.audio.channelsCount:0,"",!1,"","","",t,n)}function fi(e,t,n,i,r,a,o,s,u,l){this.u=e,this.C=t,this.h=n,this.i=i,this.D=r,this.l=a,this.g=void 0===o?"":o,this.j=void 0===s?"":s,this.m=void 0===u?"reload":u,this.s=void 0!==l&&l}function gi(){this.g=yi,this.h=(new Map).set(yi,2).set(vi,1)}function mi(e,t,n){e.h.set(yi,n).set(vi,t)}G("shaka.config.AutoShowText",{NEVER:0,ALWAYS:1,IF_PREFERRED_TEXT_LANGUAGE:2,IF_SUBTITLES_MAY_BE_NEEDED:3}),G("shaka.config.CodecSwitchingStrategy",{Zj:"reload",Eh:"smooth"}),li.prototype.add=function(e,t,n){return!!hi(this.h,e,void 0===t||t,void 0!==n&&n)&&(this.g.add(e),!0)},li.prototype.values=function(){return this.g.values()},pi.prototype.create=function(e){var t=this,n="smooth"==this.h&&Xe(),i=e.filter((function(e){return hi(t.i,e,!n,t.g)}));return i.length?new li(i[0],i,!n,this.g):this.j.create(e)},fi.prototype.create=function(t){var n=[];n=function(e,t){var n=Oe(t=Pe(t),e.map((function(e){return Ne(e)})));return n?e.filter((function(e){return n==Ne(e)})):[]}(t,this.u);var i=t.filter((function(e){return e.primary}));return t=function(e,t){return e.filter((function(e){return!!e.audio&&(t?e.audio.roles.includes(t):0==e.audio.roles.length)}))}(n=n.length?n:i.length?i:t,this.C),t.length&&(n=t),this.l&&(t=function(e,t){return e.filter((function(e){return!e.video||!e.video.videoLayout||e.video.videoLayout==t}))}(n,this.l),t.length&&(n=t)),this.i&&(t=function(t,n){return"AUTO"==n&&(n=e.matchMedia("(color-gamut: p3)").matches?"PQ":"SDR"),t.filter((function(e){return!e.video||!e.video.hdr||e.video.hdr==n}))}(n,this.i),t.length&&(n=t)),this.h&&(t=function(e,t){return e.filter((function(e){return!e.audio||!e.audio.channelsCount||e.audio.channelsCount==t}))}(n,this.h),t.length&&(n=t)),this.g&&(t=function(e,t){return e.filter((function(e){return!(!e.audio||!e.audio.label)&&e.audio.label.toLowerCase()==t.toLowerCase()}))}(n,this.g),t.length&&(n=t)),this.j&&(t=function(e,t){return e.filter((function(e){return!(!e.video||!e.video.label)&&e.video.label.toLowerCase()==t.toLowerCase()}))}(n,this.j),t.length&&(n=t)),t=function(e,t){return e.filter((function(e){return!e.audio||e.audio.spatialAudio==t}))}(n,this.D),t.length&&(n=t),new li(n[0],n,!("smooth"==this.m&&Xe()),this.s)};var vi=0,yi=1;function bi(e,t){var n=2,i=1e3,r=2,a=.5;this.l=null==e.maxAttempts?n:e.maxAttempts,this.j=null==e.baseDelay?i:e.baseDelay,this.s=null==e.fuzzFactor?a:e.fuzzFactor,this.m=null==e.backoffFactor?r:e.backoffFactor,this.g=0,this.h=this.j,(this.i=void 0!==t&&t)&&(this.g=1)}function _i(e){var t,n;return L((function(i){if(1==i.g){if(e.g>=e.l){if(!e.i)throw new ye(2,7,1010);e.g=1,e.h=e.j}return t=e.g,e.g++,0==t?i.return():(n=e.h*(1+(2*Math.random()-1)*e.s),_(i,new Promise((function(e){new ln(e).S(n/1e3)})),2))}e.h*=e.m,w(i)}))}function wi(){var e,t,n=new Promise((function(n,i){e=n,t=i}));return n.resolve=e,n.reject=t,n}function Si(e,t){this.promise=e,this.i=t,this.g=!1}function Ti(e){return new Si(Promise.reject(e),(function(){return Promise.resolve()}))}function Ai(){var e=Promise.reject(new ye(2,7,7001));return e.catch((function(){})),new Si(e,(function(){return Promise.resolve()}))}function Ei(e){return new Si(Promise.resolve(e),(function(){return Promise.resolve()}))}function Ci(e){return new Si(e,(function(){return e.catch((function(){}))}))}function xi(e){return new Si(Promise.all(e.map((function(e){return e.promise}))),(function(){return Promise.all(e.map((function(e){return e.abort()})))}))}function Ii(){this.g=[]}function ki(e,t){e.g.push(t.finally((function(){lt(e.g,t)})))}function Mi(e,t,n,i,r){J.call(this),this.i=!1,this.m=new Ii,this.g=new Set,this.h=new Set,this.l=e||null,this.j=t||null,this.u=n||null,this.C=i||null,this.D=r||null,this.s=!1}function Pi(e,t,n,i){n=n||Bi;var r=Fi[e];(!r||n>=r.priority)&&(Fi[e]={priority:n,Ge:t,$i:void 0!==i&&i})}function Li(e,t,n){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null,sessionId:null,drmInfo:null,initData:null,initDataType:null,streamDataCallback:void 0===n?null:n}}function Di(e,t,n,i,r,a,o,s){e.s&&(n.uris[a]=n.uris[a].replace("http://","https://")),0<a&&e.D&&e.D(t,i,n.uris[a],n.uris[a-1]);var u=new ne(n.uris[a]),l=u.wb,h=!1;l||(ie(u,l=(l=location.protocol).slice(0,-1)),n.uris[a]=u.toString()),l=l.toLowerCase();var c=(l=Fi[l])?l.Ge:null;if(!c)return Ti(new ye(2,1,1e3,u));var d,p=l.$i,f=null,g=null,m=!1,v=!1;return Ci(_i(r)).Fa((function(){if(e.i)return Ai();d=Date.now();var r=c(n.uris[a],n,t,(function(n,r,a){f&&f.stop(),g&&g.S(u/1e3),e.l&&t==Ui&&(e.l(n,r,Ri(i)),h=!0,s.g=a)}),(function(i){e.j&&e.j(i,n,t),v=!0}));if(!p)return r;var o=n.retryParameters.connectionTimeout;o&&(f=new ln((function(){m=!0,r.abort()}))).S(o/1e3);var u=n.retryParameters.stallTimeout;return u&&(g=new ln((function(){m=!0,r.abort()}))),r})).Fa((function(i){f&&f.stop(),g&&g.stop(),null==i.timeMs&&(i.timeMs=Date.now()-d);var r={response:i,Gi:h};return!v&&e.j&&e.j(i.headers,n,t),r}),(function(u){if(f&&f.stop(),g&&g.stop(),e.u){var l=null,h=0;u instanceof ye&&(l=u,1001==u.code&&(h=u.data[1])),e.u(n,l,h,m)}if(e.i)return Ai();if(m&&(u=new ye(1,1,1003,n.uris[a],t)),u instanceof ye){if(7001==u.code)throw u;if(1010==u.code)throw o;if(1==u.severity)return l=new j("retry",l=(new Map).set("error",u)),e.dispatchEvent(l),a=(a+1)%n.uris.length,Di(e,t,n,i,r,a,u,s)}throw u}))}function Ri(e){if(e){var t=e.segment;if(e=e.stream,t&&e&&e.fastSwitching&&t.Fd)return!1}return!0}function Ni(){this.g=0}function Oi(e,t,n){Si.call(this,e,t),this.h=n}wi.prototype.resolve=function(){},wi.prototype.reject=function(){},Si.prototype.abort=function(){return this.g=!0,this.i()},Si.prototype.finally=function(e){return this.promise.then((function(){return e(!0)}),(function(){return e(!1)})),this},Si.prototype.Fa=function(e,t){function n(n){return function(s){if(r.g&&n)a.reject(o);else{var u=n?e:t;u?i=function(e,t,n){try{var i=e(t);return i&&i.promise&&i.abort?(n.resolve(i.promise),function(){return i.abort()}):(n.resolve(i),function(){return Promise.resolve(i).then((function(){}),(function(){}))})}catch(e){return n.reject(e),function(){return Promise.resolve()}}}(u,s,a):(n?a.resolve:a.reject)(s)}}}function i(){return a.reject(o),r.abort()}var r=this,a=new wi,o=new ye(2,7,7001);return this.promise.then(n(!0),n(!1)),new Si(a,(function(){return i()}))},G("shaka.util.AbortableOperation",Si),Si.prototype.chain=Si.prototype.Fa,Si.prototype.finally=Si.prototype.finally,Si.all=xi,Si.prototype.abort=Si.prototype.abort,Si.notAbortable=Ci,Si.completed=Ei,Si.aborted=Ai,Si.failed=Ti,Ii.prototype.destroy=function(){for(var e=[],t=l(this.g),n=t.next();!n.done;n=t.next())(n=n.value).promise.catch((function(){})),e.push(n.abort());return this.g=[],Promise.all(e)},m(Mi,J),(i=Mi.prototype).mg=function(e){this.s=e},i.aj=function(e){this.g.add(e)},i.uj=function(e){this.g.delete(e)},i.Lh=function(){this.g.clear()},i.bj=function(e){this.h.add(e)},i.vj=function(e){this.h.delete(e)},i.Mh=function(){this.h.clear()},i.destroy=function(){return this.i=!0,this.g.clear(),this.h.clear(),J.prototype.release.call(this),this.m.destroy()},i.request=function(e,t,n){var i=this,r=new Ni;if(this.i){var a=Promise.reject(new ye(2,7,7001));return a.catch((function(){})),new Oi(a,(function(){return Promise.resolve()}),r)}t.method=t.method||"GET",t.headers=t.headers||{},t.retryParameters=t.retryParameters?on(t.retryParameters):{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},t.uris=on(t.uris),a=function(e,t,n,i){function r(e){a=a.Fa((function(){return n.body&&(n.body=$e(n.body)),e(t,n,i)}))}var a=Ei(void 0);e.C&&r(e.C);for(var o=(e=l(e.g)).next();!o.done;o=e.next())r(o.value);return a.Fa(void 0,(function(e){if(e instanceof ye&&7001==e.code)throw e;throw new ye(2,1,1006,e)}))}(this,e,t,n);var o=a.Fa((function(){return Di(i,e,t,n,new bi(t.retryParameters,!1),0,null,r)})),s=o.Fa((function(t){return function(e,t,n,i){for(var r=Ei(void 0),a={},o=(e=l(e.h)).next();!o.done;a={Ye:a.Ye},o=e.next())a.Ye=o.value,r=r.Fa(function(e){return function(){var r=n.response;return r.data&&(r.data=$e(r.data)),e.Ye(t,r,i)}}(a));return r.Fa((function(){return n}),(function(e){var t=2;if(e instanceof ye){if(7001==e.code)throw e;t=e.severity}throw new ye(t,1,1007,e)}))}(i,e,t,n)})),u=Date.now(),h=0;a.promise.then((function(){h=Date.now()-u}),(function(){}));var c=0;o.promise.then((function(){c=Date.now()}),(function(){}));var d=s.Fa((function(r){var a=Date.now()-c,o=r.response;return o.timeMs+=h,o.timeMs+=a,r.Gi||!i.l||o.fromCache||"HEAD"==t.method||e!=Ui||i.l(o.timeMs,o.data.byteLength,Ri(n)),o}),(function(e){throw e&&(e.severity=2),e}));return a=new Oi(d.promise,(function(){return d.abort()}),r),ki(this.m,a),a},G("shaka.net.NetworkingEngine",Mi),Mi.prototype.request=Mi.prototype.request,Mi.prototype.destroy=Mi.prototype.destroy,Mi.makeRequest=Li,Mi.defaultRetryParameters=function(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}},Mi.prototype.clearAllResponseFilters=Mi.prototype.Mh,Mi.prototype.unregisterResponseFilter=Mi.prototype.vj,Mi.prototype.registerResponseFilter=Mi.prototype.bj,Mi.prototype.clearAllRequestFilters=Mi.prototype.Lh,Mi.prototype.unregisterRequestFilter=Mi.prototype.uj,Mi.prototype.registerRequestFilter=Mi.prototype.aj,Mi.unregisterScheme=function(e){delete Fi[e]},Mi.registerScheme=Pi,Mi.prototype.setForceHTTPS=Mi.prototype.mg,Mi.NumBytesRemainingClass=Ni,m(Oi,Si),Mi.PendingRequest=Oi;var Ui=1;Mi.RequestType={MANIFEST:0,SEGMENT:Ui,LICENSE:2,APP:3,TIMING:4,SERVER_CERTIFICATE:5,KEY:6,ADS:7,CONTENT_STEERING:8},Mi.AdvancedRequestType={INIT_SEGMENT:0,MEDIA_SEGMENT:1,MEDIA_PLAYLIST:2,MASTER_PLAYLIST:3,MPD:4,MSS:5};var Bi=3;Mi.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:Bi};var Fi={};function Gi(e){this.g=!1,this.h=new wi,this.i=e}function ji(e,t){if(e.g){if(t instanceof ye&&7003==t.code)throw t;throw new ye(2,7,7003,t)}}function Hi(){this.g=new Z}function Vi(e,t,n,i){this.target=e,this.type=t,this.listener=n,this.g=function(e,t){if(null==t)return!1;if("boolean"==typeof t)return t;var n=new Set(["passive","capture"]);return Object.keys(t).filter((function(e){return!n.has(e)})),function(e){var t=Wi;if(null==t){t=!1;try{var n={},i={get:function(){return t=!0,!1}};Object.defineProperty(n,"passive",i),Object.defineProperty(n,"capture",i),i=function(){},e.addEventListener("test",i,n),e.removeEventListener("test",i,n)}catch(e){t=!1}Wi=t}return t||!1}(e)?t:t.capture||!1}(e,i),this.target.addEventListener(t,n,this.g)}Gi.prototype.destroy=function(){var e=this;return this.g?this.h:(this.g=!0,this.i().then((function(){e.h.resolve()}),(function(){e.h.resolve()})))},(i=Hi.prototype).release=function(){this.ub(),this.g=null},i.o=function(e,t,n,i){this.g&&(e=new Vi(e,t,n,i),this.g.push(t,e))},i.na=function(e,t,n,i){var r=this;this.o(e,t,(function i(a){r.hc(e,t,i),n(a)}),i)},i.hc=function(e,t,n){if(this.g)for(var i=this.g.get(t)||[],r=(i=l(i)).next();!r.done;r=i.next())(r=r.value).target!=e||n!=r.listener&&n||(r.hc(),this.g.remove(t,r))},i.ub=function(){if(this.g){var e,t=this.g,n=[];for(e in t.g)n.push.apply(n,h(t.g[e]));for(n=(t=l(n)).next();!n.done;n=t.next())n.value.hc();this.g.g={}}},G("shaka.util.EventManager",Hi),Hi.prototype.removeAll=Hi.prototype.ub,Hi.prototype.unlisten=Hi.prototype.hc,Hi.prototype.listenOnce=Hi.prototype.na,Hi.prototype.listen=Hi.prototype.o,Hi.prototype.release=Hi.prototype.release,Vi.prototype.hc=function(){this.target.removeEventListener(this.type,this.listener,this.g),this.listener=this.target=null,this.g=!1};var Wi=void 0;function zi(e){this.h=e,this.g=void 0}function Xi(e){for(var t=new Map,n=l(Object.keys(e)),i=n.next();!i.done;i=n.next())i=i.value,t.set(i,e[i]);return t}function Ki(e){var t={};return e.forEach((function(e,n){t[n]=e})),t}function Yi(){}function qi(t){if(!t)return"";if(239==(t=et(t))[0]&&187==t[1]&&191==t[2]&&(t=t.subarray(3)),e.TextDecoder&&!_n())return(t=(new TextDecoder).decode(t)).includes("")&&z('Decoded string contains an "unknown character" codepoint.  That probably means the UTF8 encoding was incorrect!'),t;for(var n="",i=0;i<t.length;++i){var r=65533;if(0==(128&t[i])?r=t[i]:t.length>=i+2&&192==(224&t[i])&&128==(192&t[i+1])?(r=(31&t[i])<<6|63&t[i+1],i+=1):t.length>=i+3&&224==(240&t[i])&&128==(192&t[i+1])&&128==(192&t[i+2])?(r=(15&t[i])<<12|(63&t[i+1])<<6|63&t[i+2],i+=2):t.length>=i+4&&240==(241&t[i])&&128==(192&t[i+1])&&128==(192&t[i+2])&&128==(192&t[i+3])&&(r=(7&t[i])<<18|(63&t[i+1])<<12|(63&t[i+2])<<6|63&t[i+3],i+=3),65535>=r)n+=String.fromCharCode(r);else{var a=1023&(r-=65536);n+=String.fromCharCode(55296+(r>>10)),n+=String.fromCharCode(56320+a)}}return n}function Zi(e,t,n){if(!e)return"";if(!n&&0!=e.byteLength%2)throw new ye(2,2,2004);n=Math.floor(e.byteLength/2);var i=new Uint16Array(n);e=nt(e);for(var r=0;r<n;r++)i[r]=e.getUint16(2*r,t);return er.value()(i)}function Ji(e){function t(e){return n.byteLength<=e||32<=n[e]&&126>=n[e]}if(!e)return"";var n=et(e);if(239==n[0]&&187==n[1]&&191==n[2])return qi(n);if(254==n[0]&&255==n[1])return Zi(n.subarray(2),!1);if(255==n[0]&&254==n[1])return Zi(n.subarray(2),!0);if(0==n[0]&&0==n[2])return Zi(e,!1);if(0==n[1]&&0==n[3])return Zi(e,!0);if(t(0)&&t(1)&&t(2)&&t(3))return qi(e);throw new ye(2,2,2003)}function Qi(t){if(e.TextEncoder&&!_n()){var n=new TextEncoder;return $e(n.encode(t))}t=encodeURIComponent(t),t=unescape(t),n=new Uint8Array(t.length);for(var i=0;i<t.length;i++)n[i]=t[i].charCodeAt(0);return $e(n)}function $i(e,t){for(var n=new ArrayBuffer(2*e.length),i=new DataView(n),r=0;r<e.length;++r)i.setUint16(2*r,e.charCodeAt(r),t);return n}zi.prototype.value=function(){return null==this.g&&(this.g=this.h()),this.g},G("shaka.util.StringUtils",Yi),Yi.resetFromCharCode=function(){er.g=void 0},Yi.toUTF16=$i,Yi.toUTF8=Qi,Yi.fromBytesAutoDetect=Ji,Yi.fromUTF16=Zi,Yi.fromUTF8=qi;var er=new zi((function(){function e(e){try{var t=new Uint8Array(e);return 0<String.fromCharCode.apply(null,t).length}catch(e){return!1}}for(var t={Ub:65536};0<t.Ub;(t={Ub:t.Ub}).Ub/=2)if(e(t.Ub))return function(e){return function(t){for(var n="",i=0;i<t.length;i+=e.Ub)n+=String.fromCharCode.apply(null,t.subarray(i,i+e.Ub));return n}}(t);return null}));function tr(e,t){this.h=nt(e),this.i=t==ir,this.g=0}function nr(){return new ye(2,3,3e3)}(i=tr.prototype).xa=function(){return this.g<this.h.byteLength},i.Ga=function(){return this.g},i.getLength=function(){return this.h.byteLength},i.ra=function(){try{var e=this.h.getUint8(this.g);return this.g+=1,e}catch(e){throw nr()}},i.Ua=function(){try{var e=this.h.getUint16(this.g,this.i);return this.g+=2,e}catch(e){throw nr()}},i.O=function(){try{var e=this.h.getUint32(this.g,this.i);return this.g+=4,e}catch(e){throw nr()}},i.ih=function(){try{var e=this.h.getInt32(this.g,this.i);return this.g+=4,e}catch(e){throw nr()}},i.Uc=function(){try{if(this.i)var e=this.h.getUint32(this.g,!0),t=this.h.getUint32(this.g+4,!0);else t=this.h.getUint32(this.g,!1),e=this.h.getUint32(this.g+4,!1)}catch(e){throw nr()}if(2097151<t)throw new ye(2,3,3001);return this.g+=8,t*Math.pow(2,32)+e},i.Qb=function(e){if(this.g+e>this.h.byteLength)throw nr();var t=et(this.h,this.g,e);return this.g+=e,t},i.skip=function(e){if(this.g+e>this.h.byteLength)throw nr();this.g+=e},i.jj=function(e){if(this.g<e)throw nr();this.g-=e},i.seek=function(e){if(0>e||e>this.h.byteLength)throw nr();this.g=e},i.Hd=function(){for(var e=this.g;this.xa()&&0!=this.h.getUint8(this.g);)this.g+=1;return e=et(this.h,e,this.g-e),this.g+=1,qi(e)},G("shaka.util.DataViewReader",tr),tr.prototype.readTerminatedString=tr.prototype.Hd,tr.prototype.seek=tr.prototype.seek,tr.prototype.rewind=tr.prototype.jj,tr.prototype.skip=tr.prototype.skip,tr.prototype.readBytes=tr.prototype.Qb,tr.prototype.readUint64=tr.prototype.Uc,tr.prototype.readInt32=tr.prototype.ih,tr.prototype.readUint32=tr.prototype.O,tr.prototype.readUint16=tr.prototype.Ua,tr.prototype.readUint8=tr.prototype.ra,tr.prototype.getLength=tr.prototype.getLength,tr.prototype.getPosition=tr.prototype.Ga,tr.prototype.hasMoreData=tr.prototype.xa;var ir=1;function rr(){this.i=[],this.h=[],this.g=!1}function ar(e){for(var t=cr(e);e.reader.xa()&&!e.parser.g;)e.parser.Ed(e.start+t,e.reader,e.partialOkay)}function or(e){for(var t=cr(e),n=e.reader.O(),i=0;i<n&&(e.parser.Ed(e.start+t,e.reader,e.partialOkay),!e.parser.g);i++);}function sr(e){var t=cr(e);for(e.reader.skip(78);e.reader.xa()&&!e.parser.g;)e.parser.Ed(e.start+t,e.reader,e.partialOkay)}function ur(e){return function(t){e(t.reader.Qb(t.reader.getLength()-t.reader.Ga()))}}function lr(e){for(var t=0,n=(e=l(e)).next();!n.done;n=e.next())t=t<<8|n.value.charCodeAt(0);return t}function hr(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}function cr(e){return 8+(e.has64BitSize?8:0)+(null!=e.flags?4:0)}tr.Endianness={BIG_ENDIAN:0,LITTLE_ENDIAN:ir},(i=rr.prototype).box=function(e,t){return e=lr(e),this.i[e]=dr,this.h[e]=t,this},i.T=function(e,t){return e=lr(e),this.i[e]=pr,this.h[e]=t,this},i.stop=function(){this.g=!0},i.parse=function(e,t,n){for(e=new tr(e,0),this.g=!1;e.xa()&&!this.g;)this.Ed(0,e,t,n)},i.Ed=function(e,t,n,i){var r=t.Ga();if(i&&r+8>t.getLength())this.g=!0;else{var a=t.O(),o=t.O(),s=hr(o),u=!1;switch(a){case 0:a=t.getLength()-r;break;case 1:if(i&&t.Ga()+8>t.getLength())return void(this.g=!0);a=t.Uc(),u=!0}var l=this.h[o];if(l){var h=null,c=null;if(this.i[o]==pr){if(i&&t.Ga()+4>t.getLength())return void(this.g=!0);h=(c=t.O())>>>24,c&=16777215}o=r+a,n&&o>t.getLength()&&(o=t.getLength()),i&&o>t.getLength()?this.g=!0:(i=o-t.Ga(),l({name:s,parser:this,partialOkay:n||!1,version:h,flags:c,reader:t=new tr(t=0<i?t.Qb(i):new Uint8Array(0),0),size:a,start:r+e,has64BitSize:u}))}else t.skip(Math.min(r+a-t.Ga(),t.getLength()-t.Ga()))}},G("shaka.util.Mp4Parser",rr),rr.headerSize=cr,rr.typeToString=hr,rr.allData=ur,rr.visualSampleEntry=sr,rr.sampleDescription=or,rr.children=ar,rr.prototype.parseNext=rr.prototype.Ed,rr.prototype.parse=rr.prototype.parse,rr.prototype.stop=rr.prototype.stop,rr.prototype.fullBox=rr.prototype.T,rr.prototype.box=rr.prototype.box;var dr=0,pr=1;function fr(){}function gr(e){return e=et(e),e=er.value()(e),btoa(e)}function mr(e,t){return t=null==t||t,e=gr(e).replace(/\+/g,"-").replace(/\//g,"_"),t?e:e.replace(/[=]*$/,"")}function vr(t){t=e.atob(t.replace(/-/g,"+").replace(/_/g,"/"));for(var n=new Uint8Array(t.length),i=0;i<t.length;++i)n[i]=t.charCodeAt(i);return n}function yr(t){for(var n=t.length/2,i=new Uint8Array(n),r=0;r<n;r++)i[r]=e.parseInt(t.substr(2*r,2),16);return i}function br(e){var t=et(e);e="";for(var n=(t=l(t)).next();!n.done;n=t.next())1==(n=(n=n.value).toString(16)).length&&(n="0"+n),e+=n;return e}function _r(){for(var e=D.apply(0,arguments),t=0,n=0;n<e.length;++n)t+=e[n].byteLength;t=new Uint8Array(t);for(var i=n=0;i<e.length;++i){var r=e[i];r instanceof Uint8Array?t.set(r,n):t.set(et(r),n),n+=r.byteLength}return t}function wr(e){var t=this;this.g=[],this.h=[],this.data=[],(new rr).box("moov",ar).box("moof",ar).T("pssh",(function(e){if(!(1<e.version)){var n=et(e.reader.h,-12,e.size);if(t.data.push(n),t.g.push(br(e.reader.Qb(16))),0<e.version){n=e.reader.O();for(var i=0;i<n;i++){var r=br(e.reader.Qb(16));t.h.push(r)}}}})).parse(e)}function Sr(e,t,n,i){var r=e.length,a=t.length+16+r;0<i&&(a+=4+16*n.size);var o=new Uint8Array(a),s=nt(o),u=0;if(s.setUint32(u,a),u+=4,s.setUint32(u,1886614376),u+=4,1>i?s.setUint32(u,0):s.setUint32(u,16777216),u+=4,o.set(t,u),u+=t.length,0<i)for(s.setUint32(u,n.size),u+=4,n=(t=l(n)).next();!n.done;n=t.next())n=yr(n.value),o.set(n,u),u+=n.length;return s.setUint32(u,r),o.set(e,u+4),o}function Tr(e,t){return 1!=(e=Er(e,t)).length?null:e[0]}function Ar(e,t,n){return 1!=(e=Cr(e,t,n)).length?null:e[0]}function Er(e,t){for(var n=[],i=(e=l(e.childNodes)).next();!i.done;i=e.next())(i=i.value)instanceof Element&&i.tagName==t&&n.push(i);return n}function Cr(e,t,n){for(var i=[],r=(e=l(e.childNodes)).next();!r.done;r=e.next())(r=r.value)instanceof Element&&r.localName==n&&r.namespaceURI==t&&i.push(r);return i}function xr(e,t,n){return e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}function Ir(e,t,n){for(var i=(t=l(t)).next();!i.done;i=t.next())if(i=i.value,e.hasAttributeNS(i,n))return e.getAttributeNS(i,n);return null}function kr(e){return Array.from(e.childNodes).every(Mr)?e.textContent.trim():null}function Mr(e){return e.nodeType==Node.TEXT_NODE||e.nodeType==Node.CDATA_SECTION_NODE}function Pr(e,t,n,i){i=void 0===i?null:i;var r=null;return null!=(e=e.getAttribute(t))&&(r=n(e)),null==r?i:r}function Lr(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:e/1e3):null}function Dr(e){return e&&(e=RegExp("^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$").exec(e))?(e=31536e3*Number(e[1]||null)+2592e3*Number(e[2]||null)+86400*Number(e[3]||null)+3600*Number(e[4]||null)+60*Number(e[5]||null)+Number(e[6]||null),isFinite(e)?e:null):null}function Rr(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return t?(e=Number(t[1]),isFinite(e)?(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null):null):null}function Nr(e){return 0==(e=Number(e))%1?e:null}function Or(e){return 0==(e=Number(e))%1&&0<e?e:null}function Ur(e){return 0==(e=Number(e))%1&&0<=e?e:null}function Br(e){return e=Number(e),isNaN(e)?null:e}function Fr(e){return!!e&&"true"===e.toLowerCase()}function Gr(e){var t,n=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e);return isNaN(n)?null:n}function jr(e,t){var n=new DOMParser,i=Vr.value()(e);e=null;try{e=n.parseFromString(i,"text/xml")}catch(e){return null}if(!(n=e.documentElement)||n.getElementsByTagName("parsererror").length||n.tagName!=t)return null;if(!("createNodeIterator"in document))return n;for(t=document.createNodeIterator(e,NodeFilter.SHOW_ALL);e=t.nextNode();)if(e instanceof HTMLElement||e instanceof SVGElement)return null;return n}function Hr(e,t){try{return jr(Ji(e),t)}catch(e){return null}}G("shaka.util.Uint8ArrayUtils",fr),fr.concat=_r,fr.toHex=br,fr.fromHex=yr,fr.fromBase64=vr,fr.toBase64=mr,fr.toStandardBase64=gr;var Vr=new zi((function(){if("undefined"!=typeof trustedTypes){var e=trustedTypes.createPolicy("shaka-player#xml",{createHTML:function(e){return e}});return function(t){return e.createHTML(t)}}return function(e){return e}}));function Wr(e,t){var n=this;t=void 0===t?1:t,this.G=e,this.J=new Set,this.m=this.u=null,this.ha=this.$=!1,this.K=0,this.g=null,this.D=new Hi,this.i=new Map,this.C=new Map,this.l=new wi,this.h=null,this.s=function(t){2==t.severity&&n.l.reject(t),e.onError(t)},this.V=new Map,this.aa=new Map,this.W=new ln((function(){return function(e){var t=e.V,n=e.aa;n.clear(),t.forEach((function(e,t){return n.set(t,e)})),(t=Array.from(n.values())).length&&t.every((function(e){return"expired"==e}))&&e.s(new ye(2,6,6014)),e.G.Fe(Ki(n))}(n)})),this.M=!1,this.L=[],this.N=!1,this.Aa=new ln((function(){!function(e){e.i.forEach((function(t,n){var i=t.Yf,r=n.expiration;isNaN(r)&&(r=1/0),r!=i&&(e.G.onExpirationUpdated(n.sessionId,r),t.Yf=r)}))}(n)})).za(t),this.l.catch((function(){})),this.j=new Gi((function(){return function(e){return L((function(t){switch(t.g){case 1:return e.D.release(),e.D=null,e.l.reject(),e.Aa.stop(),e.Aa=null,e.W.stop(),e.W=null,_(t,ra(e),2);case 2:if(!e.m){t.F(3);break}return S(t,4),_(t,e.m.setMediaKeys(null),6);case 6:A(t,5);break;case 4:E(t);case 5:e.m=null;case 3:e.g=null,e.J.clear(),e.u=null,e.C=new Map,e.h=null,e.s=function(){},e.G=null,e.Z=!1,e.I=null,w(t)}}))}(n)})),this.Z=!1,this.H=this.I=null}function zr(e,t,n){e.C=new Map;for(var i=(n=l(n)).next();!i.done;i=n.next())e.C.set(i.value,{initData:null,initDataType:null});for(i=(n=l(e.h.persistentSessionsMetadata)).next();!i.done;i=n.next())i=i.value,e.C.set(i.sessionId,{initData:i.initData,initDataType:i.initDataType});return e.M=0<e.C.size,Xr(e,t)}function Xr(t,n){var i,r,a,o,s,u,h,c,d,p,f,g,m,v,y;return L((function(b){if(1==b.g){if(i=function(t){if(0==(t=Xi(t.h.clearKeys)).size)return null;var n=[],i=[];t.forEach((function(e,t){var r=t;22!=r.length&&(r=mr(yr(t),!1)),22!=(t=e).length&&(t=mr(yr(e),!1)),e={kty:"oct",kid:r,k:t},n.push(e),i.push(e.kid)})),t=JSON.stringify({keys:n});var r=JSON.stringify({kids:i});return r=[{initData:et(Qi(r)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+e.btoa(t),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:r,keyIds:new Set(i)}}(t))for(r=l(n),a=r.next();!a.done;a=r.next())(o=a.value).video&&(o.video.drmInfos=[i]),o.audio&&(o.audio.drmInfos=[i]);for((s=n.some((function(e){return!!(e.video&&e.video.drmInfos.length||e.audio&&e.audio.drmInfos.length)})))||(u=Xi(t.h.servers),function(e,t){var n=[];for(t.forEach((function(e,t){n.push({keySystem:t,licenseServerUri:e,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",initData:[],keyIds:new Set})})),t=(e=l(e)).next();!t.done;t=e.next())(t=t.value).video&&(t.video.drmInfos=n),t.audio&&(t.audio.drmInfos=n)}(n,u)),h=new Set,c=l(n),a=c.next();!a.done;a=c.next())for(d=a.value,p=sa(d),f=l(p),g=f.next();!g.done;g=f.next())m=g.value,h.add(m);for(v=l(h),g=v.next();!g.done;g=v.next())ha(g.value,Xi(t.h.servers),Xi(t.h.advanced||{}),t.h.keySystemsMapping);return _(b,Dn(n,t.M,t.Z,t.h.preferredKeySystems),2)}return s||Object.keys(t.h.servers).length?(y=Qr(t,void 0,n),b.return(s?y:y.catch((function(){})))):(t.$=!0,b.return(Promise.resolve()))}))}function Kr(e){var t;return L((function(n){switch(n.g){case 1:if(e.m.mediaKeys)return n.return();if(!e.I){n.F(2);break}return _(n,e.I,3);case 3:return ji(e.j),n.return();case 2:return S(n,4),e.I=e.m.setMediaKeys(e.u),_(n,e.I,6);case 6:A(n,5);break;case 4:t=E(n),e.s(new ye(2,6,6003,t.message));case 5:ji(e.j),w(n)}}))}function Yr(e){var t,n,i,r;return L((function(a){if(1==a.g)return e.C.size?(e.C.forEach((function(t,n){ta(e,n,t)})),_(a,e.l,3)):a.F(2);if(2!=a.g){if(0<(e.g&&e.g.keyIds||new Set([])).size&&function(e){for(var t=l(e.g&&e.g.keyIds||new Set([])),n=t.next();!n.done;n=t.next())if("usable"!==e.V.get(n.value))return!1;return!0}(e))return a.return(e.l);e.l=new wi,e.l.catch((function(){}))}for(t=(e.g?e.g.initData:[])||[],n=l(t),i=n.next();!i.done;i=n.next())r=i.value,qr(e,r.initDataType,r.initData);return t.length||e.l.resolve(),a.return(e.l)}))}function qr(e,t,n){if(n.length){for(var i=e.i.values(),r=(i=l(i)).next();!r.done;r=i.next())if(Je(n,r.value.initData)&&e.h.ignoreDuplicateInitData)return;0<e.i.size&&ua(e)&&(e.l.resolve(),e.l=new wi,e.l.catch((function(){}))),function(e,t,n,i){try{var r=e.u.createSession(i)}catch(t){return void e.s(new ye(2,6,6005,t.message))}e.D.o(r,"message",(function(t){e.m&&e.h.delayLicenseRequestUntilPlayed&&e.m.paused&&!e.N?e.L.push(t):na(e,t)})),e.D.o(r,"keystatuseschange",(function(t){return ia(e,t)})),e.i.set(r,{initData:n,initDataType:t,loaded:!1,Yf:1/0,Db:null,type:i});try{n=e.h.initDataTransform(n,t,e.g)}catch(n){return t=n,n instanceof ye||(t=new ye(2,6,6016,n)),void e.s(t)}e.h.logLicenseExchange&&mr(n),r.generateRequest(t,n).catch((function(t){if(!e.j.g){e.i.delete(r);var n=t.errorCode;if(n&&n.systemCode){var i=n.systemCode;0>i&&(i+=Math.pow(2,32)),i="0x"+i.toString(16)}e.s(new ye(2,6,6006,t.message,t,i))}}))}(e,t,n,e.g.sessionType)}}function Zr(e){return!!e&&!!e.match(/^com\.(microsoft|chromecast)\.playready/)}function Jr(e){return e=Q(e=e.i.keys(),(function(e){return e.sessionId})),Array.from(e)}function Qr(e,t,n){var i,r,a,o,s,u,h,c,d,p,f,g,m,v;return L((function(y){switch(y.g){case 1:if(i=new Map,n.length){r=function(e,t,n){for(var i=l(t),r=i.next();!r.done;r=i.next()){var a=l(sa(r.value));for(r=a.next();!r.done;r=a.next())r=r.value,n.has(r.keySystem)||n.set(r.keySystem,[]),n.get(r.keySystem).push(r)}if(1==n.size&&n.has(""))throw new ye(2,6,6e3);for(i={},r=(e=l(e.h.preferredKeySystems)).next();!r.done;i={Xe:i.Xe},r=e.next())for(i.Xe=r.value,r=(a=l(t)).next();!r.done;r=a.next())if(r=r.value.decodingInfos.find(function(e){return function(t){return t.supported&&null!=t.keySystemAccess&&t.keySystemAccess.keySystem==e.Xe}}(i)))return r.keySystemAccess;for(r=(e=l([!0,!1])).next();!r.done;r=e.next())for(i=r.value,r=(a=l(t)).next();!r.done;r=a.next()){var o=l(r.value.decodingInfos);for(r=o.next();!r.done;r=o.next()){var s=r.value;if(s.supported&&s.keySystemAccess){var u=l(r=n.get(s.keySystemAccess.keySystem));for(r=u.next();!r.done;r=u.next())if(!!r.value.licenseServerUri==i)return s.keySystemAccess}}}return null}(e,n,i),y.F(2);break}return _(y,function(e,t){var n,i,r,a,o,s,u,h,c,d,p,f,g,m,v;return L((function(y){switch(y.g){case 1:if(1==t.size&&t.has(""))throw new ye(2,6,6e3);for(i=l(t.values()),r=i.next();!r.done;r=i.next())0==(a=r.value).audioCapabilities.length&&delete a.audioCapabilities,0==a.videoCapabilities.length&&delete a.videoCapabilities;o=l(e.h.preferredKeySystems),s=o.next();case 2:if(s.done){y.F(4);break}if(u=s.value,!t.has(u)){y.F(3);break}return h=t.get(u),S(y,6),_(y,navigator.requestMediaKeySystemAccess(u,[h]),8);case 8:return n=y.h,y.return(n);case 6:E(y);case 7:ji(e.j);case 3:s=o.next(),y.F(2);break;case 4:c=l([!0,!1]),d=c.next();case 9:if(d.done){y.F(11);break}p=d.value,f=l(t.keys()),s=f.next();case 12:if(s.done){d=c.next(),y.F(9);break}if(g=s.value,m=t.get(g),v=m.drmInfos.some((function(e){return!!e.licenseServerUri})),v!=p){y.F(13);break}return S(y,15),_(y,navigator.requestMediaKeySystemAccess(g,[m]),17);case 17:return n=y.h,y.return(n);case 15:E(y);case 16:ji(e.j);case 13:s=f.next(),y.F(12);break;case 11:return y.return(n)}}))}(e,t),3);case 3:r=y.h;case 2:if(!(a=r))throw new ye(2,6,6001);for(ji(e.j),S(y,4),e.J.clear(),o=a.getConfiguration(),s=o.audioCapabilities||[],u=o.videoCapabilities||[],h=l(s),c=h.next();!c.done;c=h.next())d=c.value,e.J.add(d.contentType.toLowerCase());for(p=l(u),c=p.next();!c.done;c=p.next())f=c.value,e.J.add(f.contentType.toLowerCase());if(n.length){var b=a.keySystem,w=i.get(a.keySystem),T=[],C=[],x=[],I=[],k=new Set;la(w,T,x,C,I,k);var M=e.M?"persistent-license":"temporary";for(b={keySystem:b,licenseServerUri:T[0],distinctiveIdentifierRequired:w[0].distinctiveIdentifierRequired,persistentStateRequired:w[0].persistentStateRequired,sessionType:w[0].sessionType||M,audioRobustness:w[0].audioRobustness||"",videoRobustness:w[0].videoRobustness||"",serverCertificate:x[0],serverCertificateUri:C[0],initData:I,keyIds:k},T=(w=l(w)).next();!T.done;T=w.next())(T=T.value).distinctiveIdentifierRequired&&(b.distinctiveIdentifierRequired=T.distinctiveIdentifierRequired),T.persistentStateRequired&&(b.persistentStateRequired=T.persistentStateRequired);w=b}else w=a.keySystem,b=t.get(a.keySystem),T=[],C=[],x=[],I=[],k=new Set,la(b.drmInfos,T,x,C,I,k),w={keySystem:w,licenseServerUri:T[0],distinctiveIdentifierRequired:"required"==b.distinctiveIdentifier,persistentStateRequired:"required"==b.persistentState,sessionType:b.sessionTypes[0]||"temporary",audioRobustness:(b.audioCapabilities?b.audioCapabilities[0].robustness:"")||"",videoRobustness:(b.videoCapabilities?b.videoCapabilities[0].robustness:"")||"",serverCertificate:x[0],serverCertificateUri:C[0],initData:I,keyIds:k};if(e.g=w,!e.g.licenseServerUri)throw new ye(2,6,6012,e.g.keySystem);return _(y,a.createMediaKeys(),6);case 6:if(g=y.h,ji(e.j),e.u=g,""==e.h.minHdcpVersion||!("getStatusForPolicy"in e.u)){y.F(7);break}return S(y,8),_(y,e.u.getStatusForPolicy({minHdcpVersion:e.h.minHdcpVersion}),10);case 10:if("usable"!=y.h)throw new ye(2,6,6018);ji(e.j),A(y,7,4);break;case 8:if((m=E(y,4))instanceof ye)throw m;throw new ye(2,6,6019,m.message);case 7:return e.$=!0,_(y,function(e){var t,n;return L((function(i){switch(i.g){case 1:if(!e.u||!e.g)return i.return();if(!e.g.serverCertificateUri||e.g.serverCertificate&&e.g.serverCertificate.length){i.F(2);break}return t=Li([e.g.serverCertificateUri],e.h.retryParameters),S(i,3),_(i,e.G.zc.request(5,t).promise,5);case 5:n=i.h,e.g.serverCertificate=et(n.data),A(i,4);break;case 3:throw new ye(2,6,6017,E(i));case 4:if(e.j.g)return i.return();case 2:return e.g.serverCertificate&&e.g.serverCertificate.length?(S(i,6),_(i,e.u.setServerCertificate(e.g.serverCertificate),8)):i.return();case 8:A(i,0);break;case 6:throw new ye(2,6,6004,E(i).message)}}))}(e),11);case 11:ji(e.j),A(y,0);break;case 4:if(v=E(y),ji(e.j,v),e.g=null,e.J.clear(),v instanceof ye)throw v;throw new ye(2,6,6002,v.message)}}))}function $r(e){ua(e)&&e.l.resolve()}function ea(e,t){new ln((function(){t.loaded=!0,$r(e)})).S(da)}function ta(e,t,n){var i,r,a,o,s,u,l;return L((function(h){switch(h.g){case 1:try{i=e.u.createSession("persistent-license")}catch(t){return r=new ye(2,6,6005,t.message),e.s(r),h.return(Promise.reject(r))}return e.D.o(i,"message",(function(t){e.m&&e.h.delayLicenseRequestUntilPlayed&&e.m.paused&&!e.N?e.L.push(t):na(e,t)})),e.D.o(i,"keystatuseschange",(function(t){return ia(e,t)})),a={initData:n.initData,initDataType:n.initDataType,loaded:!1,Yf:1/0,Db:null,type:"persistent-license"},e.i.set(i,a),S(h,2),_(h,i.load(t),4);case 4:return o=h.h,ji(e.j),o||(e.i.delete(i),s=e.h.persistentSessionOnlinePlayback?1:2,e.s(new ye(s,6,6013)),a.loaded=!0),ea(e,a),$r(e),h.return(i);case 2:u=E(h),ji(e.j,u),e.i.delete(i),l=e.h.persistentSessionOnlinePlayback?1:2,e.s(new ye(l,6,6005,u.message)),a.loaded=!0,$r(e);case 3:return h.return(Promise.resolve())}}))}function na(e,t){var n,i,r,a,o,s,u,h,c,d,p,f;L((function(g){switch(g.g){case 1:if(n=t.target,e.h.logLicenseExchange&&mr(t.message),i=e.i.get(n),r=e.g.licenseServerUri,a=e.h.advanced[e.g.keySystem],"individualization-request"==t.messageType&&a&&a.individualizationServer&&(r=a.individualizationServer),(o=Li([r],e.h.retryParameters)).body=t.message,o.method="POST",o.licenseRequestType=t.messageType,o.sessionId=n.sessionId,o.drmInfo=e.g,i&&(o.initData=i.initData,o.initDataType=i.initDataType),Zr(e.g.keySystem)){var m=Zi(o.body,!0,!0);if(m.includes("PlayReadyKeyMessage")){for(var v=l((m=jr(m,"PlayReadyKeyMessage")).getElementsByTagName("HttpHeader")),y=v.next();!y.done;y=v.next())y=y.value,o.headers[y.getElementsByTagName("name")[0].textContent]=y.getElementsByTagName("value")[0].textContent;o.body=vr(m.getElementsByTagName("Challenge")[0].textContent)}else o.headers["Content-Type"]="text/xml; charset=utf-8"}return s=Date.now(),S(g,2),_(g,e.G.zc.request(2,o).promise,4);case 4:u=g.h,A(g,3);break;case 2:return h=E(g),c=new ye(2,6,6007,h),e.s(c),i&&i.Db&&i.Db.reject(c),g.return();case 3:return e.j.g?g.return():(e.K+=(Date.now()-s)/1e3,e.h.logLicenseExchange&&mr(u.data),S(g,5),_(g,n.update(u.data),7));case 7:A(g,6);break;case 5:return d=E(g),p=new ye(2,6,6008,d.message),e.s(p),i&&i.Db&&i.Db.reject(p),g.return();case 6:if(e.j.g)return g.return();f=new j("drmsessionupdate"),e.G.onEvent(f),i&&(i.Db&&i.Db.resolve(),ea(e,i)),w(g)}}))}function ia(e,t){t=t.target;var n=e.i.get(t),i=!1;t.keyStatuses.forEach((function(t,r){if("string"==typeof r){var a=r;r=t,t=a}if(Zr(e.g.keySystem)&&16==r.byteLength&&(dn()||_n())){var o=(a=nt(r)).getUint32(0,!0),s=a.getUint16(4,!0),u=a.getUint16(6,!0);a.setUint32(0,o,!1),a.setUint16(4,s,!1),a.setUint16(6,u,!1)}"status-pending"!=t&&(n.loaded=!0),"expired"==t&&(i=!0),r=br(r).slice(0,32),e.V.set(r,t)}));var r=t.expiration-Date.now();(0>r||i&&1e3>r)&&n&&!n.Db&&(e.i.delete(t),t.close().catch((function(){}))),ua(e)&&(e.l.resolve(),e.W.S(pa))}function ra(e){var t;return L((function(n){return t=Array.from(e.i.entries()),e.i.clear(),_(n,Promise.all(t.map((function(t){var n=(t=l(t)).next().value,i=t.next().value;return L((function(t){return 1==t.g?(S(t,2),e.ha||e.C.has(n.sessionId)||"persistent-license"!==i.type||e.h.persistentSessionOnlinePlayback?_(t,function(e){var t;return L((function(n){return 1==n.g?(t=new Promise((function(e,t){new ln(t).S(ca)})),S(n,2),_(n,Promise.race([Promise.all([e.close(),e.closed]),t]),4)):2!=n.g?A(n,0):(E(n),void w(n))}))}(n),5):_(t,n.remove(),5)):2!=t.g?A(t,0):(E(t),void w(t))}))}))),0)}))}function aa(e,t){return!e.length||!t.length||e===t||0<oa(e,t).length}function oa(e,t){if(!e.length)return t;if(!t.length)return e;for(var n=[],i=(e=l(e)).next();!i.done;i=e.next()){i=i.value;for(var r=l(t),a=r.next();!a.done;a=r.next())if(a=a.value,i.keySystem==a.keySystem){r=new Map;for(var o=l((i.initData||[]).concat(a.initData||[])),s=o.next();!s.done;s=o.next())s=s.value,r.set(s.keyId,s);r=Array.from(r.values()),o=i.keyIds&&a.keyIds?new Set([].concat(h(i.keyIds),h(a.keyIds))):i.keyIds||a.keyIds,n.push({keySystem:i.keySystem,licenseServerUri:i.licenseServerUri||a.licenseServerUri,distinctiveIdentifierRequired:i.distinctiveIdentifierRequired||a.distinctiveIdentifierRequired,persistentStateRequired:i.persistentStateRequired||a.persistentStateRequired,videoRobustness:i.videoRobustness||a.videoRobustness,audioRobustness:i.audioRobustness||a.audioRobustness,serverCertificate:i.serverCertificate||a.serverCertificate,serverCertificateUri:i.serverCertificateUri||a.serverCertificateUri,initData:r,keyIds:o});break}}return n}function sa(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])}function ua(e){return function(e,t){for(var n=(e=l(e)).next();!n.done;n=e.next())if(!t(n.value))return!1;return!0}(e=e.i.values(),(function(e){return e.loaded}))}function la(e,t,n,i,r,a){for(var o={},s=(e=l(e)).next();!s.done;o={Va:o.Va},s=e.next()){if(o.Va=s.value,t.includes(o.Va.licenseServerUri)||t.push(o.Va.licenseServerUri),i.includes(o.Va.serverCertificateUri)||i.push(o.Va.serverCertificateUri),o.Va.serverCertificate&&(n.some(function(e){return function(t){return Je(t,e.Va.serverCertificate)}}(o))||n.push(o.Va.serverCertificate)),o.Va.initData){s={};for(var u=l(o.Va.initData),h=u.next();!h.done;s={Sd:s.Sd},h=u.next())s.Sd=h.value,r.some(function(e){return function(t){var n=e.Sd;return!(!t.keyId||t.keyId!=n.keyId)||t.initDataType==n.initDataType&&Je(t.initData,n.initData)}}(s))||r.push(s.Sd)}if(o.Va.keyIds)for(u=(s=l(o.Va.keyIds)).next();!u.done;u=s.next())a.add(u.value)}}function ha(t,n,i,r){var a=t.keySystem;!a||"org.w3.clearkey"==a&&t.licenseServerUri||(n.size&&(n=n.get(a)||"",t.licenseServerUri=n),t.keyIds||(t.keyIds=new Set),(i=i.get(a))&&(t.distinctiveIdentifierRequired||(t.distinctiveIdentifierRequired=i.distinctiveIdentifierRequired),t.persistentStateRequired||(t.persistentStateRequired=i.persistentStateRequired),t.videoRobustness||(t.videoRobustness=i.videoRobustness),t.audioRobustness||(t.audioRobustness=i.audioRobustness),t.serverCertificate||(t.serverCertificate=i.serverCertificate),i.sessionType&&(t.sessionType=i.sessionType),t.serverCertificateUri||(t.serverCertificateUri=i.serverCertificateUri)),r[a]&&(t.keySystem=r[a]),e.cast&&e.cast.__platform__&&"com.microsoft.playready"==a&&(t.keySystem="com.chromecast.playready"))}(i=Wr.prototype).destroy=function(){return this.j.destroy()},i.configure=function(e){this.h=e},i.Gc=function(e){var t=this;return L((function(n){if(1==n.g)return t.u?(t.m=e,t.D.na(t.m,"play",(function(){for(var e=l(t.L),n=e.next();!n.done;n=e.next())na(t,n.value);t.N=!0,t.L=[]})),"webkitCurrentPlaybackTargetIsWireless"in t.m&&t.D.o(t.m,"webkitcurrentplaybacktargetiswirelesschanged",(function(){return ra(t)})),t.H=t.g&&t.g.initData.find((function(e){return 0<e.initData.length}))||null,t.H||"com.apple.fps"!==t.g.keySystem||t.C.size?_(n,Kr(t),2):n.F(2)):(t.D.na(e,"encrypted",(function(){t.s(new ye(2,6,6010))})),n.return());Yr(t).catch((function(){})),t.H||t.C.size||t.h.parseInbandPsshEnabled||t.D.o(t.m,"encrypted",(function(e){return function(e,t){return L((function(n){if(1==n.g)return _(n,Kr(e),2);qr(e,t.initDataType,et(t.initData)),w(n)}))}(t,e)})),w(n)}))},i.Ff=function(){var e=this,t=this.i.keys();return t=Q(t,(function(t){var n=e.i.get(t);return{sessionId:t.sessionId,sessionType:n.type,initData:n.initData,initDataType:n.initDataType}})),Array.from(t)},i.td=function(){for(var e=1/0,t=this.i.keys(),n=(t=l(t)).next();!n.done;n=t.next())n=n.value,isNaN(n.expiration)||(e=Math.min(e,n.expiration));return e},i.ge=function(){return Ki(this.aa)};var ca=1,da=5,pa=.5,fa=new zi((function(){return $e(new Uint8Array([0]))}));function ga(){}function ma(e,t){if(t&&(t=va[t.toLowerCase()]))return t;throw new ye(2,4,4e3,e)}G("shaka.media.ManifestParser",ga),ga.unregisterParserByMime=function(e){delete va[e]},ga.registerParserByMime=function(e,t){va[e]=t},ga.registerParserByExtension=function(){ai("ManifestParser","Please use an ManifestParser with registerParserByMime function.")},ga.AccessibilityPurpose={tk:"visually impaired",Mj:"hard of hearing"};var va={};function ya(e,t,n,i,r){var a=_a.value(),o=e.subarray(n.start,n.start+n.size),s=nt(o),u=new Uint8Array(n.size+a.byteLength);for(u.set(o,0),(o=nt(u)).setUint32(4,r),u.set(a,n.size),r=s.getUint32(4),o.setUint32(n.size+16,r),ba(u,0,u.byteLength),r=new Uint8Array(e.byteLength+u.byteLength),n=pn()?n.start:n.start+n.size,a=e.subarray(n),r.set(e.subarray(0,n)),r.set(u,n),r.set(a,n+u.byteLength),i=(e=l(i)).next();!i.done;i=e.next())ba(r,(i=i.value).start,i.size+u.byteLength);return u=nt(r,t.start),t=cr(t),e=u.getUint32(t),u.setUint32(t,e+1),r}function ba(e,t,n){0!=(t=(e=nt(e,t)).getUint32(0))&&(1==t?(e.setUint32(8,n>>32),e.setUint32(12,4294967295&n)):e.setUint32(0,n))}var _a=new zi((function(){return new Uint8Array([0,0,0,80,115,105,110,102,0,0,0,12,102,114,109,97,0,0,0,0,0,0,0,20,115,99,104,109,0,0,0,0,99,101,110,99,0,1,0,0,0,0,0,40,115,99,104,105,0,0,0,32,116,101,110,99,0,0,0,0,0,0,1,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])}));function wa(e,t,n,i,r,a,o){this.ba=e,this.hb=t,this.Na=n,this.Uf=void 0===i?null:i,this.timescale=void 0===r?null:r,this.g=void 0===a?null:a,this.aes128Key=void 0===o?null:o,this.mimeType=this.codecs=null}function Sa(e,t){return e===t||(e&&t?e.ac()==t.ac()&&e.Xb()==t.Xb()&&ct(e.ba().sort(),t.ba().sort())&&Je(e.g,t.g):e==t)}function Ta(e,t,n,i,r,a,o,s,u,h,c,d,p,f,g,m){for(h=void 0===h?[]:h,f=void 0===f?Aa:f,this.startTime=e,this.h=this.endTime=t,this.D=n,this.hb=i,this.Na=r,this.ka=a,this.timestampOffset=o,this.appendWindowStart=s,this.appendWindowEnd=u,this.g=h,this.tilesLayout=void 0===c?"":c,this.C=void 0===d?null:d,this.oa=void 0===p?null:p,this.status=f,this.l=!1,this.j=!0,this.m=!1,this.aes128Key=void 0===g?null:g,this.u=null,this.i=0,this.s=void 0!==m&&m,this.ue=this.Fd=!1,t=(e=l(this.g)).next();!t.done;t=e.next())t.value.eh();this.s&&this.g.length&&this.g[this.g.length-1].dh(),this.mimeType=this.codecs=null}wa.prototype.ac=function(){return this.hb},wa.prototype.Xb=function(){return this.Na},G("shaka.media.InitSegmentReference",wa),wa.prototype.getEndByte=wa.prototype.Xb,wa.prototype.getStartByte=wa.prototype.ac,(i=Ta.prototype).ba=function(){return this.D()},i.getStartTime=function(){return this.startTime},i.di=function(){return this.endTime},i.ac=function(){return this.hb},i.Xb=function(){return this.Na},i.Bi=function(){return this.tilesLayout},i.Ai=function(){return this.C},i.sc=function(){return this.status},i.Ti=function(){this.status=Ea},i.Tf=function(){this.l=!0},i.Ni=function(){return this.l},i.xe=function(){this.j=!1},i.Ki=function(){return this.j},i.eh=function(){this.Fd=!0},i.Mi=function(){return this.Fd},i.dh=function(){this.ue=!0},i.Li=function(){return this.ue},i.bh=function(){this.m=!0},i.Hi=function(){return this.m},i.rh=function(e){this.u=e},i.zi=function(){return this.u},i.offset=function(e){this.startTime+=e,this.endTime+=e,this.h+=e;for(var t=l(this.g),n=t.next();!n.done;n=t.next())(n=n.value).startTime+=e,n.endTime+=e,n.h+=e},i.sg=function(e){null==this.oa?z("Sync attempted without sync time!"):(e=this.oa-e-this.startTime,.001<=Math.abs(e)&&this.offset(e))},G("shaka.media.SegmentReference",Ta),Ta.prototype.syncAgainst=Ta.prototype.sg,Ta.prototype.offset=Ta.prototype.offset,Ta.prototype.getThumbnailSprite=Ta.prototype.zi,Ta.prototype.setThumbnailSprite=Ta.prototype.rh,Ta.prototype.hasByterangeOptimization=Ta.prototype.Hi,Ta.prototype.markAsByterangeOptimization=Ta.prototype.bh,Ta.prototype.isLastPartial=Ta.prototype.Li,Ta.prototype.markAsLastPartial=Ta.prototype.dh,Ta.prototype.isPartial=Ta.prototype.Mi,Ta.prototype.markAsPartial=Ta.prototype.eh,Ta.prototype.isIndependent=Ta.prototype.Ki,Ta.prototype.markAsNonIndependent=Ta.prototype.xe,Ta.prototype.isPreload=Ta.prototype.Ni,Ta.prototype.markAsPreload=Ta.prototype.Tf,Ta.prototype.markAsUnavailable=Ta.prototype.Ti,Ta.prototype.getStatus=Ta.prototype.sc,Ta.prototype.getTileDuration=Ta.prototype.Ai,Ta.prototype.getTilesLayout=Ta.prototype.Bi,Ta.prototype.getEndByte=Ta.prototype.Xb,Ta.prototype.getStartByte=Ta.prototype.ac,Ta.prototype.getEndTime=Ta.prototype.di,Ta.prototype.getStartTime=Ta.prototype.getStartTime,Ta.prototype.getUris=Ta.prototype.ba;var Aa=0,Ea=1;function Ca(e){return!e||1==e.length&&1e-6>e.end(0)-e.start(0)?null:e.length?e.end(e.length-1):null}function xa(e,t){return!(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0)||t>e.end(e.length-1))&&t>=e.start(0)}function Ia(e,t){if(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0))return 0;for(var n=0,i=(e=l(ka(e))).next();!i.done;i=e.next()){var r=i.value;i=r.start,(r=r.end)>t&&(n+=r-Math.max(i,t))}return n}function ka(e){if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}function Ma(){}function Pa(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&255>e[t+3]&&255>e[t+4]&&128>e[t+6]&&128>e[t+7]&&128>e[t+8]&&128>e[t+9]}function La(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&255>e[t+3]&&255>e[t+4]&&128>e[t+6]&&128>e[t+7]&&128>e[t+8]&&128>e[t+9]}function Da(e,t){var n=(127&e[t])<<21;return n|=(127&e[t+1])<<14,(n|=(127&e[t+2])<<7)|127&e[t+3]}function Ra(e){var t={key:e.type,description:"",data:"",mimeType:null,pictureType:null};if("APIC"===e.type){if(2>e.size||3!==e.data[0])return null;var n=e.data.subarray(1).indexOf(0);if(-1===n)return null;var i=qi(et(e.data,1,n)),r=e.data[2+n],a=e.data.subarray(3+n).indexOf(0);if(-1===a)return null;var o,s=qi(et(e.data,3+n,a));return o="--\x3e"===i?qi(et(e.data,4+n+a)):$e(e.data.subarray(4+n+a)),t.mimeType=i,t.pictureType=r,t.description=s,t.data=o,t}return"TXXX"===e.type||"WXXX"===e.type?2>e.size||3!==e.data[0]||-1===(i=e.data.subarray(1).indexOf(0))?null:(n=qi(et(e.data,1,i)),e=qi(et(e.data,2+i)).replace(/\0*$/,""),t.description=n,t.data=e,t):"PRIV"===e.type?2>e.size||-1===(n=e.data.indexOf(0))?null:(n=qi(et(e.data,0,n)),t.description=n,"com.apple.streaming.transportStreamTimestamp"==n?(n=e.data.subarray(n.length+1),e=1&n[3],n=(n[4]<<23)+(n[5]<<15)+(n[6]<<7)+n[7],n/=45,e&&(n+=47721858.84),t.data=n):(e=$e(e.data.subarray(n.length+1)),t.data=e),t):"T"===e.type[0]?2>e.size||3!==e.data[0]?null:(e=qi(e.data.subarray(1)).replace(/\0*$/,""),t.data=e,t):"W"===e.type[0]?(e=qi(e.data).replace(/\0*$/,""),t.data=e,t):e.data?(t.data=$e(e.data),t):null}function Na(e){for(var t=0,n=[];Pa(e,t);){var i=Da(e,t+6);for(e[t+5]>>6&1&&(t+=10),i=(t+=10)+i;t+10<i;){var r=e.subarray(t),a=Da(r,4);(a=Ra(r={type:String.fromCharCode(r[0],r[1],r[2],r[3]),size:a,data:r.subarray(10,10+a)}))&&n.push(a),t+=r.size+10}La(e,t)&&(t+=10)}return n}function Oa(e,t){for(var n=t=void 0===t?0:t,i=0;Pa(e,t);)e[t+5]>>6&1&&(i+=10),i+=10,i+=Da(e,t+6),La(e,t+10)&&(i+=10),t+=i;return 0<i?e.subarray(n,n+i):new Uint8Array([])}function Ua(e,t){var n=null,i=null,r=null,a=e.O();return 1&t&&(r=e.Uc()),2&t&&e.skip(4),8&t&&(n=e.O()),16&t&&(i=e.O()),{trackId:a,Og:n,Qh:i,wk:r}}function Ba(e,t){return 1==t?(t=e.O(),e=e.O(),{baseMediaDecodeTime:t*Math.pow(2,32)+e}):{baseMediaDecodeTime:e.O()}}function Fa(e,t){return 1==t?(e.skip(8),e.skip(8)):(e.skip(4),e.skip(4)),t=e.O(),e.skip(4),e=e.Ua(),{timescale:t,language:String.fromCharCode(96+(e>>10))+String.fromCharCode(96+((960&e)>>5))+String.fromCharCode(96+(31&e))}}function Ga(e,t,n){var i=e.O(),r=[],a=null;1&n&&(a=e.O()),4&n&&e.skip(4);for(var o=0;o<i;o++){var s={gg:null,sampleSize:null,Ke:null};256&n&&(s.gg=e.O()),512&n&&(s.sampleSize=e.O()),1024&n&&e.skip(4),2048&n&&(s.Ke=0==t?e.O():e.ih()),r.push(s)}return{Ak:i,lh:r,Ph:a}}function ja(e,t){1==t?(e.skip(8),e.skip(8)):(e.skip(4),e.skip(4));var n=e.O();return 1==t?e.skip(8):e.skip(4),e.skip(4),e.skip(8),e.skip(2),e.skip(2),e.skip(2),e.skip(2),e.skip(36),{trackId:n,width:t=e.Ua()+e.Ua()/16,height:e=e.Ua()+e.Ua()/16}}function Ha(e,t){return e.skip(87),{wa:t+"."+this.g(e.ra())+this.g(e.ra())+this.g(e.ra())}}function Va(e){return{wa:hr(e=e.O())}}function Wa(e,t){if(this.j=e,void 0!==t&&t){t=new Uint8Array(e.byteLength);for(var n=0,i=0;i<e.byteLength;i++)2<=i&&3==e[i]&&0==e[i-1]&&0==e[i-2]||(t[n]=e[i],n++);this.j=et(t,0,n)}this.i=this.j.byteLength,this.g=this.h=0}function za(e){var t=e.j.byteLength-e.i,n=new Uint8Array(4),i=Math.min(4,e.i);0!==i&&(n.set(e.j.subarray(t,t+i)),e.h=new tr(n,0).O(),e.g=8*i,e.i-=i)}function Xa(e,t){if(e.g<=t){t-=e.g;var n=Math.floor(t/8);t-=8*n,e.g-=n,za(e)}e.h<<=t,e.g-=t}function Ka(e,t){var n=Math.min(e.g,t),i=e.h>>>32-n;return e.g-=n,0<e.g?e.h<<=n:0<e.i&&za(e),0<(n=t-n)?i<<n|Ka(e,n):i}function Ya(e){var t;for(t=0;t<e.g;++t)if(0!=(e.h&2147483648>>>t))return e.h<<=t,e.g-=t,t;return za(e),t+Ya(e)}function qa(e){Xa(e,1+Ya(e))}function Za(e){return Ka(e,Ya(e)+1)-1}function Ja(e){return 1&(e=Za(e))?1+e>>>1:-1*(e>>>1)}function Qa(e){return 1===Ka(e,1)}function $a(e){return Ka(e,8)}function eo(e,t){for(var n=8,i=8,r=0;r<t;r++)0!==i&&(i=(n+(i=Ja(e))+256)%256),n=0===i?n:i}function to(e){return $a(e),Za(e),Za(e)}function no(){this.D=null,this.G=!1,this.m=this.H=null,this.j=[],this.g=[],this.s=this.u=null,this.i=[],this.h=[],this.C=null,this.l=[]}function io(e){if(1!=(e[0]<<16|e[1]<<8|e[2]))return null;var t={data:new Uint8Array(0),packetLength:e[4]<<8|e[5],pts:null,dts:null,nalus:[]};if(t.packetLength&&t.packetLength>e.byteLength-6)return null;var n=e[7];return 192&n&&(t.pts=536870912*(14&e[9])+4194304*(255&e[10])+16384*(254&e[11])+128*(255&e[12])+(254&e[13])/2,t.dts=t.pts,64&n&&(t.dts=536870912*(14&e[14])+4194304*(255&e[15])+16384*(254&e[16])+128*(255&e[17])+(254&e[18])/2)),n=e[8]+9,e.byteLength<=n?null:(t.data=e.subarray(n),t)}function ro(e){return!(0>ao(e))}function ao(e){for(var t=Math.min(1e3,e.length-564),n=0;n<t;){if(71==e[n]&&71==e[n+188]&&71==e[n+376])return n;n++}return-1}Ta.Status={zj:Aa,qk:Ea,Sj:2},G("shaka.util.Id3Utils",Ma),Ma.getID3Data=Oa,Ma.getID3Frames=Na,G("shaka.util.ExpGolomb",Wa),(i=no.prototype).clearData=function(){this.j=[],this.g=[],this.i=[],this.h=[],this.l=[]},i.parse=function(e){if(564>e.length)return this;for(var t=Math.max(0,ao(e)),n=e.length-(e.length+t)%188,i=!1,r=t;r<n;r+=188)if(71==e[r]){var a=!!(64&e[r+1]),o=((31&e[r+1])<<8)+e[r+2];if(1<(48&e[r+3])>>4){var s=r+5+e[r+4];if(s==r+188)continue}else s=r+4;switch(o){case 0:a&&(s+=e[s]+1),this.D=(31&e[s+10])<<8|e[s+11];break;case 17:case 8191:break;case this.D:a&&(s+=e[s]+1),o={audio:-1,video:-1,pe:-1,audioCodec:"",videoCodec:""};var u=s+3+((15&(a=e)[s+1])<<8|a[s+2])-4;for(s+=12+((15&a[s+10])<<8|a[s+11]);s<u;){var l=(31&a[s+1])<<8|a[s+2],h=(15&a[s+3])<<8|a[s+4];switch(a[s]){case 6:if(-1==o.audio&&0<h)for(var c=s+5,d=h;2<d;){switch(a[c]){case 106:o.audio=l,o.audioCodec="ac3";break;case 122:o.audio=l,o.audioCodec="ec3"}var p=a[c+1]+2;c+=p,d-=p}break;case 15:-1==o.audio&&(o.audio=l,o.audioCodec="aac");break;case 21:-1==o.pe&&(o.pe=l);break;case 27:-1==o.video&&(o.video=l,o.videoCodec="avc");break;case 3:case 4:-1==o.audio&&(o.audio=l,o.audioCodec="mp3");break;case 36:-1==o.video&&(o.video=l,o.videoCodec="hvc");break;case 129:-1==o.audio&&(o.audio=l,o.audioCodec="ac3");break;case 132:case 135:-1==o.audio&&(o.audio=l,o.audioCodec="ec3")}s+=h+5}-1!=(a=o).video&&(this.H=a.video,this.m=a.videoCodec),-1!=a.audio&&(this.u=a.audio,this.s=a.audioCodec),-1!=a.pe&&(this.C=a.pe),i&&!this.G&&(i=!1,r=t-188),this.G=!0;break;case this.H:s=e.subarray(s,r+188),a?this.j.push([s]):this.j.length&&this.j[this.j.length-1]&&this.j[this.j.length-1].push(s);break;case this.u:s=e.subarray(s,r+188),a?this.i.push([s]):this.i.length&&this.i[this.i.length-1]&&this.i[this.i.length-1].push(s);break;case this.C:s=e.subarray(s,r+188),a?this.l.push([s]):this.l.length&&this.l[this.l.length-1]&&this.l[this.l.length-1].push(s);break;default:i=!0}}return this},i.Zi=function(e){return ai("TsParser","Please use parseNalus function instead."),this.ag(e)},i.ag=function(e,t,n){var i=e.pts?e.pts/9e4:null,r=(e=e.data).byteLength,a=1;"hvc"==this.m&&(a=2);for(var o,s=n||0,u=[],l=-1,h=0,c=0;c<r;++c){var d=e[c];if(d){if(2<=s&&1==d){if(t&&!u.length&&-1==l&&(d=c-(3<s?3:s),n&&0!=d&&(d=e.subarray(0,d),t.data=_r(t.data,d),t.fullData=_r(t.fullData,d))),0<=l?(s=c-((3<s?3:s)+1),u.push({data:e.subarray(l+a,s+1),fullData:e.subarray(l,s+1),type:h,time:i})):t&&!u.length&&0<(l=c-s)&&(l=e.subarray(0,l),t.data=_r(t.data,l),t.fullData=_r(t.fullData,l)),c>=r-a)return u;l=++c,h="hvc"==this.m?e[c]>>1&63:31&e[c]}s=0}else s++;c>=r-1&&0<=l&&0<=s&&(o={data:e.subarray(l+a,r),fullData:e.subarray(l,r),type:h,time:i})}return o&&u.push(o),!u.length&&t&&(t.data=_r(t.data,e),t.fullData=_r(t.fullData,e)),u},i.getMetadata=function(){for(var e=[],t=l(this.l),n=t.next();!n.done;n=t.next())(n=io(n=_r.apply(fr,h(n.value))))&&e.push({cueTime:n.pts?n.pts/9e4:null,data:n.data,frames:Na(n.data),dts:n.dts,pts:n.pts});return e},i.qc=function(){if(this.i.length&&!this.h.length){for(var e=!1,t=l(this.i),n=t.next();!n.done;n=t.next()){var i=_r.apply(fr,h(n.value)),r=io(i);n=this.h.length?this.h[this.h.length-1]:null,r&&null!=r.pts&&null!=r.dts&&(!n||n.pts!=r.pts&&n.dts!=r.dts)?(this.h.length&&r.dts<(n.dts||0)&&(e=!0),this.h.push(r)):this.h.length&&(i=r?r.data:i)&&((n=this.h.pop()).data=_r(n.data,i),this.h.push(n))}e&&(this.h=this.h.sort((function(e,t){var n=(e.pts||0)-(t.pts||0);return(e.dts||0)-(t.dts||0)||n})))}return this.h},i.Oc=function(e){if(e=void 0===e||e,this.j.length&&!this.g.length){for(var t=!1,n=l(this.j),i=n.next();!i.done;i=n.next()){var r=_r.apply(fr,h(i.value)),a=io(r);i=this.g.length?this.g[this.g.length-1]:null,a&&null!=a.pts&&null!=a.dts&&(!i||i.pts!=a.pts&&i.dts!=a.dts)?(this.g.length&&a.dts<(i.dts||0)&&(t=!0),this.g.push(a)):this.g.length&&(r=a?a.data:r)&&((i=this.g.pop()).data=_r(i.data,r),this.g.push(i))}if(e){var o;for(i=(n=l(this.g)).next();!i.done;i=n.next())(i=i.value).nalus=this.ag(i,o,void 0),i.nalus.length&&(o=i.nalus[i.nalus.length-1]);this.g=this.g.filter((function(e){return e.nalus.length}))}t&&(this.g=this.g.sort((function(e,t){var n=(e.pts||0)-(t.pts||0);return(e.dts||0)-(t.dts||0)||n})))}return e?this.g:(e=this.g,this.g=[],e)},i.getStartTime=function(e){if("audio"==e){e=null;var t=this.qc();return t.length&&(e=t[0],e=Math.min(e.dts,e.pts)/9e4),e}return"video"==e?(e=null,(t=this.Oc(!1)).length&&(e=t[0],e=Math.min(e.dts,e.pts)/9e4),e):null},i.sd=function(){return{audio:this.s,video:this.m}},i.le=function(){for(var e=[],t=l(this.Oc()),n=t.next();!n.done;n=t.next())e.push.apply(e,h(n.value.nalus));return e},i.Ei=function(){ai("TsParser","Please use getVideoInfo function instead.");var e=this.Lf();return{height:e.height,width:e.width}},i.Lf=function(){return"hvc"==this.m?function(e){var t={height:null,width:null,wa:null};if(!(e=e.le()).length)return t;if(!(e=e.find((function(e){return 33==e.type}))))return t;var n=new Wa(e.fullData,!0);$a(n),$a(n),Ka(n,4);var i=Ka(n,3);Qa(n);var r=Ka(n,2),a=Ka(n,1),o=Ka(n,5),s=Ka(n,32);e=$a(n);for(var u=$a(n),l=$a(n),h=$a(n),c=$a(n),d=$a(n),p=$a(n),f=[],g=[],m=0;m<i;m++)f.push(Qa(n)),g.push(Qa(n));if(0<i)for(m=i;8>m;m++)Ka(n,2);for(m=0;m<i;m++)f[m]&&Ka(n,88),g[m]&&$a(n);Za(n),3==(i=Za(n))&&Ka(n,1),f=Za(n),g=Za(n);var v=m=0,y=0,b=0;return Qa(n)&&(m+=Za(n),v+=Za(n),y+=Za(n),b+=Za(n)),t.width=String(f-(m+v)*(1===i||2===i?2:1)),t.height=String(g-(y+b)*(1===i?2:1)),n=function(e){for(var t=0,n=0;32>n;n++)t|=(e>>n&1)<<31-n;return t>>>0}(s),a=1==a?"H":"L",r="hvc1."+["","A","B","C"][r]+o,r+="."+n.toString(16).toUpperCase(),r+="."+a+p,d&&(r+="."+d.toString(16).toUpperCase()),c&&(r+="."+c.toString(16).toUpperCase()),h&&(r+="."+h.toString(16).toUpperCase()),l&&(r+="."+l.toString(16).toUpperCase()),u&&(r+="."+u.toString(16).toUpperCase()),e&&(r+="."+e.toString(16).toUpperCase()),t.wa=r,t}(this):function(e){var t={height:null,width:null,wa:null};if(!(e=e.le()).length)return t;if(!(e=e.find((function(e){return 7==e.type}))))return t;var n=$a(e=new Wa(e.data)),i=$a(e),r=$a(e);if(qa(e),oo.includes(n)){var a=Za(e);if(3===a&&Xa(e,1),qa(e),qa(e),Xa(e,1),Qa(e)){a=3!==a?8:12;for(var o=0;o<a;o++)Qa(e)&&eo(e,6>o?16:64)}}if(qa(e),0===(a=Za(e)))Za(e);else if(1===a)for(Xa(e,1),qa(e),qa(e),a=Za(e),o=0;o<a;o++)qa(e);qa(e),Xa(e,1),a=Za(e),o=Za(e);var s=Ka(e,1);0===s&&Xa(e,1),Xa(e,1);var u=0,l=0,h=0,c=0;return Qa(e)&&(u=Za(e),l=Za(e),h=Za(e),c=Za(e)),t.height=String((2-s)*(o+1)*16-2*h-2*c),t.width=String(16*(a+1)-2*u-2*l),t.wa="avc1."+("0"+n.toString(16).toUpperCase()).slice(-2)+("0"+i.toString(16).toUpperCase()).slice(-2)+("0"+r.toString(16).toUpperCase()).slice(-2),t}(this)},G("shaka.util.TsParser",no),no.syncOffset=ao,no.probe=ro,no.prototype.getVideoInfo=no.prototype.Lf,no.prototype.getVideoResolution=no.prototype.Ei,no.prototype.getVideoNalus=no.prototype.le,no.prototype.getCodecs=no.prototype.sd,no.prototype.getStartTime=no.prototype.getStartTime,no.prototype.getVideoData=no.prototype.Oc,no.prototype.getAudioData=no.prototype.qc,no.prototype.getMetadata=no.prototype.getMetadata,no.prototype.parseNalus=no.prototype.ag,no.prototype.parseAvcNalus=no.prototype.Zi,no.prototype.parse=no.prototype.parse,no.prototype.clearData=no.prototype.clearData,no.Timescale=9e4;var oo=[100,110,122,244,44,83,86,118,128,138,139,134];function so(e,t,n){this.g=null,this.s=-1,this.l=e,this.i=t,this.m=n,this.j=!1;e:{if("undefined"==typeof libDPIModule&&X("Could not find LCEVC Library dependencies on this page"),"undefined"!=typeof LCEVCdec)this.h=LCEVCdec;else{if("undefined"==typeof LcevcDil){X("Could not find LCEVC Library on this page"),e=!1;break e}this.h=LcevcDil,this.j=!0,ai("LcevcDil","lcevc_dil.js is deprecated, please use lcevc_dec.js instead")}void 0===this.h.SupportObject?(X("Could not find LCEVC Library on this page"),e=!1):(this.h.SupportObject.SupportStatus||X(this.h.SupportObject.SupportError),e=void 0!==this.h&&"undefined"!=typeof libDPIModule&&this.i instanceof HTMLCanvasElement&&this.h.SupportObject.SupportStatus)}e&&!this.g&&this.h.SupportObject.webGLSupport(this.i)&&(this.i.classList.remove("shaka-hidden"),this.g=this.j?new this.h.LcevcDil(this.l,this.i,this.m):new this.h.LCEVCdec(this.l,this.i,this.m))}function uo(e){e.g&&e.i.classList.add("shaka-hidden")}function lo(e,t,n){var i=ho,r=mo;switch(t.mimeType){case"video/webm":i=co;break;case"video/mp4":i=po}switch(n){case"DASH":r=go;break;case"HLS":r=fo}e.g&&(e.s=t.id,e.g.setLevelSwitching(t.id,!0),e.g.setContainerFormat(i),e.j||e.g.setStreamingFormat(r))}so.prototype.release=function(){this.g&&(this.g.close(),this.g=null)},G("shaka.lcevc.Dec",so),so.prototype.release=so.prototype.release;var ho=0,co=1,po=2,fo=0,go=1,mo=-1;function vo(e,t,n,i){var r=this;this.i=e,this.G=null,this.H=t,this.g={},this.I={},this.ha={},this.h=null,this.Z=!1,this.ua=n||function(){},this.N=i||null,this.j={},this.u=new Hi,this.m={},this.J=null,this.L=new wi,this.M="",this.$=!1,this.l=yo(this,this.L),this.D=!1,this.K=new Gi((function(){return function(e){var t,n,i,r,a,o,s;return L((function(u){if(1==u.g){for(n in t=[],e.j)for(i=e.j[n],r=i[0],e.j[n]=i.slice(0,1),r&&t.push(r.p.catch(rn)),a=l(i.slice(1)),o=a.next();!o.done;o=a.next())o.value.p.reject(new ye(2,7,7003,void 0));for(s in e.h&&t.push(e.h.destroy()),e.H&&t.push(e.H.destroy()),e.m)t.push(e.m[s].destroy());return _(u,Promise.all(t),2)}e.u&&(e.u.release(),e.u=null),e.i&&(e.i.removeAttribute("src"),e.i.load(),e.i=null),e.G=null,e.l=null,e.h=null,e.H=null,e.g={},e.m={},e.J=null,e.j={},e.N=null,w(u)}))}(r)})),this.C=!1,this.W="UNKNOWN",this.Aa=this.sa=!1,this.va=new wi,this.s=!1,this.aa=!0,this.V=null}function yo(t,n){if(e.ManagedMediaSource){t.i.disableRemotePlayback=!0;var i=new ManagedMediaSource;return t.u.o(i,"startstreaming",(function(){t.aa=!0})),t.u.o(i,"endstreaming",(function(){t.aa=!1})),t.u.na(i,"sourceopen",(function(){URL.revokeObjectURL(t.M),n.resolve()})),t.u.na(t.i,"playing",(function(){t.$=!0})),t.M=Oo(i),t.i.src=t.M,i}return i=new MediaSource,t.u.na(i,"sourceopen",(function(){URL.revokeObjectURL(t.M),n.resolve()})),t.u.na(t.i,"playing",(function(){t.$=!0})),t.M=Oo(i),t.i.src=t.M,i}function bo(e,t,n,i,r){r=void 0!==r&&r;var a=Ht(n.mimeType,i);if(t==Ae)_o(e,a,e.C,n.external);else{var o=e.G.forceTransmux||r;if((!ze(a)||!e.C&&Zt.includes(a))&&(o=!0),r=Vt(n.mimeType,i),o){if(o=Te("audio",(i||"").split(",")),i=Te("video",(i||"").split(",")),o&&i)return e.s=!0,bo(e,"audio",n,o,!0),void bo(e,"video",n,i,!0);(i=Nt(r))&&(a=i(),e.m[t]=a,a=a.convertCodecs(t,r))}r=a+e.G.sourceBufferExtraFeatures,ji(e.K);try{var s=e.l.addSourceBuffer(r)}catch(t){throw new ye(2,3,3015,t,"The mediaSource_ status was "+e.l.readyState+" expected 'open'")}e.C&&(s.mode=Uo),e.u.o(s,"error",(function(){e.j[t][0].p.reject(new ye(2,3,3014,e.i.error?e.i.error.code:0))})),e.u.o(s,"updateend",(function(){return Mo(e,t)})),e.g[t]=s,e.I[t]=a,e.ha[t]=!!n.drmInfos.length}}function _o(e,t,n,i){e.h||(e.h=new Jt(e.H));var r=e.h;i=i||e.Z,e=e.W,"application/cea-608"==t||"application/cea-708"==t?r.i=null:(r.i=(0,tn[t])(),r.i.setSequenceMode?r.i.setSequenceMode(n):X('Text parsers should have a "setSequenceMode" method!'),r.i.setManifestType?r.i.setManifestType(e):X('Text parsers should have a "setManifestType" method!'),r.C=i)}function wo(e){return!(e.D||e.l&&"ended"!=e.l.readyState)}function So(e,t){return e=e.D||!Object.keys(e.g).length?null:t==Ae?e.h.g:!(e=Ao(e,t))||1==e.length&&1e-6>e.end(0)-e.start(0)?null:1==e.length&&0>e.start(0)?0:e.length?e.start(0):null}function To(e,t){return e.D?null:t==Ae?e.h.h:Ca(Ao(e,t))}function Ao(e,t){try{return e.g[t].buffered}catch(e){return null}}function Eo(e,t,n,i,r,a,o,s,u,h){var c,d,p,f,g,m,v,y,b,S;return o=void 0!==o&&o,s=void 0!==s&&s,u=void 0!==u&&u,h=void 0!==h&&h,L((function(T){switch(T.g){case 1:if(t!=(c=Ee).Da){T.F(2);break}if(!e.C){T.F(3);break}return _(T,e.va,4);case 4:d=T.h,e.h.u=d;case 3:return _(T,function(e,t,n,i,r){var a,o,s,u;return L((function(l){return 1==l.g?_(l,Promise.resolve(),2):e.i&&e.j?null==n||null==i?(e.i.parseInit(et(t)),l.return()):(a=e.C?n:e.u,o={periodStart:e.u,segmentStart:n,segmentEnd:i,vttOffset:a},s=e.i.parseMedia(et(t),o,r),u=s.filter((function(t){return t.startTime>=e.l&&t.startTime<e.m})),e.j.append(u),null==e.g&&(e.g=Math.max(n,e.l)),e.h=Math.min(i,e.m),void w(l)):l.return()}))}(e.h,n,i?i.startTime:null,i?i.endTime:null,i?i.ba()[0]:null),5);case 5:return T.return();case 2:if(h||!e.s){T.F(6);break}return _(T,Eo(e,c.U,n,i,r,a,o,s,u,!0),7);case 7:return _(T,Eo(e,c.ia,n,i,r,a,o,s,u,!0),8);case 8:return T.return();case 6:if(!e.g[t])return T.return();if(p=e.g[t].timestampOffset,f=e.I[t],e.m[t]&&(f=e.m[t].getOriginalMimeType()),i&&(g=function(e,t,n,i,r,a){var o=null,s=et(n);if(Zt.includes(r))(a=Na(s)).length&&i&&((t=a.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&t.data&&(o=Math.round(t.data)/1e3),e.ua([{cueTime:i.startTime,data:s,frames:a,dts:i.startTime,pts:i.startTime}],0,i.endTime));else if(r.includes("/mp4")&&i&&0==i.timestampOffset&&i.ka&&i.ka.timescale){var u=i.ka.timescale;if(!isNaN(u)){var l=0,h=!1;(new rr).box("moof",ar).box("traf",ar).T("tfdt",(function(e){l=Ba(e.reader,e.version).baseMediaDecodeTime/u,h=!0,e.parser.stop()})).parse(n,!0),h&&(o=l)}}else r.includes("/mp4")||r.includes("/webm")||!ro(s)||(null!=(t=(s=(new no).parse(s)).getStartTime(t))&&(o=t),(s=s.getMetadata()).length&&e.ua(s,a,i?i.endTime:null));return o}(e,t,n,i,f,p),null!=g&&(m=i.startTime-g,(.001<=Math.abs(p-m)||o||s)&&(!u||0<m||!p)&&(p=m,e.Aa&&(Po(e,t,(function(){return Io(e,t)})),Po(e,t,(function(){return ko(e,t,p)})))),v=t==c.ia||!(c.ia in e.g),e.C&&v&&e.va.resolve(p))),a&&t==c.ia&&(e.h||_o(e,"application/cea-608",e.C,!1),e.J||(y=f.split(";",1)[0],e.J=new at(y)),i?(b=e.J.i(n)).length&&function(e,t,n,i,r){for(var a=n+" "+i,o=new Map,s=(t=l(t)).next();!s.done;s=t.next()){var u=s.value;s=u.stream,u=u.cue,o.has(s)||o.set(s,new Map),o.get(s).has(a)||o.get(s).set(a,[]),en(e,u,r),u.startTime>=e.l&&u.startTime<e.m&&(o.get(s).get(a).push(u),s==e.D&&e.j.append([u]))}for(a=(r=l(o.keys())).next();!a.done;a=r.next())for(a=a.value,e.s.has(a)||e.s.set(a,new Map),s=(t=l(o.get(a).keys())).next();!s.done;s=t.next())s=s.value,u=o.get(a).get(s),e.s.get(a).set(s,u);e.g=null==e.g?Math.max(n,e.l):Math.min(e.g,Math.max(n,e.l)),e.h=Math.max(e.h,Math.min(i,e.m))}(e.h,b,i.startTime,i.endTime,p):e.J.init(n)),!e.m[t]){T.F(9);break}return _(T,e.m[t].transmux(n,r,i,e.l.duration,t),10);case 10:n=T.h;case 9:return n=function(e,t,n,i){var r=e.ha[i];return e.G.insertFakeEncryptionInInit&&null==n&&r&&(fn()||pn()||Sn("SOPOpenBrowser"))&&"mp4"==e.I[i].split(";")[0].split("/")[1]&&(t=function(e){function t(){r=!0}function n(e){a.push(e),ar(e)}e=et(e);var i,r=!1,a=[],o=[];if((new rr).box("moov",n).box("trak",n).box("mdia",n).box("minf",n).box("stbl",n).T("stsd",(function(e){i=e,a.push(e),or(e)})).T("encv",t).T("enca",t).T("dvav",(function(e){o.push({box:e,cb:1701733238})})).T("dva1",(function(e){o.push({box:e,cb:1701733238})})).T("dvh1",(function(e){o.push({box:e,cb:1701733238})})).T("dvhe",(function(e){o.push({box:e,cb:1701733238})})).T("hev1",(function(e){o.push({box:e,cb:1701733238})})).T("hvc1",(function(e){o.push({box:e,cb:1701733238})})).T("avc1",(function(e){o.push({box:e,cb:1701733238})})).T("avc3",(function(e){o.push({box:e,cb:1701733238})})).T("ac-3",(function(e){o.push({box:e,cb:1701733217})})).T("ec-3",(function(e){o.push({box:e,cb:1701733217})})).T("ac-4",(function(e){o.push({box:e,cb:1701733217})})).T("mp4a",(function(e){o.push({box:e,cb:1701733217})})).parse(e),r)return e;if(0==o.length||!i)throw br(e),new ye(2,3,3019);o.reverse();for(var s=l(o),u=s.next();!u.done;u=s.next())u=u.value,e=ya(e,i,u.box,a,u.cb);return e}(t)),t}(e,n,i?i.startTime:null,t),i&&e.C&&t!=c.Da&&(o||s)&&(S=i.startTime,Po(e,t,(function(){return Io(e,t)})),Po(e,t,(function(){return ko(e,t,S)}))),_(T,Po(e,t,(function(){var i=n;if("video"==t&&e.N){var r=e.N;r.g&&r.g.appendBuffer(i,"video",r.s,-p)}e.g[t].appendBuffer(i)})),11);case 11:w(T)}}))}function Co(e,t){var n;return L((function(i){return 1==i.g?t==(n=Ee).Da?e.h?_(i,e.h.remove(0,1/0),0):i.return():_(i,Po(e,t,(function(){return xo(e,t,0,e.l.duration)})),4):e.s?_(i,Po(e,n.U,(function(){return xo(e,n.U,0,e.l.duration)})),0):i.F(0)}))}function xo(e,t,n,i){i<=n?Mo(e,t):e.g[t].remove(n,i)}function Io(e,t){var n=e.g[t].appendWindowStart,i=e.g[t].appendWindowEnd;e.g[t].abort(),e.g[t].appendWindowStart=n,e.g[t].appendWindowEnd=i,Mo(e,t)}function ko(e,t,n){0>n&&(n+=.001),e.g[t].timestampOffset=n,Mo(e,t)}function Mo(e,t){if(!e.D){var n=e.j[t][0];n&&(n.p.resolve(),Do(e,t))}}function Po(e,t,n){return ji(e.K),n={start:n,p:new wi},e.j[t].push(n),1==e.j[t].length&&Ro(e,t),n.p}function Lo(e,t){var n,i,r,a,o;return L((function(s){switch(s.g){case 1:for(r in ji(e.K),n=[],i={},e.g)i.dd=new wi,a={start:function(e){return function(){return e.dd.resolve()}}(i),p:i.dd},e.j[r].push(a),n.push(i.dd),1==e.j[r].length&&a.start(),i={dd:i.dd};return S(s,2),_(s,Promise.all(n),4);case 4:A(s,3);break;case 2:throw E(s);case 3:return S(s,5,6),_(s,t(),6);case 6:for(o in C(s),e.g)Do(e,o);x(s,0);break;case 5:throw new ye(2,3,3015,E(s),e.i.error||"No error in the media element")}}))}function Do(e,t){e.j[t].shift(),Ro(e,t)}function Ro(e,t){var n=e.j[t][0];if(n)try{n.start()}catch(i){"QuotaExceededError"==i.name?n.p.reject(new ye(2,3,3017,t)):n.p.reject(new ye(2,3,3015,i,e.i.error||"No error in the media element")),Do(e,t)}}function No(e,t){return Lo(e,(function(){return function(e,t){var n,i,r,a,o,s,u,h,c,d,p,f,g,m,v,y,b,w,S,A,E,I;return L((function(k){switch(k.g){case 1:for(s in n=Ee,e.D=!0,e.s=!1,i=e.i.currentTime,r=e.i.autoplay,a=e.i.paused,e.$&&(e.i.autoplay=!1),T(k,2),e.u.ub(),o=[],e.m)o.push(e.m[s].destroy());for(u in e.j)for(h=e.j[u],c=h[0],e.j[u]=h.slice(0,1),c&&o.push(c.p.catch(rn)),d=l(h.slice(1)),p=d.next();!p.done;p=d.next())p.value.p.reject(new ye(2,7,7003,void 0));for(f in e.g){g=e.g[f];try{e.l.removeSourceBuffer(g)}catch(e){}}return _(k,Promise.all(o),4);case 4:return e.m={},e.g={},m=e.l.duration,e.L=new wi,e.l=yo(e,e.L),_(k,e.L,5);case 5:for(!isNaN(m)&&m?e.l.duration=m:!isNaN(e.V)&&e.V&&(e.l.duration=e.V),v=new wi,y=e.l.sourceBuffers,b=t.size,w=0,e.u.o(y,"addsourcebuffer",(function(){++w===b&&v.resolve()})),S=l(t.keys()),A=S.next();!A.done;A=S.next())E=A.value,I=t.get(E),bo(e,E,I,I.codecs),e.s?(e.j[n.U]=[],e.j[n.ia]=[]):e.j[E]=[];return e.i.currentTime=i,_(k,v,2);case 2:C(k),e.D=!1,ji(e.K),e.u.na(e.i,"canplaythrough",(function(){ji(e.K),e.i.autoplay=r,a||e.i.play()})),x(k,0)}}))}(e,t)}))}(i=vo.prototype).destroy=function(){return this.K.destroy()},i.init=function(e,t,n,i){t=void 0!==t&&t,n=void 0===n?"UNKNOWN":n,i=void 0!==i&&i;var r,a,o,s,u,h=this;return L((function(c){if(1==c.g)return r=Ee,_(c,h.L,2);for(h.C=t,h.W=n,h.sa=i,h.Aa=!h.C&&"HLS"==h.W&&!h.sa,a=l(e.keys()),o=a.next();!o.done;o=a.next())s=o.value,u=e.get(s),bo(h,s,u,u.codecs),h.s?(h.j[r.U]=[],h.j[r.ia]=[]):h.j[s]=[];w(c)}))},i.configure=function(e){this.G=e},i.Lb=function(){var e={total:this.D?[]:ka(this.i.buffered),audio:this.D?[]:ka(Ao(this,"audio")),video:this.D?[]:ka(Ao(this,"video")),text:[]};if(this.h){var t=this.h.g,n=this.h.h;null!=t&&null!=n&&e.text.push({start:t,end:n})}return e},i.remove=function(e,t,n){var i,r=this;return L((function(a){return 1==a.g?e==(i=Ee).Da?_(a,r.h.remove(t,n),0):_(a,Po(r,e,(function(){return xo(r,e,t,n)})),4):r.s?_(a,Po(r,i.U,(function(){return xo(r,i.U,t,n)})),0):a.F(0)}))},i.flush=function(e){var t,n=this;return L((function(i){return 1==i.g?e==(t=Ee).Da?i.return():_(i,Po(n,e,(function(){n.i.currentTime-=.001,Mo(n,e)})),2):n.s?_(i,Po(n,t.U,(function(){var e=t.U;n.i.currentTime-=.001,Mo(n,e)})),0):i.F(0)}))},i.endOfStream=function(e){var t=this;return L((function(n){return _(n,Lo(t,(function(){wo(t)||"closed"===t.l.readyState||(e?t.l.endOfStream(e):t.l.endOfStream())})),0)}))},i.gb=function(e){var t=this;return L((function(n){return _(n,Lo(t,(function(){if(e<t.l.duration)for(var n in t.g){var i={start:function(){},p:new wi};t.j[n].unshift(i)}t.l.duration=e,t.V=e})),0)}))},i.getDuration=function(){return this.l.duration};var Oo=e.URL.createObjectURL,Uo="sequence";function Bo(e,t,n){this.i=e,this.s=t,this.C=this.j=1/0,this.g=1,this.h=this.l=null,this.u=0,this.G=!0,this.H=0,this.D=void 0===n||n,this.I=0,this.m=!1}function Fo(e,t,n){this.j=n,this.l=e,this.u=jo(e),this.g=e.g.currentTime,this.m=Date.now()/1e3,this.h=!1,this.s=0,this.C=t,this.i=function(){}}function Go(e){this.g=e}function jo(e){if(e.g.paused||0==e.g.buffered.length)var t=!1;else e:{t=e.g.currentTime;for(var n=(e=l(ka(e.g.buffered))).next();!n.done;n=e.next())if(!(t<(n=n.value).start-.1||t>n.end-.5)){t=!0;break e}t=!1}return t}function Ho(e,t,n,i,r){var a=this;this.C=r,this.g=e,this.D=t,this.u=n,this.l=new Hi,this.j=!1,this.H=e.readyState,this.G=this.i=0,this.h=i,this.s=!1,this.l.o(e,"waiting",(function(){return Vo(a)})),this.m=new ln((function(){Vo(a)})).za(this.u.gapJumpTimerTime)}function Vo(e){if(0!=e.g.readyState){if(e.g.seeking){if(!e.j)return}else e.j=!1;if(!e.g.paused||e.g.currentTime==e.i&&(e.g.autoplay||e.g.currentTime!=e.i)){var t;if(e.g.readyState!=e.H&&(e.H=e.g.readyState),!(t=!e.h)){var n=(t=e.h).l,i=jo(n),r=n.g.currentTime,a=Date.now()/1e3;t.g==r&&t.u==i||(t.m=a,t.g=r,t.u=i,t.h=!1),(i=(r=a-t.m)>=t.C&&i&&!t.h)&&(t.i(t.g,r),t.h=!0,t.g=n.g.currentTime,t.s++,t.j(new j("stalldetected"))),t=!i}t&&(t=e.g.currentTime,i=function(e,t,n){return!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0)?null:0<=(e=ka(e).findIndex((function(e,i,r){return e.start>t&&(0==i||r[i-1].end-t<=n)})))?e:null}(n=e.g.buffered,t,e.u.gapDetectionThreshold),null==i||0==i&&!e.s||(r=n.start(i))>=e.D.Nb()||.001>r-t||(0!=i&&n.end(i-1),e.g.currentTime=r,t==e.i&&(e.i=r),e.G++,e.C(new j("gapjumped"))))}}}function Wo(e,t,n,i){t==HTMLMediaElement.HAVE_NOTHING||e.readyState>=t?i():(t=zo.value().get(t),n.na(e,t,i))}(i=Bo.prototype).getDuration=function(){return this.j},i.mi=function(){return this.g},i.og=function(e){this.i=e},i.gb=function(e){this.j=e},i.pi=function(){return this.i},i.nh=function(e){this.u=e},i.Vc=function(e){this.G=e},i.Ne=function(e){this.C=e},i.oh=function(e){this.s=e},i.ci=function(){return this.s},i.hh=function(e,t){if(0!=e.length){var n=e[e.length-1].end+t;this.Ce(e[0].start+t),this.g=e.reduce((function(e,t){return Math.max(e,t.end-t.start)}),this.g),this.h=Math.max(this.h,n),null!=this.i&&this.D&&!this.m&&(this.i=(Date.now()+this.u)/1e3-this.h-this.g)}},i.Dd=function(e){if(0!=e.length){for(var t=e[0].startTime,n=e[0].endTime,i=(Date.now()+this.u)/1e3,r=(e=l(e)).next();!r.done;r=e.next())i<(r=r.value).startTime||(t=Math.min(t,r.startTime),n=Math.max(n,r.endTime),this.g=Math.max(this.g,r.endTime-r.startTime));this.Ce(t),this.h=Math.max(this.h,n),null!=this.i&&this.D&&!this.m&&(this.i=i-this.h-this.g)}},i.ve=function(){this.m=!0},i.Pi=function(){return this.m},i.Ce=function(e){this.l=null==this.l?e:Math.min(this.l,e)},i.Wf=function(e){this.g=Math.max(this.g,e)},i.offset=function(e){null!=this.l&&(this.l+=e),null!=this.h&&(this.h+=e)},i.R=function(){return 1/0==this.j&&!this.G},i.wc=function(){return 1/0!=this.j&&!this.G},i.Ab=function(){return Math.max(this.H,this.$b()-this.C)},i.sh=function(e){this.H=e},i.$b=function(){return this.R()||this.wc()?Math.min(Math.max(0,(Date.now()+this.u)/1e3-this.g-this.i)+this.I,this.j):this.h?Math.min(this.h,this.j):this.j},i.ud=function(e){var t=Math.max(this.l,this.H);return 1/0==this.C?Math.ceil(1e3*t)/1e3:Math.max(t,Math.min(this.$b()-this.C+e,this.Nb()))},i.Nc=function(){return this.ud(0)},i.Nb=function(){return Math.max(0,this.$b()-(this.R()||this.wc()?this.s:0))},i.yh=function(){return!(null==this.i||null!=this.h&&this.D)},i.mh=function(e){this.I=e},G("shaka.media.PresentationTimeline",Bo),Bo.prototype.setAvailabilityTimeOffset=Bo.prototype.mh,Bo.prototype.usingPresentationStartTime=Bo.prototype.yh,Bo.prototype.getSeekRangeEnd=Bo.prototype.Nb,Bo.prototype.getSeekRangeStart=Bo.prototype.Nc,Bo.prototype.getSafeSeekRangeStart=Bo.prototype.ud,Bo.prototype.getSegmentAvailabilityEnd=Bo.prototype.$b,Bo.prototype.setUserSeekStart=Bo.prototype.sh,Bo.prototype.getSegmentAvailabilityStart=Bo.prototype.Ab,Bo.prototype.isInProgress=Bo.prototype.wc,Bo.prototype.isLive=Bo.prototype.R,Bo.prototype.offset=Bo.prototype.offset,Bo.prototype.notifyMaxSegmentDuration=Bo.prototype.Wf,Bo.prototype.notifyMinSegmentStartTime=Bo.prototype.Ce,Bo.prototype.isStartTimeLocked=Bo.prototype.Pi,Bo.prototype.lockStartTime=Bo.prototype.ve,Bo.prototype.notifySegments=Bo.prototype.Dd,Bo.prototype.notifyTimeRange=Bo.prototype.hh,Bo.prototype.getDelay=Bo.prototype.ci,Bo.prototype.setDelay=Bo.prototype.oh,Bo.prototype.setSegmentAvailabilityDuration=Bo.prototype.Ne,Bo.prototype.setStatic=Bo.prototype.Vc,Bo.prototype.setClockOffset=Bo.prototype.nh,Bo.prototype.getPresentationStartTime=Bo.prototype.pi,Bo.prototype.setDuration=Bo.prototype.gb,Bo.prototype.setPresentationStartTime=Bo.prototype.og,Bo.prototype.getMaxSegmentDuration=Bo.prototype.mi,Bo.prototype.getDuration=Bo.prototype.getDuration,Fo.prototype.release=function(){this.j=this.l=null,this.i=function(){}},Ho.prototype.release=function(){this.l&&(this.l.release(),this.l=null),null!=this.m&&(this.m.stop(),this.m=null),this.h&&(this.h.release(),this.h=null),this.g=this.D=this.C=null},Ho.prototype.Zf=function(){this.s=!0,Vo(this)};var zo=new zi((function(){return new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]])}));function Xo(e,t,n,i){var r=this;this.g=e,this.m=t,this.u=n,this.l=null,this.j=function(){return null==r.l&&(r.l=i()),r.l},this.s=!1,this.h=new Hi,this.i=new Jo(e),Wo(this.g,HTMLMediaElement.HAVE_METADATA,this.h,(function(){qo(r,r.j())}))}function Ko(e){return e.s?e.g.currentTime:e.j()}function Yo(e,t){0<e.g.readyState?Qo(e.i,t):Wo(e.g,HTMLMediaElement.HAVE_METADATA,e.h,(function(){qo(e,e.j())}))}function qo(e,t){.001>Math.abs(e.g.currentTime-t)?Zo(e):(e.h.na(e.g,"seeking",(function(){Zo(e)})),Qo(e.i,e.g.currentTime&&0!=e.g.currentTime?e.g.currentTime:t))}function Zo(e){e.s=!0,e.h.o(e.g,"seeking",(function(){return e.m()})),e.u(e.g.currentTime)}function Jo(e){var t=this;this.h=e,this.m=10,this.l=this.j=this.i=0,this.g=new ln((function(){0>=t.i||t.h.currentTime!=t.j?t.g.stop():(t.h.currentTime=t.l,t.i--)}))}function Qo(e,t){e.j=e.h.currentTime,e.l=t,e.i=e.m,e.h.currentTime=t,e.g.za(.1)}function $o(e){this.g=e,this.j=!1,this.h=null,this.i=new Hi}function es(e,t,n,i,r,a){var o=this;this.i=e,this.g=t.presentationTimeline,this.D=t.minBufferTime||0,this.l=n,this.C=r,this.u=null,this.s=function(e,t,n){if(!t.stallEnabled)return null;var i=t.stallSkip;return function(e,t){e.i=t}(t=new Fo(new Go(e),t.stallThreshold,n),(function(){i?e.currentTime+=i:(e.pause(),e.play())})),t}(e,n,a),this.j=new Ho(e,t.presentationTimeline,n,this.s,a),this.h=new Xo(e,(function(){var e=o.j;e.j=!0,e.s=!1;var t=Ko(o.h);return e=ns(o,t),.001<Math.abs(e-t)&&(t=Date.now()/1e3,!o.u||o.u<t-1)?(o.u=t,Yo(o.h,e),e=void 0):(o.C(),e=void 0),e}),(function(e){var t=o.j;t.g.seeking&&!t.j&&(t.j=!0,t.i=e)}),(function(){var e=i;return null==e?e=1/0>o.g.getDuration()?o.g.Nc():o.g.Nb():0>e&&(e=o.g.Nb()+e),ts(o,is(o,e))})),this.m=new ln((function(){if(0!=o.i.readyState&&!o.i.paused){var e=Ko(o.h),t=o.g.Nc(),n=o.g.Nb();3>n-t&&(t=n-3),e<t&&(e=ns(o,e),o.i.currentTime=e)}}))}function ts(e,t){var n=e.g.getDuration();return t>=n?n-e.l.durationBackoff:t}function ns(e,t){var n=Math.max(e.D,e.l.rebufferingGoal),i=e.l.safeSeekOffset,r=e.g.Nc(),a=e.g.Nb(),o=e.g.getDuration();3>a-r&&(r=a-3);var s=e.g.ud(n),u=e.g.ud(i);return n=e.g.ud(n+i),t>=o?ts(e,t):t>a?a:t<r?xa(e.i.buffered,u)?u:n:t>=s||xa(e.i.buffered,t)?t:n}function is(e,t){var n=e.g.Nc();return t<n?n:t>(e=e.g.Nb())?e:t}function rs(e){this.g=e,this.m=null,this.j=0,this.s=!1}function as(e,t){for(var n=(e=l(e.g)).next();!n.done;n=e.next())t(n.value)}function os(e,t,n){return new rs([e=new Ta(e,e+t,(function(){return n}),0,null,null,e,e,e+t)])}function ss(e,t,n){this.i=e,this.g=t,this.h=n}function us(){rs.call(this,[]),this.h=[]}function ls(e){var t=this;this.g=e,this.h=this.g.ke(),this.i=new ln((function(){t.g.fh(.25*t.h)}))}function hs(e){var t=this;this.h=e,this.g=new Set,this.i=new ln((function(){cs(t,!1)})).za(.25)}function cs(e,t){for(var n=l(e.g),i=n.next();!i.done;i=n.next())i.value.j(e.h.currentTime,t)}function ds(e){J.call(this),this.g=new Map,this.h=e}function ps(e){J.call(this);var t=this;this.g=new Set,this.i=e,this.h=new ln((function(){for(var e=t.i(),n=l(t.g),i=n.next();!i.done;i=n.next())(i=i.value).endTime<e.start&&(t.g.delete(i),i=new j("regionremove",new Map([["region",i]])),t.dispatchEvent(i))})).za(2)}function fs(e,t){J.call(this);var n=this;this.i=e,this.l=t,this.g=new Map,this.m=[{Dc:null,Cc:vs,vc:function(e,t){return gs(n,"enter",e,t)}},{Dc:ms,Cc:vs,vc:function(e,t){return gs(n,"enter",e,t)}},{Dc:ys,Cc:vs,vc:function(e,t){return gs(n,"enter",e,t)}},{Dc:vs,Cc:ms,vc:function(e,t){return gs(n,"exit",e,t)}},{Dc:vs,Cc:ys,vc:function(e,t){return gs(n,"exit",e,t)}},{Dc:ms,Cc:ys,vc:function(e,t){return gs(n,"skip",e,t)}},{Dc:ys,Cc:ms,vc:function(e,t){return gs(n,"skip",e,t)}}],this.h=new Hi,this.h.o(this.i,"regionremove",(function(e){n.g.delete(e.region)}))}function gs(e,t,n,i){t=new j(t,new Map([["region",n],["seeking",i]])),e.dispatchEvent(t)}Xo.prototype.release=function(){this.h&&(this.h.release(),this.h=null),null!=this.i&&(this.i.release(),this.i=null),this.m=function(){},this.g=null},Jo.prototype.release=function(){this.g&&(this.g.stop(),this.g=null),this.h=null},(i=$o.prototype).df=function(){var e=this;Wo(this.g,HTMLMediaElement.HAVE_CURRENT_DATA,this.i,(function(){null==e.h||0==e.h?e.j=!0:(e.i.na(e.g,"seeking",(function(){e.j=!0})),e.g.currentTime=Math.max(0,e.g.currentTime+e.h))}))},i.release=function(){this.i&&(this.i.release(),this.i=null),this.g=null},i.ef=function(e){this.h=this.j?this.h:e},i.Yd=function(){return(this.j?this.g.currentTime:this.h)||0},i.Cg=function(){return 0},i.Bg=function(){return 0},i.gh=function(){},(i=es.prototype).df=function(){this.m.za(.25)},i.release=function(){this.h&&(this.h.release(),this.h=null),this.j&&(this.j.release(),this.j=null),this.m&&(this.m.stop(),this.m=null),this.i=this.h=this.g=this.l=null,this.C=function(){}},i.ef=function(e){Yo(this.h,e)},i.Yd=function(){var e=Ko(this.h);return 0<this.i.readyState&&!this.i.paused?is(this,e):e},i.Cg=function(){return this.s?this.s.s:0},i.Bg=function(){return this.j.G},i.gh=function(){this.j.Zf()},(i=rs.prototype).Zb=function(){return this.g.length},i.release=function(){this.s||(this.g=[],this.m&&this.m.stop(),this.m=null)},i.Ui=function(){this.s=!0},i.find=function(e){for(var t=this.g.length-1,n=t;0<=n;--n){var i=this.g[n],r=n<t?this.g[n+1].startTime:i.endTime;if(e>=i.startTime&&e<r)return n+this.j}return this.g.length&&e<this.g[0].startTime?this.j:null},i.get=function(e){return 0==this.g.length||0>(e-=this.j)||e>=this.g.length?null:this.g[e]},i.offset=function(e){if(!this.s)for(var t=l(this.g),n=t.next();!n.done;n=t.next())n.value.offset(e)},i.ze=function(e){if(!this.s&&e.length){var t=Math.round(1e3*e[0].startTime)/1e3;this.g=this.g.filter((function(e){return Math.round(1e3*e.startTime)/1e3<t})),this.g.push.apply(this.g,h(e))}},i.Cd=function(e,t){var n=this;e=e.filter((function(e){return e.endTime>t&&(0==n.g.length||e.endTime>n.g[0].startTime)})),this.ze(e),this.yb(t)},i.yb=function(e){if(!this.s){var t=this.g.length;this.g=this.g.filter((function(t){return t.endTime>e})),this.j+=t-this.g.length}},i.Ic=function(e,t,n){if(n=void 0!==n&&n,!this.s){for(;this.g.length&&this.g[this.g.length-1].startTime>=t;)this.g.pop();for(;this.g.length&&this.g[0].endTime<=e;)this.g.shift(),n||this.j++;0!=this.g.length&&(e=this.g[this.g.length-1],this.g[this.g.length-1]=new Ta(e.startTime,t,e.D,e.hb,e.Na,e.ka,e.timestampOffset,e.appendWindowStart,e.appendWindowEnd,e.g,e.tilesLayout,e.C,e.oa,e.status,e.aes128Key),this.g[this.g.length-1].i=e.i)}},i.Qe=function(e,t){var n=this;this.s||(this.m&&this.m.stop(),this.m=new ln((function(){var e=t();e?n.g.push.apply(n.g,h(e)):(n.m.stop(),n.m=null)})),this.m.za(e))},rs.prototype[Symbol.iterator]=function(){return this.rc(0)},rs.prototype.rc=function(e){var t=this.find(e);if(null==t)return null;t--;var n=this.get(t+1),i=-1;if(n&&0<n.g.length)for(var r=n.g.length-1;0<=r;--r){var a=n.g[r];if(e>=a.startTime&&e<a.endTime){for(;r&&!a.j;)r--,a=n.g[r];if(!a.j)return z("No independent partial segment found!"),null;t++,i=r-1;break}}return new ss(this,t,i)},G("shaka.media.SegmentIndex",rs),rs.forSingleSegment=os,rs.prototype.getIteratorForTime=rs.prototype.rc,rs.prototype.updateEvery=rs.prototype.Qe,rs.prototype.fit=rs.prototype.Ic,rs.prototype.evict=rs.prototype.yb,rs.prototype.mergeAndEvict=rs.prototype.Cd,rs.prototype.offset=rs.prototype.offset,rs.prototype.get=rs.prototype.get,rs.prototype.find=rs.prototype.find,rs.prototype.markImmutable=rs.prototype.Ui,rs.prototype.release=rs.prototype.release,ss.prototype.Oh=function(){return this.g},ss.prototype.current=function(){var e=this.i.get(this.g);return e&&0<e.g.length&&e.s&&this.h>=e.g.length&&(this.g++,this.h=0,e=this.i.get(this.g)),e&&0<e.g.length?e.g[this.h]:e},ss.prototype.next=function(){var e=this.i.get(this.g);return e&&0<e.g.length?(this.h++,e.s&&this.h==e.g.length&&(this.g++,this.h=0)):(this.g++,this.h=0),{value:e=this.current(),done:!e}},G("shaka.media.SegmentIterator",ss),ss.prototype.next=ss.prototype.next,ss.prototype.current=ss.prototype.current,ss.prototype.currentPosition=ss.prototype.Oh,m(us,rs),(i=us.prototype).clone=function(){var e=new us;return e.h=this.h.slice(),e},i.release=function(){for(var e=l(this.h),t=e.next();!t.done;t=e.next())t.value.release();this.h=[]},i.find=function(e){for(var t=0,n=l(this.h),i=n.next();!i.done;i=n.next()){var r=(i=i.value).find(e);if(null!=r)return r+t;t+=i.j+i.Zb()}return null},i.get=function(e){for(var t=0,n=l(this.h),i=n.next();!i.done;i=n.next()){var r=(i=i.value).get(e-t);if(r)return r;t+=i.j+i.Zb()}return null},i.offset=function(){},i.ze=function(){},i.yb=function(){},i.Cd=function(){},i.Ic=function(){},i.Qe=function(){},G("shaka.media.MetaSegmentIndex",us),us.prototype.updateEvery=us.prototype.Qe,us.prototype.fit=us.prototype.Ic,us.prototype.mergeAndEvict=us.prototype.Cd,us.prototype.evict=us.prototype.yb,us.prototype.merge=us.prototype.ze,us.prototype.offset=us.prototype.offset,us.prototype.get=us.prototype.get,us.prototype.find=us.prototype.find,us.prototype.release=us.prototype.release,ls.prototype.release=function(){this.set(this.Lc()),this.i&&(this.i.stop(),this.i=null),this.g=null},ls.prototype.set=function(e){if(this.h!=e)e:{if(this.h=e,this.i.stop(),0<=this.h)try{var t=this.h;this.g.ke()!=t&&this.g.pg(t);break e}catch(e){}this.i.za(.25),0!=this.g.ke()&&this.g.pg(0)}},ls.prototype.Lc=function(){return this.g.Lc()},hs.prototype.release=function(){this.i.stop();for(var e=l(this.g),t=e.next();!t.done;t=e.next())t.value.release();this.g.clear()},m(ds,J),ds.prototype.release=function(){this.g.clear(),J.prototype.release.call(this)},ds.prototype.j=function(e){for(var t=l(this.g.values()),n=t.next();!n.done;n=t.next()){e:{for(var i=(n=n.value).Gd,r=i.length-1;0<=r;r--){var a=i[r];if(a.position<=e){i=a.Uf;break e}}i=null}if((r=i)&&(r=!((r=n.Mg)===i||r&&i&&r.bandwidth==i.bandwidth&&r.audioSamplingRate==i.audioSamplingRate&&r.codecs==i.codecs&&r.contentType==i.contentType&&r.frameRate==i.frameRate&&r.height==i.height&&r.mimeType==i.mimeType&&r.channelsCount==i.channelsCount&&r.pixelAspectRatio==i.pixelAspectRatio&&r.width==i.width)),r)e:{if(r=e,a=i.contentType,(a=this.h()[a])&&0<a.length){var o=a[a.length-1].end;if(r>=a[0].start&&r<o){r=!0;break e}}r=!1}r&&(n.Mg=i,JSON.stringify(i),n=new j("qualitychange",new Map([["quality",i],["position",e]])),this.dispatchEvent(n))}},m(ps,J),ps.prototype.release=function(){this.g.clear(),this.h.stop(),J.prototype.release.call(this)},m(fs,J),fs.prototype.release=function(){this.i=null,this.g.clear(),this.h.release(),this.h=null,J.prototype.release.call(this)},fs.prototype.j=function(e,t){if(!this.l||0!=e){this.l=!1;for(var n=l(this.i.g),i=n.next();!i.done;i=n.next()){i=i.value;var r=this.g.get(i),a=e<i.startTime?ms:e>i.endTime?ys:vs;this.g.set(i,a);for(var o=l(this.m),s=o.next();!s.done;s=o.next())(s=s.value).Dc==r&&s.Cc==a&&s.vc(i,t)}}};var ms=1,vs=2,ys=3;function bs(e,t,n){this.i=e,this.h=t,this.j=0,this.l=n,this.g=new Map}function _s(e,t,n){if(n=void 0!==n&&n,e.h.segmentIndex){var i=e.h.segmentIndex.rc(Math.max(t.startTime,e.j));if(i){var r=t;for(n&&(r=i.next().value)&&r.startTime==t.startTime&&r.endTime==t.endTime&&(r=null);e.g.size<e.i&&null!=r&&(t=!0,r.l&&null!=r.Na&&(t=!1),2==r.sc()&&(t=!1),t&&!e.g.has(r)&&(As(t=new Ts(e.l),r,e.h),e.g.set(r,t)),e.j=r.startTime,!(e.h.fastSwitching&&r.Fd&&r.ue));)r=i.next().value}}}function ws(e){if(0!==e.g.size){for(var t=l(e.g.keys()),n=t.next();!n.done;n=t.next())(n=n.value)&&Ss(e,n);e.j=0}}function Ss(e,t){var n=e.g.get(t);e.g.delete(t),n&&n.abort()}function Ts(e){this.i=e,this.g=this.h=null}function As(e,t,n){var i=new Uint8Array(0);e.g=e.i(t,n,(function(t){return L((function(n){if(1==n.g)return i=0<i.byteLength?_r(i,t):t,e.h?_(n,e.h(i),3):n.F(0);i=new Uint8Array(0),w(n)}))}))}function Es(e,t,n,i,r){return e=Li(e,i,r),0==t&&null==n||(e.headers.Range=n?"bytes="+t+"-"+n:"bytes="+t+"-"),e}function Cs(e,t){var n=this;this.g=t,this.m=e,this.h=null,this.C=1,this.s=this.j=null,this.H=0,this.G=!1,this.i=new Map,this.D=!1,this.I=null,this.u=!1,this.l=new Gi((function(){return function(e){var t,n,i,r;return L((function(a){if(1==a.g){for(t=[],n=l(e.i.values()),i=n.next();!i.done;i=n.next())js(r=i.value),t.push(Hs(r));return _(a,Promise.all(t),2)}e.i.clear(),e.g=null,e.m=null,e.h=null,w(a)}))}(n)})),this.J=Date.now()/1e3}function xs(e,t){var n=e.i.get("video");if(n){var i=n.stream;i&&(t?(t=i.trickModeVideo)&&!n.Ac&&(Ms(e,t,!1,0,!1),n.Ac=i):(i=n.Ac)&&(n.Ac=null,Ms(e,i,!0,0,!1)))}}function Is(e,t,n,i,r,a){n=void 0!==n&&n,i=void 0===i?0:i,r=void 0!==r&&r,a=void 0!==a&&a,e.j=t,e.D&&(t.video&&Ms(e,t.video,n,i,r,a),t.audio&&Ms(e,t.audio,n,i,r,a))}function ks(e,t){L((function(n){if(1==n.g)return e.s=t,e.D?t.segmentIndex?n.F(2):_(n,t.createSegmentIndex(),2):n.return();Ms(e,t,!0,0,!1),w(n)}))}function Ms(e,t,n,i,r,a){var o=e.i.get(t.type);o||t.type!=Ae?o&&(o.Ac&&(t.trickModeVideo?(o.Ac=t,t=t.trickModeVideo):o.Ac=null),o.stream!=t||r)&&(o.Ia&&function(e,t){t&&t!==e.h&&(ws(e),e.h=t)}(o.Ia,t),t.type==Ae&&(r=Ht(t.mimeType,t.codecs),_o(e.g.Y,r,e.m.sequenceMode,t.external)),o.stream.closeSegmentIndex&&o.stream.closeSegmentIndex(),o.stream=t,o.ea=null,o.Dg=!!a,n&&(o.pd?o.Re=!0:o.Ta?(o.Sb=!0,o.be=i,o.Re=!0):(js(o),Fs(e,o,!0,i).catch((function(t){e.g&&e.g.onError(t)})))),function(e,t){var n,i;return L((function(r){if(1==r.g)return t.eb?(n=t.stream,i=t.eb,n.segmentIndex?r.F(2):_(r,n.createSegmentIndex(),2)):r.return();if(t.eb!=i||t.stream!=n)return r.return();var a=e.g.je(),o=To(e.g.Y,t.type),s=t.stream.segmentIndex.find(t.Sa?t.Sa.endTime:a),u=null==s?null:t.stream.segmentIndex.get(s);s=u&&u.Na?u.Na-u.hb:null,u&&!s&&(s=(u.endTime-u.getStartTime())*(t.stream.bandwidth||0)/8),s?((u=u.ka)&&(s+=(u.Na?u.Na-u.hb:null)||0),a=8*s/(u=e.g.getBandwidthEstimate())<(o||0)-a-Math.max(e.m.minBufferTime||0,e.h.rebufferingGoal)||t.eb.h.g>s):a=!1,a&&t.eb.abort(),w(r)}))}(e,o).catch((function(t){e.g&&e.g.onError(t)}))):function(e,t){var n,i,r,a,o;L((function(s){switch(s.g){case 1:return n=Ee,e.H++,i=e.H,S(s,2),_(s,Co(e.g.Y,n.Da),4);case 4:A(s,3);break;case 2:r=E(s),e.g&&e.g.onError(r);case 3:a=Ht(t.mimeType,t.codecs),_o(e.g.Y,a,e.m.sequenceMode,t.external),(e.g.Y.H.isTextVisible()||e.h.alwaysStreamText)&&e.H==i&&(o=Ls(e,t),e.i.set(n.Da,o),Gs(e,o,0)),w(s)}}))}(e,t)}function Ps(e,t){t.pd||t.Sb||(t.Ta?(t.Sb=!0,t.be=0):null==So(e.g.Y,t.type)?null==t.Eb&&Gs(e,t,0):(js(t),Fs(e,t,!1,0).catch((function(t){e.g&&e.g.onError(t)}))))}function Ls(e,t){return{stream:t,type:t.type,ea:null,Ia:Ds(e,t),Sa:null,ec:null,Rf:null,Pf:null,Of:null,Ac:null,endOfStream:!1,Ta:!1,Eb:null,Sb:!1,be:0,Re:!1,pd:!1,Kd:!0,Vf:!1,dg:!1,wd:!1,eb:null}}function Ds(e,t){return"video"!==t.type&&"audio"!==t.type?null:0<e.h.segmentPrefetchLimit?new bs(e.h.segmentPrefetchLimit,t,(function(t,n,i){return Bs(e,t,n,i)})):null}function Rs(t,n){var i,r,a,o,s;return L((function(u){switch(u.g){case 1:if(ji(t.l),n.Ta||null==n.Eb||n.pd)return u.return();if(n.Eb=null,!n.Sb){u.F(2);break}return _(u,Fs(t,n,n.Re,n.be),3);case 3:return u.return();case 2:if(n.stream.segmentIndex){u.F(4);break}return i=n.stream,_(u,n.stream.createSegmentIndex(),5);case 5:if(i!=n.stream)return i.closeSegmentIndex&&i.closeSegmentIndex(),n.Ta||n.Eb||Gs(t,n,0),u.return();case 4:S(u,6),r=function(t,n){if(Os(n))return function(e,t){var n=To(e,"video")||0;$t(e.h,t,n)}(t.g.Y,n.stream.originalId||""),null;if(n.type==Ae&&function(e){e.h&&$t(e.h,"",0)}(t.g.Y),!t.g.Y.aa&&n.type!=Ae)return t.h.updateIntervalSeconds/2;var i=t.g.je(),r=n.Sa?n.Sa.endTime:i,a=function(e,t,n){return e.D?0:t==Ae?null==(e=e.h).h||e.h<n?0:e.h-Math.max(n,e.g):Ia(e=Ao(e,t),n)}(t.g.Y,n.type,i),o=Math.max(1,Math.max(t.m.minBufferTime||0,t.h.rebufferingGoal,t.h.bufferingGoal)*t.C),s=t.m.presentationTimeline.getDuration()-r,u=To(t.g.Y,n.type);if(1e-6>s&&u)return n.endOfStream=!0,"video"==n.type&&(t=t.i.get(Ae))&&Os(t)&&(t.endOfStream=!0),null;if(n.endOfStream=!1,a>=o)return t.h.updateIntervalSeconds/2;if(a=function(e,t,n,i){if(t.ea)return t.ea.current();if(t.Sa||i)return n=t.Sa?t.Sa.endTime:i,t.Vf=!0,t.ea=t.stream.segmentIndex.rc(n),t.ea&&t.ea.next().value;e=e.h.inaccurateManifestTolerance,i=Math.max(n-e,0);var r=null;return e&&(t.ea=t.stream.segmentIndex.rc(i),r=t.ea&&t.ea.next().value),r||(t.ea=t.stream.segmentIndex.rc(n),r=t.ea&&t.ea.next().value),r}(t,n,i,u),!a)return t.h.updateIntervalSeconds;for(o=1/0,u=(s=l(s=Array.from(t.i.values()))).next();!u.done;u=s.next())Os(u=u.value)||u.ea&&!u.ea.current()||(o=Math.min(o,u.Sa?u.Sa.endTime:i));return r>=o+t.m.presentationTimeline.g?t.h.updateIntervalSeconds:(n.Ia&&n.ea&&(!(r=a.ka)||n.Sa&&Sa(r,n.ec)||function(e,t){if(e.h.segmentIndex&&e.g.size<e.i&&!e.g.has(t)){var n=new Ts(e.l);As(n,t,e.h),e.g.set(t,n)}}(n.Ia,r),_s(n.Ia,a)),function(t,n,i,r){var a,o,s,u,l,h,c,d,p,f,g,m,v,y,b;return L((function(T){switch(T.g){case 1:if(a=Ee,o=n.stream,s=n.ea,n.Ta=!0,S(T,2),2==r.sc())throw new ye(1,1,1011);return _(T,function(e,t,n){var i,r,a,o,s,u,l,h,c,d,p,f,g;return L((function(m){return 1==m.g?(i=Ee,r=[],a=Math.max(0,n.appendWindowStart-.1),o=n.appendWindowEnd+.01,s=Xt(t.stream.codecs),u=Kt(t.stream.mimeType),(l=n.timestampOffset)==t.Rf&&a==t.Pf&&o==t.Of&&s==t.Qf&&u==t.ah?m.F(2):((h=t.Qf&&t.ah&&function(e,t,n){if(t==Ae)var i=!1;else{i=Xt(Yt(e.I[t]));var r=Kt(e.I[t]),a=Ht(n.mimeType,n.codecs),o=e.G.forceTransmux;(!ze(a)||!e.C&&Zt.includes(a)||n.codecs.includes(","))&&(o=!0),n=Vt(n.mimeType,n.codecs),o&&(o=Nt(n))&&(a=(o=o()).convertCodecs(t,n),o.destroy()),t=Xt(Yt(a)),a=Kt(a),i=i!==t||r!==a}return!!i&&("smooth"!==e.G.codecSwitchingStrategy||!Xe()||e.s)}(e.g.Y,t.type,t.stream))&&(c=null,t.type===i.ia?c=e.i.get(i.U):t.type===i.U&&(c=e.i.get(i.ia)),c&&(c.ec=null,Ps(e,c),Hs(c).catch((function(){})))),d=function(){var r,c,d,p;return L((function(f){if(1==f.g)return r=new Map,e.j.audio&&r.set(i.U,e.j.audio),e.j.video&&r.set(i.ia,e.j.video),S(f,2),t.Pf=a,t.Of=o,t.Qf=s,t.ah=u,t.Rf=l,c=e.m.sequenceMode||"HLS"==e.m.type,_(f,function(e,t,n,i,r,a,o,s,u){var l,h;return L((function(c){return 1==c.g?t==(l=Ee).Da?(a||(e.h.u=n),function(e,t,n){e.l=t,e.m=n}(e.h,i,r),c.return()):(h=[],_(c,function(e,t,n,i,r){var a,o,s,u,l,h,c,d,p,f,g,m,v,y,b;return L((function(w){return 1==w.g?t==(a=Ee).Da?w.return(!1):(o=Xt(Yt(e.I[t])),s=Kt(e.I[t]),l=!1,h=Ht(n,i),c=e.G.forceTransmux,(!ze(h)||!e.C&&Zt.includes(h)||i.includes(","))&&(c=!0),c&&(d=Vt(n,i),p=Nt(d))&&(u=p(),f=Te(a.U,(i||"").split(",")),g=Te(a.ia,(i||"").split(",")),f&&g?(l=!0,m=g,t==a.U&&(m=f),h=u.convertCodecs(t,Vt(n,m))):h=u.convertCodecs(t,d)),v=Xt(Yt(h)),y=Kt(h),o===v&&s===y?w.return(!1):(b=!0,(e.s||l&&u&&!e.m[t])&&(b=!1),b&&"smooth"===e.G.codecSwitchingStrategy&&Xe()?_(w,function(e,t,n,i){return Po(e,t,(function(){t!==Ae&&(Xe()&&(e.m[t]&&(e.m[t].destroy(),delete e.m[t]),i&&(e.m[t]=i),e.g[t].changeType(n+e.G.sourceBufferExtraFeatures),e.I[t]=n),Mo(e,t))}))}(e,t,h,u),3):(u&&u.destroy(),_(w,No(e,r),3)))):w.return(!0)}))}(e,t,o,s,u),2)):(c.h||(h.push(Po(e,t,(function(){return Io(e,t)}))),e.s&&h.push(Po(e,l.U,(function(){return Io(e,l.U)})))),a||(h.push(Po(e,t,(function(){return ko(e,t,n)}))),e.s&&h.push(Po(e,l.U,(function(){return ko(e,l.U,n)})))),h.push(Po(e,t,(function(){e.g[t].appendWindowStart=0,e.g[t].appendWindowEnd=r,e.g[t].appendWindowStart=i,Mo(e,t)}))),e.s&&h.push(Po(e,l.U,(function(){var t=l.U;e.g[t].appendWindowStart=0,e.g[t].appendWindowEnd=r,e.g[t].appendWindowStart=i,Mo(e,t)}))),_(c,Promise.all(h),0))}))}(e.g.Y,t.type,l,a,o,c,n.mimeType||t.stream.mimeType,n.codecs||t.stream.codecs,r),4);if(2!=f.g)return h&&(d=null,t.type===i.ia?d=e.i.get(i.U):t.type===i.U&&(d=e.i.get(i.ia)),d&&(d.Sb=!1,d.Ta=!1,Ps(e,d))),A(f,0);throw p=E(f),t.Pf=null,t.Of=null,t.Qf=null,t.Rf=null,p}))},_(m,d(),2))):(Sa(n.ka,t.ec)||(t.ec=n.ka,n.j&&n.ka&&(p=Us(e,t,n.ka),f=function(){var r,a,o,s,u;return L((function(l){switch(l.g){case 1:return S(l,2),_(l,p,4);case 4:return r=l.h,ji(e.l),a=null,o=new Map,(new rr).box("moov",ar).box("trak",ar).box("mdia",ar).T("mdhd",(function(e){a=Fa(e.reader,e.version).timescale})).box("hdlr",(function(e){(e=e.reader).skip(8),e=e.Qb(4);var t=String.fromCharCode(e[0]);switch(t+=String.fromCharCode(e[1]),t+=String.fromCharCode(e[2]),t+=String.fromCharCode(e[3])){case"soun":o.set(i.U,a);break;case"vide":o.set(i.ia,a)}a=null})).parse(r),o.has(t.type)?n.ka.timescale=o.get(t.type):null!=a&&(n.ka.timescale=a),s=t.stream.closedCaptions&&0<t.stream.closedCaptions.size,_(l,e.g.Gg(t.type,r),5);case 5:return _(l,Eo(e.g.Y,t.type,r,null,t.stream,s),6);case 6:A(l,0);break;case 2:throw u=E(l),t.ec=null,u}}))},e.g.Wi(n.startTime,n.ka),r.push(f()))),e.m.sequenceMode&&(g=t.Sa?t.Sa.i:null,n.i!=g||t.Vf)&&(t.Vf=!1,r.push(function(e,t,n){var i;return L((function(r){return 1==r.g?t==(i=Ee).Da?r.return():(Po(e,t,(function(){return Io(e,t)})),e.s&&Po(e,i.U,(function(){return Io(e,i.U)})),_(r,Po(e,t,(function(){return ko(e,t,n)})),2)):e.s?_(r,Po(e,i.U,(function(){return ko(e,i.U,n)})),0):r.F(0)}))}(e.g.Y,t.type,n.startTime))),_(m,Promise.all(r),0))}))}(t,n,r),4);case 4:return ji(t.l),t.u?T.return():(u="video/mp4"==o.mimeType||"audio/mp4"==o.mimeType,l=e.ReadableStream,t.h.lowLatencyMode&&l&&u&&("HLS"!=t.m.type||r.m)?(c=new Uint8Array(0),p=d=!1,g=function(e){var a,s,u;return L((function(l){switch(l.g){case 1:if(d)return l.return();if(p=!0,ji(t.l),t.u)return l.return();if(S(l,2),c=function(e,t){var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}(c,e),a=!1,s=0,(new rr).box("mdat",(function(e){s=e.size+e.start,a=!0})).parse(c,!1,!0),!a){l.F(4);break}return u=c.subarray(0,s),c=c.subarray(s),_(l,Ns(t,n,i,o,r,u,!0),5);case 5:n.Ia&&n.ea&&_s(n.Ia,r,!0);case 4:A(l,0);break;case 2:f=E(l),w(l)}}))},_(T,Us(t,n,r,g),9)):_(T,Us(t,n,r),7));case 7:return h=T.h,ji(t.l),t.u?T.return():(ji(t.l),n.Sb?(n.Ta=!1,Gs(t,n,0),T.return()):_(T,Ns(t,n,i,o,r,h),6));case 9:if(m=T.h,f)throw f;if(p){T.F(10);break}return d=!0,ji(t.l),t.u?T.return():n.Sb?(n.Ta=!1,Gs(t,n,0),T.return()):_(T,Ns(t,n,i,o,r,m),10);case 10:n.Ia&&n.ea&&_s(n.Ia,r,!0);case 6:if(ji(t.l),t.u)return T.return();n.Sa=r,s.next(),n.Ta=!1,n.dg=!1,v=t.g.Y.Lb(),y=v[n.type],JSON.stringify(y),n.Sb||t.g.Zf(r,n.stream),Gs(t,n,0),A(T,0);break;case 2:if(b=E(T),ji(t.l,b),t.u)return T.return();if(n.Ta=!1,7001==b.code)n.Ta=!1,js(n),Gs(t,n,0),T.F(0);else if(n.type==a.Da&&t.h.ignoreTextStreamFailures)t.i.delete(a.Da),T.F(0);else{if(3017!=b.code)return n.wd=!0,b.severity=2,_(T,Vs(t,n,b),0);(function(e,t,n){if(!Array.from(e.i.values()).some((function(e){return e!=t&&e.dg}))){if(0<e.h.maxDisabledTime&&e.g.ce(t.stream,e.h.maxDisabledTime))return;var i=Math.round(100*e.C);if(20<i)e.C-=.2;else{if(!(4<i))return t.wd=!0,e.u=!0,void e.g.onError(n);e.C-=.04}t.dg=!0}Gs(e,t,4)})(t,n,b),T.F(0)}}}))}(t,n,i,a).catch((function(){})),null)}(t,n),null!=r&&(Gs(t,n,r),n.wd=!1),A(u,7);break;case 6:return a=E(u),_(u,Vs(t,n,a),8);case 8:return u.return();case 7:if(o=Array.from(t.i.values()),!t.D||!o.every((function(e){return e.endOfStream}))){u.F(0);break}return _(u,t.g.Y.endOfStream(),10);case 10:ji(t.l),0!=(s=t.g.Y.getDuration())&&s<t.m.presentationTimeline.getDuration()&&t.m.presentationTimeline.gb(s),w(u)}}))}function Ns(e,t,n,i,r,a,o){var s,u,l,h,c,d;return o=void 0!==o&&o,L((function(p){switch(p.g){case 1:return s=i.closedCaptions&&0<i.closedCaptions.size,l=null!=i.emsgSchemeIdUris&&0<i.emsgSchemeIdUris.length||e.h.dispatchAllEmsgBoxes,h=e.h.parsePrftBox&&!e.G,(l||h)&&(u=new rr),l&&u.T("emsg",(function(t){var n=i.emsgSchemeIdUris;if(0===t.version)var a=t.reader.Hd(),o=t.reader.Hd(),s=t.reader.O(),u=t.reader.O(),l=t.reader.O(),h=t.reader.O(),c=r.startTime+u/s;else s=t.reader.O(),u=(c=t.reader.Uc()/s+r.timestampOffset)-r.startTime,l=t.reader.O(),h=t.reader.O(),a=t.reader.Hd(),o=t.reader.Hd();t=t.reader.Qb(t.reader.getLength()-t.reader.Ga()),(n&&n.includes(a)||e.h.dispatchAllEmsgBoxes)&&("urn:mpeg:dash:event:2012"==a?e.g.Xi():((n=new j("emsg",n=(new Map).set("detail",{startTime:c,endTime:c+l/s,schemeIdUri:a,value:o,timescale:s,presentationTimeDelta:u,eventDuration:l,id:h,messageData:t}))).cancelable=!0,e.g.onEvent(n),n.defaultPrevented||"https://aomedia.org/emsg/ID3"!=a&&"https://developer.apple.com/streaming/emsg-id3"!=a||(a=Na(t)).length&&r&&e.g.Yi([{cueTime:r.startTime,data:t,frames:a,dts:r.startTime,pts:r.startTime}],0,r.endTime)))})),h&&u.T("prft",(function(t){if(!e.G&&r.ka.timescale){var n=t.reader,i=t.version;n.O(),t=1e3*(t=n.O())+n.O()/Math.pow(2,32)*1e3,0===i?n=n.O():(i=n.O(),n=n.O(),n=i*Math.pow(2,32)+n),t=new Date(new Date(Date.UTC(1900,0,1,0,0,0)).getTime()+t).getTime(),n=new j("prft",n=(new Map).set("detail",{wallClockTime:t,programStartDate:new Date(t-n/r.ka.timescale*1e3)})),e.g.onEvent(n),e.G=!0}})),(l||h)&&u.parse(a),_(p,function(e,t,n){var i,r,a;return L((function(o){if(1==o.g)return i=Math.max(e.h.bufferBehind,e.m.presentationTimeline.g),null==(r=So(e.g.Y,t.type))||1>=(a=n-r-i)?o.return():_(o,e.g.Y.remove(t.type,r,r+a),2);ji(e.l),w(o)}))}(e,t,n),2);case 2:return ji(e.l),c=t.Kd,t.Kd=!1,d=t.Dg,t.Dg=!1,_(p,e.g.Gg(t.type,a),3);case 3:return _(p,Eo(e.g.Y,t.type,a,r,i,s,c,d,o),4);case 4:ji(e.l),w(p)}}))}function Os(e){return e&&e.type==Ae&&("application/cea-608"==e.stream.mimeType||"application/cea-708"==e.stream.mimeType)}function Us(t,n,i,r){var a,o,s,u,l;return L((function(h){switch(h.g){case 1:if(i instanceof wa&&(a=i.g))return h.return(a);if(o=null,n.Ia){var c=n.Ia;if(c.g.has(i)){var d=c.g.get(i);r&&(d.h=r),c.g.delete(i),o=d.g}else o=null}return o||(o=Bs(t,i,n.stream,r)),s=0,n.ea&&(s=n.ea.g),n.eb=o,_(h,o.promise,2);case 2:if(u=h.h,n.eb=null,l=u.data,!i.aes128Key){h.F(3);break}return _(h,function(t,n,i){var r,a,o,s;return L((function(u){if(1==u.g)return(r=n).cryptoKey?u.F(2):_(u,r.fetchKey(),3);if(!(a=r.iv))for(a=et(new ArrayBuffer(16)),o=r.firstMediaSequenceNumber+i,s=a.byteLength-1;0<=s;s--)a[s]=255&o,o>>=8;return u.return(e.crypto.subtle.decrypt({name:"AES-CBC",iv:a},r.cryptoKey,t))}))}(l,i.aes128Key,s),4);case 4:l=h.h;case 3:return h.return(l)}}))}function Bs(e,t,n,i){var r=t instanceof Ta?t:void 0,a=r?1:0;return t=Es(t.ba(),t.hb,t.Na,e.h.retryParameters,i),e.g.zc.request(Ui,t,{type:a,stream:n,segment:r})}function Fs(e,t,n,i){var r,a;return L((function(o){return 1==o.g?(t.Sb=!1,t.Re=!1,t.be=0,t.pd=!0,t.Sa=null,t.ec=null,t.ea=null,t.Ia&&ws(t.Ia),i?(r=e.g.je(),a=e.g.Y.getDuration(),_(o,e.g.Y.remove(t.type,r+i,a),3)):_(o,Co(e.g.Y,t.type),4)):3!=o.g?(ji(e.l),n?_(o,e.g.Y.flush(t.type),3):o.F(3)):(ji(e.l),t.pd=!1,t.endOfStream=!1,t.Ta||t.Eb||Gs(e,t,0),void w(o))}))}function Gs(e,t,n){var i=t.type;(i!=Ae||e.i.has(i))&&(t.Eb=new un((function(){var n;return L((function(i){return 1==i.g?(S(i,2),_(i,Rs(e,t),4)):2!=i.g?A(i,0):(n=E(i),e.g&&e.g.onError(n),void w(i))}))})).S(n))}function js(e){null!=e.Eb&&(e.Eb.stop(),e.Eb=null)}function Hs(e){return L((function(t){return e.eb?_(t,e.eb.abort(),0):t.F(0)}))}function Vs(e,t,n){var i;return L((function(r){if(1==r.g)return _(r,_i(e.I),2);ji(e.l),i=0===e.h.maxDisabledTime&&1011==n.code?1:e.h.maxDisabledTime,1===n.category&&0<i&&(n.handled=e.g.ce(t.stream,i),n.handled&&(n.severity=1)),e.g.onError(n),n.handled||e.h.failureCallback(n),w(r)}))}function Ws(e,t,n){var i,r,a,o,s,u,l;return L((function(h){switch(h.g){case 1:var c=new ne(e).Ya.split("/").pop().split(".");return i=1==c.length?"":c.pop().toLowerCase(),(r=zs[i])?h.return(r):(a=0,o=Li([e],n),S(h,2),o.method="HEAD",_(h,t.request(a,o).promise,4));case 4:s=h.h,r=s.headers["content-type"],A(h,3);break;case 2:if(!(u=E(h))||1002!=u.code&&1001!=u.code){h.F(3);break}return o.method="GET",_(h,t.request(a,o).promise,6);case 6:l=h.h,r=l.headers["content-type"];case 3:return h.return(r?r.toLowerCase().split(";").shift():"")}}))}Ts.prototype.abort=function(){this.g&&this.g.abort()},(i=Cs.prototype).destroy=function(){return this.l.destroy()},i.configure=function(e){this.h=e,this.I=new bi({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0,stallTimeout:0,connectionTimeout:0},!0);for(var t=l(this.i.keys()),n=t.next();!n.done;n=t.next())if((n=this.i.get(n.value)).Ia){var i=n.Ia,r=e.segmentPrefetchLimit;i.i=r;for(var a=Array.from(i.g.keys());a.length>r;){var o=a.pop();o&&Ss(i,o)}0<e.segmentPrefetchLimit||(n.Ia=null)}else 0<e.segmentPrefetchLimit&&(n.Ia=Ds(this,n.stream))},i.start=function(){var e=this;return L((function(t){if(1==t.g)return _(t,function(e){var t,n,i,r,a,o,s,u;return L((function(h){if(1==h.g){if(t=Ee,!e.j)throw new ye(2,5,5006);return n=new Map,i=new Set,e.j.audio&&(n.set(t.U,e.j.audio),i.add(e.j.audio)),e.j.video&&(n.set(t.ia,e.j.video),i.add(e.j.video)),e.s&&(n.set(t.Da,e.s),i.add(e.s)),_(h,e.g.Y.init(n,e.m.sequenceMode,e.m.type,e.m.ignoreManifestTimestampsInSegmentsMode),2)}for(ji(e.l),e.updateDuration(),r=l(n.keys()),a=r.next();!a.done;a=r.next())o=a.value,s=n.get(o),e.i.has(o)||(u=Ls(e,s),e.i.set(o,u),Gs(e,u,0));w(h)}))}(e),2);ji(e.l),e.D=!0,w(t)}))},i.Kd=function(){if(this.g)for(var e=this.g.je(),t=l(this.i.keys()),n=t.next();!n.done;n=t.next()){var i=n.value,r=null;(n=this.i.get(i)).ea&&(r=n.ea.current()),(!r||r.startTime>e||r.endTime<e)&&(n.ea=null),(r=!(r=this.g.Y).D&&(i==Ae?null!=(r=r.h).g&&null!=r.h&&e>=r.g&&e<r.h:xa(r=Ao(r,i),e)))||((null!=To(this.g.Y,i)||n.Ta)&&Ps(this,n),n.eb&&(n.eb.abort(),n.eb=null),i===Ae&&(i=this.g.Y).J&&i.J.h(),n.Kd=!0)}},i.updateDuration=function(){var e=this.m.presentationTimeline.getDuration();1/0>e?this.g.Y.gb(e):this.g.Y.gb(Math.pow(2,32))};var zs={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mpd:"application/dash+xml",ism:"application/vnd.ms-sstr+xml",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav",sbv:"text/x-subviewer",srt:"text/srt",vtt:"text/vtt",webvtt:"text/vtt",ttml:"application/ttml+xml",lrc:"application/x-subtitle-lrc",ssa:"text/x-ssa",ass:"text/x-ssa"};function Xs(e,t){if(e.lineBreak)return"\n";if(e.nestedCues.length)return e.nestedCues.map((function(t){return Xs(t,e)})).join("");var n=[],i=700<=e.fontWeight,r="italic"==e.fontStyle,a=e.textDecoration.includes("underline");return i&&n.push(["b"]),r&&n.push(["i"]),a&&n.push(["u"]),""==(r=e.color)&&t&&(r=t.color),i="",(r=Ks(r))&&(i+="."+r),""==(r=e.backgroundColor)&&t&&(r=t.backgroundColor),(t=Ks(r))&&(i+=".bg_"+t),i&&n.push(["c",i]),n.reduceRight((function(e,t){var n=l(t);return"<"+(t=n.next().value)+(void 0===(n=n.next().value)?"":n)+">"+e+"</"+t+">"}),e.payload)}function Ks(e){var t=(e=e.toLowerCase()).replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i);switch(t?e="#"+(256|parseInt(t[1],10)).toString(16).slice(1)+(256|parseInt(t[2],10)).toString(16).slice(1)+(256|parseInt(t[3],10)).toString(16).slice(1):e.startsWith("#")&&7<e.length&&(e=e.slice(0,7)),e){case"white":case"#fff":case"#ffffff":return"white";case"lime":case"#0f0":case"#00ff00":return"lime";case"cyan":case"#0ff":case"#00ffff":return"cyan";case"red":case"#f00":case"#ff0000":return"red";case"yellow":case"#ff0":case"#ffff00":return"yellow";case"magenta":case"#f0f":case"#ff00ff":return"magenta";case"blue":case"#00f":case"#0000ff":return"blue";case"black":case"#000":case"#000000":return"black"}return null}function Ys(e,t){for(var n=[],i=(e=l(e)).next();!i.done;i=e.next())if((i=i.value).isContainer)n.push.apply(n,h(Ys(i.nestedCues,i)));else{var r=i.clone();r.nestedCues=[],r.payload=Xs(i,t),n.push(r)}return n}function qs(e,t){this.g=null;for(var n=l(Array.from(e.textTracks)),i=n.next();!i.done;i=n.next())(i=i.value).mode="disabled",i.label==t&&(this.g=i);this.g||(this.g=e.addTextTrack("subtitles",t)),this.g.mode="hidden"}function Zs(e){if(e.startTime>=e.endTime)return null;var t=new VTTCue(e.startTime,e.endTime,e.payload);t.lineAlign=e.lineAlign,t.positionAlign=e.positionAlign,e.size&&(t.size=e.size);try{t.align=e.textAlign}catch(e){}return"center"==e.textAlign&&"center"!=t.align&&(t.align="middle"),"vertical-lr"==e.writingMode?t.vertical="lr":"vertical-rl"==e.writingMode&&(t.vertical="rl"),1==e.lineInterpretation&&(t.snapToLines=!1),null!=e.line&&(t.line=e.line),null!=e.position&&(t.position=e.position),t}function Js(e,t){var n=e.mode;e.mode="showing"==n?"showing":"hidden";for(var i=l(Array.from(e.cues)),r=i.next();!r.done;r=i.next())(r=r.value)&&t(r)&&e.removeCue(r);e.mode=n}function Qs(){}function $s(){}function eu(e){return document.createElement(e)}function tu(){var e=document.createElement("button");return e.setAttribute("type","button"),e}function nu(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function iu(t,n){var i=this;this.m=!1,this.i=[],this.D=t,this.u=n,this.j=null,this.g=eu("div"),this.g.classList.add("shaka-text-container"),this.g.style.textAlign="center",this.g.style.display="flex",this.g.style.flexDirection="column",this.g.style.alignItems="center",this.g.style.justifyContent="flex-end",this.u.appendChild(this.g),this.G=new ln((function(){ou(i)})).za(.25),this.h=new Map,this.l=new Hi,this.l.o(document,"fullscreenchange",(function(){ou(i,!0)})),this.l.o(this.D,"resize",(function(){var e=i.D,t=e.videoWidth;e=e.videoHeight,i.j=t&&e?t/e:null})),this.s=null,"ResizeObserver"in e&&(this.s=new ResizeObserver((function(){ou(i,!0)})),this.s.observe(this.g)),this.C=new Map}function ru(e,t){for(;null!=t;){if(t==e.g)return!0;t=t.parentElement}return!1}function au(e,t,n,i,r){for(var a=!1,o=[],s=[],u=(t=l(t)).next();!u.done;u=t.next()){u=u.value,r.push(u);var h=e.h.get(u),c=u.startTime<=i&&u.endTime>i,d=h?h.Ch:null;h&&(o.push(h.nf),h.Id&&o.push(h.Id),c||(a=!0,e.h.delete(u),h=null)),c&&(s.push(u),h?ru(e,d)||(a=!0):(su(e,u,r),d=(h=e.h.get(u)).Ch,a=!0)),0<u.nestedCues.length&&d&&au(e,u.nestedCues,d,i,r),r.pop()}if(a){for(r=(i=l(o)).next();!r.done;r=i.next())(r=r.value).parentElement&&r.parentElement.removeChild(r);for(s.sort((function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime-t.endTime})),u=(s=l(s)).next();!u.done;u=s.next())(i=e.h.get(u.value)).Id?(n.appendChild(i.Id),i.Id.appendChild(i.nf)):n.appendChild(i.nf)}}function ou(e,t){if(e.g){var n=e.D.currentTime;if(!e.m||void 0!==t&&t){for(var i=(t=l(e.C.values())).next();!i.done;i=t.next())nu(i.value);nu(e.g),e.h.clear(),e.C.clear()}if(e.m){t=new Map;for(var r=(i=l(e.h.keys())).next();!r.done;r=i.next())r=r.value,t.set(r,e.h.get(r));au(e,e.i,e.g,n,[])}}}function su(e,t,n){var i=1<n.length,r=i?"span":"div";t.lineBreak&&(r="br"),t.rubyTag&&(r=t.rubyTag),i=!i&&0<t.nestedCues.length;var a=eu(r);if("br"!=r&&function(e,t,n,i,r){var a=t.style,o=0==n.nestedCues.length,s=1<i.length;a.whiteSpace="pre-wrap";var u=n.payload.replace(/\s+$/g,(function(e){return"".repeat(e.length)}));if(a.webkitTextStrokeColor=n.textStrokeColor,a.webkitTextStrokeWidth=n.textStrokeWidth,a.color=n.color,a.direction=n.direction,a.opacity=n.opacity,a.paddingLeft=uu(n.linePadding,n,e.u),a.paddingRight=uu(n.linePadding,n,e.u),a.textCombineUpright=n.textCombineUpright,a.textShadow=n.textShadow,n.backgroundImage)a.backgroundImage="url('"+n.backgroundImage+"')",a.backgroundRepeat="no-repeat",a.backgroundSize="contain",a.backgroundPosition="center",a.width="100%",a.height="100%";else{if(n.nestedCues.length)var l=t;else l=eu("span"),t.appendChild(l);n.border&&(l.style.border=n.border),!r&&((t=lu(i,(function(e){return e.backgroundColor})))?l.style.backgroundColor=t:u&&(l.style.backgroundColor="rgba(0, 0, 0, 0.8)"),t=lu(i,(function(e){return e.fontFamily})))&&(l.style.fontFamily=t),u&&(l.textContent=u)}s&&!i[i.length-1].isContainer?a.display="inline":(a.display="flex",a.flexDirection="column",a.alignItems="center",a.justifyContent="before"==n.displayAlign?"flex-start":"center"==n.displayAlign?"center":"flex-end"),o||(a.margin="0"),a.fontFamily=n.fontFamily,a.fontWeight=n.fontWeight.toString(),a.fontStyle=n.fontStyle,a.letterSpacing=n.letterSpacing,a.fontSize=uu(n.fontSize,n,e.u),null!=(i=n.line)&&((o=n.lineInterpretation)==St&&(o=1,s=16,e.j&&1>e.j&&(s=32),i=0>i?100+i/s*100:i/s*100),1==o&&(a.position="absolute",n.writingMode==wt?(a.width="100%",n.lineAlign==Tt?a.top=i+"%":"end"==n.lineAlign&&(a.bottom=100-i+"%")):"vertical-lr"==n.writingMode?(a.height="100%",n.lineAlign==Tt?a.left=i+"%":"end"==n.lineAlign&&(a.right=100-i+"%")):(a.height="100%",n.lineAlign==Tt?a.right=i+"%":"end"==n.lineAlign&&(a.left=100-i+"%")))),a.lineHeight=n.lineHeight,null!=n.position&&(n.writingMode==wt?a.paddingLeft=n.position:a.paddingTop=n.position),e=function(e){var t=e.direction,n=e.positionAlign;return e=e.textAlign,n!==gt?n:"left"===e||"start"===e&&t===_t||"end"===e&&"rtl"===t?"line-left":"right"===e||"start"===e&&"rtl"===t||"end"===e&&t===_t?"line-right":"center"}(n),"line-left"==e?a.cssFloat="left":"line-right"==e&&(a.cssFloat="right"),a.textAlign=n.textAlign,a.textDecoration=n.textDecoration.join(" "),a.writingMode=n.writingMode,"writingMode"in document.documentElement.style&&a.writingMode==n.writingMode||(a.webkitWritingMode=n.writingMode),n.size&&(n.writingMode==wt?a.width=n.size+"%":a.height=n.size+"%")}(e,a,t,n,i),n=null,t.region&&t.region.id){n=t.region,r=e.j===4/3?2.5:1.9;var o=n.id+"_"+n.width+"x"+n.height+(n.heightUnits==Pt?"%":"px")+"-"+n.viewportAnchorX+"x"+n.viewportAnchorY+(n.viewportAnchorUnits==Pt?"%":"px");if(e.C.has(o))n=e.C.get(o);else{var s=eu("span"),u=n.heightUnits==Pt?"%":"px",l=n.widthUnits==Pt?"%":"px",h=n.viewportAnchorUnits==Pt?"%":"px";s.id="shaka-text-region---"+o,s.classList.add("shaka-text-region"),s.style.position="absolute",2===n.heightUnits&&2===n.widthUnits?(s.style.height=5.33*n.height+"%",s.style.width=n.width*r+"%"):(s.style.height=n.height+u,s.style.width=n.width+l),2===n.viewportAnchorUnits?(u=n.viewportAnchorY/75*100,l=n.viewportAnchorX/(e.j===4/3?160:210)*100,u-=n.regionAnchorY*n.height*5.33/100,l-=n.regionAnchorX*n.width*r/100,s.style.top=u+"%",s.style.left=l+"%"):(s.style.top=n.viewportAnchorY-n.regionAnchorY*n.height/100+h,s.style.left=n.viewportAnchorX-n.regionAnchorX*n.width/100+h),s.style.display="flex",s.style.flexDirection="column",s.style.alignItems="center",s.style.justifyContent="before"==t.displayAlign?"flex-start":"center"==t.displayAlign?"center":"flex-end",e.C.set(o,s),n=s}}r=a,i&&((r=eu("span")).classList.add("shaka-text-wrapper"),r.style.backgroundColor=t.backgroundColor,r.style.lineHeight="normal",a.appendChild(r)),e.h.set(t,{nf:a,Ch:r,Id:n})}function uu(e,t,n){var i=(i=new RegExp(/(\d*\.?\d+)([a-z]+|%+)/).exec(e))?{value:Number(i[1]),unit:i[2]}:null;if(!i)return e;var r=i.value;switch(i.unit){case"%":return r/100*n.clientHeight/t.cellResolution.rows+"px";case"c":return n.clientHeight*r/t.cellResolution.rows+"px";default:return e}}function lu(e,t){for(var n=e.length-1;0<=n;n--){var i=t(e[n]);if(i||0===i)return i}return null}function hu(e,t){this.h=e,this.g=t,this.m=void 0,this.i=!1,this.l=!0,this.j=!1}function cu(t){return t.g.sessionId||(t.g.sessionId=e.crypto.randomUUID()),{v:1,sf:t.m,sid:t.g.sessionId,cid:t.g.contentId,mtp:t.h.getBandwidthEstimate()/1e3}}function du(e,t,n){n=void 0===n?{}:n;var i=void 0===i?e.g.useHeaders:i;if(e.g.enabled){Object.assign(n,cu(e)),n.pr=e.h.Mb();var r=n.ot===vu||n.ot===yu;if(e.j&&r&&(n.bs=!0,n.su=!0,e.j=!1),null==n.su&&(n.su=e.l),i)e=function(e){for(var t=Object.keys(e),n={},i=["Object","Request","Session","Status"],r=[{},{},{},{}],a={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},o=(t=l(t)).next();!o.done;o=t.next())r[null!=a[o=o.value]?a[o]:1][o]=e[o];for(e=0;e<r.length;e++)(a=pu(r[e]))&&(n["CMCD-"+i[e]]=a);return n}(n),Object.keys(e).length&&Object.assign(t.headers,e);else{var a=pu(n);a&&(t.uris=t.uris.map((function(e){return fu(e,a)})))}}}function pu(e){function t(e){return 100*n(e/100)}function n(e){return Math.round(e)}for(var i,r=[],a={br:n,d:n,bl:t,dl:t,mtp:t,nor:function(e){return encodeURIComponent(e)},rtp:t,tb:n},o=Object.keys(e||{}).sort(),s=(o=l(o)).next();!s.done;s=o.next()){var u=e[s=s.value];if(i=u,!(Number.isNaN(i)||null==i||""===i||!1===i||"v"===s&&1===u||"pr"==s&&1===u)){var h,c=a[s];c&&(u=c(u)),h="string"==(c=typeof u)&&"ot"!==s&&"sf"!==s&&"st"!==s?s+"="+JSON.stringify(u):"boolean"===c?s:"symbol"===c?s+"="+u.description:s+"="+u,r.push(h)}}return r.join(",")}function fu(e,t){return!t||e.includes("offline:")?e:((e=new ne(e)).g.set("CMCD",t),e.toString())}(i=qs.prototype).remove=function(e,t){return!!this.g&&(Js(this.g,(function(n){return n.startTime<t&&n.endTime>e})),!0)},i.append=function(e){var t=Ys(e),n=[];e=this.g.cues?Array.from(this.g.cues):[];for(var i={},r=(t=l(t)).next();!r.done;i={Ec:i.Ec},r=t.next())i.Ec=r.value,e.some(function(e){return function(t){return t.startTime==e.Ec.startTime&&t.endTime==e.Ec.endTime&&t.text==e.Ec.payload}}(i))||(r=Zs(i.Ec))&&n.push(r);for(i=(e=l(e=n.slice().sort((function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:"line"in VTTCue.prototype?n.indexOf(t)-n.indexOf(e):n.indexOf(e)-n.indexOf(t)})))).next();!i.done;i=e.next())this.g.addCue(i.value)},i.destroy=function(){return this.g&&(Js(this.g,(function(){return!0})),this.g.mode="disabled"),this.g=null,Promise.resolve()},i.isTextVisible=function(){return"showing"==this.g.mode},i.setTextVisibility=function(e){this.g.mode=e?"showing":"hidden"},G("shaka.text.SimpleTextDisplayer",qs),qs.prototype.setTextVisibility=qs.prototype.setTextVisibility,qs.prototype.isTextVisible=qs.prototype.isTextVisible,qs.prototype.destroy=qs.prototype.destroy,qs.prototype.append=qs.prototype.append,qs.prototype.remove=qs.prototype.remove,(i=Qs.prototype).remove=function(){},i.append=function(){},i.destroy=function(){},i.isTextVisible=function(){return!1},i.setTextVisibility=function(){},G("shaka.text.StubTextDisplayer",Qs),Qs.prototype.setTextVisibility=Qs.prototype.setTextVisibility,Qs.prototype.isTextVisible=Qs.prototype.isTextVisible,Qs.prototype.destroy=Qs.prototype.destroy,Qs.prototype.append=Qs.prototype.append,Qs.prototype.remove=Qs.prototype.remove,G("shaka.util.Dom",$s),$s.removeAllChildren=nu,(i=iu.prototype).append=function(e){for(var t=[].concat(h(this.i)),n={},i=(e=l(e)).next();!i.done;n={Rd:n.Rd},i=e.next())n.Rd=i.value,t.some(function(e){return function(t){return ft(t,e.Rd)}}(n))||this.i.push(n.Rd);ou(this)},i.destroy=function(){return this.g?(this.u.removeChild(this.g),this.g=null,this.m=!1,this.i=[],this.G&&this.G.stop(),this.h.clear(),this.l&&(this.l.release(),this.l=null),this.s&&(this.s.disconnect(),this.s=null),Promise.resolve()):Promise.resolve()},i.remove=function(e,t){if(!this.g)return!1;var n=this.i.length;return this.i=this.i.filter((function(n){return n.startTime<e||n.endTime>=t})),ou(this,n>this.i.length),!0},i.isTextVisible=function(){return this.m},i.setTextVisibility=function(e){this.m=e},G("shaka.text.UITextDisplayer",iu),iu.prototype.setTextVisibility=iu.prototype.setTextVisibility,iu.prototype.isTextVisible=iu.prototype.isTextVisible,iu.prototype.remove=iu.prototype.remove,iu.prototype.destroy=iu.prototype.destroy,iu.prototype.append=iu.prototype.append,G("shaka.text.WebVttGenerator",(function(){})),hu.prototype.configure=function(e){this.g=e};var gu="m",mu="a",vu="v",yu="av",bu="i",_u="c",wu="tt";function Su(e){this.h=e,this.g=null}function Tu(e){return!e||"false"!==e.toLowerCase()&&(/^[-0-9]/.test(e)?parseInt(e,10):e.replace(/["]+/g,""))}G("shaka.util.CmcdManager.StreamingFormat",{DASH:"d",HLS:"h",Eh:"s",OTHER:"o"}),(i=Su.prototype).configure=function(e){this.h=e},i.Ug=function(){return this.h.enabled&&this.h.applyMaximumSuggestedBitrate&&this.g&&this.g.has(Eu)?1e3*this.g.get(Eu):null},i.Tg=function(){return this.h.enabled&&this.g&&this.g.has(Au)?1e3*this.g.get(Au):null},i.ri=function(){return this.h.enabled&&this.g&&this.g.has(Cu)?this.g.get(Cu):null},i.si=function(){return this.h.enabled&&this.g&&this.g.has(xu)?this.g.get(xu):null},i.getBandwidthEstimate=function(e){var t=this.Tg();if(!t)return e;var n=this.h.estimatedThroughputWeightRatio;return 0<n&&1>=n?e*(1-n)+t*n:e},G("shaka.util.CmsdManager",Su),Su.prototype.getBandwidthEstimate=Su.prototype.getBandwidthEstimate,Su.prototype.getRoundTripTime=Su.prototype.si,Su.prototype.getResponseDelay=Su.prototype.ri,Su.prototype.getEstimatedThroughput=Su.prototype.Tg,Su.prototype.getMaxBitrate=Su.prototype.Ug;var Au="etp",Eu="mb",Cu="rd",xu="rtt";function Iu(){}function ku(e,t,n,i,r){var a,o=r in i,s=!0;for(a in t){var u=r+"."+a,l=o?i[r]:n[a];o||a in n?void 0===t[a]?void 0===l||o?delete e[a]:e[a]=on(l):l.constructor==Object&&t[a]&&t[a].constructor==Object?(e[a]||(e[a]=on(l)),u=ku(e[a],t[a],l,i,u),s=s&&u):typeof t[a]!=typeof l||null==t[a]||"function"!=typeof t[a]&&t[a].constructor!=l.constructor?(z("Invalid config, wrong type for "+u),s=!1):("function"==typeof n[a]&&n[a].length!=t[a].length&&X("Unexpected number of arguments for "+u),e[a]=t[a]):(z("Invalid config, unrecognized key "+u),s=!1)}return s}function Mu(e,t){for(var n={},i=n,r=0,a=0;!(0>(r=e.indexOf(".",r)));)0!=r&&"\\"==e[r-1]||(i[a=e.substring(a,r).replace(/\\\./g,".")]={},i=i[a],a=r+1),r+=1;return i[e.substring(a).replace(/\\\./g,".")]=t,n}function Pu(e,t){return e&&t}function Lu(){this.g=null,this.h=[]}function Du(e,t){return L((function(n){if(1==n.g)return e.g?_(n,new Promise((function(t){return e.h.push(t)})),2):n.F(2);e.g=t,w(n)}))}function Ru(){}function Nu(e){return new ne(e=Ji(e)).Kb}function Ou(e,t,n){function i(e){nt(a).setUint32(o,e.byteLength,!0),o+=4,a.set(et(e),o),o+=e.byteLength}if(!n||!n.byteLength)throw new ye(2,6,6015);var r;r="string"==typeof t?$i(t,!0):t,e=$i(e=Ji(e),!0);var a=new Uint8Array(12+e.byteLength+r.byteLength+n.byteLength),o=0;return i(e),i(r),i(n),a}function Uu(e,t,n){return"skd"!==t?e:(t=n.serverCertificate,Ou(e,n=Ji(e).split("skd://").pop(),t))}function Bu(e,t){2===e&&(t.headers["Content-Type"]="application/octet-stream")}function Fu(){}function Gu(){var t=1/0;navigator.connection&&navigator.connection.saveData&&(t=360);var n={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,persistentSessionOnlinePlayback:!1,persistentSessionsMetadata:[],initDataTransform:function(t,n,i){return e.shakaMediaKeysPolyfill&&"skd"==n&&(n=i.serverCertificate,t=Ou(t,i=Nu(t),n)),t},logLicenseExchange:!1,updateExpirationTime:1,preferredKeySystems:[],keySystemsMapping:{},parseInbandPsshEnabled:pn(),minHdcpVersion:"",ignoreDuplicateInitData:!mn()},i="reload",r=!1;mn()||gn()||Sn("Tizen 4")||vn()||navigator.userAgent.match(/webOS\/4/i)||navigator.userAgent.match(/webOS\/5/i)||(i="smooth",r=!0),r={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,disableThumbnails:!1,defaultPresentationDelay:0,segmentRelativeVttTiming:!1,raiseFatalErrorOnManifestUpdateRequestFailure:!1,dash:{clockSyncUri:"",ignoreDrmInfo:!1,disableXlinkProcessing:!1,xlinkFailGracefully:!1,ignoreMinBufferTime:!1,autoCorrectDrift:!0,initialSegmentLimit:1e3,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1,ignoreMaxSegmentDuration:!1,keySystemsByURI:{"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},manifestPreprocessor:function(e){return Pu([e],e)},sequenceMode:!1,enableAudioGroups:!1,multiTypeVariantsAllowed:r},hls:{ignoreTextStreamFailures:!1,ignoreImageStreamFailures:!1,defaultAudioCodec:"mp4a.40.2",defaultVideoCodec:"avc1.42E01E",ignoreManifestProgramDateTime:!1,mediaPlaylistFullMimeType:'video/mp2t; codecs="avc1.42E01E, mp4a.40.2"',useSafariBehaviorForLive:!0,liveSegmentsDelay:3,sequenceMode:!(gn()||mn()||vn()||_n()),ignoreManifestTimestampsInSegmentsMode:!1,disableCodecGuessing:!1,allowLowLatencyByteRangeOptimization:!0},mss:{manifestPreprocessor:function(e){return Pu([e],e)},sequenceMode:!1,keySystemsBySystemId:{"9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready"}}};var a={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},failureCallback:function(e){return Pu([e])},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,gapDetectionThreshold:.5,gapJumpTimerTime:.25,durationBackoff:1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0,inaccurateManifestTolerance:2,lowLatencyMode:!1,autoLowLatencyMode:!1,forceHTTPS:!1,preferNativeHls:!1,updateIntervalSeconds:1,dispatchAllEmsgBoxes:!1,observeQualityChanges:!1,maxDisabledTime:30,parsePrftBox:!1,segmentPrefetchLimit:0,liveSync:!1,liveSyncMaxLatency:1,liveSyncPlaybackRate:1.1,liveSyncMinLatency:0,liveSyncMinPlaybackRate:1,allowMediaSourceRecoveries:!0,minTimeBetweenRecoveries:5};(Sn("Web0S")||fn()||yn()||Sn("Hisense")||Sn("VIDAA"))&&(a.stallSkip=0);var o={trackSelectionCallback:function(e){return L((function(t){return t.return(e)}))},downloadSizeCallback:function(e){var t;return L((function(n){return 1==n.g?navigator.storage&&navigator.storage.estimate?_(n,navigator.storage.estimate(),3):n.return(!0):(t=n.h,n.return(t.usage+e<.95*t.quota))}))},progressCallback:function(e,t){return Pu([e,t])},usePersistentLicense:!0,numberOfParallelDownloads:5},s={drm:n,manifest:r,streaming:a,mediaSource:{codecSwitchingStrategy:i,sourceBufferExtraFeatures:"",forceTransmux:!1,insertFakeEncryptionInInit:!0},offline:o,abrFactory:function(){return new ei},abr:{enabled:!0,useNetworkInformation:!0,defaultBandwidthEstimate:1e6,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:t,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},advanced:{minTotalBytes:128e3,minBytes:16e3,fastHalfLife:2,slowHalfLife:5},restrictToElementSize:!1,restrictToScreenSize:!1,ignoreDevicePixelRatio:!1,clearBufferSwitch:!1,safeMarginSwitch:0},autoShowText:3,preferredAudioLanguage:"",preferredAudioLabel:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,preferredVideoHdrLevel:"AUTO",preferredVideoLayout:"",preferredVideoLabel:"",preferredVideoCodecs:[],preferredAudioCodecs:[],preferForcedSubs:!1,preferSpatialAudio:!1,preferredDecodingAttributes:[],restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayFactory:function(){return null},cmcd:{enabled:!1,sessionId:"",contentId:"",useHeaders:!1},cmsd:{enabled:!0,applyMaximumSuggestedBitrate:!0,estimatedThroughputWeightRatio:.5},lcevc:{enabled:!1,dynamicPerformanceScaling:!0,logLevel:0,drawLogo:!1},ads:{customPlayheadTracker:!1}};return o.trackSelectionCallback=function(t){return L((function(n){return n.return(function(t,n,i){var r=i;"AUTO"==r&&(r=e.matchMedia("(color-gamut: p3)").matches?"PQ":"SDR");var a=t.filter((function(e){return!("variant"!=e.type||e.hdr&&e.hdr!=r)}));i=[];var o=Oe(n,a.map((function(e){return e.language})));o&&(i=a.filter((function(e){return Pe(e.language)==o}))),0==i.length&&(i=a.filter((function(e){return e.primary}))),0==i.length&&(a.map((function(e){return e.language})),i=a);var s=i.filter((function(e){return e.height&&480>=e.height}));for(s.length&&(s.sort((function(e,t){return t.height-e.height})),i=s.filter((function(e){return e.height==s[0].height}))),n=[],i.length&&(a=Math.floor(i.length/2),i.sort((function(e,t){return e.bandwidth-t.bandwidth})),n.push(i[a])),i=(t=l(t)).next();!i.done;i=t.next())(i=i.value).type!=Ae&&"image"!=i.type||n.push(i);return n}(t,s.preferredAudioLanguage,s.preferredVideoHdrLevel))}))},s}function ju(e,t,n){var i={".drm.keySystemsMapping":"",".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",sessionType:"",serverCertificate:new Uint8Array(0),serverCertificateUri:"",individualizationServer:""}};return ku(e,t,n||Gu(),i,"")}function Hu(){this.g=null,this.h=[]}function Vu(e,t){var n=0;e.g&&e.g.state==t&&(n+=e.g.duration);for(var i=(e=l(e.h)).next();!i.done;i=e.next())n+=(i=i.value).state==t?i.duration:0;return n}function Wu(){this.i=this.h=null,this.g=[]}function zu(e,t,n){e.i!=t&&(e.i=t,e.g.push({timestamp:Date.now()/1e3,id:t.id,type:"text",fromAdaptation:n,bandwidth:null}))}function Xu(){this.C=this.D=this.I=this.G=this.u=this.j=this.H=this.m=this.i=this.M=this.N=this.J=this.K=this.L=this.l=this.s=NaN,this.g=new Hu,this.h=new Wu}function Ku(t,n){J.call(this);var i=this;this.l=zl,this.oe=this.h=null,this.$=!1,this.Be=new Hi,this.Fb=new Hi,this.s=new Hi,this.va=new Hi,this.G=this.I=this.m=this.J=null,this.He=0,this.W=new Lu,this.ha=this.aa=this.i=this.Ie=this.H=this.j=this.sa=this.L=this.Bh=this.Z=this.V=this.ua=this.M=this.K=this.xb=null,this.Xa=!1,this.fg=this.u=null,this.Ag=1e9,this.tc=[],this.N=NaN,this.g=fl(this),this.Ee={width:1/0,height:1/0},this.C=null,this.Ra=new fi(this.g.preferredAudioLanguage,this.g.preferredVariantRole,this.g.preferredAudioChannelCount,this.g.preferredVideoHdrLevel,this.g.preferSpatialAudio,this.g.preferredVideoLayout,this.g.preferredAudioLabel,this.g.preferredVideoLabel,this.g.mediaSource.codecSwitchingStrategy,this.g.manifest.dash.enableAudioGroups),this.Wa=this.g.preferredTextLanguage,this.nc=this.g.preferredTextRole,this.Vb=this.g.preferForcedSubs,this.Ib=[],n&&n(this),this.V=function(e){return new hu({getBandwidthEstimate:function(){return e.u?e.u.getBandwidthEstimate():NaN},Lb:function(){return e.Lb()},getCurrentTime:function(){return e.h?e.h.currentTime:0},Mb:function(){return e.Mb()},Yb:function(){return e.Yb()},mb:function(){return e.mb()},R:function(){return e.R()}},e.g.cmcd)}(this),this.Z=new Su(this.g.cmsd),this.J=function(e){return new Mi((function(t,n,i){e.u&&e.u.segmentDownloaded(t,n,i)}),(function(t,n,i){if(n=(new Map).set("headers",t).set("request",n).set("requestType",i),e.dispatchEvent(qu("downloadheadersreceived",n)),e.Z&&(n=e.Z).h.enabled){if(i=t["cmsd-static"])try{var r=new Map,a=i.split(",");for(i=0;i<a.length;i++){var o=a[i].split("=");r.set(o[0],Tu(o[1]))}}catch(e){}if(t=t["cmsd-dynamic"]){try{var s=new Map,u=t.split(";");for(t=1;t<u.length;t++){var l=u[t].split("=");s.set(l[0],Tu(l[1]))}var h=s}catch(e){h=null}h&&(n.g=h)}}}),(function(t,n,i,r){t=(new Map).set("request",t).set("error",n).set("httpResponseCode",i).set("aborted",r),e.dispatchEvent(qu("downloadfailed",t))}),(function(t,n,i){var r=e.V;if(i=void 0===i?{}:i,r.g.enabled)if("HEAD"===n.method)du(r,n);else switch(t){case 0:try{if(r.g.enabled){if(i.type){e:{switch(i.type){case 4:var a="d";break e;case 3:case 2:a="h";break e;case 5:a="s";break e}a=void 0}r.m=a}du(r,n,{ot:gu,su:!r.i})}}catch(e){K("CMCD_MANIFEST_ERROR","Could not generate manifest CMCD data.",e)}break;case Ui:t=i;try{if(r.g.enabled){var o=t.segment;a=0,o&&(a=o.endTime-o.startTime);var s={d:1e3*a,st:r.h.R()?"l":"v"};s.ot=function(e){if(0===e.type)return bu;if(e=e.stream){var t=e.type;if("video"==t)return e.codecs&&e.codecs.includes(",")?yu:vu;if("audio"==t)return mu;if("text"==t)return"application/mp4"===e.mimeType?wu:_u}}(t);var u=s.ot===vu||s.ot===mu||s.ot===yu||s.ot===wu,h=t.stream;h&&(u&&(s.bl=function(e,t){if(!(t=e.h.Lb()[t]).length)return NaN;var n=e.h.getCurrentTime();return(e=t.find((function(e){return e.start<=n&&e.end>=n})))?1e3*(e.end-n):NaN}(r,h.type)),h.bandwidth&&(s.br=h.bandwidth/1e3)),u&&s.ot!==wu&&(s.tb=function(e,t){var n=e.h.mb();if(!n.length)return NaN;e=n[0];for(var i=(n=l(n)).next();!i.done;i=n.next())"variant"===(i=i.value).type&&i.bandwidth>e.bandwidth&&(e=i);switch(t){case vu:return e.videoBandwidth||NaN;case mu:return e.audioBandwidth||NaN;default:return e.bandwidth}}(r,s.ot)/1e3),du(r,n,s)}}catch(e){K("CMCD_SEGMENT_ERROR","Could not generate segment CMCD data.",e)}break;case 2:case 5:case 6:du(r,n,{ot:"k"});break;case 4:du(r,n,{ot:"o"})}}),(function(t,n,i,r){e.H&&e.H.banLocation&&e.H.banLocation(r)}))}(this),this.J.mg(this.g.streaming.forceHTTPS),this.D=null,Jl&&(this.D=Jl(),this.D.configure(this.g.ads)),this.Be.o(e,"online",(function(){Dl(i),i.eg()})),this.se=new ln((function(){return function(e){for(var t=Date.now()/1e3,n=!1,i=l(e.i.variants),r=i.next();!r.done;r=i.next())0<(r=r.value).disabledUntilTime&&r.disabledUntilTime<=t&&(r.disabledUntilTime=0,n=!0,o=void 0,o="",(a=r).video&&(o+="video:"+a.video.id),a.audio&&(o=o+(o?"&":"")+"audio:"+a.audio.id));var a,o;e.i.variants.every((function(e){return 0===e.disabledUntilTime}))&&e.se.stop(),n&&El(e,!0,void 0,!1,!1)}(i)})),t&&(ai("Player","Please migrate from initializing Player with a mediaElement; use the attach method instead."),this.Gc(t,!0))}function Yu(e){null!=e.L&&(uo(e.L),e.L.release(),e.L=null)}function qu(e,t){return new j(e,t)}function Zu(){if(e.Promise||X("A Promise implementation or polyfill is required"),!(e.Promise&&e.Uint8Array&&Array.prototype.forEach)||Sn("Trident/"))return!1;var t=wn();return!(t&&9>t||!(e.MediaKeys&&e.navigator&&e.navigator.requestMediaKeySystemAccess&&e.MediaKeySystemAccess&&e.MediaKeySystemAccess.prototype.getConfiguration))&&(!!hn()||cn("application/x-mpegurl"))}function Ju(e,t){e.dispatchEvent(qu("onstatechange",(new Map).set("state",t)))}function Qu(e,t){var n;return L((function(i){return 1==i.g?(n=++e.He,_(i,Du(e.W,t),2)):n!=e.He?(e.W.release(),i.return(!0)):i.return(!1)}))}function $u(e){var t,n,i,r,a;return L((function(o){if(1==o.g)return Ju(e,"media-source"),t=e.g.textDisplayFactory,n=t(),e.xg=t,i=function(e,t,n,i){return new vo(e,t,n,i)}(e.h,n,(function(t,n,i){el(e,t,n,i)}),e.L),i.configure(e.g.mediaSource),r=e.g.manifest,a=r.segmentRelativeVttTiming,i.Z=a,_(o,i.L,2);e.I=i,w(o)}))}function el(e,t,n,i){for(var r=(t=l(t)).next();!r.done;r=t.next())if((r=r.value).data&&r.cueTime&&r.frames){var a=r.cueTime+n,o=i;o&&a>o&&(o=a);for(var s=l(r.frames),u=s.next();!u.done;u=s.next())tl(e,a,o,"org.id3",u.value);e.D&&e.D.onHlsTimedMetadata(r,a)}}function tl(e,t,n,i,r){t=(new Map).set("startTime",t).set("endTime",n).set("metadataType",i).set("payload",r),e.dispatchEvent(qu("metadata",t))}function nl(e,t){if(t&&"chapters"==t.kind){t.mode="hidden";var n=new ln((function(){t.mode="hidden"})).Qa().S(.5);e.Ib.push((function(){n.stop()}))}}function il(e,t){return new Wr(t,e.g.drm.updateExpirationTime)}function rl(e,t,n){e.M=new gi,e.M.g=vi,mi(e.M,n,Math.min(.5,n/2)),yl(e),e.s.o(t,"waiting",(function(){return al(e)})),e.s.o(t,"stalled",(function(){return al(e)})),e.s.o(t,"canplaythrough",(function(){return al(e)})),e.s.o(t,"progress",(function(){return al(e)}))}function al(e){switch(e.l){case Kl:if(e.h.ended)var t=!0;else{var n=Ca(e.h.buffered);t=null!=n&&n>=e.h.duration-1}break;case Xl:e:if(e.h.ended||wo(e.I))t=!0;else{if(e.i.presentationTimeline.R()){n=e.i.presentationTimeline.$b();var i=Ca(e.h.buffered);if(null!=i&&i>=n){t=!0;break e}}t=!1}break;default:t=!1}i=Ia(e.h.buffered,e.h.currentTime);var r=t,a=(n=e.M).h.get(n.g);t=n.g,i=r||i>=a?yi:vi,n.g=i,t!=i&&yl(e)}function ol(e){if(e.H){var t=on(e.g.manifest);e.h&&"AUDIO"===e.h.nodeName&&(t.disableVideo=!0),e.H.configure(t)}if(e.m&&e.m.configure(e.g.drm),e.j){e.j.configure(e.g.streaming);try{ml(e,e.i)}catch(t){Rl(e,t)}e.u&&Tl(e),!(t=e.j.j)||t.allowedByApplication&&t.allowedByKeySystem||El(e)}if(e.J&&e.J.mg(e.g.streaming.forceHTTPS),e.I&&(e.I.configure(e.g.mediaSource),e.I.Z=e.g.manifest.segmentRelativeVttTiming,t=e.g.textDisplayFactory,e.xg!=t)){var n=t(),i=e.I,r=i.H;i.H=n,r&&(n.setTextVisibility(r.isTextVisible()),r.destroy()),i.h&&(i.h.j=n),e.xg=t,e.j&&(n=(t=e.j).i.get(Ae))&&Ms(t,n.stream,!0,0,!0)}e.u&&(e.u.configure(e.g.abr),e.g.abr.enabled?e.u.enable():e.u.disable(),Ll(e)),e.M&&(t=e.g.streaming.rebufferingGoal,e.i&&(t=Math.max(t,e.i.minBufferTime)),mi(e.M,t,Math.min(.5,t/2))),e.i&&Fl(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),e.D&&e.D.configure(e.g.ads),e.V&&e.V.configure(e.g.cmcd),e.Z&&e.Z.configure(e.g.cmsd)}function sl(e){return e&&(e=/(\d+)x(\d+)/.exec(e))?{mc:parseInt(e[1],10),rows:parseInt(e[2],10)}:null}function ul(e){return Array.from(e.h.textTracks).filter((function(e){return"metadata"!=e.kind&&"chapters"!=e.kind&&"Shaka Player TextTrack"!=e.label}))}function ll(e){return Array.from(e.h.textTracks).filter((function(e){return"chapters"==e.kind}))}function hl(e,t){var n;return L((function(i){switch(i.g){case 1:return S(i,2),_(i,Ws(t,e.J,e.g.streaming.retryParameters),4);case 4:n=i.h,A(i,3);break;case 2:E(i);case 3:if(n)return i.return(n);throw new ye(1,2,2011,t)}}))}function cl(e,t,n,i,r,a,o){var s,u,l,h;return L((function(c){if(1==c.g)return"text/vtt"!=r||o.length?_(c,dl(e,t,e.J,e.g.streaming.retryParameters),3):c.F(2);2!=c.g&&(s=c.h,u=pl(e,s,r,o),l=new Blob([u],{type:"text/vtt"}),t=Oo(l),r="text/vtt"),h=document.createElement("track");var d=e.V,p=t;try{if(d.g.enabled){var f=cu(d);f.ot=_u,f.su=!0;var g=fu(p,pu(f))}else g=p}catch(e){K("CMCD_TEXT_TRACK_ERROR","Could not generate text track CMCD data.",e),g=p}return h.src=g,h.label=a,h.kind=i,h.srclang=n,e.h.getAttribute("crossorigin")||e.h.setAttribute("crossorigin","anonymous"),e.h.appendChild(h),c.return(h)}))}function dl(e,t,n,i){var r,a,o;return L((function(s){if(1==s.g){r=Ui,(a=Li([t],i)).method="GET";var u=e.V;try{u.g.enabled&&du(u,a,{ot:_u,su:!0})}catch(e){K("CMCD_TEXT_ERROR","Could not generate text CMCD data.",e)}return _(s,n.request(r,a).promise,2)}return o=s.h,s.return(o.data)}))}function pl(e,t,n,i){var r=tn[n];if(r)return n=r(),e={periodStart:0,segmentStart:0,segmentEnd:e.h.duration,vttOffset:0},t=et(t),function(e,t){function n(e){for(var n=e,i=l(t),r=i.next();!r.done;r=i.next())(r=r.value).end&&r.start<e&&(n+=r.end-r.start);return(10>(e=Math.floor(n/3600))?"0":"")+e+":"+(10>(i=Math.floor(n/60%60))?"0":"")+i+":"+(10>(r=Math.floor(n%60))?"0":"")+r+"."+(100>(n=Math.floor(1e3*n%1e3))?10>n?"00":"0":"")+n}var i=Ys(e);e="WEBVTT\n\n";for(var r=(i=l(i)).next();!r.done;r=i.next())e+=n((r=r.value).startTime)+" --\x3e "+n(r.endTime)+function(e){var t=[];switch(e.textAlign){case"left":t.push("align:left");break;case"right":t.push("align:right");break;case mt:t.push("align:middle");break;case"start":t.push("align:start");break;case"end":t.push("align:end")}switch(e.writingMode){case"vertical-lr":t.push("vertical:lr");break;case"vertical-rl":t.push("vertical:rl")}return t.length?" "+t.join(" "):""}(r)+"\n",e+=r.payload+"\n\n";return e}(t=n.parseMedia(t,e,null),i);throw new ye(2,2,2014,n)}function fl(e){var t=Gu();return t.streaming.failureCallback=function(t){if(e.R()){var n=null;1001==t.code||1002==t.code?n=1:1003==t.code&&(n=.1),null!=n&&(t.severity=1,e.eg(n))}},t.textDisplayFactory=function(){return e.oe?new iu(e.h,e.oe):HTMLMediaElement.prototype.addTextTrack?new qs(e.h,"Shaka Player TextTrack"):new Qs},t}function gl(e,t){return L((function(n){if(1==n.g)return _(n,function(e,t){return L((function(n){if(1==n.g)return _(n,function(e,t){return L((function(n){return 1==n.g?_(n,Mn(e,t,0<t.offlineSessionIds.length),2):(function(e){e.textStreams=e.textStreams.filter((function(e){return Qt(e=Ht(e.mimeType,e.codecs))}))}(t),_(n,function(e){var t,n,i,r,a,o,s;return L((function(u){switch(u.g){case 1:t=[],n=l(e.imageStreams),i=n.next();case 2:if(i.done){u.F(4);break}if(r=i.value,"application/mp4"==(a=r.mimeType)&&"mjpg"==r.codecs&&(a="image/jpg"),Qn.has(a)){u.F(5);break}if(!(o=$n.get(a))){Qn.set(a,!1),u.F(5);break}return _(u,function(e){return new Promise((function(t){var n=new Image;n.src=e,"decode"in n?n.decode().then((function(){t(!0)})).catch((function(){t(!1)})):n.onload=n.onerror=function(){t(2===n.height)}}))}(o),7);case 7:s=u.h,Qn.set(a,s);case 5:Qn.get(a)&&t.push(r),i=n.next(),u.F(2);break;case 4:e.imageStreams=t,w(u)}}))}(t),0))}))}(e.m,t),2);if(!t.variants.some(Wn))throw new ye(2,4,4032);w(n)}))}(e,t),2);ml(e,t),w(n)}))}function ml(e,t){if(e.l!=Wl){kn(t.variants,e.g.restrictions,e.Ee)&&e.j&&Il(e);var n=e.m?e.m.g:null;if(n&&e.m.u)for(var i=l(t.variants),r=i.next();!r.done;r=i.next())r=r.value,vl(e,n.keySystem,r.video),vl(e,n.keySystem,r.audio);Gl(e,t)}}function vl(e,t,n){if(n)for(var i=(n=l(n.drmInfos)).next();!i.done;i=n.next())if((i=i.value).keySystem==t)for(var r=(i=l(i.initData||[])).next();!r.done;r=i.next())r=r.value,qr(e.m,r.initDataType,r.initData)}function yl(e){var t=e.yd();if(e.C&&e.M&&e.G){if(e.V){var n=e.V;t||n.i||(n.i=!0),n.i&&t&&(n.j=!0),n.l=t}_l(e)}t=(new Map).set("buffering",t),e.dispatchEvent(qu("buffering",t))}function bl(e){var t=e.h.playbackRate;0!=t&&(e.K&&e.K.set(t),t=qu("ratechange"),e.dispatchEvent(t))}function _l(e){if(e.C&&e.M){var t=e.C.g,n="playing";e.M.g==vi?n="buffering":e.h.paused?n="paused":e.h.ended&&(n="ended");var i=n;if(null==t.g)t.g={timestamp:Date.now()/1e3,state:i,duration:0},t=!0;else{var r=Date.now()/1e3;t.g.duration=r-t.g.timestamp,t.g.state==i?t=!1:(t.h.push(t.g),t.g={timestamp:r,state:i,duration:0},t=!0)}t&&(n=(new Map).set("newstate",n),e.dispatchEvent(qu("statechanged",n)))}}function wl(e){if(e.R()){var t=e.Ha();if(Number.isFinite(t.end)&&!(e.h.currentTime<t.start)){if(e.g.streaming.liveSync)var n=e.g.streaming.liveSyncMaxLatency,i=e.g.streaming.liveSyncPlaybackRate;else e.i&&e.i.serviceDescription&&(n=e.i.serviceDescription.maxLatency||e.g.streaming.liveSyncMaxLatency,i=e.i.serviceDescription.maxPlaybackRate||e.g.streaming.liveSyncPlaybackRate);if(e.g.streaming.liveSync)var r=e.g.streaming.liveSyncMinLatency,a=e.g.streaming.liveSyncMinPlaybackRate;else e.i&&e.i.serviceDescription&&(r=e.i.serviceDescription.minLatency||e.g.streaming.liveSyncMinLatency,a=e.i.serviceDescription.minPlaybackRate||e.g.streaming.liveSyncMinPlaybackRate);var o=e.h.playbackRate,s=t.end-e.h.currentTime,u=0;if(e.l==Kl){var l=e.h.buffered;0<l.length&&(u=l.end(l.length-1),u=Math.max(i,u-t.end))}n&&i&&s-u>n?o!=i&&e.Pd(i):r&&a&&s-u<r?o!=a&&e.Pd(a):o!==e.K.Lc()&&e.od()}}}function Sl(e){if(e.h){var t,n=!1,i=e.h.currentTime/e.h.duration;isNaN(i)||(i=Math.round(100*i),isNaN(e.N)?(e.N=i,n=!0):(i=Math.max(e.N,i),e.N!=i&&(e.N=i,n=!0))),n&&(0==e.N?t=qu("started"):25==e.N?t=qu("firstquartile"):50==e.N?t=qu("midpoint"):75==e.N?t=qu("thirdquartile"):100==e.N&&(t=qu("complete")),t&&e.dispatchEvent(t))}}function Tl(e){try{Gl(e,e.i)}catch(t){return Rl(e,t),!1}var t=zn(e.i.variants);return t=e.Ra.create(t),e.u.setVariants(Array.from(t.values())),!0}function Al(e,t){return t=void 0!==t&&t,Tl(e)?e.u.chooseVariant(t):null}function El(e,t,n,i,r){t=void 0===t||t,n=void 0===n?0:n,i=void 0!==i&&i,r=void 0===r||r;var a=Al(e);a&&Cl(e,a,r,t,n,i)}function Cl(e,t,n,i,r,a){a=void 0!==a&&a;var o=e.j.j;if(t==o)i&&Is(e.j,t,i,r,!0);else{var s=e.C.h;s.h!=t&&(s.h=t,s.g.push({timestamp:Date.now()/1e3,id:t.id,type:"variant",fromAdaptation:n,bandwidth:t.bandwidth})),Is(e.j,t,i,r,a,n),i=null,o&&(i=Un(o)),t=Un(t),n?(n=(new Map).set("oldTrack",i).set("newTrack",t),e.L&&lo(e.L,t,e.If()),jl(e,n=qu("adaptation",n))):kl(e,i,t)}}function xl(e,t){var n=Array.from(e.h.audioTracks).find((function(e){return e.enabled}));t.enabled=!0,t.id!==n.id&&(n.enabled=!1),kl(e,n=Hn(n),t=Hn(t))}function Il(e){jl(e,qu("trackschanged"))}function kl(e,t,n){t=(new Map).set("oldTrack",t).set("newTrack",n),e.L&&lo(e.L,n,e.If()),jl(e,n=qu("variantchanged",t))}function Ml(e){jl(e,qu("textchanged"))}function Pl(e){jl(e,qu("texttrackvisibility"))}function Ll(e){e.g.abr.enabled||Dl(e),jl(e,qu("abrstatuschanged",(new Map).set("newStatus",e.g.abr.enabled)))}function Dl(e,t){if(t=void 0===t||t,e.l==Xl){e.se.stop();for(var n=l(e.i.variants),i=n.next();!i.done;i=n.next())i.value.disabledUntilTime=0;t&&Tl(e)}}function Rl(e,t){var n,i,r;return L((function(a){switch(a.g){case 1:if(e.l==Wl)return a.return();if(n=!0,!(e.Xa&&e.i&&e.j)||3016!=t.code&&3014!=t.code&&3015!=t.code&&3018!=t.code){a.F(2);break}return S(a,3),_(a,function(e){var t,n,i,r,a,o;return L((function(s){return 1==s.g?(t=Date.now()/1e3,n=e.h.minTimeBetweenRecoveries,!e.h.allowMediaSourceRecoveries||t-e.J<n?s.return(!1):(e.J=t,i=Ee,(r=e.i.get(i.U))&&(r.ec=null,Ps(e,r),Hs(r).catch((function(){}))),(a=e.i.get(i.ia))&&(a.ec=null,Ps(e,a),Hs(a).catch((function(){}))),o=new Map,e.j.audio&&o.set(i.U,e.j.audio),e.j.video&&o.set(i.ia,e.j.video),_(s,No(e.g.Y,o),2))):s.return(!0)}))}(e.j),5);case 5:i=a.h,n=!i,A(a,2);break;case 3:E(a),n=!0;case 2:if(!n)return a.return();2===t.severity&&Dl(e,!1),r=qu("error",(new Map).set("detail",t)),e.dispatchEvent(r),r.defaultPrevented&&(t.handled=!0),w(a)}}))}function Nl(e,t,n){n=(new Map).set("detail",{schemeIdUri:n.schemeIdUri,value:n.value,startTime:n.startTime,endTime:n.endTime,id:n.id,eventElement:n.eventElement}),e.dispatchEvent(qu(t,n))}function Ol(e){if(!e.h.error)return null;var t=e.h.error.code;if(1==t)return null;var n=e.h.error.msExtendedCode;return n&&(0>n&&(n+=Math.pow(2,32)),n=n.toString(16)),new ye(2,3,3016,t,n,e.h.error.message)}function Ul(e,t){if(e.j){var n=qu("keystatuschanged");e.dispatchEvent(n);var i=Object.keys(t);n=1==i.length&&"00"==i[0];var r=!1;if(i.length)for(var a=(i=l(e.i.variants)).next();!a.done;a=i.next()){var o=[];(a=a.value).audio&&o.push(a.audio),a.video&&o.push(a.video);for(var s=(o=l(o)).next();!s.done;s=o.next()){var u=s.value;if(s=a.allowedByKeySystem,u.keyIds.size){a.allowedByKeySystem=!0;for(var h=(u=l(u.keyIds)).next();!h.done;h=u.next())h=h.value,((h=t[n?"00":h])||e.m.H)&&(a.allowedByKeySystem=a.allowedByKeySystem&&!!h&&!ql.includes(h))}s!=a.allowedByKeySystem&&(r=!0)}}if(r&&(Il(e),!Tl(e)))return;(t=e.j.j)&&!t.allowedByKeySystem&&El(e)}}function Bl(e,t,n){e.H&&e.H.onExpirationUpdated&&e.H.onExpirationUpdated(t,n),t=qu("expirationupdated"),e.dispatchEvent(t)}function Fl(e,t,n){0<t&&(e.R()||e.sh(t)),n<(t=e.getDuration())&&(e.R()||e.gb(n))}function Gl(e,t){e=e.m?e.m.ge():{};var n=Object.keys(e);n=n.length&&"00"==n[0];for(var i=!1,r=!1,a=new Set,o=new Set,s=(t=l(t.variants)).next();!s.done;s=t.next()){var u=[];(s=s.value).audio&&u.push(s.audio),s.video&&u.push(s.video);for(var h=(u=l(u)).next();!h.done;h=u.next())if((h=h.value).keyIds.size)for(var c=(h=l(h.keyIds)).next();!c.done;c=h.next()){c=c.value;var d=e[n?"00":c];d?ql.includes(d)&&o.add(d):a.add(c)}s.allowedByApplication?s.allowedByKeySystem&&(i=!0):r=!0}if(!i)throw new ye(2,4,4012,e={hasAppRestrictions:r,missingKeys:Array.from(a),restrictedKeyStatuses:Array.from(o)})}function jl(e,t){L((function(n){if(1==n.g)return _(n,Promise.resolve(),2);e.l!=Wl&&e.dispatchEvent(t),w(n)}))}function Hl(e){for(var t=new Set,n=(e=l(e)).next();!n.done;n=e.next())(n=n.value).language?t.add(Pe(n.language)):t.add("und");return t}function Vl(e){for(var t=new Map,n=new Map,i=(e=l(e)).next();!i.done;i=e.next()){var r="und",a=[];(i=i.value).language&&(r=Pe(i.language)),(a="variant"==i.type?i.audioRoles:i.roles)&&a.length||(a=[""]),t.has(r)||t.set(r,new Set);for(var o=(a=l(a)).next();!o.done;o=a.next())o=o.value,t.get(r).add(o),i.label&&(n.has(r)||n.set(r,new Map),n.get(r).set(o,i.label))}var s=[];return t.forEach((function(e,t){for(var i=(e=l(e)).next();!i.done;i=e.next()){i=i.value;var r=null;n.has(t)&&n.get(t).has(i)&&(r=n.get(t).get(i)),s.push({language:t,role:i,label:r})}})),s}G("shaka.util.ConfigUtils",Iu),Iu.convertToConfigObject=Mu,Iu.mergeConfigObjects=ku,Lu.prototype.release=function(){0<this.h.length?this.h.shift()():this.g=null},G("shaka.util.FairPlayUtils",Ru),Ru.commonFairPlayResponse=function(e,t){if(2===e){try{var n=qi(t.data)}catch(e){return}e=!1,"<ckc>"===(n=n.trim()).substr(0,5)&&"</ckc>"===n.substr(-6)&&(n=n.slice(5,-6),e=!0);try{var i=JSON.parse(n);i.ckc&&(n=i.ckc,e=!0),i.CkcMessage&&(n=i.CkcMessage,e=!0),i.License&&(n=i.License,e=!0)}catch(e){}e&&(t.data=$e(vr(n)))}},Ru.expressplayFairPlayRequest=function(e,t){Bu(e,t)},Ru.conaxFairPlayRequest=function(e,t){Bu(e,t)},Ru.ezdrmFairPlayRequest=function(e,t){Bu(e,t)},Ru.verimatrixFairPlayRequest=function(e,t){2===e&&(e=mr(e=et(t.body)),t.headers["Content-Type"]="application/x-www-form-urlencoded",t.body=Qi("spc="+e))},Ru.expressplayInitDataTransform=function(e,t,n){return Uu(e,t,n)},Ru.conaxInitDataTransform=function(t,n,i){if("skd"!==n)return t;n=i.serverCertificate,i=Ji(t).split("skd://").pop().split("?").shift(),i=e.atob(i);var r=new ArrayBuffer(2*i.length);r=tt(r);for(var a=0,o=i.length;a<o;a++)r[a]=i.charCodeAt(a);return Ou(t,r,n)},Ru.ezdrmInitDataTransform=function(e,t,n){return"skd"!==t?e:(t=n.serverCertificate,Ou(e,n=Ji(e).split(";").pop(),t))},Ru.verimatrixInitDataTransform=function(e,t,n){return Uu(e,t,n)},Ru.initDataTransform=Ou,Ru.defaultGetContentId=Nu,Ru.isFairPlaySupported=function(){var e;return L((function(t){return 1==t.g?(e={initDataTypes:["cenc","sinf","skd"],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'}]},S(t,2),_(t,navigator.requestMediaKeySystemAccess("com.apple.fps",[e]),4)):2!=t.g?t.return(!0):(E(t),t.return(!1))}))},G("shaka.util.PlayerConfiguration",Fu),Fu.mergeConfigObjects=ju,Fu.createDefault=Gu,m(Ku,J),(i=Ku.prototype).destroy=function(){var e,t=this;return L((function(n){switch(n.g){case 1:return t.l==Wl?n.return():(Yu(t),e=t.detach(),t.l=Wl,_(n,e,2));case 2:if(t.Be&&(t.Be.release(),t.Be=null),t.Fb&&(t.Fb.release(),t.Fb=null),t.s&&(t.s.release(),t.s=null),t.va&&(t.va.release(),t.va=null),t.fg=null,t.g=null,t.C=null,t.oe=null,t.V=null,t.Z=null,!t.J){n.F(3);break}return _(n,t.J.destroy(),4);case 4:t.J=null;case 3:t.u&&(t.u.release(),t.u=null),J.prototype.release.call(t),w(n)}}))},i.Gc=function(e,t){t=void 0===t||t;var n,i,r=this;return L((function(a){switch(a.g){case 1:if(r.l==Wl)throw new ye(2,7,7e3);if(!r.h||r.h==e){a.F(2);break}return _(a,r.detach(),2);case 2:return _(a,Qu(r,"attach"),4);case 4:if(a.h)return a.return();if(S(a,5,6),Ju(r,"attach"),n=function(){var e=Ol(r);e&&Rl(r,e)},r.Fb.o(e,"error",n),r.h=e,!t||!hn()||r.I){a.F(6);break}return _(a,$u(r),6);case 6:C(a),r.W.release(),x(a,0);break;case 5:return i=E(a),_(a,r.detach(),10);case 10:throw i}}))},i.Eg=function(e){this.Bh=e},i.detach=function(e){e=void 0!==e&&e;var t=this;return L((function(n){if(1==n.g){if(t.l==Wl)throw new ye(2,7,7e3);return _(n,t.Wc(!1,e),2)}if(3!=n.g)return _(n,Qu(t,"detach"),3);if(n.h)return n.return();try{t.h&&(t.Fb.ub(),t.h=null),Ju(t,"detach"),t.D&&!e&&t.D.release()}finally{t.W.release()}w(n)}))},i.Wc=function(e,t){e=void 0===e||e,t=void 0!==t&&t;var n,i,r,a,o,s,u,h,c,d=this;return L((function(p){switch(p.g){case 1:return d.l!=Wl&&(d.l=zl),_(p,Qu(d,"unload"),2);case 2:return p.h?p.return():(T(p,3),d.Xa=!1,Ju(d,"unload"),e&&!hn()&&(e=!1),Yu(d),n=d.Ib.map((function(e){return e()})),d.Ib=[],_(p,Promise.all(n),5));case 5:if(d.dispatchEvent(qu("unloading")),d.ua&&(d.ua.release(),d.ua=null),d.h&&(d.s.ub(),d.va.ub()),d.se.stop(),d.xb&&(d.xb.release(),d.xb=null),!d.H){p.F(6);break}return _(p,d.H.stop(),7);case 7:d.H=null,d.Ie=null;case 6:if(!d.u){p.F(8);break}return _(p,d.u.stop(),8);case 8:if(!d.j){p.F(10);break}return _(p,d.j.destroy(),11);case 11:d.j=null;case 10:if(d.K&&(d.K.release(),d.K=null),d.G&&(d.G.release(),d.G=null),!d.I){p.F(12);break}return _(p,d.I.destroy(),13);case 13:d.I=null;case 12:if(d.D&&!t&&d.D.onAssetUnload(),d.Z&&(d.Z.g=null),d.h&&nu(d.h),!d.h||!d.h.src){p.F(14);break}return _(p,new Promise((function(e){return new ln(e).S(.1)})),15);case 15:d.h.removeAttribute("src"),d.h.load();case 14:if(!d.m){p.F(16);break}return _(p,d.m.destroy(),17);case 17:d.m=null;case 16:if(d.aa=null,d.M=null,d.i){for(i=l(d.i.variants),r=i.next();!r.done;r=i.next())for(a=r.value,o=l([a.audio,a.video]),s=o.next();!s.done;s=o.next())(u=s.value)&&u.segmentIndex&&u.segmentIndex.release();for(h=l(d.i.textStreams),s=h.next();!s.done;s=h.next())(c=s.value).segmentIndex&&c.segmentIndex.release()}d.i=null,d.C=new Xu,d.xg=null,d.tc=[],d.N=NaN,yl(d);case 3:C(p),d.W.release(),x(p,4);break;case 4:if(e&&hn()&&!d.I)return _(p,$u(d),0);p.F(0)}}))},i.xj=function(e){this.ha=e},i.load=function(e,t,n){t=void 0===t?null:t;var i,r,a,o,s,u=this;return L((function(h){switch(h.g){case 1:if(u.l==Wl)throw new ye(2,7,7e3);return _(h,Du(u.W,"load"),2);case 2:if(u.W.release(),!u.h)throw new ye(2,7,7002);if(!u.aa){h.F(3);break}return _(h,u.Wc(!1),3);case 3:if(i=++u.He,r=function(){if(u.He!=i)throw new ye(2,7,7e3)},a=function(e,t){return L((function(n){switch(n.g){case 1:return T(n,2),_(n,Du(u.W,t),4);case 4:return r(),_(n,e(),5);case 5:r();case 2:C(n),u.W.release(),x(n,0)}}))},S(h,5),u.ha=t,u.Xa=!1,u.dispatchEvent(qu("loading")),o=Date.now()/1e3,u.C=new Xu,u.aa=e,n){h.F(7);break}return _(h,a((function(){return L((function(e){if(1==e.g)return _(e,function(e){var t,n;return L((function(i){return 1==i.g?(t=e.g.manifest.retryParameters,_(i,Ws(e.aa,e.J,t),2)):("application/x-mpegurl"==(n=i.h)&&bn()&&(n="application/vnd.apple.mpegurl"),i.return(n))}))}(u),2);n=e.h,w(e)}))}),"guessMimeType_"),7);case 7:if(function(e,t){if(!hn())return!0;if(t){if(""==(e.h||Tn()).canPlayType(t))return!1;if(!hn()||!(t in va))return!0;if("application/x-mpegurl"===t||"application/vnd.apple.mpegurl"===t){if(e.g.streaming.preferNativeHls)return!0;if(bn())return e.g.streaming.useNativeHlsOnSafari}}return!1}(u,n))return _(h,a((function(){return L((function(e){return _(e,function(e,t){var n,i,r,a;return L((function(o){return 1==o.g?(n=Ee,i=Date.now()/1e3,r=!0,e.m=il(e,{zc:e.J,onError:function(t){Rl(e,t)},Fe:function(t){Ul(e,t)},onExpirationUpdated:function(t,n){Bl(e,t,n)},onEvent:function(t){e.dispatchEvent(t),"drmsessionupdate"==t.type&&r&&(r=!1,e.C.j=Date.now()/1e3-i)}}),e.m.configure(e.g.drm),a={id:0,language:"und",disabledUntilTime:0,primary:!1,audio:null,video:{id:0,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:t?Kt(t):"",codecs:t?Yt(t):"",encrypted:!0,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:n.ia,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1},bandwidth:100,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},e.m.Z=!0,_(o,zr(e.m,[a],[]),2)):_(o,e.m.Gc(e.h),0)}))}(u,n),0)}))}),"initializeSrcEqualsDrmInner_"),16);if(u.I){h.F(11);break}return _(h,a((function(){return L((function(e){return _(e,$u(u),0)}))}),"initializeMediaSourceEngineInner_"),11);case 11:return _(h,a((function(){return L((function(e){return _(e,function(e,t){var n,i,r,a,o,s,u,h;return L((function(c){if(1==c.g)return n=e.J,Ju(e,"manifest-parser"),e.Ie=ma(e.aa,t||null),e.H=e.Ie(),i=on(e.g.manifest),e.h&&"AUDIO"===e.h.nodeName&&(i.disableVideo=!0),e.H.configure(i),e.ua=new ps((function(){return e.Ha()})),e.ua.addEventListener("regionadd",(function(t){t=t.region,Nl(e,"timelineregionadded",t),e.D&&e.D.onDashTimedMetadata(t)})),e.sa=null,e.g.streaming.observeQualityChanges&&(e.sa=new ds((function(){return e.Lb()})),e.sa.addEventListener("qualitychange",(function(t){var n=t.quality;t=t.position,n=(new Map).set("mediaQuality",{bandwidth:n.bandwidth,audioSamplingRate:n.audioSamplingRate,codecs:n.codecs,contentType:n.contentType,frameRate:n.frameRate,height:n.height,mimeType:n.mimeType,channelsCount:n.channelsCount,pixelAspectRatio:n.pixelAspectRatio,width:n.width}).set("position",t),e.dispatchEvent(qu("mediaqualitychanged",n))}))),r={networkingEngine:n,filter:function(t){return gl(e,t)},makeTextStreamsForClosedCaptions:function(t){return function(e,t){for(var n=new Set,i=l(t.textStreams),r=i.next();!r.done;r=i.next())"application/cea-608"!=(r=r.value).mimeType&&"application/cea-708"!=r.mimeType||n.add(r.originalId);for(r=(i=l(t.variants)).next();!r.done;r=i.next())if((r=r.value.video)&&r.closedCaptions)for(var a=l(r.closedCaptions.keys()),o=a.next();!o.done;o=a.next())if(o=o.value,!n.has(o)){var s=o.startsWith("CC")?"application/cea-608":"application/cea-708",u=new us,h=r.closedCaptions.get(o);s={id:e.Ag++,originalId:o,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:u,mimeType:s,codecs:"",kind:"caption",encrypted:!1,drmInfos:[],keyIds:new Set,language:h,originalLanguage:h,label:null,type:Ae,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:r.roles,forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1},t.textStreams.push(s),n.add(o)}}(e,t)},onTimelineRegionAdded:function(t){var n=e.ua;e:{for(var i=l(n.g),r=i.next();!r.done;r=i.next())if((r=r.value).schemeIdUri==t.schemeIdUri&&r.id==t.id&&r.startTime==t.startTime&&r.endTime==t.endTime){i=r;break e}i=null}null==i&&(n.g.add(t),t=new j("regionadd",new Map([["region",t]])),n.dispatchEvent(t))},onEvent:function(t){return e.dispatchEvent(t)},onError:function(t){return Rl(e,t)},isLowLatencyMode:function(){return e.g.streaming.lowLatencyMode},isAutoLowLatencyMode:function(){return e.g.streaming.autoLowLatencyMode},enableLowLatencyMode:function(){e.configure("streaming.lowLatencyMode",!0)},updateDuration:function(){e.j&&e.j.updateDuration()},newDrmInfo:function(t){var n=e.m?e.m.g:null;n&&e.m.u&&vl(e,n.keySystem,t)},onManifestUpdated:function(){var t=(new Map).set("isLive",e.R());e.dispatchEvent(qu("manifestupdated",t)),e.D&&e.D.onManifestUpdated(e.R())},getBandwidthEstimate:function(){return e.u.getBandwidthEstimate()}},a=Date.now()/1e3,Ju(e,"manifest"),o=e,_(c,e.H.start(e.aa,r),2);if(o.i=c.h,s=qu("manifestparsed"),e.dispatchEvent(s),0==e.i.variants.length)throw new ye(2,4,4036);!function(e){function t(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")}e.variants.some(t)&&(e.variants=e.variants.filter(t))}(e.i),u=Date.now()/1e3,h=u-a,e.C.H=h,w(c)}))}(u,n),0)}))}),"parseManifestInner_"),13);case 13:return _(h,a((function(){return L((function(e){return _(e,function(e){var t,n,i;return L((function(r){return 1==r.g?(Ju(e,"drm-engine"),t=Date.now()/1e3,n=!0,e.m=il(e,{zc:e.J,onError:function(t){Rl(e,t)},Fe:function(t){Ul(e,t)},onExpirationUpdated:function(t,n){Bl(e,t,n)},onEvent:function(i){e.dispatchEvent(i),"drmsessionupdate"==i.type&&n&&(n=!1,e.C.j=Date.now()/1e3-t,e.L&&uo(e.L))}}),e.m.configure(e.g.drm),kn(e.i.variants,e.g.restrictions,e.Ee)&&e.j&&Il(e),i=zn(e.i.variants),_(r,zr(e.m,i,e.i.offlineSessionIds),2)):3!=r.g?_(r,e.m.Gc(e.h),3):_(r,gl(e,e.i),0)}))}(u),0)}))}),"initializeDrmInner_"),14);case 14:return _(h,a((function(){return L((function(e){return _(e,function(e,t){var n,i,r,a,o,s,u,h,c,d,p,f,g,m,v,y,b,S;return L((function(T){switch(T.g){case 1:for(Ju(e,"load"),n=e.h,e.K=new ls({ke:function(){return n.playbackRate},Lc:function(){return n.defaultPlaybackRate},pg:function(e){n.playbackRate=e},fh:function(e){n.currentTime+=e}}),i=function(){return _l(e)},r=function(){return bl(e)},e.s.o(n,"playing",i),e.s.o(n,"pause",i),e.s.o(n,"ended",i),e.s.o(n,"ratechange",r),function(e,t){if(t.lcevc.enabled){var n=e.mb();n&&n[0]&&"video/mp2t"==n[0].videoMimeType&&(dn()||navigator.userAgent.match(/Edge\//))&&(t.mediaSource.forceTransmux||X("LCEVC Warning: For MPEG-2 TS decoding the config.mediaSource.forceTransmux must be enabled.")),Yu(e),null==e.L&&(e.L=new so(e.h,e.Bh,t.lcevc),e.I&&(e.I.N=e.L))}else Yu(e)}(e,e.g),a=e.g.abrFactory,e.u&&e.fg==a||(e.fg=a,e.u=a(),"function"!=typeof e.u.setMediaElement&&(ai("AbrManager","Please use an AbrManager with setMediaElement function."),e.u.setMediaElement=function(){}),"function"!=typeof e.u.setCmsdManager&&(ai("AbrManager","Please use an AbrManager with setCmsdManager function."),e.u.setCmsdManager=function(){}),"function"!=typeof e.u.trySuggestStreams&&(ai("AbrManager","Please use an AbrManager with trySuggestStreams function."),e.u.trySuggestStreams=function(){}),e.u.configure(e.g.abr)),e.Ra=new fi(e.g.preferredAudioLanguage,e.g.preferredVariantRole,e.g.preferredAudioChannelCount,e.g.preferredVideoHdrLevel,e.g.preferSpatialAudio,e.g.preferredVideoLayout,e.g.preferredAudioLabel,e.g.preferredVideoLabel,e.g.mediaSource.codecSwitchingStrategy,e.g.manifest.dash.enableAudioGroups),e.Wa=e.g.preferredTextLanguage,e.nc=e.g.preferredTextRole,e.Vb=e.g.preferForcedSubs,Fl(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),e.u.init((function(t,n,i){e.j&&t!=e.j.j&&Cl(e,t,!0,void 0!==n&&n,void 0===i?0:i)})),e.u.setMediaElement(n),e.u.setCmsdManager(e.Z),xn(e.i,e.g.preferredVideoCodecs,e.g.preferredAudioCodecs,e.g.preferredDecodingAttributes),e.j=function(e){return new Cs(e.i,{je:function(){return e.G?e.G.Yd():0},getBandwidthEstimate:function(){return e.u.getBandwidthEstimate()},Y:e.I,zc:e.J,onError:function(t){return Rl(e,t)},onEvent:function(t){return e.dispatchEvent(t)},Xi:function(){e.H&&e.H.update&&e.H.update()},Zf:function(t,n){var i=t.startTime,r=t.endTime,a=n.type;e.G&&e.G.gh(),al(e),i=(new Map).set("start",i).set("end",r).set("contentType",a),e.dispatchEvent(qu("segmentappended",i)),e.u&&n.fastSwitching&&t.Fd&&t.ue&&e.u.trySuggestStreams()},Wi:function(t,n){(n=n.Uf)&&e.sa&&function(e,t,n){var i=function(e,t){var n=e.g.get(t);return n||(n={Gd:[],Mg:null,contentType:t},e.g.set(t,n)),n}(e,t.contentType);!function(e,t){if((e=e.h()[t.contentType])&&0<e.length){var n=e[0].start,i=e[e.length-1].end,r=t.Gd;t.Gd=r.filter((function(e,t){return!(e.position<=n&&t+1<r.length&&r[t+1].position<=n||e.position>=i)}))}else t.Gd=[]}(e,i),e={Uf:t,position:n},0<=(t=(i=i.Gd).findIndex((function(e){return e.position>=n})))?i.splice(t,i[t].position==n?1:0,e):i.push(e)}(e.sa,n,t)},Gg:function(t,n){var i=e.m;if(i.h.parseInbandPsshEnabled&&!i.H&&["audio","video"].includes(t)){var r=0,a=l((n=new wr(et(n))).data);for(t=a.next();!t.done;t=a.next())r+=t.value.length;if(0==r)i=Promise.resolve();else{for(r=new Uint8Array(r),a=0,t=(n=l(n.data)).next();!t.done;t=n.next())t=t.value,r.set(t,a),a+=t.length;qr(i,"cenc",r),i=i.l}}else i=Promise.resolve();return i},Yi:function(t,n,i){el(e,t,n,i)},ce:function(t,n){return e.ce(t,n)}})}(e),e.j.configure(e.g.streaming),e.l=Xl,n.textTracks&&e.s.o(n.textTracks,"addtrack",(function(t){t.track&&"chapters"===(t=t.track).kind&&nl(e,t)})),e.dispatchEvent(qu("streaming")),o=null,(s=e.j.j)||(o=Al(e,!0)),u=[],c=l([(h=s||o).video,h.audio]),d=c.next();!d.done;d=c.next())(p=d.value)&&!p.segmentIndex&&u.push(p.createSegmentIndex());if(!(0<u.length)){T.F(2);break}return _(T,Promise.all(u),2);case 2:if(e.H&&e.H.onInitialVariantChosen&&e.H.onInitialVariantChosen(h),Fl(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),e.G=function(e,t){return new es(e.h,e.i,e.g.streaming,t,(function(){e.xb&&cs(e.xb,!0),e.j&&e.j.Kd(),e.M&&al(e)}),(function(t){return e.dispatchEvent(t)}))}(e,e.ha),e.xb=function(e,t){(t=new fs(e.ua,e.R()||0<t)).addEventListener("enter",(function(t){Nl(e,"timelineregionenter",t.region)})),t.addEventListener("exit",(function(t){Nl(e,"timelineregionexit",t.region)})),t.addEventListener("skip",(function(t){var n=t.region;t.seeking||(Nl(e,"timelineregionenter",n),Nl(e,"timelineregionexit",n))}));var n=new hs(e.h);return n.g.add(t),e.sa&&n.g.add(e.sa),n}(e,t),f=Math.max(e.i.minBufferTime,e.g.streaming.rebufferingGoal),rl(e,n,f),s){T.F(4);break}if(Cl(e,o,!0,!1,0),!e.g.streaming.startAtSegmentBoundary){T.F(4);break}return g=e.G,m=g.ef,_(T,function(e,t){var n,i,r,a,o;return L((function(s){return 1==s.g?(n=e.audio,i=e.video,r=function(e,t){var n,i,r;return L((function(a){return 1==a.g?e?_(a,e.createSegmentIndex(),2):a.return(null):(i=(n=e.segmentIndex.rc(t))?n.next().value:null)?(r=i.startTime,a.return(r)):a.return(null)}))},_(s,r(n,t),2)):3!=s.g?(a=s.h,_(s,r(i,t),3)):null!=(o=s.h)&&null!=a?s.return(Math.max(o,a)):null!=o?s.return(o):null!=a?s.return(a):s.return(t)}))}(o,e.G.Yd()),6);case 6:m.call(g,T.h);case 4:return e.G.df(),e.bc().find((function(e){return e.active}))||((v=Xn(e.i.textStreams,e.Wa,e.nc,e.Vb)[0]||null)&&zu(e.C.h,v,!0),o&&(v?(o.audio&&function(e,t,n){if(0==e.g.autoShowText)return!1;if(1==e.g.autoShowText)return!0;var i=Pe(e.g.preferredTextLanguage);return n=Pe(n.language),2==e.g.autoShowText?Ie(n,i):3==e.g.autoShowText?(e=Pe(t.language),Ie(n,i)&&!Ie(e,n)):(X("Invalid autoShowText setting!"),!1)}(e,o.audio,v)&&(e.$=!0),e.$&&e.I.H.setTextVisibility(!0),Pl(e)):e.$=!1),v&&(e.g.streaming.alwaysStreamText||e.xc())&&ks(e.j,v)),_(T,e.j.start(),7);case 7:e.g.abr.enabled&&(e.u.enable(),Ll(e)),Il(e),Tl(e),e.i.variants.some((function(e){return e.primary})),(y=e.R())&&(e.g.streaming.liveSync||e.i.serviceDescription)?(b=function(){return wl(e)},e.s.o(n,"timeupdate",b)):y||(S=function(){return Sl(e)},e.s.o(n,"timeupdate",S),Sl(e)),e.D&&e.D.onManifestUpdated(y),e.Xa=!0,e.s.na(n,"loadedmetadata",(function(){e.C.m=Date.now()/1e3-t})),w(T)}}))}(u,o),0)}))}),"loadInner_"),10);case 16:return _(h,a((function(){return L((function(e){return _(e,function(e,t,n){var i,r,a,o,s,u,h,c,d,p;return L((function(f){if(1==f.g)return Ju(e,"src-equals"),i=e.h,e.G=new $o(i),r=!1,e.Ib.push((function(){r=!0})),null!=e.ha&&e.G.ef(e.ha),e.K=new ls({ke:function(){return i.playbackRate},Lc:function(){return i.defaultPlaybackRate},pg:function(e){i.playbackRate=e},fh:function(e){i.currentTime+=e}}),a=e.g.streaming.rebufferingGoal,rl(e,i,a),o=function(){return _l(e)},s=function(){return bl(e)},e.s.o(i,"playing",o),e.s.o(i,"pause",o),e.s.o(i,"ended",o),e.s.o(i,"ratechange",s),"none"!=i.preload&&e.s.na(i,"loadedmetadata",(function(){e.C.m=Date.now()/1e3-t})),i.audioTracks&&(e.s.o(i.audioTracks,"addtrack",(function(){return Il(e)})),e.s.o(i.audioTracks,"removetrack",(function(){return Il(e)})),e.s.o(i.audioTracks,"change",(function(){return Il(e)}))),i.textTracks&&(e.s.o(i.textTracks,"addtrack",(function(t){if(t.track)switch(t=t.track,t.kind){case"metadata":!function(e,t){if("metadata"==t.kind){t.mode="hidden",e.s.o(t,"cuechange",(function(){if(t.activeCues)for(var n=l(t.activeCues),i=n.next();!i.done;i=n.next())i=i.value,tl(e,i.startTime,i.endTime,i.type,i.value),e.D&&e.D.onCueMetadataChange(i.value)}));var n=new ln((function(){for(var t=function(e){return Array.from(e.h.textTracks).filter((function(e){return"metadata"==e.kind}))}(e),n=(t=l(t)).next();!n.done;n=t.next())n.value.mode="hidden"})).Qa().S(.5);e.Ib.push((function(){n.stop()}))}}(e,t);break;case"chapters":nl(e,t);break;default:Il(e)}})),e.s.o(i.textTracks,"removetrack",(function(){return Il(e)})),e.s.o(i.textTracks,"change",(function(){return Il(e)}))),i.src=function(e,t,n){try{if(!e.g.enabled)return t;var i=cu(e);e:{switch(n.toLowerCase()){case"audio/mp4":case"audio/webm":case"audio/ogg":case"audio/mpeg":case"audio/aac":case"audio/flac":case"audio/wav":var r=mu;break e;case"video/webm":case"video/mp4":case"video/mpeg":case"video/mp2t":r=yu;break e;case"application/x-mpegurl":case"application/vnd.apple.mpegurl":case"application/dash+xml":case"video/vnd.mpeg.dash.mpd":case"application/vnd.ms-sstr+xml":r=gu;break e}r=void 0}return i.ot=r,i.su=!0,fu(t,pu(i))}catch(e){return K("CMCD_SRC_ERROR","Could not generate src CMCD data.",e),t}}(e.V,e.aa,n),(fn()||Sn("Web0S"))&&i.load(),e.l=Kl,e.dispatchEvent(qu("streaming")),u=new wi,Wo(i,HTMLMediaElement.HAVE_METADATA,e.s,(function(){e.G.df(),u.resolve()})),Wo(i,HTMLMediaElement.HAVE_CURRENT_DATA,e.s,(function(){var t;return L((function(n){return 1==n.g?(function(e){var t=e.g.preferredAudioLanguage;""!=t&&e.Le(t,e.g.preferredVariantRole)}(e),(t=ul(e)).find((function(e){return"disabled"!=e.mode}))?(0<t.length&&(e.$=!0),n.F(2)):_(n,new Promise((function(t){e.s.na(i.textTracks,"change",t),new ln(t).S(1)})),2)):r?n.return():(function(e){var t=e.g.preferredTextLanguage;""!=t&&e.ig(t,e.g.preferredTextRole,e.g.preferForcedSubs)}(e),void w(n))}))})),i.error?u.reject(Ol(e)):"none"==i.preload&&(X('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),u.resolve()),e.s.na(i,"error",(function(){u.reject(Ol(e))})),_(f,u,2);(h=e.R())&&e.g.streaming.liveSync?(c=function(){return wl(e)},e.s.o(i,"timeupdate",c)):h||(d=function(){return Sl(e)},e.s.o(i,"timeupdate",d),Sl(e)),e.D&&(e.D.onManifestUpdated(h),h&&(p=e.Ha().end,e.s.o(i,"progress",(function(){var t=e.Ha().end;p!=t&&(e.D.onManifestUpdated(e.R()),p=t)})))),e.Xa=!0,w(f)}))}(u,o,n),0)}))}),"srcEqualsInner_"),10);case 10:u.dispatchEvent(qu("loaded")),A(h,0);break;case 5:if(7e3==(s=E(h)).code){h.F(18);break}return _(h,u.Wc(!1),18);case 18:throw s}}))},i.dj=function(){for(var e=this.W;e.g;)e.release()},i.configure=function(e,t){2==arguments.length&&"string"==typeof e&&(e=Mu(e,t)),e.streaming&&"forceTransmuxTS"in e.streaming&&(ai("streaming.forceTransmuxTS configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource.mediaSource=e.streaming.forceTransmuxTS,delete e.streaming.forceTransmuxTS),e.streaming&&"forceTransmux"in e.streaming&&(ai("streaming.forceTransmux configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource.mediaSource=e.streaming.forceTransmux,delete e.streaming.forceTransmux),e.streaming&&e.streaming.lowLatencyMode&&(null==e.streaming.inaccurateManifestTolerance&&(e.streaming.inaccurateManifestTolerance=0),null==e.streaming.rebufferingGoal&&(e.streaming.rebufferingGoal=.01),null==e.streaming.segmentPrefetchLimit&&(e.streaming.segmentPrefetchLimit=2),null==e.streaming.retryParameters&&(e.streaming.retryParameters={}),null==e.streaming.retryParameters.baseDelay&&(e.streaming.retryParameters.baseDelay=100),null==e.manifest&&(e.manifest={}),null==e.manifest.retryParameters&&(e.manifest.retryParameters={}),null==e.manifest.retryParameters.baseDelay&&(e.manifest.retryParameters.baseDelay=100),null==e.drm&&(e.drm={}),null==e.drm.retryParameters&&(e.drm.retryParameters={}),null==e.drm.retryParameters.baseDelay&&(e.drm.retryParameters.baseDelay=100));var n=ju(this.g,e,fl(this));return ol(this),n},i.getConfiguration=function(){var e=fl(this);return ju(e,this.g,fl(this)),e},i.Uh=function(){if(this.h){var e=this.h.buffered.length;e=e?this.h.buffered.end(e-1):0;var t=this.getConfiguration().streaming.bufferingGoal;if(e>=(t=Math.min(this.h.currentTime+t,this.Ha().end)))return 1;if(!(e<=this.h.currentTime)&&e<t)return(e-this.h.currentTime)/(t-this.h.currentTime)}return 0},i.hj=function(){for(var e in this.g)delete this.g[e];ju(this.g,fl(this),fl(this)),ol(this)},i.ie=function(){return this.l},i.If=function(){return this.i?this.i.type:null},i.ni=function(){return this.h},i.Yb=function(){return this.J},i.Gf=function(){return this.aa},i.ee=function(){return this.D?this.D:null},i.R=function(){return this.i?this.i.presentationTimeline.R():!(!this.h||!this.h.src)&&1/0==this.h.duration},i.wc=function(){return!!this.i&&this.i.presentationTimeline.wc()},i.Pc=function(){if(this.i){var e=this.i.variants;return!!e.length&&!e[0].video}return!(!this.h||!this.h.src)&&(this.h.videoTracks?0==this.h.videoTracks.length:0==this.h.videoHeight)},i.Ha=function(){if(this.i){if(!this.Xa&&"HLS"==this.i.type)return{start:0,end:0};var e=this.i.presentationTimeline;return{start:e.Nc(),end:e.Nb()}}return this.h&&this.h.src&&(e=this.h.seekable).length?{start:e.start(0),end:e.end(e.length-1)}:{start:0,end:0}},i.Fi=function(){this.R()&&(this.h.currentTime=this.Ha().end)},i.keySystem=function(){var e=this.drmInfo();return e?e.keySystem:""},i.drmInfo=function(){return this.m?this.m.g:null},i.td=function(){return this.m?this.m.td():1/0},i.Ff=function(){return this.m?this.m.Ff():[]},i.ge=function(){return this.m?this.m.ge():{}},i.yd=function(){return!!this.M&&this.M.g==vi},i.Mb=function(){return this.h?this.K?this.K.h:1:0},i.Pd=function(e){var t=this;0==e?X("A trick play rate of 0 is unsupported!"):(this.va.ub(),this.h.paused&&this.h.play(),this.K.set(e),this.l==Xl&&(this.u.playbackRateChanged(e),xs(this.j,1<Math.abs(e))),this.R()&&this.va.o(this.h,"timeupdate",(function(){var n=t.h.currentTime,i=t.Ha(),r=t.g.streaming.safeSeekOffset;0<e?n>=i.end&&t.od():n<=i.start+r&&t.od()})))},i.od=function(){var e=this.K.Lc();this.l==Kl&&this.K.set(e),this.l==Xl&&(this.K.set(e),this.u.playbackRateChanged(e),xs(this.j,!1)),this.va.ub()},i.mb=function(){if(this.i){for(var e=this.j?this.j.j:null,t=[],n=0,i=l(this.i.variants),r=i.next();!r.done;r=i.next())if(Wn(r=r.value)){var a=Un(r);a.active=r==e,a.active||1==n||null==e||r.video!=e.video||r.audio!=e.audio||(a.active=!0),a.active&&n++,t.push(a)}return t}return this.h&&this.h.audioTracks?Array.from(this.h.audioTracks).map((function(e){return Hn(e)})):[]},i.bc=function(){if(this.i){for(var e=this.j?this.j.s:null,t=[],n=l(this.i.textStreams),i=n.next();!i.done;i=n.next()){var r=Bn(i=i.value);r.active=i==e,t.push(r)}return t}return this.h&&this.h.src&&this.h.textTracks?ul(this).map((function(e){return jn(e)})):[]},i.fe=function(){var e=this.tc;return this.i&&(e=this.i.imageStreams),e.map((function(e){return Fn(e)}))},i.Rh=function(e){var t,n,i,r,a=this;return L((function(o){return 1==o.g?a.l!=Xl&&a.l!=Kl?o.return(null):(t=a.tc,a.i&&(t=a.i.imageStreams),(n=t.find((function(t){return t.id==e})))?n.segmentIndex?o.F(2):_(o,n.createSegmentIndex(),2):o.return(null)):4!=o.g?(i=[],as(n.segmentIndex,(function(t){var r=sl(t.tilesLayout||n.tilesLayout);if(r){r=r.rows*r.mc;for(var o=t.h-t.startTime,s=0;s<r;s++)i.push(a.Kf(e,t.startTime+o*s/r))}})),_(o,Promise.all(i),4)):(r=o.h,o.return(r.filter((function(e){return e}))))}))},i.Kf=function(e,t){var n,i,r,a,o,s,u,l,h,c,d,p,f,g,m,v,y,b,w=this;return L((function(S){return 1==S.g?w.l!=Xl&&w.l!=Kl?S.return(null):(n=w.tc,w.i&&(n=w.i.imageStreams),(i=n.find((function(t){return t.id==e})))?i.segmentIndex?S.F(2):_(S,i.createSegmentIndex(),2):S.return(null)):null==(r=i.segmentIndex.find(t))?S.return(null):(a=i.segmentIndex.get(r),(o=sl(a.tilesLayout||i.tilesLayout))?(s=i.width||0,u=i.height||0,l=s/o.mc,h=u/o.rows,c=o.mc*o.rows,d=a.h-a.startTime,p=a.C||d/c,f=a.startTime,m=g=0,1<c&&(v=Math.floor((t-a.startTime)/p),f=a.startTime+v*p,g=v%o.mc*l,m=Math.floor(v/o.mc)*h),y=!1,(b=a.u)&&(y=!0,h=b.height,g=b.positionX,m=b.positionY,l=b.width),S.return({segment:a,imageHeight:u,imageWidth:s,height:h,positionX:g,positionY:m,startTime:f,duration:p,uris:a.ba(),width:l,sprite:y})):S.return(null))}))},i.jg=function(e){if(this.i&&this.j){var t=this.i.textStreams.find((function(t){return t.id==e.id}));t&&t!=this.j.s&&(zu(this.C.h,t,!1),ks(this.j,t),Ml(this),this.Wa=t.language)}else if(this.h&&this.h.src&&this.h.textTracks){for(var n=(t=l(t=ul(this))).next();!n.done;n=t.next())Gn(n=n.value)==e.id?n.mode=this.$?"showing":"hidden":n.mode="disabled";Ml(this)}},i.Me=function(e,t,n){if(t=void 0!==t&&t,n=void 0===n?0:n,this.i&&this.j){this.g.abr.enabled&&X("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var i=this.i.variants.find((function(t){return t.id==e.id}));i&&Wn(i)&&(Cl(this,i,!1,t,n),this.Ra=new pi(i,this.g.mediaSource.codecSwitchingStrategy,this.g.manifest.dash.enableAudioGroups),Tl(this))}else if(this.h&&this.h.audioTracks)for(n=(t=l(t=Array.from(this.h.audioTracks))).next();!n.done;n=t.next())if(Gn(n=n.value)==e.id){xl(this,n);break}},i.Th=function(){return Vl(this.mb())},i.xi=function(){return Vl(this.bc())},i.Sh=function(){return Array.from(Hl(this.mb()))},i.wi=function(){return Array.from(Hl(this.bc()))},i.Le=function(e,t,n,i){if(n=void 0===n?0:n,i=void 0===i?0:i,this.i&&this.G){this.Ra=new fi(e,t||"",n,"",!1,"","","",this.g.mediaSource.codecSwitchingStrategy,this.g.manifest.dash.enableAudioGroups),e=function(e,t){return e.video||t.video?e.video&&t.video?Math.abs((e.video.height||0)-(t.video.height||0))+Math.abs((e.video.width||0)-(t.video.width||0)):1/0:0},t=this.j.j;var r=this.Ra.create(this.i.variants);n=null;for(var a=(r=l(r.values())).next();!a.done;a=r.next())a=a.value,(!n||e(n,t)>e(a,t))&&(n=a);n?(e=Un(n),this.Me(e,!0,i)):El(this)}else this.h&&this.h.audioTracks&&(i=Xn(this.mb(),e,t||"",!1)[0])&&this.Me(i)},i.ig=function(e,t,n){n=void 0!==n&&n,this.i&&this.G?(this.Wa=e,this.nc=t||"",this.Vb=n,(e=Xn(this.i.textStreams,this.Wa,this.nc,this.Vb)[0]||null)&&e!=this.j.s&&(zu(this.C.h,e,!1),this.g.streaming.alwaysStreamText||this.xc())&&(ks(this.j,e),Ml(this))):(e=Xn(this.bc(),e,t||"",n)[0])&&this.jg(e)},i.oj=function(e,t,n){if(t=void 0===t||t,n=void 0===n?0:n,this.i&&this.G){for(var i=null,r=l(this.i.variants),a=r.next();!a.done;a=r.next())if((a=a.value).audio.label==e){i=a;break}null!=i&&(this.Ra=new fi(i.language,"",0,"",!1,"",e,"",this.g.mediaSource.codecSwitchingStrategy,this.g.manifest.dash.enableAudioGroups),El(this,t,n))}else if(this.h&&this.h.audioTracks){for(t=null,i=(n=l(n=Array.from(this.h.audioTracks))).next();!i.done;i=n.next())(i=i.value).label==e&&(t=i);t&&xl(this,t)}},i.xc=function(){var e=this.$;return this.I&&this.l==Xl?this.I.H.isTextVisible():this.h&&this.h.src&&this.h.textTracks?ul(this).some((function(e){return"showing"==e.mode})):e},i.Sg=function(){return this.h&&this.h.src&&this.h.textTracks?ll(this).map((function(e){return jn(e)})):[]},i.Wh=function(e){if(!this.h||!this.h.src||!this.h.textTracks)return[];var t=Pe(e),n=ll(this).filter((function(e){return Pe(e.language)==t}));if(!n||!n.length)return[];e=[];for(var i=new Set,r=(n=l(n)).next();!r.done;r=n.next())if((r=r.value)&&r.cues)for(var a=(r=l(r.cues)).next();!a.done;a=r.next()){var o=a.value;(a=o.id)&&""!=a||(a=o.startTime+"-"+o.endTime+"-"+o.text),o={id:a,title:o.text,startTime:o.startTime,endTime:o.endTime},i.has(a)||(e.push(o),i.add(a))}return e},i.Oe=function(e){if(e=!!e,this.$!=e){if(this.$=e,this.l==Xl)this.I.H.setTextVisibility(e),this.g.streaming.alwaysStreamText||(e?this.j.s||0<(e=Xn(this.i.textStreams,this.Wa,this.nc,this.Vb)).length&&(ks(this.j,e[0]),Ml(this)):function(e){var t=e.i.get(Ae);t&&(js(t),Hs(t).catch((function(){})),e.i.delete(Ae)),e.s=null}(this.j));else if(this.h&&this.h.src&&this.h.textTracks)for(var t=ul(this),n=(t=l(t)).next();!n.done;n=t.next())"disabled"!=(n=n.value).mode&&(n.mode=e?"showing":"hidden");Pl(this)}},i.oi=function(){if(!this.R())return null;if(this.G)var e=this.G.Yd();else{if(null==this.ha)return new Date;e=this.ha}if(this.i)return new Date(1e3*(this.i.presentationTimeline.i+e));if(this.h&&this.h.getStartDate){var t=this.h.getStartDate();return isNaN(t.getTime())?null:new Date(t.getTime()+1e3*e)}return null},i.Vg=function(){if(!this.R())return null;if(this.i)return new Date(1e3*this.i.presentationTimeline.i);if(this.h&&this.h.getStartDate){var e=this.h.getStartDate();return isNaN(e.getTime())?null:e}return null},i.Lb=function(){if(this.l==Xl)return this.I.Lb();var e={total:[],audio:[],video:[],text:[]};return this.l==Kl&&(e.total=ka(this.h.buffered)),e},i.getStats=function(){if(this.l!=Xl&&this.l!=Kl)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,stallsDetected:NaN,gapsJumped:NaN,estimatedBandwidth:NaN,completionPercent:NaN,loadLatency:NaN,manifestTimeSeconds:NaN,drmTimeSeconds:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,liveLatency:NaN,maxSegmentDuration:NaN,switchHistory:[],stateHistory:[]};_l(this);var e=this.h,t=e.currentTime/e.duration;if(!isNaN(t)){var n=this.C;t=Math.round(100*t),n.i=isNaN(n.i)?t:Math.max(n.i,t)}if(this.G&&(this.C.M=this.G.Bg(),this.C.N=this.G.Cg()),e.getVideoPlaybackQuality){n=e.getVideoPlaybackQuality(),t=this.C;var i=Number(n.totalVideoFrames);t.L=Number(n.droppedVideoFrames),t.K=i,this.C.J=Number(n.corruptedVideoFrames)}if(n=this.m&&(n=this.m).K?n.K:NaN,this.C.u=n,this.l==Xl){if(n=this.j.j,t=this.j.s,n){var r=(i=this.K?this.K.h:1)*n.bandwidth;t&&t.bandwidth&&(r+=i*t.bandwidth),this.C.D=r}n&&n.video&&(t=this.C,i=n.video.height||NaN,t.s=n.video.width||NaN,t.l=i),this.R()&&(n=this.Vg().valueOf()+1e3*e.currentTime,this.C.G=(Date.now()-n)/1e3),this.i&&this.i.presentationTimeline&&(this.C.I=this.i.presentationTimeline.g),n=this.u.getBandwidthEstimate(),this.C.C=n}this.l==Kl&&(n=this.C,t=e.videoHeight||NaN,n.s=e.videoWidth||NaN,n.l=t);var a=this.C;e=a.s,n=a.l,t=a.D,i=a.K,r=a.L;for(var o=a.J,s=a.N,u=a.M,h=a.C,c=a.i,d=a.m,p=a.H,f=a.j,g=Vu(a.g,"playing"),m=Vu(a.g,"paused"),v=Vu(a.g,"buffering"),y=a.u,b=a.G,_=a.I,w=function(e){function t(e){return{timestamp:e.timestamp,state:e.state,duration:e.duration}}for(var n=[],i=l(e.h),r=i.next();!r.done;r=i.next())n.push(t(r.value));return e.g&&n.push(t(e.g)),n}(a.g),S=[],T=(a=l(a.h.g)).next();!T.done;T=a.next())T=T.value,S.push({timestamp:T.timestamp,id:T.id,type:T.type,fromAdaptation:T.fromAdaptation,bandwidth:T.bandwidth});return{width:e,height:n,streamBandwidth:t,decodedFrames:i,droppedFrames:r,corruptedFrames:o,stallsDetected:s,gapsJumped:u,estimatedBandwidth:h,completionPercent:c,loadLatency:d,manifestTimeSeconds:p,drmTimeSeconds:f,playTime:g,pauseTime:m,bufferingTime:v,licenseTime:y,liveLatency:b,maxSegmentDuration:_,stateHistory:w,switchHistory:S}},i.Hh=function(e,t,n,i,r,a,o){o=void 0!==o&&o;var s,u,l,h,c,d,p,f,g,m,v=this;return L((function(y){switch(y.g){case 1:if(v.l!=Xl&&v.l!=Kl)throw new ye(1,7,7004);if("subtitles"!=n&&"captions"!=n&&X("Using a kind value different of `subtitles` or `captions` can cause unwanted issues."),i){y.F(2);break}return _(y,hl(v,e),3);case 3:i=y.h;case 2:if(s=[],v.D&&(s=v.D.getCuePoints()),v.l!=Kl){y.F(4);break}return o&&(n="forced"),_(y,cl(v,e,t,n,i,a||"",s),5);case 5:if(u=Pe(t),l=v.bc(),h=l.find((function(e){return Pe(e.language)==u&&e.label==(a||"")&&e.kind==n})))return Il(v),y.return(h);throw new ye(1,2,2012);case 4:if(c=Ee,d=v.h.duration,v.i&&(d=v.i.presentationTimeline.getDuration()),1/0==d)throw new ye(1,4,4033);if(!s.length){y.F(6);break}return _(y,dl(v,e,v.J,v.g.streaming.retryParameters),7);case 7:p=y.h,f=pl(v,p,i,s),g=new Blob([f],{type:"text/vtt"}),e=Oo(g),i="text/vtt";case 6:if(m={id:v.Ag++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:os(0,d,[e]),mimeType:i||"",codecs:r||"",kind:n,encrypted:!1,drmInfos:[],keyIds:new Set,language:t,originalLanguage:t,label:a||null,type:c.Da,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!!o,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1},!Qt(Ht(m.mimeType,m.codecs)))throw new ye(2,2,2014,i);return v.i.textStreams.push(m),Il(v),y.return(Bn(m))}}))},i.Ih=function(e,t){var n,i,r,a,o,s,u,h,c,d,p,f,g,m,v,y,b=this;return L((function(w){switch(w.g){case 1:if(b.l!=Xl&&b.l!=Kl)throw new ye(1,7,7004);if(t){w.F(2);break}return _(w,hl(b,e),3);case 3:t=w.h;case 2:if("text/vtt"!=t)throw new ye(1,2,2017,e);if(n=Ee,i=b.h.duration,b.i&&(i=b.i.presentationTimeline.getDuration()),1/0==i)throw new ye(1,4,4045);return _(w,dl(b,e,b.J,b.g.streaming.retryParameters),4);case 4:if(r=w.h,!(a=tn[t]))throw new ye(2,2,2014,t);for(o=a(),s={periodStart:0,segmentStart:0,segmentEnd:i,vttOffset:0},u=et(r),h=o.parseMedia(u,s,e),c=[],d={},p=l(h),f=p.next();!f.done;d={jd:d.jd,jc:d.jc},f=p.next())d.jc=f.value,d.jd=null,g=function(t){return function(){return null==t.jd&&(t.jd=_e([e],[t.jc.payload])),t.jd||[]}}(d),m=new Ta(d.jc.startTime,d.jc.endTime,g,0,null,null,0,0,1/0),d.jc.payload.includes("#xywh")&&4===(v=d.jc.payload.split("#xywh=")[1].split(",")).length&&m.rh({height:parseInt(v[3],10),positionX:parseInt(v[0],10),positionY:parseInt(v[1],10),width:parseInt(v[2],10)}),c.push(m);return y={id:b.Ag++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new rs(c),mimeType:t||"",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:n.cf,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,tilesLayout:"1x1",accessibilityPurpose:null,external:!0,fastSwitching:!1},b.l==Kl?b.tc.push(y):b.i.imageStreams.push(y),Il(b),w.return(Fn(y))}}))},i.Gh=function(e,t,n){var i,r,a,o,s=this;return L((function(u){switch(u.g){case 1:if(s.l!=Xl&&s.l!=Kl)throw new ye(1,7,7004);if(n){u.F(2);break}return _(u,hl(s,e),3);case 3:n=u.h;case 2:return i=[],s.D&&(i=s.D.getCuePoints()),_(u,cl(s,e,t,"chapters",n,"",i),4);case 4:if(r=u.h,a=s.Sg(),!(o=a.find((function(e){return e.language==t})))){u.F(5);break}return _(u,new Promise((function(e,t){s.s.na(r,"load",e),s.s.na(r,"error",(function(){t(new ye(1,2,2015))}))})),6);case 6:return Il(s),u.return(o);case 5:throw new ye(1,2,2012)}}))},i.ng=function(e,t){this.Ee.width=e,this.Ee.height=t},i.eg=function(e){if(this.l==Xl){var t=this.j;if(e=void 0===e?.1:e,t.l.g)t=!1;else if(t.u)t=!1;else{for(var n=l(t.i.values()),i=n.next();!i.done;i=n.next())!(i=i.value).wd||i.Ta||i.Eb||(i.wd=!1,Gs(t,i,e));t=!0}}else t=!1;return t},i.ki=function(){return X("Shaka Player's internal Manifest structure is NOT covered by semantic versioning compatibility guarantees.  It may change at any time!  Please consider filing a feature request for whatever you use getManifest() for."),this.i},i.li=function(){return this.Ie},i.rg=function(e){this.oe=e},i.ce=function(e,t){if(!this.g.abr.enabled||this.l===Wl||!navigator.onLine)return!1;if(this.i.variants.some((function(t){return!(!(t=t[e.type])||t.id===e.id||"audio"==e.type&&e.language!==t.language)}))){for(var n=l(this.i.variants),i=n.next();!i.done;i=n.next()){var r=(i=i.value)[e.type];r&&r.id===e.id&&(i.disabledUntilTime=Date.now()/1e3+t)}return this.se.za(1),El(this,!0,t=this.Lb().video.reduce((function(e,t){return e+t.end-t.start}),0),!0,!1),!0}return!1},G("shaka.Player",Ku),Ku.prototype.setVideoContainer=Ku.prototype.rg,Ku.prototype.getManifestParserFactory=Ku.prototype.li,Ku.prototype.getManifest=Ku.prototype.ki,Ku.prototype.retryStreaming=Ku.prototype.eg,Ku.prototype.setMaxHardwareResolution=Ku.prototype.ng,Ku.prototype.addChaptersTrack=Ku.prototype.Gh,Ku.prototype.addThumbnailsTrack=Ku.prototype.Ih,Ku.prototype.addTextTrackAsync=Ku.prototype.Hh,Ku.prototype.getStats=Ku.prototype.getStats,Ku.prototype.getBufferedInfo=Ku.prototype.Lb,Ku.prototype.getPresentationStartTimeAsDate=Ku.prototype.Vg,Ku.prototype.getPlayheadTimeAsDate=Ku.prototype.oi,Ku.prototype.setTextTrackVisibility=Ku.prototype.Oe,Ku.prototype.getChapters=Ku.prototype.Wh,Ku.prototype.getChaptersTracks=Ku.prototype.Sg,Ku.prototype.isTextTrackVisible=Ku.prototype.xc,Ku.prototype.selectVariantsByLabel=Ku.prototype.oj,Ku.prototype.selectTextLanguage=Ku.prototype.ig,Ku.prototype.selectAudioLanguage=Ku.prototype.Le,Ku.prototype.getTextLanguages=Ku.prototype.wi,Ku.prototype.getAudioLanguages=Ku.prototype.Sh,Ku.prototype.getTextLanguagesAndRoles=Ku.prototype.xi,Ku.prototype.getAudioLanguagesAndRoles=Ku.prototype.Th,Ku.prototype.selectVariantTrack=Ku.prototype.Me,Ku.prototype.selectTextTrack=Ku.prototype.jg,Ku.prototype.getThumbnails=Ku.prototype.Kf,Ku.prototype.getAllThumbnails=Ku.prototype.Rh,Ku.prototype.getImageTracks=Ku.prototype.fe,Ku.prototype.getTextTracks=Ku.prototype.bc,Ku.prototype.getVariantTracks=Ku.prototype.mb,Ku.prototype.cancelTrickPlay=Ku.prototype.od,Ku.prototype.trickPlay=Ku.prototype.Pd,Ku.prototype.getPlaybackRate=Ku.prototype.Mb,Ku.prototype.isBuffering=Ku.prototype.yd,Ku.prototype.getKeyStatuses=Ku.prototype.ge,Ku.prototype.getActiveSessionsMetadata=Ku.prototype.Ff,Ku.prototype.getExpiration=Ku.prototype.td,Ku.prototype.drmInfo=Ku.prototype.drmInfo,Ku.prototype.keySystem=Ku.prototype.keySystem,Ku.prototype.goToLive=Ku.prototype.Fi,Ku.prototype.seekRange=Ku.prototype.Ha,Ku.prototype.isAudioOnly=Ku.prototype.Pc,Ku.prototype.isInProgress=Ku.prototype.wc,Ku.prototype.isLive=Ku.prototype.R,Ku.prototype.getAdManager=Ku.prototype.ee,Ku.prototype.getAssetUri=Ku.prototype.Gf,Ku.prototype.getNetworkingEngine=Ku.prototype.Yb,Ku.prototype.getMediaElement=Ku.prototype.ni,Ku.prototype.getManifestType=Ku.prototype.If,Ku.prototype.getLoadMode=Ku.prototype.ie,Ku.prototype.resetConfiguration=Ku.prototype.hj,Ku.prototype.getBufferFullness=Ku.prototype.Uh,Ku.prototype.getConfiguration=Ku.prototype.getConfiguration,Ku.prototype.configure=Ku.prototype.configure,Ku.prototype.releaseAllMutexes=Ku.prototype.dj,Ku.prototype.load=Ku.prototype.load,Ku.prototype.updateStartTime=Ku.prototype.xj,Ku.prototype.unload=Ku.prototype.Wc,Ku.prototype.detach=Ku.prototype.detach,Ku.prototype.attachCanvas=Ku.prototype.Eg,Ku.prototype.attach=Ku.prototype.Gc,Ku.probeSupport=function(e){var t,n,i,r,a;return e=void 0===e||e,L((function(o){if(1==o.g)return t={},e?_(o,function(){var e,t,n,i,r,a;return L((function(o){return 1==o.g?(e="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.microsoft.playready.recommendation com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" "),n=[{videoCapabilities:t=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],persistentState:"required",sessionTypes:["persistent-license"]},{initDataTypes:["cenc"],videoCapabilities:t}],i=new Map,r=function(e){var t,r,a;return L((function(o){switch(o.g){case 1:if(S(o,2),"org.w3.clearkey"===e&&wn())throw Error("Unsupported keySystem");return _(o,navigator.requestMediaKeySystemAccess(e,n),4);case 4:return t=o.h,a=!!(r=t.getConfiguration().sessionTypes)&&r.includes("persistent-license"),gn()&&(a=!1),i.set(e,{persistentState:a}),_(o,t.createMediaKeys(),5);case 5:A(o,0);break;case 2:E(o),i.set(e,null),w(o)}}))},a=e.map((function(e){return r(e)})),_(o,Promise.all(a),2)):o.return(Ki(i))}))}(),3):o.F(2);2!=o.g&&(t=o.h);var s={};if(hn())for(var u in va)s[u]=!0;for(var c=(u=l(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"])).next();!c.done;c=u.next())s[c=c.value]=hn()?!!va[c]:cn(c);for(n=s,s={},c=(u=l(u='video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",video/mp4; codecs="dvh1.20.01",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="ac-4",audio/mp4; codecs="opus",audio/mp4; codecs="flac",audio/mp4; codecs="dtsc",audio/mp4; codecs="dtse",audio/mp4; codecs="dtsx",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",").concat(h(Zt)))).next();!c.done;c=u.next()){s[c=c.value]=hn()?!!Qt(c)||ze(c)||!!Nt(c):cn(c);var d=c.split(";")[0];s[d]=s[d]||s[c]}for(a in i={manifest:n,media:s,drm:t},r=Zl)i[a]=r[a]();return o.return(i)}))},Ku.isBrowserSupported=Zu,Ku.setAdManagerFactory=function(e){Jl=e},Ku.registerSupportPlugin=function(e,t){Zl[e]=t},Ku.prototype.destroy=Ku.prototype.destroy;var Wl=0,zl=1,Xl=2,Kl=3;Ku.LoadMode={DESTROYED:Wl,NOT_LOADED:zl,MEDIA_SOURCE:Xl,SRC_EQUALS:Kl},Ku.version="v4.7.10";var Yl=["4","7"];ui=new function(e){this.g=e,this.i=oi,this.h=si}(new ri(Number(Yl[0]),Number(Yl[1])));var ql=["output-restricted","internal-error"],Zl={},Jl=null;function Ql(){this.h=[],this.j=this.i=this.g=0}function $l(e,t,n){var i=this;this.g=e,this.h=t,this.j=n,this.i=!1,this.l=this.h.getVolume(),this.m=new Hi,this.m.o(this.h,google.ima.AdEvent.Type.PAUSED,(function(){i.i=!0})),this.m.o(this.h,google.ima.AdEvent.Type.RESUMED,(function(){i.i=!1}))}function eh(t,n,i,r,a){var o=this;this.s=t,this.i=n,this.D=!1,this.u=this.G=null,this.H=NaN,this.m=a,this.j=null,this.h=new Hi,google.ima.settings.setLocale(i),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),(t=new google.ima.AdDisplayContainer(this.s,this.i)).initialize(),this.l=new google.ima.AdsLoader(t),this.l.getSettings().setPlayerType("shaka-player"),this.l.getSettings().setPlayerVersion("v4.7.10"),this.g=null,this.C=r||new google.ima.AdsRenderingSettings,this.h.o(this.l,google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(function(t){!function(t,n){if(t.m(new j("ads-loaded",(new Map).set("loadTime",Date.now()/1e3-t.H))),t.G.customPlayheadTracker){var i={currentTime:t.i.currentTime};t.g=n.getAdsManager(i,t.C),t.i.muted?t.g.setVolume(0):t.g.setVolume(t.i.volume),t.h.o(t.i,"timeupdate",(function(){t.i.duration&&(i.currentTime=t.i.currentTime)})),t.h.o(t.i,"volumechange",(function(){t.j&&(t.j.setVolume(t.i.volume),t.i.muted&&t.j.setMuted(!0))}))}else t.g=n.getAdsManager(t.i,t.C);t.m(new j("ima-ad-manager-loaded",(new Map).set("imaAdManager",t.g)));var r=t.g.getCuePoints();if(r.length){n=[];for(var a=(r=l(r)).next();!a.done;a=r.next())n.push({start:a.value,end:null});t.m(new j("ad-cue-points-changed",(new Map).set("cuepoints",n)))}!function(e){function t(t,n){t=(new Map).set("originalEvent",t),e.m(new j(n,t))}e.h.o(e.g,google.ima.AdErrorEvent.Type.AD_ERROR,(function(t){th(e,t)})),e.h.o(e.g,google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,(function(t){ih(e,t)})),e.h.o(e.g,google.ima.AdEvent.Type.STARTED,(function(t){ih(e,t)})),e.h.o(e.g,google.ima.AdEvent.Type.FIRST_QUARTILE,(function(e){t(e,"ad-first-quartile")})),e.h.o(e.g,google.ima.AdEvent.Type.MIDPOINT,(function(e){t(e,"ad-midpoint")})),e.h.o(e.g,google.ima.AdEvent.Type.THIRD_QUARTILE,(function(e){t(e,"ad-third-quartile")})),e.h.o(e.g,google.ima.AdEvent.Type.COMPLETE,(function(e){t(e,"ad-complete")})),e.h.o(e.g,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,(function(t){rh(e,t)})),e.h.o(e.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,(function(t){rh(e,t)})),e.h.o(e.g,google.ima.AdEvent.Type.SKIPPED,(function(e){t(e,"ad-skipped")})),e.h.o(e.g,google.ima.AdEvent.Type.VOLUME_CHANGED,(function(e){t(e,"ad-volume-changed")})),e.h.o(e.g,google.ima.AdEvent.Type.VOLUME_MUTED,(function(e){t(e,"ad-muted")})),e.h.o(e.g,google.ima.AdEvent.Type.PAUSED,(function(n){e.j&&(e.j.i=!0,t(n,"ad-paused"))})),e.h.o(e.g,google.ima.AdEvent.Type.RESUMED,(function(n){e.j&&(e.j.i=!1,t(n,"ad-resumed"))})),e.h.o(e.g,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,(function(n){e.j&&t(n,"ad-skip-state-changed")})),e.h.o(e.g,google.ima.AdEvent.Type.CLICK,(function(e){t(e,"ad-clicked")})),e.h.o(e.g,google.ima.AdEvent.Type.AD_PROGRESS,(function(e){t(e,"ad-progress")})),e.h.o(e.g,google.ima.AdEvent.Type.AD_BUFFERING,(function(e){t(e,"ad-buffering")})),e.h.o(e.g,google.ima.AdEvent.Type.IMPRESSION,(function(e){t(e,"ad-impression")})),e.h.o(e.g,google.ima.AdEvent.Type.DURATION_CHANGE,(function(e){t(e,"ad-duration-changed")})),e.h.o(e.g,google.ima.AdEvent.Type.USER_CLOSE,(function(e){t(e,"ad-closed")})),e.h.o(e.g,google.ima.AdEvent.Type.LOADED,(function(e){t(e,"ad-loaded")})),e.h.o(e.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,(function(e){t(e,"all-ads-completed")})),e.h.o(e.g,google.ima.AdEvent.Type.LINEAR_CHANGED,(function(e){t(e,"ad-linear-changed")})),e.h.o(e.g,google.ima.AdEvent.Type.AD_METADATA,(function(e){t(e,"ad-metadata")})),e.h.o(e.g,google.ima.AdEvent.Type.LOG,(function(e){t(e,"ad-recoverable-error")})),e.h.o(e.g,google.ima.AdEvent.Type.AD_BREAK_READY,(function(e){t(e,"ad-break-ready")})),e.h.o(e.g,google.ima.AdEvent.Type.INTERACTION,(function(e){t(e,"ad-interaction")}))}(t);try{t.g.init(t.i.offsetWidth,t.i.offsetHeight,nh(t)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL),t.h.o(t.i,"loadeddata",(function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight,nh(t)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)})),"ResizeObserver"in e?(t.u=new ResizeObserver((function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight,nh(t)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)})),t.u.observe(t.i)):t.h.o(document,"fullscreenchange",(function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight,nh(t)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)})),t.D?t.g.start():t.h.na(t.i,"play",(function(){t.D=!0,t.g.start()}))}catch(e){rh(t,null)}}(o,t)})),this.h.o(this.l,google.ima.AdErrorEvent.Type.AD_ERROR,(function(e){th(o,e)})),this.h.o(this.i,"ended",(function(){o.l.contentComplete()})),this.h.na(this.i,"play",(function(){o.D=!0}))}function th(e,t){t.getError(),t=(new Map).set("originalEvent",t),e.m(new j("ad-error",t)),rh(e,null),e.m(new j("ad-cue-points-changed",(new Map).set("cuepoints",[])))}function nh(e){return document.fullscreenEnabled?!!document.fullscreenElement:!!(e=e.i).webkitSupportsFullscreen&&e.webkitDisplayingFullscreen}function ih(e,t){var n=t.getAd();n?(e.j=new $l(n,e.g,e.i),t=(new Map).set("ad",e.j).set("sdkAdObject",n).set("originalEvent",t),e.m(new j("ad-started",t)),e.j.isLinear()&&(e.s.setAttribute("ad-active","true"),e.i.pause(),e.i.muted?((t=e.j).l=e.i.volume,t.h.setVolume(0)):e.j.setVolume(e.i.volume))):X("The IMA SDK fired a "+t.type+" event with no associated ad. Unable to play ad!")}function rh(e,t){e.m(new j("ad-stopped",(new Map).set("originalEvent",t))),e.j&&e.j.isLinear()&&(e.s.removeAttribute("ad-active"),e.i.ended||e.i.play())}function ah(e,t,n,i,r){this.h=e,this.g=r,this.i=t,this.j=n,this.l=i}function oh(e,t,n,i){this.D=e,this.K=t,this.g=n,this.l=null,this.W=NaN,this.i=i,this.J=!1,this.C=null,this.j=[],this.M=[],this.L=this.G=this.h=null,this.H=new Map,this.m=[],this.u=[],this.N="",this.V=!0,this.I="",this.s=new Hi}function sh(e,t){var n,i,r,a,o,s,u;L((function(l){return 1==l.g?t.staticResource?(n=uh(t),e.H.get(n)?l.return():(i=Li([t.staticResource],{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}),r=e.K.request(7,i),S(l,2),e.H.set(n,[]),_(l,r.promise,4))):l.return():2!=l.g?(a=l.h,o=qi(a.data),s=JSON.parse(o),u=s.apps,e.H.set(n,u),A(l,0)):(E(l),e.H.delete(n),void w(l))}))}function uh(e){return[e.adId,e.adParameters,e.adSystem,e.adTitle,e.creativeAdId,e.creativeId,e.creativeSequence,e.height,e.width,e.staticResource].join("")}function lh(e){var t=e.g.currentTime;if(0!=t&&null==e.C){for(var n,i,r=l(e.j),a=r.next();!a.done;a=r.next())for(var o=l((a=a.value).ads),s=o.next();!s.done;s=o.next())if(s=s.value,i){if(s.startTimeInSeconds<t&&s.startTimeInSeconds>i.startTimeInSeconds+i.durationInSeconds){i=s,n=a;break}}else s.startTimeInSeconds<t&&(i=s,n=a);n&&i&&!e.M.includes(i.adId)&&(e.C=t,e.g.currentTime=n.startTimeInSeconds)}}function hh(e){if(e.g.duration&&(e.h||e.j.length)){var t=e.g.currentTime,n=!1;if(e.h){n=!0;var i=e.G,r=i.startTimeInSeconds+.5*i.durationInSeconds,a=i.startTimeInSeconds+.75*i.durationInSeconds;t>=i.startTimeInSeconds+.25*i.durationInSeconds&&!e.u.includes("firstQuartile")?(e.u.push("firstQuartile"),ph(e,"firstQuartile")):t>=r&&!e.u.includes("midpoint")?(e.u.push("midpoint"),ph(e,"midpoint")):t>=a&&!e.u.includes("thirdQuartile")&&(e.u.push("thirdQuartile"),ph(e,"thirdQuartile")),i=e.h.getRemainingTime(),0<(r=e.h.getDuration())&&(0>=i||i>r)&&ch(e)}if(!e.h||!e.h.isLinear()){e:for(i=l(e.j),r=i.next();!r.done&&(r=r.value,!e.h||!e.h.isLinear());r=i.next())for(a=0;a<r.ads.length;a++){var o=r.ads[a],s=o.startTimeInSeconds+o.durationInSeconds;if(o.startTimeInSeconds<=t&&s>t){if(e.M.includes(o.adId)){if(e.g.ended)continue;e.g.currentTime=s;break e}ch(e),e.L=r,e.h=new ah(o,a+1,r.ads.length,!0,e.g),e.G=o,0===a&&ph(e,"breakStart"),dh(e);break}}if(!e.h)for(r=(i=l(e.j)).next();!r.done&&(r=r.value,!e.h);r=i.next())for(a=0;a<r.nonLinearAdsList.length;a++)if((o=r.nonLinearAdsList[a]).nonLinearAdList.length){s=r.startTimeInSeconds;var u=e.H.get(uh(o.nonLinearAdList[0]));if(s<=t&&u&&u.length){ch(e),s=e;for(var h=(u=l(u)).next();!h.done;h=u.next())if((h=h.value).data.source.length){var c=document.createElement("img");c.src=h.data.source[0].url,c.style.top=(h.placeholder.top||0)+"%",c.style.height=100-(h.placeholder.top||0)+"%",c.style.left=(h.placeholder.left||0)+"%",c.style.maxWidth=100-(h.placeholder.left||0)+"%",c.style.objectFit="contain",c.style.position="absolute",s.D.appendChild(c)}e.L=r,e.h=new ah(o,a+1,r.ads.length,!1,e.g),e.G=o,0===a&&ph(e,"breakStart"),dh(e);break}}n&&!e.h&&(t=e.g.currentTime,e.C&&e.C>t&&(e.g.currentTime=e.C),e.C=null)}}}function ch(e){if(e.h){for(;e.D.lastChild;)e.D.removeChild(e.D.firstChild);e.J||e.M.push(e.G.adId),ph(e,"complete");for(var t=l(e.m),n=t.next();!n.done;n=t.next())n=n.value,e.s.hc(n.target,n.type,n.listener);e.m=[],e.u=[],(t=e.h.getPositionInSequence())===(n=e.h.getSequenceLength())&&ph(e,"breakEnd"),e.h=null,e.G=null,e.L=null}}function dh(e){var t=!1;e.g.paused?t=!0:(ph(e,"impression"),ph(e,"start")),e.m.push({target:e.g,type:"volumechange",listener:function(){e.g.muted&&ph(e,"mute")}}),e.m.push({target:e.g,type:"volumechange",listener:function(){e.g.muted||ph(e,"unmute")}}),e.m.push({target:e.g,type:"play",listener:function(){t?(ph(e,"impression"),ph(e,"start"),t=!1):ph(e,"resume")}}),e.m.push({target:e.g,type:"pause",listener:function(){ph(e,"pause")}});for(var n=l(e.m),i=n.next();!i.done;i=n.next())i=i.value,e.s.o(i.target,i.type,i.listener)}function ph(e,t){var n=e.G.trackingEvents.find((function(e){return e.eventType==t}));if(n||(n=e.L.adBreakTrackingEvents.find((function(e){return e.eventType==t}))),n)for(var i=(n=l(n.beaconUrls)).next();!i.done;i=n.next())(i=i.value)&&""!=i&&((i=Li([i],{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4})).method="POST",e.K.request(7,i));switch(t){case"impression":e.i(new j("ad-impression"));break;case"start":e.i(new j("ad-started",(new Map).set("ad",e.h)));break;case"mute":e.i(new j("ad-muted"));break;case"unmute":e.i(new j("ad-volume-changed"));break;case"resume":e.i(new j("ad-resumed"));break;case"pause":e.i(new j("ad-paused"));break;case"firstQuartile":e.i(new j("ad-first-quartile"));break;case"midpoint":e.i(new j("ad-midpoint"));break;case"thirdQuartile":e.i(new j("ad-third-quartile"));break;case"complete":e.i(new j("ad-complete")),e.i(new j("ad-stopped"));break;case"breakStart":e.D.setAttribute("ad-active","true");break;case"breakEnd":e.D.removeAttribute("ad-active")}}function fh(e,t){this.g=e,this.i=null,this.h=t}function gh(e,t,n,i){var r=this;this.u=e,this.l=t,this.j=null,this.H=NaN,this.i=i,this.I=!1,this.C=this.m=this.s=null,this.D="",this.G=[],this.h=new Hi,(e=new google.ima.dai.api.UiSettings).setLocale(n),this.g=new google.ima.dai.api.StreamManager(this.l,this.u,e),this.i(new j("ima-stream-manager-loaded",(new Map).set("imaStreamManager",this.g))),this.h.o(this.g,google.ima.dai.api.StreamEvent.Type.LOADED,(function(e){!function(e,t){e.i(new j("ads-loaded",(new Map).set("loadTime",Date.now()/1e3-e.H))),t=t.getStreamData().url,e.j.resolve(t),e.j=null,e.I||e.h.o(e.l,"seeked",(function(){var t=e.l.currentTime;if(0!=t){e.g.streamTimeForContentTime(t);var n=e.g.previousCuePointForStreamTime(t);n&&!n.played&&(e.s=t,e.l.currentTime=n.start)}}))}(r,e)})),this.h.o(this.g,google.ima.dai.api.StreamEvent.Type.ERROR,(function(){r.D.length?r.j.resolve(r.D):r.j.reject("IMA Stream request returned an error and there was no backup asset uri provided."),r.j=null})),this.h.o(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_STARTED,(function(){})),this.h.o(this.g,google.ima.dai.api.StreamEvent.Type.STARTED,(function(e){e=e.getAd(),r.m=new fh(e,r.l),r.C&&(r.m.i=r.C),r.i(new j("ad-started",(new Map).set("ad",r.m))),r.u.setAttribute("ad-active","true")})),this.h.o(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_ENDED,(function(){r.u.removeAttribute("ad-active");var e=r.l.currentTime;r.s&&r.s>e&&(r.l.currentTime=r.s,r.s=null)})),this.h.o(this.g,google.ima.dai.api.StreamEvent.Type.AD_PROGRESS,(function(e){r.C=e.getStreamData().adProgressData,r.m&&(r.m.i=r.C)})),this.h.o(this.g,google.ima.dai.api.StreamEvent.Type.FIRST_QUARTILE,(function(){r.i(new j("ad-first-quartile"))})),this.h.o(this.g,google.ima.dai.api.StreamEvent.Type.MIDPOINT,(function(){r.i(new j("ad-midpoint"))})),this.h.o(this.g,google.ima.dai.api.StreamEvent.Type.THIRD_QUARTILE,(function(){r.i(new j("ad-third-quartile"))})),this.h.o(this.g,google.ima.dai.api.StreamEvent.Type.COMPLETE,(function(){r.i(new j("ad-complete")),r.i(new j("ad-stopped")),r.u.removeAttribute("ad-active"),r.m=null})),this.h.o(this.g,google.ima.dai.api.StreamEvent.Type.SKIPPED,(function(){r.i(new j("ad-skipped")),r.i(new j("ad-stopped"))})),this.h.o(this.g,google.ima.dai.api.StreamEvent.Type.CUEPOINTS_CHANGED,(function(e){var t=e.getStreamData();e=[];for(var n=(t=l(t.cuepoints)).next();!n.done;n=t.next())n=n.value,e.push({start:n.start,end:n.end});r.G=e,r.i(new j("ad-cue-points-changed",(new Map).set("cuepoints",e)))}))}function mh(){J.call(this),this.g=this.i=this.h=null,this.j=new Ql,this.m=navigator.language,this.l=null}function vh(e,t){if(t&&t.type)switch(t.type){case"ads-loaded":e.j.h.push(t.loadTime);break;case"ad-started":e.j.g++;break;case"ad-complete":e.j.i++;break;case"ad-skipped":e.j.j++}e.dispatchEvent(t)}function yh(e){return JSON.stringify(e,(function(e,t){if("function"!=typeof t){if(t instanceof Event||t instanceof j){var n={};for(i in t)(e=t[i])&&"object"==typeof e?"detail"==i&&(n[i]=e):i in Event||(n[i]=e);return n}if(t instanceof Error){var i=new Set(["name","message","stack"]);for(n in t)i.add(n);for(n=(e=l(Object.getOwnPropertyNames(t))).next();!n.done;n=e.next())i.add(n.value);for(e={},n=(i=l(i)).next();!n.done;n=i.next())e[n=n.value]=t[n];t={__type__:"Error",contents:e}}else if(t instanceof TimeRanges){for(i={__type__:"TimeRanges",length:t.length,start:[],end:[]},n=(t=l(ka(t))).next();!n.done;n=t.next())e=(n=n.value).end,i.start.push(n.start),i.end.push(e);t=i}else t=t instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(t)}:"number"==typeof t?isNaN(t)?"NaN":isFinite(t)?t:0>t?"-Infinity":"Infinity":t;return t}}))}function bh(e){return JSON.parse(e,(function(e,t){if("NaN"==t)var n=NaN;else if("-Infinity"==t)n=-1/0;else if("Infinity"==t)n=1/0;else if(t&&"object"==typeof t&&"TimeRanges"==t.__type__)n=function(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}}(t);else if(t&&"object"==typeof t&&"Uint8Array"==t.__type__)n=new Uint8Array(t.entries);else if(t&&"object"==typeof t&&"Error"==t.__type__){for(n in e=t.contents,t=Error(e.message),e)t[n]=e[n];n=t}else n=t;return n}))}(i=$l.prototype).getDuration=function(){return this.g.getDuration()},i.getMinSuggestedDuration=function(){return this.g.getMinSuggestedDuration()},i.getRemainingTime=function(){return this.h.getRemainingTime()},i.isPaused=function(){return this.i},i.isSkippable=function(){return 0<=this.g.getSkipTimeOffset()},i.getTimeUntilSkippable=function(){var e=this.g.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},i.canSkipNow=function(){return this.h.getAdSkippableState()},i.skip=function(){return this.h.skip()},i.pause=function(){return this.h.pause()},i.play=function(){return this.h.resume()},i.getVolume=function(){return this.h.getVolume()},i.setVolume=function(e){return this.j.volume=e,this.h.setVolume(e)},i.isMuted=function(){return 0==this.h.getVolume()},i.isLinear=function(){return this.g.isLinear()},i.resize=function(e,t){var n=!1,i=this.j;document.fullscreenEnabled?n=!!document.fullscreenElement:i.webkitSupportsFullscreen&&(n=i.webkitDisplayingFullscreen),this.h.resize(e,t,n?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)},i.setMuted=function(e){(this.j.muted=e)?(this.l=this.getVolume(),this.h.setVolume(0)):this.h.setVolume(this.l)},i.getSequenceLength=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getTotalAds()},i.getPositionInSequence=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getAdPosition()},i.getTitle=function(){return this.g.getTitle()},i.getDescription=function(){return this.g.getDescription()},i.getVastMediaBitrate=function(){return this.g.getVastMediaBitrate()},i.getVastMediaHeight=function(){return this.g.getVastMediaHeight()},i.getVastMediaWidth=function(){return this.g.getVastMediaWidth()},i.getAdId=function(){return this.g.getAdId()},i.getCreativeAdId=function(){return this.g.getCreativeAdId()},i.getAdvertiserName=function(){return this.g.getAdvertiserName()},i.getMediaUrl=function(){return this.g.getMediaUrl()},i.getTimeOffset=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getTimeOffset()},i.getPodIndex=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getPodIndex()},i.release=function(){this.h=this.g=null},G("shaka.ads.ClientSideAd",$l),$l.prototype.release=$l.prototype.release,$l.prototype.getPodIndex=$l.prototype.getPodIndex,$l.prototype.getTimeOffset=$l.prototype.getTimeOffset,$l.prototype.getMediaUrl=$l.prototype.getMediaUrl,$l.prototype.getAdvertiserName=$l.prototype.getAdvertiserName,$l.prototype.getCreativeAdId=$l.prototype.getCreativeAdId,$l.prototype.getAdId=$l.prototype.getAdId,$l.prototype.getVastMediaWidth=$l.prototype.getVastMediaWidth,$l.prototype.getVastMediaHeight=$l.prototype.getVastMediaHeight,$l.prototype.getVastMediaBitrate=$l.prototype.getVastMediaBitrate,$l.prototype.getDescription=$l.prototype.getDescription,$l.prototype.getTitle=$l.prototype.getTitle,$l.prototype.getPositionInSequence=$l.prototype.getPositionInSequence,$l.prototype.getSequenceLength=$l.prototype.getSequenceLength,$l.prototype.setMuted=$l.prototype.setMuted,$l.prototype.resize=$l.prototype.resize,$l.prototype.isLinear=$l.prototype.isLinear,$l.prototype.isMuted=$l.prototype.isMuted,$l.prototype.setVolume=$l.prototype.setVolume,$l.prototype.getVolume=$l.prototype.getVolume,$l.prototype.play=$l.prototype.play,$l.prototype.pause=$l.prototype.pause,$l.prototype.skip=$l.prototype.skip,$l.prototype.canSkipNow=$l.prototype.canSkipNow,$l.prototype.getTimeUntilSkippable=$l.prototype.getTimeUntilSkippable,$l.prototype.isSkippable=$l.prototype.isSkippable,$l.prototype.isPaused=$l.prototype.isPaused,$l.prototype.getRemainingTime=$l.prototype.getRemainingTime,$l.prototype.getMinSuggestedDuration=$l.prototype.getMinSuggestedDuration,$l.prototype.getDuration=$l.prototype.getDuration,eh.prototype.configure=function(e){this.G=e},eh.prototype.stop=function(){this.g&&this.g.stop(),this.s&&nu(this.s)},eh.prototype.release=function(){this.stop(),this.u&&this.u.disconnect(),this.h&&this.h.release(),this.g&&this.g.destroy(),this.l.destroy()},(i=ah.prototype).getDuration=function(){return this.h.durationInSeconds},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){return this.h.startTimeInSeconds+this.h.durationInSeconds-this.g.currentTime},i.isPaused=function(){return this.g.paused},i.isSkippable=function(){return!!this.h.skipOffset},i.getTimeUntilSkippable=function(){if(!this.h.skipOffset)return this.getRemainingTime();var e=this.getRemainingTime()-this.h.skipOffset;return Math.max(e,0)},i.canSkipNow=function(){return 0==this.getTimeUntilSkippable()},i.skip=function(){this.g.currentTime+=this.getRemainingTime()},i.pause=function(){return this.g.pause()},i.play=function(){return this.g.play()},i.getVolume=function(){return this.g.volume},i.setVolume=function(e){this.g.volume=e},i.isMuted=function(){return this.g.muted},i.isLinear=function(){return this.l},i.resize=function(){},i.setMuted=function(e){this.g.muted=e},i.getSequenceLength=function(){return this.j?this.j:1},i.getPositionInSequence=function(){return this.i?this.i:1},i.getTitle=function(){return this.h.adTitle},i.getDescription=function(){return""},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return 0},i.getVastMediaWidth=function(){return 0},i.getAdId=function(){return this.h.adId},i.getCreativeAdId=function(){return this.h.creativeId},i.getAdvertiserName=function(){return""},i.getMediaUrl=function(){return null},i.getTimeOffset=function(){return 0},i.getPodIndex=function(){return 0},i.release=function(){this.j=this.i=this.g=this.h=null},G("shaka.ads.MediaTailorAd",ah),ah.prototype.release=ah.prototype.release,ah.prototype.getPodIndex=ah.prototype.getPodIndex,ah.prototype.getTimeOffset=ah.prototype.getTimeOffset,ah.prototype.getMediaUrl=ah.prototype.getMediaUrl,ah.prototype.getAdvertiserName=ah.prototype.getAdvertiserName,ah.prototype.getCreativeAdId=ah.prototype.getCreativeAdId,ah.prototype.getAdId=ah.prototype.getAdId,ah.prototype.getVastMediaWidth=ah.prototype.getVastMediaWidth,ah.prototype.getVastMediaHeight=ah.prototype.getVastMediaHeight,ah.prototype.getVastMediaBitrate=ah.prototype.getVastMediaBitrate,ah.prototype.getDescription=ah.prototype.getDescription,ah.prototype.getTitle=ah.prototype.getTitle,ah.prototype.getPositionInSequence=ah.prototype.getPositionInSequence,ah.prototype.getSequenceLength=ah.prototype.getSequenceLength,ah.prototype.setMuted=ah.prototype.setMuted,ah.prototype.resize=ah.prototype.resize,ah.prototype.isLinear=ah.prototype.isLinear,ah.prototype.isMuted=ah.prototype.isMuted,ah.prototype.setVolume=ah.prototype.setVolume,ah.prototype.getVolume=ah.prototype.getVolume,ah.prototype.play=ah.prototype.play,ah.prototype.pause=ah.prototype.pause,ah.prototype.skip=ah.prototype.skip,ah.prototype.canSkipNow=ah.prototype.canSkipNow,ah.prototype.getTimeUntilSkippable=ah.prototype.getTimeUntilSkippable,ah.prototype.isSkippable=ah.prototype.isSkippable,ah.prototype.isPaused=ah.prototype.isPaused,ah.prototype.getRemainingTime=ah.prototype.getRemainingTime,ah.prototype.getMinSuggestedDuration=ah.prototype.getMinSuggestedDuration,ah.prototype.getDuration=ah.prototype.getDuration,oh.prototype.stop=function(){for(var e=l(this.m),t=e.next();!t.done;t=e.next())t=t.value,this.s.hc(t.target,t.type,t.listener);ch(this),this.m=[],this.u=[],this.N="",this.V=!0,this.I="",this.C=null,this.j=[],this.M=[],this.H.clear()},oh.prototype.release=function(){this.stop(),this.s&&this.s.release()},oh.prototype.onManifestUpdated=function(e){this.J=e,""!=this.N&&(function(e,t,n){var i,r,a,o,s,u,h,c,d,p,f,g,m,v,y;L((function(b){if(1==b.g)return i=Li([t],{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}),r=e.K.request(7,i),S(b,2),_(b,r.promise,4);if(2!=b.g){if(a=b.h,o=[],s=qi(a.data),0<(u=JSON.parse(s)).avails.length){if(JSON.stringify(e.j)!=JSON.stringify(u.avails)){for(e.j=u.avails,h=l(e.j),c=h.next();!c.done;c=h.next())for(d=c.value,p=l(d.nonLinearAdsList),f=p.next();!f.done;f=p.next())for(g=f.value,m=l(g.nonLinearAdList),v=m.next();!v.done;v=m.next())y=v.value,sh(e,y);o=e.getCuePoints(),e.i(new j("ad-cue-points-changed",(new Map).set("cuepoints",o)))}}else e.j.length&&e.i(new j("ad-cue-points-changed",(new Map).set("cuepoints",o))),ch(e),e.j=[];return n&&(e.J||0<o.length)&&function(e){hh(e),e.J||(lh(e),e.s.o(e.g,"seeked",(function(){lh(e)})),e.s.o(e.g,"ended",(function(){ch(e)}))),e.s.o(e.g,"timeupdate",(function(){hh(e)}))}(e),A(b,0)}E(b),w(b)}))}(this,this.N,this.V),this.V=!1)},oh.prototype.getCuePoints=function(){for(var e=[],t=l(this.j),n=t.next();!n.done;n=t.next())for(var i=(n=l(n.value.ads)).next();!i.done;i=n.next())i=i.value,e.push({start:i.startTimeInSeconds,end:i.startTimeInSeconds+i.durationInSeconds});return e},(i=fh.prototype).getDuration=function(){return this.i?this.i.duration:-1},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){return this.i?this.i.duration-this.i.currentTime:-1},i.isPaused=function(){return this.h.paused},i.isSkippable=function(){return this.g.isSkippable()},i.getTimeUntilSkippable=function(){var e=this.g.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},i.canSkipNow=function(){return 0==this.getTimeUntilSkippable()},i.skip=function(){this.h.currentTime+=this.getRemainingTime()},i.pause=function(){return this.h.pause()},i.play=function(){return this.h.play()},i.getVolume=function(){return this.h.volume},i.setVolume=function(e){this.h.volume=e},i.isMuted=function(){return this.h.muted},i.isLinear=function(){return!0},i.resize=function(){},i.setMuted=function(e){this.h.muted=e},i.getSequenceLength=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getTotalAds()},i.getPositionInSequence=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getAdPosition()},i.getTitle=function(){return this.g.getTitle()},i.getDescription=function(){return this.g.getDescription()},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return this.g.getVastMediaHeight()},i.getVastMediaWidth=function(){return this.g.getVastMediaWidth()},i.getAdId=function(){return this.g.getAdId()},i.getCreativeAdId=function(){return this.g.getCreativeAdId()},i.getAdvertiserName=function(){return this.g.getAdvertiserName()},i.getMediaUrl=function(){return null},i.getTimeOffset=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getTimeOffset()},i.getPodIndex=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getPodIndex()},i.release=function(){this.h=this.i=this.g=null},G("shaka.ads.ServerSideAd",fh),fh.prototype.release=fh.prototype.release,fh.prototype.getPodIndex=fh.prototype.getPodIndex,fh.prototype.getTimeOffset=fh.prototype.getTimeOffset,fh.prototype.getMediaUrl=fh.prototype.getMediaUrl,fh.prototype.getAdvertiserName=fh.prototype.getAdvertiserName,fh.prototype.getCreativeAdId=fh.prototype.getCreativeAdId,fh.prototype.getAdId=fh.prototype.getAdId,fh.prototype.getVastMediaWidth=fh.prototype.getVastMediaWidth,fh.prototype.getVastMediaHeight=fh.prototype.getVastMediaHeight,fh.prototype.getVastMediaBitrate=fh.prototype.getVastMediaBitrate,fh.prototype.getDescription=fh.prototype.getDescription,fh.prototype.getTitle=fh.prototype.getTitle,fh.prototype.getPositionInSequence=fh.prototype.getPositionInSequence,fh.prototype.getSequenceLength=fh.prototype.getSequenceLength,fh.prototype.setMuted=fh.prototype.setMuted,fh.prototype.resize=fh.prototype.resize,fh.prototype.isLinear=fh.prototype.isLinear,fh.prototype.isMuted=fh.prototype.isMuted,fh.prototype.setVolume=fh.prototype.setVolume,fh.prototype.getVolume=fh.prototype.getVolume,fh.prototype.play=fh.prototype.play,fh.prototype.pause=fh.prototype.pause,fh.prototype.skip=fh.prototype.skip,fh.prototype.canSkipNow=fh.prototype.canSkipNow,fh.prototype.getTimeUntilSkippable=fh.prototype.getTimeUntilSkippable,fh.prototype.isSkippable=fh.prototype.isSkippable,fh.prototype.isPaused=fh.prototype.isPaused,fh.prototype.getRemainingTime=fh.prototype.getRemainingTime,fh.prototype.getMinSuggestedDuration=fh.prototype.getMinSuggestedDuration,fh.prototype.getDuration=fh.prototype.getDuration,(i=gh.prototype).configure=function(){},i.stop=function(){this.D="",this.s=null,this.G=[]},i.release=function(){this.stop(),this.h&&this.h.release()},i.onCueMetadataChange=function(e){if(e.key&&e.data){var t={};t[e.key]=e.data,this.g.onTimedMetadata(t)}},i.getCuePoints=function(){return this.G},m(mh,J),(i=mh.prototype).setLocale=function(e){this.m=e},i.configure=function(e){this.l=e,this.h&&this.h.configure(this.l),this.g&&this.g.configure(this.l)},i.initClientSide=function(t,n,i){var r=this;if(!e.google||!google.ima||!google.ima.AdsLoader)throw new ye(2,10,1e4);this.h&&this.h.release(),this.h=new eh(t,n,this.m,i,(function(e){return vh(r,e)})),this.h.configure(this.l)},i.release=function(){this.h&&(this.h.release(),this.h=null),this.i&&(this.i.release(),this.i=null),this.g&&(this.g.release(),this.g=null),J.prototype.release.call(this)},i.onAssetUnload=function(){this.h&&this.h.stop(),this.i&&this.i.stop(),this.g&&this.g.stop(),this.dispatchEvent(new j("ad-stopped")),this.j=new Ql},i.requestClientSideAds=function(e){if(!this.h)throw new ye(1,10,10001);var t=this.h;t.g&&t.g.destroy(),t.l&&t.l.contentComplete(),t.H=Date.now()/1e3,t.l.requestAds(e)},i.updateClientSideAdsRenderingSettings=function(e){if(!this.h)throw new ye(1,10,10001);var t=this.h;t.C=e,t.g&&t.g.updateAdsRenderingSettings(t.C)},i.initMediaTailor=function(e,t,n){var i=this;this.i&&this.i.release(),this.i=new oh(e,t,n,(function(e){return vh(i,e)}))},i.requestMediaTailorStream=function(e,t,n){if(!this.i)throw new ye(1,10,10005);var i=this.i;return n=void 0===n?"":n,i.l?e=Promise.reject(new ye(1,10,10004)):(i.l=new wi,function(e,t,n){var i,r,a,o,s,u,l,h,c,d,p;L((function(f){if(1==f.g)return(i=Li([t],{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4})).method="POST",n&&(r=JSON.stringify(n),i.body=Qi(r)),a=e.K.request(7,i),S(f,2),_(f,a.promise,4);if(2!=f.g){if(o=f.h,s=qi(o.data),!(u=JSON.parse(s)).manifestUrl||!u.trackingUrl)throw Error("Insufficient data from MediaTailor.");return l=new ne(t),h=new ne(u.trackingUrl),e.N=l.resolve(h).toString(),c=Date.now()/1e3,d=c-e.W,e.i(new j("ads-loaded",(new Map).set("loadTime",d))),p=new ne(u.manifestUrl),e.l.resolve(l.resolve(p).toString()),e.l=null,A(f,0)}if(E(f),!e.I.length)return e.l.reject("MediaTailor request returned an error and there was no backup asset uri provided."),e.l=null,f.return();e.l.resolve(e.I),e.l=null,w(f)}))}(i,e,t),i.I=n||"",i.W=Date.now()/1e3,e=i.l),e},i.initServerSide=function(t,n){var i=this;if(!e.google||!google.ima||!google.ima.dai)throw new ye(2,10,10002);this.g&&this.g.release(),this.g=new gh(t,n,this.m,(function(e){return vh(i,e)})),this.g.configure(this.l)},i.requestServerSideStream=function(e,t){if(t=void 0===t?"":t,!this.g)throw new ye(1,10,10003);e.adTagParameters||(e.adTagParameters={});var n=e.adTagParameters;return(n.mpt||n.mpv)&&X('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overriden.'),e.adTagParameters.mpt="shaka-player",e.adTagParameters.mpv="v4.7.10",(n=this.g).j?e=Promise.reject(new ye(1,10,10004)):(e instanceof google.ima.dai.api.LiveStreamRequest&&(n.I=!0),n.j=new wi,n.g.requestStream(e),n.D=t||"",n.H=Date.now()/1e3,e=n.j),e},i.replaceServerSideAdTagParameters=function(e){if(!this.g)throw new ye(1,10,10003);(e.mpt||e.mpv)&&X('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overriden.'),e.mpt="Shaka Player",e.mpv="v4.7.10",this.g.g.replaceAdTagParameters(e)},i.getServerSideCuePoints=function(){return ai("AdManager","Please use getCuePoints function."),this.getCuePoints()},i.getCuePoints=function(){var e=[];return this.g&&(e=e.concat(this.g.getCuePoints())),this.i&&(e=e.concat(this.i.getCuePoints())),e},i.getStats=function(){var e=this.j;return{loadTimes:e.h,started:e.g,playedCompletely:e.i,skipped:e.j}},i.onManifestUpdated=function(e){this.i&&this.i.onManifestUpdated(e)},i.onDashTimedMetadata=function(e){if(this.g&&"urn:google:dai:2018"==e.schemeIdUri){var t=e.schemeIdUri,n=e.eventElement?e.eventElement.getAttribute("messageData"):null;this.g.g.processMetadata(t,n,e.startTime)}},i.onHlsTimedMetadata=function(e,t){this.g&&this.g.g.processMetadata("ID3",e.data,t)},i.onCueMetadataChange=function(e){this.g&&this.g.onCueMetadataChange(e)},G("shaka.ads.AdManager",mh),mh.prototype.onCueMetadataChange=mh.prototype.onCueMetadataChange,mh.prototype.onHlsTimedMetadata=mh.prototype.onHlsTimedMetadata,mh.prototype.onDashTimedMetadata=mh.prototype.onDashTimedMetadata,mh.prototype.onManifestUpdated=mh.prototype.onManifestUpdated,mh.prototype.getStats=mh.prototype.getStats,mh.prototype.getCuePoints=mh.prototype.getCuePoints,mh.prototype.getServerSideCuePoints=mh.prototype.getServerSideCuePoints,mh.prototype.replaceServerSideAdTagParameters=mh.prototype.replaceServerSideAdTagParameters,mh.prototype.requestServerSideStream=mh.prototype.requestServerSideStream,mh.prototype.initServerSide=mh.prototype.initServerSide,mh.prototype.requestMediaTailorStream=mh.prototype.requestMediaTailorStream,mh.prototype.initMediaTailor=mh.prototype.initMediaTailor,mh.prototype.updateClientSideAdsRenderingSettings=mh.prototype.updateClientSideAdsRenderingSettings,mh.prototype.requestClientSideAds=mh.prototype.requestClientSideAds,mh.prototype.onAssetUnload=mh.prototype.onAssetUnload,mh.prototype.release=mh.prototype.release,mh.prototype.initClientSide=mh.prototype.initClientSide,mh.prototype.configure=mh.prototype.configure,mh.prototype.setLocale=mh.prototype.setLocale,mh.ADS_LOADED="ads-loaded",mh.AD_STARTED="ad-started",mh.AD_FIRST_QUARTILE="ad-first-quartile",mh.AD_MIDPOINT="ad-midpoint",mh.AD_THIRD_QUARTILE="ad-third-quartile",mh.AD_COMPLETE="ad-complete",mh.AD_STOPPED="ad-stopped",mh.AD_SKIPPED="ad-skipped",mh.AD_VOLUME_CHANGED="ad-volume-changed",mh.AD_MUTED="ad-muted",mh.AD_PAUSED="ad-paused",mh.AD_RESUMED="ad-resumed",mh.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",mh.CUEPOINTS_CHANGED="ad-cue-points-changed",mh.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",mh.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",mh.AD_CLICKED="ad-clicked",mh.AD_PROGRESS="ad-progress",mh.AD_BUFFERING="ad-buffering",mh.AD_IMPRESSION="ad-impression",mh.AD_DURATION_CHANGED="ad-duration-changed",mh.AD_CLOSED="ad-closed",mh.AD_LOADED="ad-loaded",mh.ALL_ADS_COMPLETED="all-ads-completed",mh.AD_LINEAR_CHANGED="ad-linear-changed",mh.AD_METADATA="ad-metadata",mh.AD_RECOVERABLE_ERROR="ad-recoverable-error",mh.AD_ERROR="ad-error",mh.AD_BREAK_READY="ad-break-ready",mh.AD_INTERACTION="ad-interaction",Jl=function(){return new mh};var _h="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),wh="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),Sh=["loop","playbackRate"],Th=["pause","play"],Ah={getAssetUri:2,getAudioLanguages:4,getAudioLanguagesAndRoles:4,getBufferFullness:1,getBufferedInfo:2,getExpiration:2,getKeyStatuses:2,getPlaybackRate:2,getTextLanguages:4,getTextLanguagesAndRoles:4,getImageTracks:2,getThumbnails:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,getLoadMode:10,getManifestType:10},Eh={getConfiguration:4,getStats:5,getTextTracks:2,getVariantTracks:2},Ch={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},xh=[["getConfiguration","configure"]],Ih=[["isTextTrackVisible","setTextTrackVisibility"]],kh="addChaptersTrack addTextTrackAsync addThumbnailsTrack cancelTrickPlay configure getChapters getChaptersTracks resetConfiguration retryStreaming selectAudioLanguage selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay updateStartTime goToLive".split(" "),Mh=["attach","attachCanvas","detach","load","unload"];function Ph(e,t,n,i,r,a,o){var s=this;this.I=e,this.M=o,this.j=new ln(t),this.N=n,this.C=!1,this.u=i,this.H=r,this.K=a,this.h=this.m=!1,this.L="",this.s=null,this.D=function(){return Oh(s)},this.G=function(e,t){switch((e=bh(t)).type){case"event":var n=e.targetName,i=H(e.event);s.u(n,i);break;case"update":for(i in n=e.update)for(var r in e=s.g[i]||{},n[i])e[r]=n[i][r];s.C&&(s.N(),s.C=!1);break;case"asyncComplete":if(i=e.id,r=e.error,e=s.i[i],delete s.i[i],e)if(r){for(n in i=new ye(r.severity,r.category,r.code),r)i[n]=r[n];e.reject(i)}else e.resolve()}},this.g={video:{},player:{}},this.J=0,this.i={},this.l=null,Vh.add(this)}function Lh(e,t,n){jh=n,n.addUpdateListener(e.D),n.addMessageListener("urn:x-cast:com.google.shaka.v2",e.G),Oh(e),Bh(e,{type:"init",initState:t,appData:e.s}),e.l.resolve()}function Dh(e,t){var n=8003;switch(t.code){case"cancel":n=8004;break;case"timeout":n=8005;break;case"receiver_unavailable":n=8006}e.l.reject(new ye(2,8,n,t))}function Rh(e,t){var n=e.K();e.l=new wi,e.C=!0,Lh(e,n,t)}function Nh(e){var t=jh;t.removeUpdateListener(e.D),t.removeMessageListener("urn:x-cast:com.google.shaka.v2",e.G)}function Oh(e){var t=!!jh&&"connected"==jh.status;if(e.h&&!t){for(var n in e.H(),e.g)e.g[n]={};Uh(e)}e.h=t,e.L=t?jh.receiver.friendlyName:"",e.j.Qa()}function Uh(e){for(var t in e.i){var n=e.i[t];delete e.i[t],n.reject(new ye(1,7,7e3))}}function Bh(e,t){t=yh(t);var n=jh;try{n.sendMessage("urn:x-cast:com.google.shaka.v2",t,(function(){}),Y)}catch(i){throw t=new ye(2,8,8005,i),n=new j("error",(new Map).set("detail",t)),e.u("player",n),e.Jc(),t}}(i=Ph.prototype).destroy=function(){return Vh.delete(this),Uh(this),jh&&Nh(this),this.j&&(this.j.stop(),this.j=null),this.H=this.u=null,this.h=this.m=!1,this.G=this.D=this.l=this.i=this.g=this.s=null,Promise.resolve()},i.Ba=function(){return this.h},i.Je=function(){return this.L},i.init=function(){if(this.I.length)if(e.chrome&&chrome.cast&&chrome.cast.isAvailable){this.m=!0,this.j.Qa();var t=new chrome.cast.SessionRequest(this.I,[],null,this.M,null);t=new chrome.cast.ApiConfig(t,(function(e){for(var t=l(Vh),n=t.next();!n.done;n=t.next())Rh(n.value,e)}),(function(e){for(var t=l(Vh),n=t.next();!n.done;n=t.next())n=n.value,Gh="available"==e,n.j.Qa()}),"origin_scoped"),chrome.cast.initialize(t,(function(){}),(function(){})),Gh&&this.j.S(Fh),(t=jh)&&t.status!=chrome.cast.SessionStatus.STOPPED?Rh(this,t):jh=null}else e.__onGCastApiAvailable!==Wh&&(Hh=e.__onGCastApiAvailable||null,e.__onGCastApiAvailable=Wh)},i.kg=function(e){this.s=e,this.h&&Bh(this,{type:"appData",appData:this.s})},i.cast=function(e){var t=this;return L((function(n){if(!t.m)throw new ye(1,8,8e3);if(!Gh)throw new ye(1,8,8001);if(t.h)throw new ye(1,8,8002);return t.l=new wi,chrome.cast.requestSession((function(n){return Lh(t,e,n)}),(function(e){return Dh(t,e)})),_(n,t.l,0)}))},i.Jc=function(){if(this.h){if(Uh(this),jh){Nh(this);try{jh.stop((function(){}),(function(){}))}catch(e){}jh=null}Oh(this)}},i.get=function(e,t){var n=this;if("video"==e){if(Th.includes(t))return function(){return n.kh.apply(n,[e,t].concat(h(D.apply(0,arguments))))}}else if("player"==e){if(Ch[t]&&!this.get("player","isLive")())return function(){};if(kh.includes(t))return function(){return n.kh.apply(n,[e,t].concat(h(D.apply(0,arguments))))};if(Mh.includes(t))return function(){return n.ej.apply(n,[e,t].concat(h(D.apply(0,arguments))))};if(Ah[t]||Eh[t])return function(){return n.g[e][t]}}return this.g[e][t]},i.set=function(e,t,n){this.g[e][t]=n,Bh(this,{type:"set",targetName:e,property:t,value:n})},i.kh=function(e,t){Bh(this,{type:"call",targetName:e,methodName:t,args:D.apply(2,arguments)})},i.ej=function(e,t){var n=D.apply(2,arguments),i=new wi,r=this.J.toString();this.J++,this.i[r]=i;try{Bh(this,{type:"asyncCall",targetName:e,methodName:t,args:n,id:r})}catch(e){i.reject(e)}return i};var Fh=.02,Gh=!1,jh=null,Hh=null,Vh=new Set;function Wh(t){if(Hh?e.__onGCastApiAvailable=Hh:delete e.__onGCastApiAvailable,Hh=null,t)for(var n=l(Vh),i=n.next();!i.done;i=n.next())i.value.init();"function"==typeof e.__onGCastApiAvailable&&e.__onGCastApiAvailable(t)}function zh(e,t,n,i){i=void 0!==i&&i,J.call(this);var r=this;this.i=e,this.h=t,this.m=this.s=this.j=this.u=this.l=null,this.G=n,this.D=i,this.C=new Map,this.g=new Ph(n,(function(){return Yh(r)}),(function(){return qh(r)}),(function(e,t){return Qh(r,e,t)}),(function(){return Zh(r)}),(function(){return Kh(r)}),i),function(e){e.g.init(),e.m=new Hi;for(var t=l(_h),n=t.next();!n.done;n=t.next())e.m.o(e.i,n.value,(function(t){e.g.Ba()||(t=H(t),e.j.dispatchEvent(t))}));for(var i in V)e.m.o(e.h,V[i],(function(t){e.g.Ba()||e.s.dispatchEvent(t)}));for(var r in e.l={},t={},e.i)t.$c=r,Object.defineProperty(e.l,t.$c,{configurable:!1,enumerable:!0,get:function(t){return function(){return Jh(e,t.$c)}}(t),set:function(t){return function(n){var i=t.$c;e.g.Ba()?e.g.set("video",i,n):e.i[i]=n}}(t)}),t={$c:t.$c};e.u={},Xh(e,(function(t){Object.defineProperty(e.u,t,{configurable:!1,enumerable:!0,get:function(){return function(e,t){if(e.C.has(t)&&(t=e.C.get(t)),"addEventListener"==t)return function(t,n,i){return e.s.addEventListener(t,n,i)};if("removeEventListener"==t)return function(t,n,i){return e.s.removeEventListener(t,n,i)};if("getMediaElement"==t)return function(){return e.l};if("getSharedConfiguration"==t)return e.g.get("player","getConfiguration");if("getNetworkingEngine"==t)return function(){return e.h.Yb()};if("getDrmEngine"==t)return function(){return e.h.m};if("getAdManager"==t)return function(){return e.h.ee()};if("setVideoContainer"==t)return function(t){return e.h.rg(t)};if(e.g.Ba()){if("getManifest"==t||"drmInfo"==t)return function(){return X(t+"() does not work while casting!"),null};if("attach"==t||"detach"==t)return function(){return X(t+"() does not work while casting!"),Promise.resolve()}}return e.g.Ba()&&0==Object.keys(e.g.g.video).length&&(Ah[t]||Eh[t])||!e.g.Ba()?e.h[t].bind(e.h):e.g.get("player",t)}(e,t)}})})),function(e){var t=new Map;Xh(e,(function(n,i){t.has(i)?(i=t.get(i),n.length<i.length?e.C.set(n,i):e.C.set(i,n)):t.set(i,n)}))}(e),e.j=new J,e.j.we=e.l,e.s=new J,e.s.we=e.u}(this)}function Xh(e,t){function n(e){return"constructor"!=e&&"function"==typeof r[e]&&!a.has(e)}var i,r=e.h,a=new Set;for(i in r)n(i)&&(a.add(i),t(i,r[i]));for(e=Object.getPrototypeOf(r),i=Object.getPrototypeOf({});e&&e!=i;){for(var o=l(Object.getOwnPropertyNames(e)),s=o.next();!s.done;s=o.next())n(s=s.value)&&(a.add(s),t(s,r[s]));e=Object.getPrototypeOf(e)}}function Kh(e){var t={video:{},player:{},playerAfterLoad:{},manifest:e.h.Gf(),startTime:null};e.i.pause();for(var n=l(Sh),i=n.next();!i.done;i=n.next())i=i.value,t.video[i]=e.i[i];for(e.i.ended||(t.startTime=e.i.currentTime),i=(n=l(xh)).next();!i.done;i=n.next()){var r=i.value;i=r[1],r=e.h[r[0]](),t.player[i]=r}for(i=(n=l(Ih)).next();!i.done;i=n.next())i=(r=i.value)[1],r=e.h[r[0]](),t.playerAfterLoad[i]=r;return t}function Yh(e){var t=new j("caststatuschanged");e.dispatchEvent(t)}function qh(e){var t=new j(e.l.paused?"pause":"play");e.j.dispatchEvent(t)}function Zh(e){for(var t=l(xh),n=t.next();!n.done;n=t.next()){var i=n.value;n=i[1],i=e.g.get("player",i[0])(),e.h[n](i)}var r=e.g.get("player","getAssetUri")();i=e.g.get("video","ended"),t=Promise.resolve();var a,o=e.i.autoplay;n=null,i||(n=e.g.get("video","currentTime")),(i=e.g.get("player","getTextTracks")())&&i.length&&(a=i.find((function(e){return e.active})));var s=e.g.get("player","isTextTrackVisible")();r&&(e.i.autoplay=!1,t=e.h.load(r,n));var u={};for(i=(n=l(Sh)).next();!i.done;i=n.next())i=i.value,u[i]=e.g.get("video",i);t.then((function(){if(e.i){for(var t=l(Sh),n=t.next();!n.done;n=t.next())n=n.value,e.i[n]=u[n];for(n=(t=l(Ih)).next();!n.done;n=t.next()){var i=n.value;n=i[1],i=e.g.get("player",i[0])(),e.h[n](i)}e.h.Oe(s),a&&e.h.ig(a.language,a.roles,a.forced),e.i.autoplay=o,r&&e.i.play()}}),(function(t){t=new j("error",t=(new Map).set("detail",t)),e.h.dispatchEvent(t)}))}function Jh(e,t){if("addEventListener"==t)return function(t,n,i){return e.j.addEventListener(t,n,i)};if("removeEventListener"==t)return function(t,n,i){return e.j.removeEventListener(t,n,i)};if(e.g.Ba()&&0==Object.keys(e.g.g.video).length){var n=e.i[t];if("function"!=typeof n)return n}return e.g.Ba()?e.g.get("video",t):("function"==typeof(t=e.i[t])&&(t=t.bind(e.i)),t)}function Qh(e,t,n){e.g.Ba()&&("video"==t?e.j.dispatchEvent(n):"player"==t&&e.s.dispatchEvent(n))}function $h(e,t,n,i){J.call(this);var r=this;this.g=e,this.h=t,this.j=new Hi,this.J={video:e,player:t},this.G=n||function(){},this.K=i||function(e){return e},this.i=null,this.H=!1,this.s=!0,this.m=0,this.D=!1,this.C=!0,this.u=this.l=null,this.I=new ln((function(){ic(r)})),function(e){var t=cast.receiver.CastReceiverManager.getInstance();t.onSenderConnected=function(){return ec(e)},t.onSenderDisconnected=function(){return ec(e)},t.onSystemVolumeChanged=function(){var t=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();t&&sc(e,{type:"update",update:{video:{volume:t.level,muted:t.muted}}},e.l),sc(e,{type:"event",targetName:"video",event:{type:"volumechange"}},e.l)},e.u=t.getCastMessageBus("urn:x-cast:com.google.cast.media"),e.u.onMessage=function(t){return function(e,t){var n=bh(t.data);switch(n.type){case"PLAY":e.g.play(),uc(e);break;case"PAUSE":e.g.pause(),uc(e);break;case"SEEK":t=n.currentTime;var i=n.resumeState;null!=t&&(e.g.currentTime=Number(t)),i&&"PLAYBACK_START"==i?(e.g.play(),uc(e)):i&&"PLAYBACK_PAUSE"==i&&(e.g.pause(),uc(e));break;case"STOP":e.h.Wc().then((function(){e.h&&uc(e)}));break;case"GET_STATUS":ac(e,Number(n.requestId));break;case"VOLUME":t=(i=n.volume).level,i=i.muted;var r=e.g.volume,a=e.g.muted;null!=t&&(e.g.volume=Number(t)),null!=i&&(e.g.muted=i),r==e.g.volume&&a==e.g.muted||uc(e);break;case"LOAD":e.m=0,e.D=!1,e.C=!1,t=n.media,i=n.currentTime,r=e.K(t.contentId),a=n.autoplay||!0,e.G(t.customData),a&&(e.g.autoplay=!0),e.h.load(r,i).then((function(){e.h&&ac(e)})).catch((function(t){var i="LOAD_FAILED";7==t.category&&7e3==t.code&&(i="LOAD_CANCELLED"),sc(e,{requestId:Number(n.requestId),type:i},e.u)}));break;default:sc(e,{requestId:Number(n.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},e.u)}}(e,t)},e.l=t.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),e.l.onMessage=function(t){return function(e,t){var n=bh(t.data);switch(n.type){case"init":e.m=0,e.D=!1,e.C=!0,function(e,t,n){var i,r,a,o,s,u,l,h,c,d;L((function(p){switch(p.g){case 1:for(i in t.player)r=t.player[i],e.h[i](r);return e.G(n),a=e.g.autoplay,t.manifest?(e.g.autoplay=!1,S(p,5),_(p,e.h.load(t.manifest,t.startTime),7)):_(p,Promise.resolve(),3);case 7:A(p,3);break;case 5:return o=E(p),s=(new Map).set("detail",o),u=new j("error",s),e.h&&e.h.dispatchEvent(u),p.return();case 3:if(!e.h)return p.return();for(l in t.video)h=t.video[l],e.g[l]=h;for(c in t.playerAfterLoad)d=t.playerAfterLoad[c],e.h[c](d);e.g.autoplay=a,t.manifest&&(e.g.play(),uc(e)),w(p)}}))}(e,n.initState,n.appData),ic(e);break;case"appData":e.G(n.appData);break;case"set":var i=n.targetName,r=n.property;if(n=n.value,"video"==i){if(t=cast.receiver.CastReceiverManager.getInstance(),"volume"==r){t.setSystemVolumeLevel(n);break}if("muted"==r){t.setSystemVolumeMuted(n);break}}e.J[i][r]=n;break;case"call":(i=e.J[n.targetName])[n.methodName].apply(i,n.args);break;case"asyncCall":i=n.targetName,r=n.methodName,"player"==i&&"load"==r&&(e.m=0,e.D=!1);var a=n.id,o=t.senderId;n=(t=e.J[i])[r].apply(t,n.args),"player"==i&&"load"==r&&(n=n.then((function(){e.C=!0}))),n.then((function(){return oc(e,o,a,null)}),(function(t){return oc(e,o,a,t)}))}}(e,t)},t.start();for(var n=(t=l(_h)).next();!n.done;n=t.next())e.j.o(e.g,n.value,(function(t){return nc(e,"video",t)}));for(var i in V)e.j.o(e.h,V[i],(function(t){return nc(e,"player",t)}));cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?e.h.ng(3840,2160):e.h.ng(1920,1080),e.j.o(e.g,"loadeddata",(function(){e.D=!0})),e.j.o(e.h,"loading",(function(){e.s=!1,tc(e)})),e.j.o(e.g,"playing",(function(){e.s=!1,tc(e)})),e.j.o(e.g,"pause",(function(){tc(e)})),e.j.o(e.h,"unloading",(function(){e.s=!0,tc(e)})),e.j.o(e.g,"ended",(function(){new ln((function(){e.g&&e.g.ended&&(e.s=!0,tc(e))})).S(hc)}))}(this)}function ec(e){e.m=0,e.C=!0,e.H=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,tc(e)}function tc(e){var t;L((function(n){return 1==n.g?_(n,Promise.resolve(),2):e.h?(t=new j("caststatuschanged"),e.dispatchEvent(t),rc(e)||uc(e),void w(n)):n.return()}))}function nc(e,t,n){e.h&&(ic(e),sc(e,{type:"event",targetName:t,event:n},e.l))}function ic(e){e.I.S(lc);for(var t={video:{},player:{}},n=l(wh),i=n.next();!i.done;i=n.next())i=i.value,t.video[i]=e.g[i];if(e.h.R())for(var r in Ch)0==e.m%Ch[r]&&(t.player[r]=e.h[r]());for(var a in Ah)0==e.m%Ah[a]&&(t.player[a]=e.h[a]());for(var o in(n=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(t.video.volume=n.level,t.video.muted=n.muted),sc(e,{type:"update",update:t},e.l),Eh)0==e.m%Eh[o]&&((t={player:{}}).player[o]=e.h[o](),sc(e,{type:"update",update:t},e.l));e.D&&(e.m+=1),rc(e)}function rc(e){return!(!e.C||!e.g.duration&&!e.h.R()||(ac(e),e.C=!1,0))}function ac(e,t){var n={contentId:e.h.Gf(),streamType:e.h.R()?"LIVE":"BUFFERED",contentType:""};e.h.R()||(n.duration=e.g.duration),e.i&&(n.metadata=e.i),uc(e,void 0===t?0:t,n)}function oc(e,t,n,i){e.h&&sc(e,{type:"asyncComplete",id:n,error:i},e.l,t)}function sc(e,t,n,i){e.H&&(e=yh(t),i?n.getCastChannel(i).send(e):n.broadcast(e))}function uc(e,t,n){n=void 0===n?null:n;var i={mediaSessionId:0,playbackRate:e.g.playbackRate,playerState:e.s?cc:e.h.yd()?pc:e.g.paused?fc:dc,currentTime:e.g.currentTime,supportedMediaCommands:63,volume:{level:e.g.volume,muted:e.g.muted}};n&&(i.media=n),sc(e,{requestId:void 0===t?0:t,type:"MEDIA_STATUS",status:[i]},e.u)}m(zh,J),(i=zh.prototype).destroy=function(e){return e&&this.g.Jc(),this.m&&(this.m.release(),this.m=null),e=[],this.h&&(e.push(this.h.destroy()),this.h=null),this.g&&(e.push(this.g.destroy()),this.g=null),this.u=this.l=this.i=null,J.prototype.release.call(this),Promise.all(e)},i.cc=function(){return this.l},i.Mc=function(){return this.u},i.kf=function(){return this.g.m&&Gh},i.Ba=function(){return this.g.Ba()},i.Je=function(){return this.g.Je()},i.cast=function(){var e,t=this;return L((function(n){return 1==n.g?(e=Kh(t),_(n,t.g.cast(e),2)):t.h?_(n,t.h.Wc(),0):n.return()}))},i.kg=function(e){this.g.kg(e)},i.vh=function(){!function(e){if(e.h){var t=e.K();chrome.cast.requestSession((function(n){return Lh(e,t,n)}),(function(t){return Dh(e,t)}))}}(this.g)},i.Jc=function(){this.g.Jc()},i.Jg=function(e,t){t=void 0!==t&&t;var n=this;return L((function(i){if(1==i.g)return e==n.G&&t==n.D?i.return():(n.G=e,n.D=t,n.g.Jc(),_(i,n.g.destroy(),2));n.g=null,n.g=new Ph(e,(function(){return Yh(n)}),(function(){return qh(n)}),(function(e,t){return Qh(n,e,t)}),(function(){return Zh(n)}),(function(){return Kh(n)}),t),n.g.init(),w(i)}))},G("shaka.cast.CastProxy",zh),zh.prototype.changeReceiverId=zh.prototype.Jg,zh.prototype.forceDisconnect=zh.prototype.Jc,zh.prototype.suggestDisconnect=zh.prototype.vh,zh.prototype.setAppData=zh.prototype.kg,zh.prototype.cast=zh.prototype.cast,zh.prototype.receiverName=zh.prototype.Je,zh.prototype.isCasting=zh.prototype.Ba,zh.prototype.canCast=zh.prototype.kf,zh.prototype.getPlayer=zh.prototype.Mc,zh.prototype.getVideo=zh.prototype.cc,zh.prototype.destroy=zh.prototype.destroy,m($h,J),(i=$h.prototype).isConnected=function(){return this.H},i.Ji=function(){return this.s},i.rj=function(e){this.i=e},i.Nh=function(){this.i=null},i.sj=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.title=e},i.qj=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.images=[{url:e}]},i.pj=function(e){this.i||(this.i={}),this.i.artist=e,this.i.metadataType=cast.receiver.media.MetadataType.MUSIC_TRACK},i.destroy=function(){var e,t=this;return L((function(n){if(1==n.g)return t.j&&(t.j.release(),t.j=null),e=[],t.h&&(e.push(t.h.destroy()),t.h=null),t.I&&(t.I.stop(),t.I=null),t.g=null,t.J=null,t.G=null,t.H=!1,t.s=!0,t.l=null,t.u=null,J.prototype.release.call(t),_(n,Promise.all(e),2);cast.receiver.CastReceiverManager.getInstance().stop(),w(n)}))},G("shaka.cast.CastReceiver",$h),$h.prototype.destroy=$h.prototype.destroy,$h.prototype.setContentArtist=$h.prototype.pj,$h.prototype.setContentImage=$h.prototype.qj,$h.prototype.setContentTitle=$h.prototype.sj,$h.prototype.clearContentMetadata=$h.prototype.Nh,$h.prototype.setContentMetadata=$h.prototype.rj,$h.prototype.isIdle=$h.prototype.Ji,$h.prototype.isConnected=$h.prototype.isConnected;var lc=.5,hc=5,cc="IDLE",dc="PLAYING",pc="BUFFERING",fc="PAUSED";function gc(e,t,n,i,r){if(i>=r)return null;for(var a=-1,o=-1,s=0;s<n.length;s++)if(n[s].some((function(e){return null!=e&&""!=e.g.trim()}))){a=s;break}for(s=n.length-1;0<=s;s--)if(n[s].some((function(e){return null!=e&&""!=e.g.trim()}))){o=s;break}if(-1===a||-1===o)return null;for(var u=s=!1,l="white",h="black",c=mc(i,r,s,u,l,h);a<=o;a++){for(var d=n[a],p=-1,f=-1,g=0;g<d.length;g++)if(null!=d[g]&&""!==d[g].g.trim()){p=g;break}for(g=d.length-1;0<=g;g--)if(null!=d[g]&&""!==d[g].g.trim()){f=g;break}if(-1===p||-1===f)d=vc(i,r),e.nestedCues.push(d);else{for(;p<=f;p++)if(g=d[p]){var m=g.l,v=g.i,y=g.j,b=g.h;m==s&&v==u&&y==l&&b==h||(c.payload&&e.nestedCues.push(c),c=mc(i,r,m,v,y,b),s=m,u=v,l=y,h=b),c.payload+=g.g}else c.payload+=" ";c.payload&&e.nestedCues.push(c),a!==o&&(c=vc(i,r),e.nestedCues.push(c)),c=mc(i,r,s,u,l,h)}}return e.nestedCues.length?{cue:e,stream:t}:null}function mc(e,t,n,i,r,a){return e=new dt(e,t,""),n&&e.textDecoration.push("underline"),i&&(e.fontStyle="italic"),e.color=r,e.backgroundColor=a,e}function vc(e,t){return(e=new dt(e,t,"")).lineBreak=!0,e}function yc(e,t,n,i,r){this.g=e,this.l=t,this.i=n,this.h=i,this.j=r}function bc(e,t){this.i=[],this.g=1,this.h=0,this.C=e,this.u=t,this.j=this.m=!1,this.l="white",this.s="black",wc(this)}function _c(e,t,n){var i="CC"+(1+(e.C<<1|e.u)),r=new dt(t,n,"");r.lineInterpretation=1;var a=Dc.get(e.g);return a&&(r.line=a),gc(r,i,e.i,t,n)}function wc(e){Ac(e,0,15),e.g=1}function Sc(e,t,n){if(!(32>n||127<n)){var i="";switch(t){case Ec:i=kc.has(n)?kc.get(n):String.fromCharCode(n);break;case Cc:i=Mc.get(n);break;case xc:e.i[e.g].pop(),i=Pc.get(n);break;case Ic:e.i[e.g].pop(),i=Lc.get(n)}i&&e.i[e.g].push(new yc(i,e.m,e.j,e.s,e.l))}}function Tc(e,t,n,i){if(!(0>n||0>t))if(t>=n)for(--i;0<=i;i--)e.i[t+i]=e.i[n+i].map((function(e){return e}));else for(var r=0;r<i;r++)e.i[t+r]=e.i[n+r].map((function(e){return e}))}function Ac(e,t,n){for(var i=0;i<=n;i++)e.i[t+i]=[]}var Ec=0,Cc=1,xc=2,Ic=3,kc=new Map([[39,""],[42,""],[92,""],[92,""],[94,""],[95,""],[96,""],[123,""],[124,""],[125,""],[126,""],[127,""]]),Mc=new Map([[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[54,""],[55,""],[56,""],[57,""],[58,""],[59,""],[60,""],[61,""],[62,""],[63,""]]),Pc=new Map([[32,""],[33,""],[34,""],[35,""],[36,""],[37,""],[38,""],[39,""],[40,"*"],[41,"'"],[42,""],[43,""],[44,""],[45,""],[46,""],[47,""],[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[54,""],[55,""],[56,""],[57,""],[58,""],[59,""],[60,""],[61,""],[62,""],[63,""]]),Lc=new Map([[32,""],[33,""],[34,""],[35,""],[36,""],[37,""],[38,""],[39,""],[40,""],[41,"{"],[42,"}"],[43,"\\"],[44,"^"],[45,"_"],[46,"|"],[47,"~"],[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[54,""],[55,""],[56,""],[57,""],[58,""],[59,""],[60,""],[61,""],[62,""],[63,""]]),Dc=new Map([[1,10],[2,15.33],[3,20.66],[4,26],[5,31.33],[6,36.66],[7,42],[8,47.33],[9,52.66],[10,58],[11,63.33],[12,68.66],[13,74],[14,79.33],[15,84.66]]);function Rc(e,t){this.h=Bc,this.s=new bc(e,t),this.i=new bc(e,t),this.g=this.j=new bc(e,t),this.l=0,this.m=null}function Nc(e,t,n){e.g=e.i;var i=e.g,r=null;return e.h!==Gc&&e.h!==jc&&(r=_c(i,e.l,n),(n=e.i).g=0<n.h?n.h:0,Ac(n,0,15),(n=e.j).g=0<n.h?n.h:0,Ac(n,0,15),i.g=15),e.h=Gc,i.h=t,r}function Oc(e){e.h=Fc,e.g=e.j,e.g.h=0}function Uc(e){K("Cea608DataChannel","CEA-608 text mode entered, but is unsupported"),e.g=e.s,e.h=jc}var Bc=0,Fc=1,Gc=3,jc=4,Hc="black green blue cyan red yellow magenta black".split(" "),Vc="white green blue cyan red yellow magenta white_italics".split(" ");function Wc(e,t){this.K=t,this.N=e,this.L=this.l=!1,this.m=this.s=this.I=this.M=this.J=0,this.H=Qc,this.i=[],this.g=this.h=this.j=0,this.G=this.C=!1,this.D="white",this.u="black",zc(this)}function zc(e){e.i=[];for(var t=0;16>t;t++)e.i.push(Xc())}function Xc(){for(var e=[],t=0;42>t;t++)e.push(null);return e}function Kc(e,t){Yc(e)&&(e.i[e.h][e.g]=new yc(t,e.G,e.C,e.u,e.D),e.g++)}function Yc(e){var t=e.g<e.m&&0<=e.g;return e.h<e.s&&0<=e.h&&t}function qc(e,t,n){var i=new dt(e.j,t,"");i.textAlign=e.H===Zc?"left":e.H===Jc?"right":mt;var r=i.region;switch(e.K&&(r.id+="svc"+e.K),r.id+="win"+e.N,r.height=e.s,r.width=e.m,r.heightUnits=2,r.widthUnits=2,r.viewportAnchorX=e.J,r.viewportAnchorY=e.M,r.viewportAnchorUnits=e.L?Pt:2,e.I){case $c:r.regionAnchorX=0,r.regionAnchorY=0;break;case ed:r.regionAnchorX=50,r.regionAnchorY=0;break;case td:r.regionAnchorX=100,r.regionAnchorY=0;break;case nd:r.regionAnchorX=0,r.regionAnchorY=50;break;case id:r.regionAnchorX=50,r.regionAnchorY=50;break;case rd:r.regionAnchorX=100,r.regionAnchorY=50;break;case ad:r.regionAnchorX=0,r.regionAnchorY=100;break;case od:r.regionAnchorX=50,r.regionAnchorY=100;break;case sd:r.regionAnchorX=100,r.regionAnchorY=100}return(n=gc(i,"svc"+n,e.i,e.j,t))&&(e.j=t),n}Wc.prototype.isVisible=function(){return this.l};var Zc=0,Jc=1,Qc=2,$c=0,ed=1,td=2,nd=3,id=4,rd=5,ad=6,od=7,sd=8;function ud(){this.i=[],this.h=null,this.g=0}function ld(e,t){3===t.type?(e.g=2*(63&t.value)-1,e.h=[]):e.h&&(0<e.g&&(e.h.push(t),e.g--),0===e.g&&(e.i.push(new hd(e.h)),e.h=null,e.g=0))}function hd(e){this.g=0,this.h=e}function cd(e){if(!e.xa())throw new ye(2,2,3e3);return e.h[e.g++]}function dd(e){this.i=e,this.h=[null,null,null,null,null,null,null,null],this.g=null}function pd(e,t,n,i){if(128<=n&&135>=n)i=7&n,e.h[i]&&(e.g=e.h[i]);else{if(136===n){n=cd(t).value,t=null;for(var r=(n=l(fd(e,n))).next();!r.done;r=n.next())(r=e.h[r.value]).isVisible()&&(t=qc(r,i,e.i)),zc(r);return t}if(137===n)for(n=(t=l(fd(e,t=cd(t).value))).next();!n.done;n=t.next())(n=e.h[n.value]).isVisible()||(n.j=i),n.l=!0;else{if(138===n){for(n=cd(t).value,t=null,r=(n=l(fd(e,n))).next();!r.done;r=n.next())(r=e.h[r.value]).isVisible()&&(t=qc(r,i,e.i)),r.l=!1;return t}if(139===n){for(n=cd(t).value,t=null,r=(n=l(fd(e,n))).next();!r.done;r=n.next())(r=e.h[r.value]).isVisible()?t=qc(r,i,e.i):r.j=i,r.l=!r.l;return t}if(140===n)return gd(e,t=cd(t).value,i);if(143===n)return i=gd(e,255,i),md(e),i;if(144===n)t.skip(1),i=cd(t).value,e.g&&(e.g.C=0<(128&i),e.g.G=0<(64&i));else if(145===n)i=cd(t).value,n=cd(t).value,t.skip(1),e.g&&(t=vd((48&n)>>4,(12&n)>>2,3&n),e.g.D=vd((48&i)>>4,(12&i)>>2,3&i),e.g.u=t);else if(146===n)i=cd(t).value,t=cd(t).value,e.g&&((e=e.g).h=15&i,e.g=63&t);else if(151===n)t.skip(1),t.skip(1),i=cd(t).value,t.skip(1),e.g&&(e.g.H=3&i);else if(152<=n&&159>=n){if(n=(15&n)-8,!(r=null!==e.h[n])){var a=new Wc(n,e.i);a.j=i,e.h[n]=a}i=cd(t).value,a=cd(t).value;var o=cd(t).value,s=cd(t).value,u=cd(t).value;t=cd(t).value,r&&0==(7&t)||((t=e.h[n]).h=0,t.g=0,t.G=!1,t.C=!1,t.D="white",t.u="black"),(t=e.h[n]).l=0<(32&i),t.M=127&a,t.J=o,t.I=(240&s)>>4,t.L=0<(128&a),t.s=1+(15&s),t.m=1+(63&u),e.g=e.h[n]}}}return null}function fd(e,t){for(var n=[],i=0;8>i;i++)1==(1&t)&&e.h[i]&&n.push(i),t>>=1;return n}function gd(e,t,n){for(var i=null,r=(t=l(fd(e,t))).next();!r.done;r=t.next()){r=r.value;var a=e.h[r];a.isVisible()&&(i=qc(a,n,e.i)),e.h[r]=null}return i}function md(e){e.g=null,e.h=[null,null,null,null,null,null,null,null]}function vd(e,t,n){var i={0:0,1:0,2:1,3:1};return bd[(e=i[e])<<2|(t=i[t])<<1|(n=i[n])]}hd.prototype.xa=function(){return this.g<this.h.length},hd.prototype.Ga=function(){return this.g},hd.prototype.skip=function(e){if(this.g+e>this.h.length)throw new ye(2,2,3e3);this.g+=e};var yd=new Map([[32," "],[33,""],[37,""],[42,""],[44,""],[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[57,""],[58,""],[60,""],[61,""],[63,""],[118,""],[119,""],[120,""],[121,""],[122,""],[123,""],[124,""],[125,""],[126,""],[127,""]]),bd="black blue green cyan red magenta yellow white".split(" ");function _d(){this.h=[],this.g=[],this.i=new ud,this.l=0,this.m=new Map([["CC1",new Rc(0,0)],["CC2",new Rc(0,1)],["CC3",new Rc(1,0)],["CC4",new Rc(1,1)]]),this.u=this.s=0,this.j=new Map,this.D=!0,this.C=new Set,wd(this)}function wd(e){e.s=0,e.u=0;for(var t=l(e.m.values()),n=t.next();!n.done;n=t.next())(n=n.value).h=Bc,n.g=n.j,n.m=null,wc(n.i),wc(n.j),wc(n.s);e.D=!0}function Sd(e,t){var n=t.type;if(16==(112&t.jb)){var i=t.jb>>3&1;0===n?e.s=i:e.u=i}if(i="CC"+(1+(n<<1|(n?e.u:e.s))),n=e.m.get(i),255===t.jb&&255===t.Jb||!t.jb&&!t.Jb||!Ad(t.jb)||!Ad(t.Jb))return 45<=++e.l&&wd(e),null;if(e.l=0,t.jb&=127,t.Jb&=127,!t.jb&&!t.Jb)return null;if(e.C.add(i),e=null,16==(112&t.jb))e:{if(i=t.jb,e=t.Jb,n.m===(i<<8|e))n.m=null;else if(n.m=i<<8|e,16==(240&i)&&64==(192&e)){t=[11,11,1,2,3,4,12,13,14,15,5,6,7,8,9,10][(7&i)<<1|e>>5&1];var r=(30&e)>>1;i="white";var a=!1;7>r?i=Vc[r]:7===r&&(a=!0),e=1==(1&e),n.h!==jc&&(r=n.g,n.h===Gc&&t!==r.g&&(Tc(r,n=1+t-r.h,1+r.g-r.h,r.h),Ac(r,0,n-1),Ac(r,t+1,15-t)),r.g=t,r.m=e,r.j=a,r.l=i,r.s="black")}else if(17==(247&i)&&32==(240&e))n.g.m=!1,n.g.j=!1,n.g.l="white",Sc(n.g,Ec,32),i=!1,"white_italics"===(t=Vc[(14&e)>>1])&&(t="white",i=!0),n.g.m=1==(1&e),n.g.j=i,n.g.l=t;else if(16==(247&i)&&32==(240&e)||23==(247&i)&&45==(255&e))t="black",0==(7&i)&&(t=Hc[(14&e)>>1]),n.g.s=t;else if(17==(247&i)&&48==(240&e))Sc(n.g,Cc,e);else if(18==(246&i)&&32==(224&e))Sc(n.g,1&i?Ic:xc,e);else if(20==(246&i)&&32==(240&e)){switch(e=t.pts,i=null,t.Jb){case 32:Oc(n);break;case 33:(n=n.g).i[n.g].pop();break;case 37:i=Nc(n,2,e);break;case 38:i=Nc(n,3,e);break;case 39:i=Nc(n,4,e);break;case 40:Sc(n.g,Ec,32);break;case 41:n.h=2,n.g=n.i,n.g.h=0,n.l=e;break;case 42:wc(n.s),Uc(n);break;case 43:Uc(n);break;case 44:t=n.i,i=null,n.h!==jc&&(i=_c(t,n.l,e)),Ac(t,0,15);break;case 45:t=n.g,n.h!==Gc?i=null:(i=_c(t,n.l,e),Tc(t,(a=t.g-t.h+1)-1,a,t.h),Ac(t,0,a-1),Ac(t,t.g,15-t.g),n.l=e);break;case 46:Ac(n.j,0,15);break;case 47:t=null,n.h!==jc&&(t=_c(n.i,n.l,e)),i=n.j,n.j=n.i,n.i=i,Oc(n),n.l=e,i=t}e=i;break e}e=null}else i=t.Jb,Sc(n.g,Ec,t.jb),Sc(n.g,Ec,i);return e}function Td(e,t){var n=[];try{for(;t.xa();){var i=cd(t).value,r=(224&i)>>5,a=31&i;if(7===r&&0!=a&&(r=63&cd(t).value),0!=r){e.C.add("svc"+r),e.j.has(r)||e.j.set(r,new dd(r));for(var o=e.j.get(r),s=t.Ga();t.Ga()-s<a;){var u=cd(r=t),l=u.value,h=u.pts;if(16===l&&(l=l<<16|cd(r).value),0<=l&&31>=l){var c=h;if(o.g){var d=o.g;switch(r=null,l){case 8:!Yc(d)||0>=d.g&&0>=d.h||(0>=d.g?(d.g=d.m-1,d.h--):d.g--,d.i[d.h][d.g]=null);break;case 13:if(d.isVisible()&&(r=qc(d,c,o.i)),d.h+1>=d.s){c=d;for(var p=0,f=1;16>f;f++,p++)c.i[p]=c.i[f];for(f=0;1>f;f++,p++)c.i[p]=Xc()}else d.h++;d.g=0;break;case 14:d.isVisible()&&(r=qc(d,c,o.i)),d.i[d.h]=Xc(),d.g=0;break;case 12:d.isVisible()&&(r=qc(d,c,o.i)),zc(d),(c=d).h=0,c.g=0}var g=r}else g=null}else if(128<=l&&159>=l)g=pd(o,r,l,h);else{if(4096<=l&&4127>=l)8<=(c=255&l)&&15>=c?r.skip(1):16<=c&&23>=c?r.skip(2):24<=c&&31>=c&&r.skip(3);else if(4224<=l&&4255>=l)128<=(c=255&l)&&135>=c?r.skip(4):136<=c&&143>=c&&r.skip(5);else if(32<=l&&127>=l)r=l,o.g&&Kc(o.g,127===r?"":String.fromCharCode(r));else if(160<=l&&255>=l)o.g&&Kc(o.g,String.fromCharCode(l));else if(4128<=l&&4223>=l){if(r=255&l,o.g)if(yd.has(r)){var m=yd.get(r);Kc(o.g,m)}else Kc(o.g,"_")}else 4256<=l&&4351>=l&&o.g&&Kc(o.g,160!=(255&l)?"_":"[CC]");g=null}(r=g)&&n.push(r)}}}}catch(e){if(!(e instanceof ye&&3e3===e.code))throw e;K("CEA708_INVALID_DATA","Buffer read out of bounds / invalid CEA-708 Data.")}return n}function Ad(e){for(var t=0;e;)t^=1&e,e>>=1;return 1===t}function Ed(e){for(var t=[],n=e,i=e=0;i<n.length;)2==e&&3==n[i]?(e=0,(n=[].concat(h(n))).splice(i,1),n=new Uint8Array(n)):0==n[i]?e++:e=0,i++;for(e=n,i=0;i<e.length;){for(n=0;255==e[i];)n+=255,i++;n+=e[i++];for(var r=0;255==e[i];)r+=255,i++;r+=e[i++],4==n&&t.push(e.subarray(i,i+r)),i+=r}return t}function Cd(){this.j=new Map,this.i=this.h=0,this.g=xd}_d.prototype.clear=function(){this.l=0,this.h=[],this.g=[];var e=this.i;e.i=[],e.h=[],e.g=0,wd(this);for(var t=(e=l(this.j.values())).next();!t.done;t=e.next())md(t.value)},_d.prototype.extract=function(e,t){if(this.D){for(var n=l(this.m.values()),i=n.next();!i.done;i=n.next())i.value.l=t;this.D=!1}if(!(8>(e=new tr(e,0)).getLength())&&181===e.ra()&&49===e.Ua()&&1195456820===e.O()&&3===e.ra()&&0!=(64&(n=e.ra())))for(n&=31,e.skip(1),i=0;i<n;i++){var r=e.ra(),a=(4&r)>>2,o=e.ra(),s=e.ra();a&&(0==(r&=3)||1===r?this.h.push({pts:t,type:r,jb:o,Jb:s,order:this.h.length}):(this.g.push({pts:t,type:r,value:o,order:this.g.length}),this.g.push({pts:t,type:2,value:s,order:this.g.length})))}},_d.prototype.decode=function(){function e(e,t){return e.pts-t.pts||e.order-t.order}var t=[];this.h.sort(e),this.g.sort(e);for(var n=l(this.h),i=n.next();!i.done;i=n.next())(i=Sd(this,i.value))&&t.push(i);for(i=(n=l(this.g)).next();!i.done;i=n.next())ld(this.i,i.value);for(i=(n=l(this.i.i)).next();!i.done;i=n.next())i=Td(this,i.value),t.push.apply(t,h(i));return this.i.i=[],this.h=[],this.g=[],t},_d.prototype.getStreams=function(){return Array.from(this.C)},G("shaka.cea.CeaDecoder",_d),st=function(){return new _d},Cd.prototype.init=function(e){function t(e){(e=e.name)in Md&&(n.g=Md[e])}var n=this,i=[],r=[];if((new rr).box("moov",ar).box("mvex",ar).T("trex",(function(e){var t=e.reader;t.skip(4),t.skip(4),e=t.O(),t=t.O(),n.h=e,n.i=t})).box("trak",ar).T("tkhd",(function(e){e=ja(e.reader,e.version),i.push(e.trackId)})).box("mdia",ar).T("mdhd",(function(e){e=Fa(e.reader,e.version),r.push(e.timescale)})).box("minf",ar).box("stbl",ar).T("stsd",or).box("avc1",t).box("avc3",t).box("hev1",t).box("hvc1",t).box("dvh1",t).box("dvhe",t).box("encv",sr).box("sinf",ar).box("frma",(function(e){(e=Va(e.reader).wa)in Md&&(n.g=Md[e])})).parse(e,!0),!i.length||!r.length||i.length!=r.length)throw new ye(2,2,2010);this.g==xd&&X("Unable to determine bitstream format for CEA parsing!"),i.forEach((function(e,t){n.j.set(e,r[t])}))},Cd.prototype.parse=function(e){var t=this;if(this.g==xd)return[];var n=[],i=this.h,r=this.i,a=0,o=[],s=null,u=9e4;return(new rr).box("moof",(function(e){a=e.start,o=[],ar(e)})).box("traf",ar).T("trun",(function(e){e=Ga(e.reader,e.version,e.flags),o.push(e)})).T("tfhd",(function(e){e=Ua(e.reader,e.flags),i=e.Og||t.h,r=e.Qh||t.i,e=e.trackId,t.j.has(e)&&(u=t.j.get(e))})).T("tfdt",(function(e){s=Ba(e.reader,e.version).baseMediaDecodeTime})).box("mdat",(function(e){if(null===s)throw X("Unable to find base media decode time for CEA captions!"),new ye(2,2,2010);!function(e,t,n,i,r,a,o,s,u){var c=0,d=a,p=s.map((function(e){return e.lh}));for((p=[].concat.apply([],h(p))).length&&(d=p[0].sampleSize||a),t.skip(o+s[0].Ph);t.xa();){o=t.O();var f=t.ra(),g=null;switch(g=!1,s=1,e.g){case Id:g=6==(g=31&f);break;case kd:s=2,t.skip(1),g=39==(g=f>>1&63)||40==g;break;default:return}if(g)for(f=0,c<p.length&&(f=p[c].Ke||0),f=(n+f)/i,g=(s=l(Ed(t.Qb(o-s)))).next();!g.done;g=s.next())u.push({packet:g.value,pts:f});else try{t.skip(o-s)}catch(e){break}0==(d-=o+4)&&(n=c<p.length?n+(p[c].gg||r):n+r,d=++c<p.length&&p[c].sampleSize||a)}}(t,e.reader,s,u,i,r,a-e.start-8,o,n)})).parse(e,!1),n},G("shaka.cea.Mp4CeaParser",Cd);var xd=0,Id=1,kd=2,Md={avc1:Id,avc3:Id,hev1:kd,hvc1:kd,dvh1:kd,dvhe:kd};function Pd(){}function Ld(t,n,i){var r=function(e){for(var t=[],n=(e=l(e)).next();!n.done;n=e.next())(n=Rd(n.value))&&t.push(n);return t}(t),a=null;t=[];var o=[],s=null,u=new Set(r.map((function(e){return e.keyId})));if(u.delete(null),1<u.size)throw new ye(2,4,4010);if(!n){if(o=r.filter((function(e){return"urn:mpeg:dash:sea:2012"==e.Jd})),1<o.length)throw new ye(2,4,4050);o.length&&(s=function(t){if(!e.crypto||!e.crypto.subtle)throw X("Web Crypto API is not available to decrypt AES-128. (Web Crypto only exists in secure origins like https)"),new ye(2,4,4042);var n=Ar(t.node,"urn:mpeg:dash:schema:sea:2012","SegmentEncryption");if(!n)throw new ye(2,4,4051);if("urn:mpeg:dash:sea:aes128-cbc:2013"!=n.getAttribute("schemeIdUri"))throw new ye(2,4,4051);if(!(n=Ar(t.node,"urn:mpeg:dash:schema:sea:2012","CryptoPeriod")))throw new ye(2,4,4051);if(t=n.getAttribute("IV"),n=n.getAttribute("keyUriTemplate"),!t||!n)throw new ye(2,4,4051);if(16!=(t=yr(t.substr(2))).byteLength)throw new ye(2,4,4048);return{Qi:n,iv:t}}(o[0])),o=r.filter((function(e){return"urn:mpeg:dash:mp4protection:2011"==e.Jd?(a=e.init||a,!1):"urn:mpeg:dash:sea:2012"!=e.Jd})),o.length&&(t=function(e,t,n,i){for(var r=[],a=(t=l(t)).next();!a.done;a=t.next()){var o=n[(a=a.value).Jd];if(o){var s;if(s=Ar(a.node,"urn:microsoft:playready","pro")){s=vr(s.textContent);var u=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);s=[{initData:Sr(s,u,new Set,0),initDataType:"cenc",keyId:a.keyId}]}else s=null;if(u=null,"urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e"===a.Jd)if(0==(u=i).size)u=null;else{var h=new Uint8Array([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75]);u=[{initData:Sr(new Uint8Array([]),h,u,1),initDataType:"cenc",keyId:a.keyId}]}s=we(o,a.init||e||s||u),(o=Od.get(o))&&(s.licenseServerUri=o(a)),r.push(s)}}return r}(a,o,i,u),0==t.length&&(t=[we("",a)]))}if(r.length&&!s&&(n||!o.length))for(t=[],i=(n=l(Object.values(i))).next();!i.done;i=n.next())"org.w3.clearkey"!=(i=i.value)&&t.push(we(i,a));if(u=Array.from(u)[0]||null)for(i=(n=l(t)).next();!i.done;i=n.next())for(r=(i=l(i.value.initData)).next();!r.done;r=i.next())r.value.keyId=u;return{Ng:u,xk:a,drmInfos:t,gf:s,Rg:!0}}function Dd(e){var t=Ar(e.node,"https://dashif.org/CPS","Laurl");return t&&t.textContent?t.textContent:(e=Ar(e.node,"urn:microsoft:playready","pro"))?(e=function(e){var t=0,n=nt(e),i=n.getUint32(t,!0);if(i!=e.byteLength)return[];e:{for(e=t+6,t=[];e<n.byteLength-1;){i=n.getUint16(e,!0),e+=2;var r=n.getUint16(e,!0);if(e+=2,0!=(1&r)||r+e>n.byteLength){n=[];break e}var a=et(n,e,r);t.push({type:i,value:a}),e+=r}n=t}return n}(e=vr(e.textContent)).filter((function(e){return e.type===Nd}))[0],e&&(e=jr(e=Zi(e.value,!0),"WRMHEADER"))?function(e){for(var t=(e=l(e.getElementsByTagName("DATA"))).next();!t.done;t=e.next())for(var n=(t=l(t.value.childNodes)).next();!n.done;n=t.next())if((n=n.value)instanceof Element&&"LA_URL"==n.tagName)return n.textContent;return""}(e):""):""}function Rd(e){var t=e.getAttribute("schemeIdUri"),n=xr(e,"urn:mpeg:cenc:2013","default_KID"),i=Cr(e,"urn:mpeg:cenc:2013","pssh").map(kr);if(!t)return null;if(t=t.toLowerCase(),n&&(n=n.replace(/-/g,"").toLowerCase()).includes(" "))throw new ye(2,4,4009);var r=[];try{r=i.map((function(e){return{initDataType:"cenc",initData:vr(e),keyId:null}}))}catch(e){throw new ye(2,4,4007)}return{node:e,Jd:t,keyId:n,init:0<r.length?r:null}}ot["video/mp4"]=function(){return new Cd},Pd.prototype.init=function(){},Pd.prototype.parse=function(e){var t=[];if(!ro(e=et(e)))return t;var n=(e=(new no).parse(e)).sd(),i=e.le();switch(e=[],n.video){case"avc":e.push(6);break;case"hvc":e.push(39),e.push(40)}if(!e.length)return t;for(i=(n=l(i)).next();!i.done;i=n.next())if(i=i.value,e.includes(i.type)&&null!=i.time)for(var r=l(Ed(i.data)),a=r.next();!a.done;a=r.next())t.push({packet:a.value,pts:i.time});return t},G("shaka.cea.TsCeaParser",Pd),ot["video/mp2t"]=function(){return new Pd};var Nd=1,Od=(new Map).set("com.widevine.alpha",(function(e){var t=Ar(e.node,"https://dashif.org/CPS","Laurl");return t&&t.textContent?t.textContent:(e=Ar(e.node,"urn:microsoft","laurl"))&&e.getAttribute("licenseUrl")||""})).set("com.microsoft.playready",Dd).set("com.microsoft.playready.recommendation",Dd).set("com.microsoft.playready.software",Dd).set("com.microsoft.playready.hardware",Dd).set("org.w3.clearkey",(function(e){var t=Ar(e.node,"https://dashif.org/CPS","Laurl");return t&&t.textContent?t.textContent:(e=Ar(e.node,"http://dashif.org/guidelines/clearKey","Laurl"))&&"EME-1.0"===e.getAttribute("Lic_type")&&e.textContent?e.textContent:""}));function Ud(t,n,i,r,a,o){var s={RepresentationID:n,Number:i,SubNumber:r,Bandwidth:a,Time:o};return t.replace(/\$(RepresentationID|Number|SubNumber|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,(function(t,n,i,r){if("$$"==t)return"$";var a=s[n];if(null==a)return t;switch("RepresentationID"==n&&i&&(i=void 0),"Time"==n&&"bigint"!=typeof a&&(.2<=Math.abs(a-Math.round(a))&&X("Calculated $Time$ values must be close to integers"),a=Math.round(a)),r){case void 0:case"d":case"i":case"u":t=a.toString();break;case"o":t=a.toString(8);break;case"x":t=a.toString(16);break;case"X":t=a.toString(16).toUpperCase();break;default:t=a.toString()}return i=e.parseInt(i,10)||1,Array(Math.max(0,i-t.length)+1).join("0")+t}))}function Bd(e,t){var n=Gd(e,t,"timescale"),i=1;n&&(i=Or(n)||1);var r=Gd(e,t,"duration");n=Or(r||""),"image"==e.P.contentType&&(n=Br(r||"")),n&&(n/=i);var a=Gd(e,t,"startNumber");r=Number(Gd(e,t,"presentationTimeOffset"))||0;var o=Ur(a||"");null!=a&&null!=o||(o=1);var s=jd(e,t,"SegmentTimeline");if(t=null,s){t=i,e=e.ma.duration||1/0,a=o,s=Er(s,"S");for(var u=[],l=-r,h=0;h<s.length;++h){var c=s[h],d=s[h+1],p=Pr(c,"t",Ur),f=Pr(c,"d",Ur),g=Pr(c,"r",Nr);if(c=Pr(c,"k",Nr)||0,null!=p&&(p-=r),!f)break;if(p=null!=p?p:l,0>(g=g||0))if(d){if(null==(d=Pr(d,"t",Ur)))break;if(p>=d)break;g=Math.ceil((d-p)/f)-1}else{if(1/0==e)break;if(p/t>=e)break;g=Math.ceil((e*t-p)/f)-1}for(0<u.length&&p!=l&&(u[u.length-1].end=p/t),d=0;d<=g;++d)l=p+f,u.push({start:p/t,end:l/t,zg:p,Bb:c,nj:u.length+a}),p=l}t=u}return{timescale:i,Pa:n,Nd:o,Rb:r/i||0,yg:r,timeline:t}}function Fd(e,t){return[t(e.P),t(e.Ea),t(e.Ka)].filter(an)}function Gd(e,t,n){t=Fd(e,t),e=null;for(var i=(t=l(t)).next();!i.done&&!(e=i.value.getAttribute(n));i=t.next());return e}function jd(e,t,n){t=Fd(e,t),e=null;for(var i=(t=l(t)).next();!i.done&&!(e=Tr(i.value,n));i=t.next());return e}function Hd(e,t,n,i,r,a){if(a=void 0===a?0:a,xr(e,"http://www.w3.org/1999/xlink","href")){var o=function(e,t,n,i,r,a){for(var o=xr(e,"http://www.w3.org/1999/xlink","href"),s=xr(e,"http://www.w3.org/1999/xlink","actuate")||"onRequest",u=l(Array.from(e.attributes)),h=u.next();!h.done;h=u.next())"http://www.w3.org/1999/xlink"==(h=h.value).namespaceURI&&e.removeAttributeNS(h.namespaceURI,h.localName);if(5<=a)return Ti(new ye(2,4,4028));if("onLoad"!=s)return Ti(new ye(2,4,4027));var c=_e([i],[o]);return r.request(0,Li(c,t)).Fa((function(i){if(!(i=Hr(i.data,e.tagName)))return Ti(new ye(2,4,4001,o));for(;e.childNodes.length;)e.removeChild(e.childNodes[0]);for(;i.childNodes.length;){var s=i.childNodes[0];i.removeChild(s),e.appendChild(s)}for(s=(i=l(Array.from(i.attributes))).next();!s.done;s=i.next())e.setAttributeNode(s.value.cloneNode(!1));return Hd(e,t,n,c[0],r,a+1)}))}(e,t,n,i,r,a);return n&&(o=o.Fa(void 0,(function(){return Hd(e,t,n,i,r,a)}))),o}o=[];for(var s=l(Array.from(e.childNodes)),u=s.next();!u.done;u=s.next())(u=u.value)instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==xr(u,"http://www.w3.org/1999/xlink","href")?e.removeChild(u):"SegmentTimeline"!=u.tagName&&o.push(Hd(u,t,n,i,r,a)));return xi(o).Fa((function(){return e}))}function Vd(e){this.h=nt(e),this.g=new tr(this.h,0)}function Wd(e){var t=zd(e);if(7<t.length)throw new ye(2,3,3002);for(var n=0,i=(t=l(t)).next();!i.done;i=t.next())n=256*n+i.value;t=zd(e);e:{for(var r=(i=l(Xd)).next();!r.done;r=i.next())if(Je(t,new Uint8Array(r.value))){i=!0;break e}i=!1}if(i)t=e.h.byteLength-e.g.Ga();else{if(8==t.length&&224&t[1])throw new ye(2,3,3001);for(r=i=0;r<t.length;r++){var a=t[r];i=0==r?a&(1<<8-t.length)-1:256*i+a}t=i}return t=e.g.Ga()+t<=e.h.byteLength?t:e.h.byteLength-e.g.Ga(),i=nt(e.h,e.g.Ga(),t),e.g.skip(t),new Kd(n,i)}function zd(e){var t=e.g.Ga(),n=e.g.ra();if(0==n)throw new ye(2,3,3002);return n=8-Math.floor(Math.log2(n)),e.g.skip(n-1),et(e.h,t,n)}Vd.prototype.xa=function(){return this.g.xa()};var Xd=[[255],[127,255],[63,255,255],[31,255,255,255],[15,255,255,255,255],[7,255,255,255,255,255],[3,255,255,255,255,255,255],[1,255,255,255,255,255,255,255]];function Kd(e,t){this.id=e,this.g=t}function Yd(e){if(8<e.g.byteLength)throw new ye(2,3,3002);if(8==e.g.byteLength&&224&e.g.getUint8(0))throw new ye(2,3,3001);for(var t=0,n=0;n<e.g.byteLength;n++)t=256*t+e.g.getUint8(n);return t}function qd(e){var t=new Vd(e.g);if(179!=(e=Wd(t)).id)throw new ye(2,3,3013);if(e=Yd(e),183!=(t=Wd(t)).id)throw new ye(2,3,3012);t=new Vd(t.g);for(var n=0;t.xa();){var i=Wd(t);if(241==i.id){n=Yd(i);break}}return{wj:e,cj:n}}function Zd(e,t,n){if(!(t=jd(e,t,"Initialization")))return null;var i=e.P.zb(),r=t.getAttribute("sourceURL");r&&(i=_e(i,[r])),r=0;var a=null;return(t=Pr(t,"range",Rr))&&(r=t.start,a=t.end),new wa((function(){return i}),r,a,tp(e),null,null,n)}function Jd(e,t,n,i,r,a,o){var s,u,l,h,c,d,p,f,g,m,v,y,b,w,S;return L((function(T){if(1==T.g)return s=e.presentationTimeline,u=!e.Wb||!e.ma.Mf,l=e.ma.start,h=e.ma.duration,c=e.P.mimeType.split("/")[1],p=null,f=[(d=t)(i,r,a,!1),"webm"==c?d(n.ba(),n.hb,n.Na,!0):null],d=null,_(T,Promise.all(f),2);if(g=T.h,m=g[0],v=g[1]||null,b=l-o,w=l,S=h?l+h:1/0,"mp4"==c)var A=function(e,t,n,i,r,a,o){var s,u=(new rr).T("sidx",(function(e){s=function(e,t,n,i,r,a,o){var s=[];o.reader.skip(4);var u=o.reader.O();if(0==u)throw new ye(2,3,3005);if(0==o.version)var l=o.reader.O(),h=o.reader.O();else l=o.reader.Uc(),h=o.reader.Uc();o.reader.skip(2);var c=o.reader.Ua();for(e=e+o.size+h,h=0;h<c;h++){var d=o.reader.O(),p=(2147483648&d)>>>31;d&=2147483647;var f=o.reader.O();if(o.reader.skip(4),1==p)throw new ye(2,3,3006);s.push(new Ta(l/u+n,(l+f)/u+n,(function(){return a}),e,e+d-1,t,n,i,r)),l+=f,e+=d}return o.parser.stop(),s}(t,i,r,a,o,n,e)}));if(e&&u.parse(e),s)return s;throw new ye(2,3,3004)}(m,r,i,n,b,w,S);else{if(440786851!=Wd(A=new Vd(v)).id)throw new ye(2,3,3008);var E=Wd(A);if(408125543!=E.id)throw new ye(2,3,3009);A=E.g.byteOffset,E=new Vd(E.g);for(var C=null;E.xa();){var x=Wd(E);if(357149030==x.id){C=x;break}}if(!C)throw new ye(2,3,3010);for(C=new Vd(C.g),x=1e6,E=null;C.xa();){var I=Wd(C);if(2807729==I.id)x=Yd(I);else if(17545==I.id)if(4==I.g.byteLength)E=I.g.getFloat32(0);else{if(8!=I.g.byteLength)throw new ye(2,3,3003);E=I.g.getFloat64(0)}}if(null==E)throw new ye(2,3,3011);if(E*=C=x/1e9,475249515!=(x=Wd(new Vd(m))).id)throw new ye(2,3,3007);A=function(e,t,n,i,r,a,o,s,u){function l(){return r}var h=[];e=new Vd(e.g);for(var c=null,d=null;e.xa();){var p=Wd(e);if(187==p.id){var f=qd(p);f&&(p=n*f.wj,f=t+f.cj,null!=c&&h.push(new Ta(c+o,p+o,l,d,f-1,a,o,s,u)),c=p,d=f)}}return null!=c&&h.push(new Ta(c+o,i+o,l,d,null,a,o,s,u)),h}(x,A,C,E,i,n,b,w,S)}return y=A,s.Dd(y),p=new rs(y),u&&p.Ic(w,S,!0),T.return(p)}))}function Qd(e){return e.Ld}function $d(e){var t=jd(e,Qd,"RepresentationIndex");return e=Rr((e=Gd(e,Qd,"indexRange"))||""),t&&(e=Pr(t,"range",Rr,e)),e}function ep(e,t){var n=e.P.mimeType.split("/")[1];if(e.P.contentType!=Ae&&"mp4"!=n&&"webm"!=n)throw new ye(2,4,4006);if("webm"==n&&!t)throw new ye(2,4,4005)}function tp(e){var t=e.P;return{bandwidth:e.bandwidth,audioSamplingRate:t.audioSamplingRate,codecs:t.codecs,contentType:t.contentType,frameRate:t.frameRate||null,height:t.height||null,mimeType:t.mimeType,channelsCount:t.De,pixelAspectRatio:t.pixelAspectRatio||null,width:t.width||null}}function np(e){return e.fc}function ip(e){return e.Md}function rp(e,t,n,i,r,a,o,s,u,l){rs.call(this,[]),this.h=e,this.H=t,this.D=n,this.G=i,this.i=r,this.l=a,this.u=o,this.C=u,this.I=l,s&&op(this)}function ap(e,t,n,i,r,a){if(e.u=a,e.h){n=e.h.timeline,e.h.Sc=t.Sc;var o=n[n.length-1];0<(t=t.timeline.filter((function(e){return e.start>=o.end}))).length&&e.h.timeline.push.apply(e.h.timeline,h(t)),e.l!==i&&(e.l=i)}else e.h=t,e.i=n,e.l=i;r&&op(e)}function op(e){if(!e.s){for(var t=e.h.timeline;t.length&&t[t.length-1].start>=e.l;)t.pop();e.yb(e.i)}}function sp(e,t,n,i,r,a,o){return e=Ud(e,t,n,a,i||null,r),_e(o(),[e]).map((function(e){return e.toString()}))}function up(e){this.s=null,this.C=e,this.I=new Ii,this.j=[],this.h=null,this.m=[],this.D=null,this.H=[],this.G=300,this.l=new Map,this.i=new Map,this.g=null,this.u="UNKNOWN"}function lp(e,t){var n,i,r,a,o,s,u;return L((function(l){return 1==l.g?(n=_e(e.j,[hp(e,t)]),i=Li(n,e.s.retryParameters),r=e.C.networkingEngine.request(8,i),ki(e.I,r),S(l,2),_(l,r.promise,4)):2!=l.g?(a=l.h,o=qi(a.data),1==(s=JSON.parse(o)).VERSION&&function(e,t,n){null!=e.g&&(e.g.stop(),e.g=null);var i=t["RELOAD-URI"]||n;e.g=new ln((function(){lp(e,i)})),(n=t.TTL)&&(e.G=n),e.g.S(e.G),e.m=t["PATHWAY-PRIORITY"]||[],e.H=t["PATHWAY-CLONES"]||[]}(e,s,a.uri),A(l,0)):(u=E(l))&&7001==u.code?l.return():(null!=e.g&&(e.g.stop(),e.g=null),e.g=new ln((function(){lp(e,t)})),e.g.S(e.G),void w(l))}))}function hp(e,t){if(!e.m.length)return t;t=new ne(t);var n=e.D||e.m[0],i=Math.round(e.C.getBandwidthEstimate()),r=t.g;return"DASH"==e.u?(r.add("_DASH_pathway",n),r.add("_DASH_throughput",String(i))):"HLS"==e.u&&(r.add("_HLS_pathway",n),r.add("_HLS_throughput",String(i))),ve(r)&&oe(t,r),t.toString()}function cp(e,t,n,i){var r=e.l.get(t);r||(r=new Map),r.set(n,i),e.l.set(t,r)}function dp(e,t,n){n=void 0!==n&&n,t=e.l.get(t)||new Map;for(var i=[],r={},a=l(e.m),o=a.next();!o.done;r={lc:r.lc},o=a.next())if(r.lc=o.value,o=t.get(r.lc))i.push({cg:r.lc,location:o});else if(o=e.H.find(function(e){return function(t){return t.Nj==e.lc}}(r))){var s=t.get(o["BASE-ID"]);s&&(o["URI-REPLACEMENT"].Dh?(re(s=new ne(s),o["URI-REPLACEMENT"].Dh),i.push({cg:r.lc,location:s.toString()})):i.push({cg:r.lc,location:s}))}for(r=Date.now(),o=(a=l(e.i.keys())).next();!o.done;o=a.next())o=o.value,r>(s=e.i.get(o))&&e.i.delete(o);if(i=i.filter((function(t){for(var n=l(e.i.keys()),i=n.next();!i.done;i=n.next())if(i.value.includes(new ne(t.location).Kb))return!1;return!0})),i.length&&(e.D=i[0].cg),i=i.map((function(e){return e.location})),!i.length&&e.h)for(o=(r=l(e.h.split(","))).next();!o.done;o=r.next())(a=t.get(o.value))&&(e.D=e.h,i.push(a));if(!i.length)for(r=(t=l(t.values())).next();!r.done;r=t.next())i.push(r.value);return n?i:_e(e.j,i)}function pp(){this.j=[],this.h=[],this.g=[],this.l=[],this.i=[],this.m=!1,this.s=new Set}function fp(e,t){for(var n=[],i=[],r=[],a=[],o=(e=l(e)).next();!o.done;o=e.next()){var s=o.value;o=new Map(s.audioStreams.map((function(e){return[Gp(e),e]})));var u=new Map(s.videoStreams.map((function(e){return[Fp(e),e]}))),h=new Map(s.textStreams.map((function(e){return[jp(e),e]})));if(s=new Map(s.imageStreams.map((function(e){return[Hp(e),e]}))),t){var c=Np(Ae);h.set(jp(c),c),c=Np("image"),s.set(Hp(c),c)}n.push(o),i.push(u),r.push(h),a.push(s)}return{Fg:n,Ah:i,wh:r,Yg:a}}function gp(e){var t,n,i,r,a,o,s,u,h,c,d,p,f,g,m,v,y,b,w,S,T,A,E,C,x,I,k,M,P;return L((function(L){switch(L.g){case 1:if(t=Ee,1==e.length)return L.return(e[0]);for(n=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.U})).map((function(e){return[Gp(e),e]})))})),i=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.ia})).map((function(e){return[Fp(e),e]})))})),r=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.Da})).map((function(e){return[jp(e),e]})))})),a=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.cf})).map((function(e){return[Hp(e),e]})))})),o=l(r),s=o.next();!s.done;s=o.next())u=s.value,h=Rp(t.Da),u.set(jp(h),h);for(c=l(a),d=c.next();!d.done;d=c.next())p=d.value,f=Rp(t.cf),p.set(Hp(f),f);return _(L,mp(g=new pp,[],n,0,wp,Tp),2);case 2:return m=L.h,_(L,mp(g,[],i,0,wp,Tp),3);case 3:return v=L.h,_(L,mp(g,[],r,0,wp,Tp),4);case 4:return y=L.h,_(L,mp(g,[],a,0,wp,Tp),5);case 5:if(b=L.h,w=0,v.length&&m.length)for(E=l(m),C=E.next();!C.done;C=E.next())for(x=C.value,I=l(v),k=I.next();!k.done;k=I.next())M=k.value,P=w++,M.variantIds.push(P),x.variantIds.push(P);else for(S=v.concat(m),T=l(S),A=T.next();!A.done;A=T.next())A.value.variantIds=[w++];return L.return(v.concat(m).concat(y).concat(b))}}))}function mp(e,t,n,i,r,a){var o,s,u,h,c,d,p,f,g,m,v,y,b,w,S,T,A;return L((function(E){switch(E.g){case 1:for(o=[],s=0;s<i;s++)o.push(new Set);for(u=i;u<n.length;u++)o.push(new Set(n[u].values()));h=l(t),c=h.next();case 2:if(c.done){E.F(4);break}return d=c.value,_(E,function(e,t,n,i,r,a){return L((function(o){return 1==o.g?(Ap(e,n,t),t.matchedStreams?t.segmentIndex?_(o,vp(t,i),2):o.F(2):o.return(!1)):(bp(t,i,r,a),o.return(!0))}))}(e,d,n,i,a,o),5);case 5:if(!E.h)throw new ye(2,4,4037);c=h.next(),E.F(2);break;case 4:for(p=l(o),f=p.next();!f.done;f=p.next())for(g=f.value,m=l(g),v=m.next();!v.done;v=m.next())y=v.value,(b=yp(e,y,n,r,a,o))&&t.push(b);for(w=l(o),f=w.next();!f.done;f=w.next())for(S=f.value,T={},A=l(S),v=A.next();!v.done;T={Wd:T.Wd},v=A.next())if(T.Wd=v.value,!Bp(T.Wd)&&t.some(function(t){return function(n){return xp(e,t.Wd,n)}}(T)))throw new ye(2,4,4037);return E.return(t)}}))}function vp(e,t){var n,i,r,a,o,s,u;return L((function(h){if(1==h.g){for(n=[],i=e.matchedStreams,r=l(i),a=r.next();!a.done;a=r.next())o=a.value,n.push(o.createSegmentIndex()),o.trickModeVideo&&!o.trickModeVideo.segmentIndex&&n.push(o.trickModeVideo.createSegmentIndex());return _(h,Promise.all(n),2)}if(e.segmentIndex instanceof us)for(s={},u=t;u<i.length;s={Gb:s.Gb},u++)s.Gb=i[u],s.Gb.segmentIndex&&(as(s.Gb.segmentIndex,function(e){return function(t){t.codecs=e.Gb.codecs,t.mimeType=e.Gb.mimeType,t.ka&&(t.ka.codecs=e.Gb.codecs,t.ka.mimeType=e.Gb.mimeType)}}(s)),e.segmentIndex.h.push(s.Gb.segmentIndex));w(h)}))}function yp(e,t,n,i,r,a){if(Bp(t))return null;var o=i(t);return Ap(e,n,o),o.createSegmentIndex&&(o.createSegmentIndex=function(){return L((function(e){return o.segmentIndex?e.F(0):(o.segmentIndex=new us,_(e,vp(o,0),0))}))}),o.matchedStreams&&o.matchedStreams.length?(bp(o,0,r,a),o):null}function bp(e,t,n,i){for(var r=e.matchedStreams;t<r.length;t++){var a=r[t];n(e,a);var o=!0;if("audio"==e.type&&0==De(e.language,a.language)&&(o=!1),o){i[t].delete(a),o=new Set(e.codecs.split(","));for(var s=(a=l(a.codecs.split(","))).next();!s.done;s=a.next())(s=s.value)&&o.add(s);s=Array.from(o),o=new Set,a=[];for(var u=(s=l(s)).next();!u.done;u=s.next()){var h=Xt(u=u.value);o.has(h)||(a.push(u),o.add(h))}e.codecs=a.join(",")}}}function _p(e){var t=Object.assign({},e);return t.originalId=null,t.createSegmentIndex=function(){return Promise.resolve()},t.closeSegmentIndex=function(){if(t.segmentIndex&&(t.segmentIndex.release(),t.segmentIndex=null),t.matchedStreams)for(var e=l(t.matchedStreams),n=e.next();!n.done;n=e.next())(n=n.value).segmentIndex&&(n.segmentIndex.release(),n.segmentIndex=null)},t.roles=t.roles.slice(),t.segmentIndex=null,t.emsgSchemeIdUris=[],t.keyIds=new Set,t.closedCaptions=null,t.trickModeVideo=null,t}function wp(e){return(e=Object.assign({},e)).roles=e.roles.slice(),e.keyIds=new Set,e.segments=[],e.variantIds=[],e.closedCaptions=null,e}function Sp(e,t){function n(e,t){e||(e=[]);for(var n=(t=l(t)).next();!n.done;n=t.next())n=n.value,e.includes(n)||e.push(n);return e}e.roles=n(e.roles,t.roles),t.emsgSchemeIdUris&&(e.emsgSchemeIdUris=n(e.emsgSchemeIdUris,t.emsgSchemeIdUris));for(var i=l(t.keyIds),r=i.next();!r.done;r=i.next())e.keyIds.add(r.value);if(null==e.originalId?e.originalId=t.originalId:e.originalId+=","+(t.originalId||""),i=oa(e.drmInfos,t.drmInfos),t.drmInfos.length&&e.drmInfos.length&&!i.length)throw new ye(2,4,4038);if(e.drmInfos=i,e.encrypted=e.encrypted||t.encrypted,t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),r=(i=l(t.closedCaptions)).next();!r.done;r=i.next()){var a=l(r.value);r=a.next().value,a=a.next().value,e.closedCaptions.set(r,a)}t.trickModeVideo?(e.trickModeVideo||(e.trickModeVideo=_p(t.trickModeVideo),e.trickModeVideo.createSegmentIndex=function(){return e.trickModeVideo.segmentIndex=e.segmentIndex.clone(),Promise.resolve()}),Sp(e.trickModeVideo,t.trickModeVideo)):e.trickModeVideo&&Sp(e.trickModeVideo,t)}function Tp(e,t){var n=e.roles;n||(n=[]);for(var i=l(t.roles),r=i.next();!r.done;r=i.next())r=r.value,n.includes(r)||n.push(r);for(e.roles=n,i=(n=l(t.keyIds)).next();!i.done;i=n.next())e.keyIds.add(i.value);if(e.encrypted=e.encrypted&&t.encrypted,e.segments.push.apply(e.segments,h(t.segments)),t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),n=(t=l(t.closedCaptions)).next();!n.done;n=t.next())n=(i=l(n.value)).next().value,i=i.next().value,e.closedCaptions.set(n,i)}function Ap(e,t,n){for(var i=[],r=(t=l(t)).next();!r.done;r=t.next()){if(!(r=Ep(e,r.value,n)))return;i.push(r)}n.matchedStreams=i}function Ep(e,t,n){var i=null,r=(0,{audio:Gp,video:Fp,text:jp,image:Hp}[n.type])(n);if(t.has(r))i=t.get(r);else{r={audio:function(t,n){return xp(e,t,n)},video:function(t,n){return xp(e,t,n)},text:Ip,image:kp}[n.type];for(var a={audio:Mp,video:Pp,text:Lp,image:Dp}[n.type],o=(t=l(t.values())).next();!o.done;o=t.next())!r(n,o=o.value)||n.fastSwitching!=o.fastSwitching||i&&!a(n,i,o)||(i=o)}return i}function Cp(e,t){function n(e){if(!Xp.has(e)){var t=zt(e);Xp.set(e,t)}return Xp.get(e)}return e.mimeType==t.mimeType&&n(e.codecs)==n(t.codecs)}function xp(e,t,n){return!(!Cp(t,n)&&!e.m||t.drmInfos&&!aa(t.drmInfos,n.drmInfos))}function Ip(e,t){return!t.language||e.forced===t.forced&&0!=De(e.language,t.language)&&t.kind==e.kind}function kp(){return!0}function Mp(e,t,n){var i=Cp(e,t),r=Cp(e,n);if(i&&!r)return!1;if(!i&&r)return!0;if(i=De(e.language,t.language),(r=De(e.language,n.language))>i)return!0;if(r<i)return!1;if(t.label!==n.label){if(e.label===t.label)return!1;if(e.label===n.label)return!0}return e.roles.length?(i=t.roles.filter((function(t){return e.roles.includes(t)})),(r=n.roles.filter((function(t){return e.roles.includes(t)}))).length>i.length||!(r.length<i.length)&&n.roles.length<t.roles.length):!((n.roles.length||!t.roles.length)&&(n.roles.length&&!t.roles.length||(t.primary||!n.primary)&&(t.primary&&!n.primary||(i=Op(e.channelsCount,t.channelsCount,n.channelsCount))!=Vp&&(i==zp||(i=Op(e.audioSamplingRate,t.audioSamplingRate,n.audioSamplingRate))!=Vp&&(i==zp||!e.bandwidth||Up(e.bandwidth,t.bandwidth,n.bandwidth)!=Vp)))))}function Pp(e,t,n){var i=Cp(e,t),r=Cp(e,n);if(i&&!r)return!1;if(!i&&r)return!0;if((i=Op(e.width*e.height,t.width*t.height,n.width*n.height))==Vp)return!0;if(i==zp)return!1;if(e.frameRate){if((i=Op(e.frameRate,t.frameRate,n.frameRate))==Vp)return!0;if(i==zp)return!1}return!(!e.bandwidth||Up(e.bandwidth,t.bandwidth,n.bandwidth)!=Vp)}function Lp(e,t,n){var i=De(e.language,t.language),r=De(e.language,n.language);if(r>i)return!0;if(r<i)return!1;if(!t.primary&&n.primary)return!0;if(t.primary&&!n.primary)return!1;if(t.label!==n.label){if(e.label===t.label)return!1;if(e.label===n.label)return!0}if(e.roles.length){if(i=t.roles.filter((function(t){return e.roles.includes(t)})),(r=n.roles.filter((function(t){return e.roles.includes(t)}))).length>i.length)return!0;if(r.length<i.length)return!1}else{if(!n.roles.length&&t.roles.length)return!0;if(n.roles.length&&!t.roles.length)return!1}return n.mimeType==e.mimeType&&n.codecs==e.codecs&&(t.mimeType!=e.mimeType||t.codecs!=e.codecs)}function Dp(e,t,n){return Op(e.width*e.height,t.width*t.height,n.width*n.height)==Vp}function Rp(e){return{id:0,originalId:"",groupId:null,primary:!1,type:e,mimeType:"",codecs:"",language:"",originalLanguage:null,label:null,width:null,height:null,encrypted:!1,keyIds:new Set,segments:[],variantIds:[],roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,external:!1,fastSwitching:!1}}function Np(e){return{id:0,originalId:"",groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new rs([]),mimeType:"",codecs:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"",originalLanguage:null,label:null,type:e,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1}}function Op(e,t,n){if(t==e&&e!=n)return zp;if(n==e&&e!=t)return Vp;if(t>e){if(n<=e||n-e<t-e)return Vp;if(n-e>t-e)return zp}else{if(n>e)return zp;if(e-n<e-t)return Vp;if(e-n>e-t)return zp}return Wp}function Up(e,t,n){return t=Math.abs(e-t),(e=Math.abs(e-n))<t?Vp:t<e?zp:Wp}function Bp(e){switch(e.type){case Ae:return!e.language;case"image":return!e.tilesLayout;default:return!1}}function Fp(e){return JSON.stringify([e.fastSwitching,e.width,e.frameRate,e.codecs,e.mimeType,e.label,e.roles,e.closedCaptions?Array.from(e.closedCaptions.entries()):null,e.bandwidth])}function Gp(e){return JSON.stringify([e.fastSwitching,e.channelsCount,e.language,e.bandwidth,e.label,e.codecs,e.mimeType,e.roles,e.audioSamplingRate,e.primary])}function jp(e){return JSON.stringify([e.language,e.label,e.codecs,e.mimeType,e.bandwidth,e.roles])}function Hp(e){return JSON.stringify([e.width,e.codecs,e.mimeType])}m(rp,rs),(i=rp.prototype).Zb=function(){return this.h?this.h.timeline.length:0},i.release=function(){rs.prototype.release.call(this),this.h=null},i.yb=function(e){if(this.h){for(var t=0,n=this.h.timeline,i=0;i<n.length&&n[i].end+this.i<=e;i+=1)t+=1;0<t&&(this.h.timeline=n.slice(t),this.g.length>=t&&(this.g=this.g.slice(t)),this.j+=t,0===this.Zb()&&this.release())}},i.find=function(e){if(this.h&&this.h.timeline&&this.h.timeline.length&&e<this.h.timeline[0].start+this.i)return this.j;if(!this.h)return null;var t=this.h.timeline;if(e<this.i||e>=this.l)return null;for(var n=t.length-1,i=0;i<t.length;i++){var r=t[i],a=r.start+this.i;if(r=i<n?t[i+1].start+this.i:1/0===this.l?r.end+this.i:this.l,e>=a&&e<r)return i+this.j}return null},i.get=function(e){var t=this;if(0>(e-=this.j)||e>=this.Zb()||!this.h)return null;var n=this.g[e];if(!n){var i=this.h.Sc,r=this.h.timeline[e],a=r.nj,o=this.h.yg+r.zg;n=this.i-this.h.Rb;var s=this.i+r.end,u=s;e===this.Zb()-1&&1/0!==this.l&&(u=this.l);for(var l=[],h=(r.end-r.start)/r.Bb,c={},d=0;d<r.Bb;c={ld:c.ld,$e:c.$e},d++){var p=r.start+h*d,f=p+h;c.$e=d+1,c.ld=null,p=new Ta(this.i+p,this.i+f,function(e){return function(){return t.h?(null==e.ld&&(e.ld=sp(t.h.Sc,t.H,a,t.D,o,e.$e,t.G)),e.ld):[]}}(c),0,null,this.u,n,this.i,this.l,[],"",null,null,Aa,this.C),0==this.I?0<d&&p.xe():0!=d%this.I&&p.xe(),l.push(p)}(n=new Ta(this.i+r.start,u,(function(){return 0<r.Bb?[]:sp(i,t.H,a,t.D,o,null,t.G)}),0,null,this.u,n,this.i,this.l,l,"",null,null,Aa,this.C,0<r.Bb)).h=s,this.g[e]=n}return n},up.prototype.configure=function(e){this.s=e},up.prototype.destroy=function(){return this.C=this.s=null,this.j=[],this.h=null,this.m=[],this.H=[],this.l.clear(),null!=this.g&&(this.g.stop(),this.g=null),this.I.destroy()},up.prototype.setManifestType=function(e){this.u=e},(i=pp.prototype).release=function(){for(var e=l(this.h.concat(this.g,this.l,this.i)),t=e.next();!t.done;t=e.next())(t=t.value).segmentIndex&&t.segmentIndex.release();this.h=[],this.g=[],this.l=[],this.i=[],this.j=[]},i.Ci=function(){return this.j},i.Jf=function(){return this.l.slice()},i.ei=function(){return this.i},i.Kg=function(e,t){var n,i,r,a,o,s,u,h,c,d,p,f,g,m,v,y,b,S,T,A,E,C,x,I,k,M,P,D,R,N=this;return L((function(L){if(1==L.g){if(n=Ee,!t&&1==e.length)return i=fp(e,!1),r=i.Fg,a=i.Ah,o=i.wh,s=i.Yg,N.h=Array.from(r[0].values()),N.g=Array.from(a[0].values()),N.l=Array.from(o[0].values()),N.i=Array.from(s[0].values()),L.F(2);for(u=-1,h=0;h<e.length;h++)c=e[h],N.s.has(c.id)||(N.s.add(c.id),-1==u&&(u=h));return-1==u?L.return():(d=fp(e,!0),p=d.Fg,f=d.Ah,g=d.wh,m=d.Yg,_(L,Promise.all([mp(N,N.h,p,u,_p,Sp),mp(N,N.g,f,u,_p,Sp),mp(N,N.l,g,u,_p,Sp),mp(N,N.i,m,u,_p,Sp)]),2))}if(v=0,y=[],N.g.length&&N.h.length)for(C=l(N.h),x=C.next();!x.done;x=C.next())for(I=x.value,k=l(N.g),M=k.next();!M.done;M=k.next())P=M.value,D=oa(I.drmInfos,P.drmInfos),I.drmInfos.length&&P.drmInfos.length&&!D.length||(R=v++,y.push({id:R,language:I.language,disabledUntilTime:0,primary:I.primary,audio:I,video:P,bandwidth:(I.bandwidth||0)+(P.bandwidth||0),drmInfos:D,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]}));else for(b=N.g.length?N.g:N.h,S=l(b),T=S.next();!T.done;T=S.next())A=T.value,E=v++,y.push({id:E,language:A.language,disabledUntilTime:0,primary:A.primary,audio:A.type==n.U?A:null,video:A.type==n.ia?A:null,bandwidth:A.bandwidth||0,drmInfos:A.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});N.j=y,w(L)}))},G("shaka.util.PeriodCombiner",pp),pp.prototype.combinePeriods=pp.prototype.Kg,pp.prototype.getImageStreams=pp.prototype.ei,pp.prototype.getTextStreams=pp.prototype.Jf,pp.prototype.getVariants=pp.prototype.Ci;var Vp=1,Wp=0,zp=-1,Xp=new Map;function Kp(){var e=this;this.i=this.h=null,this.s=[],this.j=null,this.K=1,this.m={},this.M={},this.l=new pp,this.H=0,this.J=new He(5),this.I=new ln((function(){!function(e){var t,n;L((function(i){switch(i.g){case 1:return t=0,S(i,2),_(i,Yp(e),4);case 4:t=i.h,A(i,3);break;case 2:if(n=E(i),e.i){if(e.h.raiseFatalErrorOnManifestUpdateRequestFailure)return e.i.onError(n),i.return();n.severity=1,e.i.onError(n)}case 3:if(!e.i)return i.return();e.i.onManifestUpdated(),$p(e,t),w(i)}}))}(e)})),this.G=new Ii,this.C=null,this.L=[],this.D=1/0,this.u=!1,this.g=null}function Yp(e){var t,n,i,r,a,o,s;return L((function(u){return 1==u.g?(t=e.s,1<e.s.length&&e.g&&(n=dp(e.g,"Location",!0)).length&&(t=n),i=Li(t,e.h.retryParameters),r=Date.now(),_(u,af(e,i,0,{type:4}),2)):3!=u.g?(a=u.h,e.i?(a.uri&&a.uri!=a.originalUri&&!e.s.includes(a.uri)&&e.s.unshift(a.uri),_(u,function(e,t,n){var i,r,a,o;return L((function(s){if(1==s.g){if(!(i=Hr(t,"MPD")))throw new ye(2,4,4001,n);return e.h.dash.disableXlinkProcessing?s.return(qp(e,i,n)):(r=e.h.dash.xlinkFailGracefully,a=Hd(i,e.h.retryParameters,r,n,e.i.networkingEngine),ki(e.G,a),_(s,a.promise,2))}return o=s.h,s.return(qp(e,o,n))}))}(e,a.data,a.uri),3)):u.return(0)):(o=Date.now(),s=(o-r)/1e3,e.J.sample(1,s),u.return(s))}))}function qp(e,t,n){var i,r,a,o,s,u,h,c,d,p,f,g,m,v,y,b,T,C,x,I,k,M,P,D,R,N,O,U,B,F,G,j,H,V,W,z,K,Y,q,Z,J,Q,$,ee,te,ne,ie,re,ae,oe,se,ue,le;return L((function(he){switch(he.g){case 1:for((i=e.h.dash.manifestPreprocessor)&&i(t),e.g&&e.g.l.clear(),r=[n],a=[],o=new Map,s=Er(t,"Location"),u=l(s),h=u.next();!h.done;h=u.next())c=h.value,d=c.getAttribute("serviceLocation"),(p=kr(c))&&(f=_e(r,[p])[0],d&&(e.g?cp(e.g,"Location",d,f):o.set(d,f)),a.push(f));if(e.g?0<(g=dp(e.g,"Location",!0)).length&&(r=e.s=g):a.length&&(r=e.s=a),m=Promise.resolve(),(v=Tr(t,"ContentSteering"))&&e.i)for(y=v.getAttribute("defaultServiceLocation"),e.g?(e.g.j=r,e.g.h=y):(e.g=new up(e.i),e.g.configure(e.h),e.g.setManifestType("DASH"),e.g.j=r,e.g.h=y,(b=kr(v))&&(Pr(v,"queryBeforeStart",Fr,!1)?m=lp(e.g,b):lp(e.g,b))),T=l(o.keys()),C=T.next();!C.done;C=T.next())x=C.value,I=o.get(x),cp(e.g,"Location",x,I);if(k=Er(t,"BaseURL"),P=!1,e.g)for(D=l(k),R=D.next();!R.done;R=D.next())N=R.value,O=N.getAttribute("serviceLocation"),U=kr(N),O&&U&&(cp(e.g,"BaseURL",O,U),P=!0);if(P&&e.g||(B=k.map(kr),M=_e(r,B)),F=function(){return e.g&&P?dp(e.g,"BaseURL"):M||[]},G=0,k&&k.length&&(G=Pr(k[0],"availabilityTimeOffset",Br)||0),j=e.h.dash.ignoreMinBufferTime,H=0,j||(H=Pr(t,"minBufferTime",Dr)||0),e.H=Pr(t,"minimumUpdatePeriod",Dr,-1),V=Pr(t,"availabilityStartTime",Lr),W=Pr(t,"timeShiftBufferDepth",Dr),z=e.h.dash.ignoreSuggestedPresentationDelay,K=null,z||(K=Pr(t,"suggestedPresentationDelay",Dr)),Y=e.h.dash.ignoreMaxSegmentDuration,q=null,Y||(q=Pr(t,"maxSegmentDuration",Dr)),Z=t.getAttribute("type")||"static",e.j)for(J=e.j.presentationTimeline,Q=l(Object.values(e.m)),$=Q.next();!$.done;$=Q.next())(ee=$.value).segmentIndex&&ee.segmentIndex.yb(J.Ab());else te=e.h.defaultPresentationDelay||1.5*H,J=new Bo(V,null!=K?K:te,e.h.dash.autoCorrectDrift);return J.Vc("static"==Z),J.R()&&!isNaN(e.h.availabilityWindowOverride)&&(W=e.h.availabilityWindowOverride),null==W&&(W=1/0),J.Ne(W),ne=t.getAttribute("profiles")||"",ie={Wb:"static"!=Z,presentationTimeline:J,Ka:null,ma:null,Ea:null,P:null,bandwidth:0,Zg:!1,Hc:G,profiles:ne.split(",")},re=function(e,t,n,i){var r=Pr(i,"mediaPresentationDuration",Dr),a=[],o=0;i=Er(i,"Period");for(var s=0;s<i.length;s++){var u=i[s],l=i[s+1],h=Pr(u,"start",Dr,o),c=u.id,d=Pr(u,"duration",Dr),p=null;if(l){var f=Pr(l,"start",Dr);null!=f&&(p=f-h)}else null!=r&&(p=r-h);if(null==p&&(p=d),!(null!==e.C&&null!==c&&null!==h&&h<e.C)||e.L.includes(c)||s+1==i.length){if(null!==h&&(null===e.C||h>e.C)&&(e.C=h),o=Jp(e,t,n,{start:h,duration:p,node:u,Mf:null==p||!l}),a.push(o),t.Ka.id&&p&&(e.M[t.Ka.id]=p),null==p){o=null;break}o=h+p}}return e.L=a.map((function(e){return e.id})),null!=r?{periods:a,duration:r,Pg:!1}:{periods:a,duration:o,Pg:!0}}(e,ie,F,t),ae=re.duration,oe=re.periods,"static"!=Z&&re.Pg||J.gb(ae||1/0),e.D&&!e.u&&e.i.isAutoLowLatencyMode()&&(e.i.enableLowLatencyMode(),e.u=e.i.isLowLatencyMode()),e.u?J.mh(e.D):e.D&&X("Low-latency DASH live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details."),J.Wf(q||1),_(he,e.l.Kg(oe,ie.Wb),2);case 2:return _(he,m,3);case 3:if(e.u&&(H=0),e.j){e.j.variants=e.l.j,0<(se=e.l.Jf()).length&&(e.j.textStreams=se),e.j.imageStreams=e.l.i,e.i.filter(e.j),he.F(4);break}if(e.j={presentationTimeline:J,variants:e.l.j,textStreams:e.l.Jf(),imageStreams:e.l.i,offlineSessionIds:[],minBufferTime:H||0,sequenceMode:e.h.dash.sequenceMode,ignoreManifestTimestampsInSegmentsMode:!1,type:"DASH",serviceDescription:Zp(t)},!J.yh()){he.F(5);break}return ue=Er(t,"UTCTiming"),_(he,function(e,t,n){var i,r,a,o,s,u,h,c;return L((function(d){switch(d.g){case 1:i=n.map((function(e){return{scheme:e.getAttribute("schemeIdUri"),value:e.getAttribute("value")}})),r=e.h.dash.clockSyncUri,!i.length&&r&&i.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:r}),a=l(i),o=a.next();case 2:if(o.done){d.F(4);break}switch(s=o.value,S(d,5),u=s.scheme,h=s.value,u){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return d.F(7);case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return d.F(8);case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return c=Date.parse(h),d.return(isNaN(c)?0:c-Date.now());case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":X("NTP UTCTiming scheme is not supported");break;default:X("Unrecognized scheme in UTCTiming element",u)}d.F(9);break;case 7:return _(d,tf(e,t,h,"HEAD"),10);case 10:return d.return(d.h);case 8:return _(d,tf(e,t,h,"GET"),11);case 11:return d.return(d.h);case 9:A(d,3);break;case 5:E(d);case 3:o=a.next(),d.F(2);break;case 4:return X("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),d.return(0)}}))}(e,F,ue),6);case 6:if(le=he.h,!e.i)return he.return();J.nh(le);case 5:J.ve();case 4:e.i.makeTextStreamsForClosedCaptions(e.j),w(he)}}))}function Zp(e){if(!(e=Tr(e,"ServiceDescription")))return null;var t=Tr(e,"Latency"),n=Tr(e,"PlaybackRate");return t&&t.getAttribute("max")||n?{maxLatency:e=t&&t.getAttribute("max")?parseInt(t.getAttribute("max"),10)/1e3:null,maxPlaybackRate:n?parseFloat(n.getAttribute("max")):null,minLatency:t=t&&t.getAttribute("min")?parseInt(t.getAttribute("min"),10)/1e3:null,minPlaybackRate:n=n?parseFloat(n.getAttribute("min")):null}:null}function Jp(t,n,i,r){n.Ka=ef(t,r.node,null,i),n.ma=r,n.Ka.Hc=n.Hc,n.Ka.id||(n.Ka.id="__shaka_period_"+r.start);var a=Er(r.node,"EventStream");i=n.presentationTimeline.Ab();for(var o=(a=l(a)).next();!o.done;o=a.next())nf(t,r.start,r.duration,o.value,i);if(i=Er(r.node,"AdaptationSet").map((function(i){return function(t,n,i){function r(e){switch(e){case 1:case 6:case 13:case 14:case 15:return"SDR";case 16:return"PQ";case 18:return"HLG"}}n.Ea=ef(t,i,n.Ka,null);var a,o=!1,s=Er(i,"Role"),u=s.map((function(e){return e.getAttribute("value")})).filter(an),c=void 0,d=n.Ea.contentType==Ae;d&&(c="subtitle");for(var p=(s=l(s)).next();!p.done;p=s.next()){var f=(p=p.value).getAttribute("schemeIdUri");if(null==f||"urn:mpeg:dash:role:2011"==f)switch(p=p.getAttribute("value"),p){case"main":o=!0;break;case"caption":case"subtitle":c=p}}f=Er(i,"EssentialProperty"),s=null;var g=!1;p=!1;for(var m=(f=l(f)).next();!m.done;m=f.next()){var v=(m=m.value).getAttribute("schemeIdUri");"http://dashif.org/guidelines/trickmode"==v?s=m.getAttribute("value"):"urn:mpeg:mpegB:cicp:TransferCharacteristics"==v?a=r(parseInt(m.getAttribute("value"),10)):"urn:mpeg:mpegB:cicp:ColourPrimaries"!=v&&"urn:mpeg:mpegB:cicp:MatrixCoefficients"!=v&&("urn:mpeg:dash:ssr:2023"==v?g=!0:p=!0)}for(m=(f=l(f=Er(i,"SupplementalProperty"))).next();!m.done;m=f.next())"urn:mpeg:mpegB:cicp:TransferCharacteristics"==(m=m.value).getAttribute("schemeIdUri")&&(a=r(parseInt(m.getAttribute("value"),10)));f=Er(i,"Accessibility");var y,b=new Map;for(m=(f=l(f)).next();!m.done;m=f.next())if(m=(v=m.value).getAttribute("schemeIdUri"),v=v.getAttribute("value"),"urn:scte:dash:cc:cea-608:2015"==m)if(m=1,null!=v)for(var S=l(v=v.split(";")),T=S.next();!T.done;T=S.next()){var A=T.value,E=T=void 0;A.includes("=")?(T=(A=A.split("="))[0].startsWith("CC")?A[0]:"CC"+A[0],E=A[1]||"und"):(T="CC"+m,2==v.length?m+=2:m++,E=A),b.set(T,Pe(E))}else b.set("CC1","und");else if("urn:scte:dash:cc:cea-708:2015"==m)if(m=1,null!=v)for(T=(v=l(v.split(";"))).next();!T.done;T=v.next())A=S=void 0,(T=T.value).includes("=")?(S="svc"+(T=T.split("="))[0],A=T[1].split(",")[0].split(":").pop()):(S="svc"+m,m++,A=T),b.set(S,Pe(A));else b.set("svc1","und");else"urn:mpeg:dash:role:2011"==m?null!=v&&(u.push(v),"captions"==v&&(c="caption")):"urn:tva:metadata:cs:AudioPurposeCS:2007"==m&&("1"==v?y="visually impaired":"2"==v&&(y="hard of hearing"));if(p)return null;var C=Ld(p=Er(i,"ContentProtection"),t.h.dash.ignoreDrmInfo,t.h.dash.keySystemsByURI),x=Pe(n.Ea.language||"und"),I=i.getAttribute("label");if((p=Er(i,"Label"))&&p.length&&((p=p[0]).textContent&&(I=p.textContent)),i=(p=Er(i,"Representation")).map((function(i){return(i=function(t,n,i,r,a,o,s,u,h,c,d){if(n.P=ef(t,c,n.Ea,null),t.D=Math.min(t.D,n.P.Hc),!function(e){var t=e.Ld?1:0;return t+=e.fc?1:0,0==(t+=e.Md?1:0)?e.contentType==Ae||"application"==e.contentType:(1!=t&&(e.Ld&&(e.fc=null),e.Md=null),!0)}(n.P))return null;var p=n.ma.start;n.bandwidth=Pr(c,"bandwidth",Or)||0;var f=n.P.contentType,g=f==Ae||"application"==f;f="image"==f;try{var m=void 0;if(i.gf){var v=n.P.zb,y=_e(v(),[i.gf.Qi]),b=Li(y,t.h.retryParameters);m={method:"AES-128",iv:i.gf.iv,firstMediaSequenceNumber:0,fetchKey:function(){var n,i,r;return L((function(a){if(1==a.g)return _(a,af(t,b,6),2);if(3!=a.g){if(!(n=a.h).data||16!=n.data.byteLength)throw new ye(2,4,4049);return i={name:"AES-CBC"},r=m,_(a,e.crypto.subtle.importKey("raw",n.data,i,!0,["decrypt"]),3)}r.cryptoKey=a.h,m.fetchKey=void 0,w(a)}))}}}if(v=function(e,n,i,r){return function(e,t,n,i,r){var a,o,s,u;return L((function(l){return 1==l.g?(a=Ui,o=r?0:1,s=Es(t,n,i,e.h.retryParameters),_(l,af(e,s,a,{type:o}),2)):(u=l.h,l.return(u.data))}))}(t,e,n,i,r)},n.P.Ld)var S=function(e,t,n){var i=Number(Gd(e,Qd,"presentationTimeOffset"))||0,r=Gd(e,Qd,"timescale"),a=1;r&&(a=Or(r)||1);var o=i/a||0,s=Zd(e,Qd,n);!function(e,t){if(ep(e,t),!$d(e))throw new ye(2,4,4002)}(e,s);var u=sn(e);return{Kc:function(){var e=jd(u,Qd,"RepresentationIndex"),n=u.P.zb();return e&&(e=e.getAttribute("sourceURL"))&&(n=_e(n,[e])),e=$d(u),Jd(u,t,s,n,e.start,e.end,o)}}}(n,v,m);else if(n.P.fc)S=function(e,t,n){var i=Zd(e,np,n),r=function(e){var t=function(e){return[e.P.fc,e.Ea.fc,e.Ka.fc].filter(an).map((function(e){return Er(e,"SegmentURL")})).reduce((function(e,t){return 0<e.length?e:t})).map((function(t){return t.getAttribute("indexRange")&&!e.Zg&&(e.Zg=!0),{Vi:t.getAttribute("media"),start:(t=Pr(t,"mediaRange",Rr,{start:0,end:null})).start,end:t.end}}))}(e),n=(e=Bd(e,np)).Nd;0==n&&(n=1);var i=0;return e.Pa?i=e.Pa*(n-1):e.timeline&&0<e.timeline.length&&(i=e.timeline[0].start),{Pa:e.Pa,startTime:i,Nd:n,Rb:e.Rb,timeline:e.timeline,Rc:t}}(e);if(!r.Pa&&!r.timeline&&1<r.Rc.length)throw new ye(2,4,4002);if(!r.Pa&&!e.ma.duration&&!r.timeline&&1==r.Rc.length)throw new ye(2,4,4002);if(r.timeline&&0==r.timeline.length)throw new ye(2,4,4002);var a=null,o=null;e.Ka.id&&e.P.id&&(o=t[e.Ka.id+","+e.P.id])&&(a=o.segmentIndex);var s=function(e,t,n,i,r,a){var o=i.Rc.length;i.timeline&&i.timeline.length!=i.Rc.length&&(o=Math.min(i.timeline.length,i.Rc.length));for(var s=e-i.Rb,u=t?e+t:1/0,l=[],h=i.startTime,c={},d=0;d<o;c={kd:c.kd,fd:c.fd},d++){var p;c.fd=i.Rc[d],p=null!=i.Pa?h+i.Pa:i.timeline?i.timeline[d].end:h+t,c.kd=null,l.push(new Ta(e+h,e+p,function(e){return function(){return null==e.kd&&(e.kd=_e(n(),[e.fd.Vi])),e.kd}}(c),c.fd.start,c.fd.end,r,s,e,u,[],"",null,null,Aa,a)),h=p}return l}(e.ma.start,e.ma.duration,e.P.zb,r,i,n);return t=!a,a?a.Cd(s,e.presentationTimeline.Ab()):a=new rs(s),e.presentationTimeline.Dd(s),e.Wb&&e.ma.Mf||a.Ic(e.ma.start,e.ma.duration?e.ma.start+e.ma.duration:1/0,t),o&&(o.segmentIndex=a),{Kc:function(){return a&&0!=a.Zb()||a.ze(s),Promise.resolve(a)}}}(n,t.m,m);else if(n.P.Md)S=function(t,n,i,r,a,o,s){var u=function(e,t){var n=Gd(e,ip,"initialization");if(!n)return null;var i=e.P.id,r=e.bandwidth||null,a=e.P.zb;return new wa((function(){var e=Ud(n,i,null,null,r,null);return _e(a(),[e])}),0,null,tp(e),null,null,t)}(t,s),h=function(e){var t=Bd(e,ip),n=Gd(e,ip,"media");return e=Gd(e,ip,"index"),{Pa:t.Pa,timescale:t.timescale,Nd:t.Nd,Rb:t.Rb,yg:t.yg,timeline:t.timeline,Sc:n,xd:e}}(t);!function(e){var t=e.xd?1:0;if(t+=e.timeline?1:0,0==(t+=e.Pa?1:0))throw new ye(2,4,4002);if(1!=t&&(e.xd&&(e.timeline=null),e.Pa=null),!e.xd&&!e.Sc)throw new ye(2,4,4002)}(h);var c=sn(t);if(h.xd)return ep(t,u),{Kc:function(){var e=Ud(h.xd,c.P.id,null,null,c.bandwidth||null,null);return e=_e(c.P.zb(),[e]),Jd(c,n,u,e,0,null,h.Rb)}};if(h.Pa)return r||"image"===t.Ea.contentType||(t.presentationTimeline.Wf(h.Pa),t.presentationTimeline.Ce(t.ma.start)),{Kc:function(){return function(t,n,i,r,a,o){function s(t){var i=(t-m)*g,a=i+n.Rb,s=i+d;return i=s+g,(s=new Ta(s,Math.min(i,h()),(function(){var n=a*v;return"BigInt"in e&&n>Number.MAX_SAFE_INTEGER&&(n=BigInt(a)*BigInt(v)),n=Ud(y,_,t,null,b,n),_e(w(),[n])}),0,null,r,S,d,h(),[],"",null,null,Aa,o)).h=i,s}function u(){var e=[Math.max(c.Ab(),d),Math.min(c.$b(),h())].map((function(e){return e-d}));return[Math.ceil(e[0]/g),Math.ceil(e[1]/g)-1].map((function(e){return e+m}))}function h(){var e=null!=p&&a[p]||f;return e?d+e:1/0}var c=t.presentationTimeline,d=t.ma.start,p=t.Ka.id,f=t.ma.duration,g=n.Pa,m=n.Nd,v=n.timescale,y=n.Sc,b=t.bandwidth||null,_=t.P.id,w=t.P.zb,S=d-n.Rb,T=u();t=t.Wb?Math.max(T[0],T[1]-i+1):T[0],T=T[1],i=[];for(var A=t;A<=T;++A){var E=s(A);i.push(E)}var C=new rs(i);if(i=c.$b()<h(),A=c.R(),i||A){var x=Math.max(t,T+1);C.Qe(g,(function(){var e=c.Ab();C.yb(e);var t=l(u());t.next(),t=t.next().value;for(var n=[];x<=t;){var i=s(x);n.push(i),x++}return e>h()&&!n.length?null:n}))}return Promise.resolve(C)}(c,h,a,u,o,s)}};var d=null;r=r=null,t.Ka.id&&t.P.id&&(r=i[r=t.Ka.id+","+t.P.id])&&(d=r.segmentIndex);var p=t.ma.start,f=t.ma.duration?p+t.ma.duration:1/0,g=!(t.Wb&&t.ma.Mf);return d?(ap(i=d,h,p,f,g,u),i.yb(t.presentationTimeline.Ab())):d=new rp(h,t.P.id,t.bandwidth,t.P.zb,p,f,u,g,s,t.P.hg),h.timeline&&"image"!==t.Ea.contentType&&t.presentationTimeline.hh(h.timeline,p),r&&t.Wb&&(r.segmentIndex=d),{Kc:function(){return d instanceof rp&&0==d.Zb()&&ap(d,h,p,f,g,u),Promise.resolve(d)}}}(n,v,t.m,!!t.j,t.h.dash.initialSegmentLimit,t.M,m);else{var T=n.ma.duration||0,A=n.P.zb;S={Kc:function(){return Promise.resolve(os(p,T,A()))}}}}catch(e){if((g||f)&&4002==e.code)return null;throw e}v=function(e,t,n,i){var r=Ld(e,n,i);if(t.Rg)e=1==t.drmInfos.length&&!t.drmInfos[0].keySystem,n=0==r.drmInfos.length,(0==t.drmInfos.length||e&&!n)&&(t.drmInfos=r.drmInfos),t.Rg=!1;else if(0<r.drmInfos.length&&(t.drmInfos=t.drmInfos.filter((function(e){return r.drmInfos.some((function(t){return t.keySystem==e.keySystem}))})),0==t.drmInfos.length))throw new ye(2,4,4008);return r.Ng||t.Ng}(v=Er(c,"ContentProtection"),i,t.h.dash.ignoreDrmInfo,t.h.dash.keySystemsByURI),v=new Set(v?[v]:[]),y=!1,Er(c,"SupplementalProperty").some((function(e){return"tag:dolby.com,2018:dash:EC3_ExtensionType:2018"==e.getAttribute("schemeIdUri")&&"JOC"==e.getAttribute("value")}))&&(y=!0);var E,C,x=!1;if(g&&(x=u.includes("forced_subtitle")||u.includes("forced-subtitle")),f&&((c=Er(c,"EssentialProperty").find((function(e){return["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"].includes(e.getAttribute("schemeIdUri"))})))&&(E=c.getAttribute("value")),!E))return null;c=n.P.codecs,n.profiles.includes("http://dashif.org/guidelines/dash-if-uhd#hevc-hdr-pq10")&&(c.includes("hvc1.2.4.L153.B0")||c.includes("hev1.2.4.L153.B0"))&&(C="PQ");var I=(c=n.P.id?n.Ka.id+","+n.P.id:"")&&t.m[c]?t.m[c]:{id:t.K++,originalId:n.P.id,groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){I.segmentIndex&&(I.segmentIndex.release(),I.segmentIndex=null)},segmentIndex:null,mimeType:n.P.mimeType,codecs:n.P.codecs,frameRate:n.P.frameRate,pixelAspectRatio:n.P.pixelAspectRatio,bandwidth:n.bandwidth,width:n.P.width,height:n.P.height,kind:r,encrypted:0<i.drmInfos.length,drmInfos:i.drmInfos,keyIds:v,language:a,originalLanguage:n.Ea.language,label:o,type:n.Ea.contentType,primary:s,trickModeVideo:null,emsgSchemeIdUris:n.P.emsgSchemeIdUris,roles:u,forced:x,channelsCount:n.P.De,audioSamplingRate:n.P.audioSamplingRate,spatialAudio:y,closedCaptions:h,hdr:C,videoLayout:void 0,tilesLayout:E,accessibilityPurpose:d,external:!1,fastSwitching:!1};return I.createSegmentIndex=function(){var e;return L((function(t){if(1==t.g)return I.segmentIndex?t.F(0):(e=I,_(t,S.Kc(),3));e.segmentIndex=t.h,w(t)}))},c&&n.Wb&&!t.m[c]&&(t.m[c]=I),I}(t,n,C,c,x,I,o,u,b,i,y))&&(i.hdr=i.hdr||a,i.fastSwitching=g),i})).filter((function(e){return!!e})),0==i.length){if(s="image"==n.Ea.contentType,t.h.dash.ignoreEmptyAdaptationSet||d||s)return null;throw new ye(2,4,4003)}if(!n.Ea.contentType||"application"==n.Ea.contentType)for(n.Ea.contentType=rf(i[0].mimeType,i[0].codecs),m=(d=l(i)).next();!m.done;m=d.next())m.value.type=n.Ea.contentType;for(d=n.Ea.id||"__fake__"+t.K++,m=(f=l(i)).next();!m.done;m=f.next()){for(m=m.value,S=(v=l(C.drmInfos)).next();!S.done;S=v.next())(S=S.value).keyIds=S.keyIds&&m.keyIds?new Set([].concat(h(S.keyIds),h(m.keyIds))):S.keyIds||m.keyIds;t.h.dash.enableAudioGroups&&(m.groupId=d)}return p=p.map((function(e){return e.getAttribute("id")})).filter(an),{id:d,contentType:n.Ea.contentType,language:x,yk:o,streams:i,drmInfos:C.drmInfos,wg:s,gj:p}}(t,n,i)})).filter(an),n.Wb){for(r=[],o=(a=l(i)).next();!o.done;o=a.next())for(var s=(o=l(o.value.gj)).next();!s.done;s=o.next())r.push(s.value);if(r.length!=new Set(r).size)throw new ye(2,4,4018)}for(r=i.filter((function(e){return!e.wg})),a=(i=l(i=i.filter((function(e){return e.wg})))).next();!a.done;a=i.next()){o=(a=a.value).wg.split(" ");for(var u=(s=l(r)).next();!u.done;u=s.next()){var c=u.value;if(o.includes(c.id)){u={};for(var d=(c=l(c.streams)).next();!d.done;u={Xd:u.Xd},d=c.next())u.Xd=d.value,u.Xd.trickModeVideo=a.streams.find(function(e){return function(t){return zt(e.Xd.codecs)==zt(t.codecs)}}(u))}}}if(i=Qp(t.h.disableAudio,r,"audio"),a=Qp(t.h.disableVideo,r,"video"),o=Qp(t.h.disableText,r,Ae),r=Qp(t.h.disableThumbnails,r,"image"),0===a.length&&0===i.length)throw new ye(2,4,4004);return{id:n.Ka.id,audioStreams:i,videoStreams:a,textStreams:o,imageStreams:r}}function Qp(e,t,n){return e||!t.length?[]:t.reduce((function(e,t){return t.contentType!=n||e.push.apply(e,h(t.streams)),e}),[])}function $p(e,t){0>e.H||e.I.S(Math.max(e.H-t,Ve(e.J)))}function ef(e,t,n,i){n=n||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,pixelAspectRatio:void 0,De:null,audioSamplingRate:null,Hc:0,hg:0},i=i||n.zb;var r,a=t.getAttribute("id"),o=Er(t,"BaseURL"),s=!1;if(e.g)for(var u=l(o),h=u.next();!h.done;h=u.next()){var c=h.value;h=c.getAttribute("serviceLocation"),c=kr(c),h&&c&&(cp(e.g,a,h,c),s=!0)}s&&e.g||(r=o.map(kr)),u=t.getAttribute("contentType")||n.contentType,h=t.getAttribute("mimeType")||n.mimeType,c=t.getAttribute("codecs")||n.codecs;var d=Pr(t,"frameRate",Gr)||n.frameRate,p=t.getAttribute("sar")||n.pixelAspectRatio,f=function(e,t){t=t.slice();for(var n=(e=l(e)).next();!n.done;n=e.next())n=n.value.getAttribute("schemeIdUri"),t.includes(n)||t.push(n);return t}(Er(t,"InbandEventStream"),n.emsgSchemeIdUris),g=Er(t,"AudioChannelConfiguration");g=function(e){for(var t=(e=l(e)).next();!t.done;t=e.next()){var n=t.value;if((t=n.getAttribute("schemeIdUri"))&&(n=n.getAttribute("value")))switch(t){case"urn:mpeg:dash:outputChannelPositionList:2012":return n.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":if(!(t=parseInt(n,10)))continue;return t;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(!(t=parseInt(n,16)))continue;for(e=0;t;)1&t&&++e,t>>=1;return e;case"urn:mpeg:mpegB:cicp:ChannelConfiguration":if(t=[0,1,2,3,4,5,6,8,2,3,4,7,8,24,8,12,10,12,14,12,14],(n=parseInt(n,10))&&0<n&&n<t.length)return t[n]}}return null}(g)||n.De;var m=Pr(t,"audioSamplingRate",Ur)||n.audioSamplingRate;u||(u=rf(h,c));var v=Tr(t,"SegmentBase"),y=Tr(t,"SegmentTemplate"),b=v&&Pr(v,"availabilityTimeOffset",Br)||0,_=y&&Pr(y,"availabilityTimeOffset",Br)||0,w=o&&o.length&&Pr(o[0],"availabilityTimeOffset",Br)||0;return b=n.Hc+w+b+_,_=null,(w=Tr(t,"SegmentSequenceProperties"))&&(w=Tr(w,"SAP"))&&(_=Pr(w,"cadence",Nr)),{zb:function(){return _e(i(),o.length?e.g&&s?dp(e.g,a):r||[]:[])},Ld:v||n.Ld,fc:Tr(t,"SegmentList")||n.fc,Md:y||n.Md,width:Pr(t,"width",Ur)||n.width,height:Pr(t,"height",Ur)||n.height,contentType:u,mimeType:h,codecs:c,frameRate:d,pixelAspectRatio:p,emsgSchemeIdUris:f,id:a,language:t.getAttribute("lang"),De:g,audioSamplingRate:m,Hc:b,hg:_||n.hg}}function tf(e,t,n,i){var r,a,o,s,u,l;return L((function(h){if(1==h.g)return r=_e(t(),[n]),(a=Li(r,e.h.retryParameters)).method=i,o=e.i.networkingEngine.request(4,a),ki(e.G,o),_(h,o.promise,2);if(s=h.h,"HEAD"==i){if(!s.headers||!s.headers.date)return h.return(0);u=s.headers.date}else u=qi(s.data);return l=Date.parse(u),isNaN(l)?h.return(0):h.return(l-Date.now())}))}function nf(e,t,n,i,r){for(var a=i.getAttribute("schemeIdUri")||"",o=i.getAttribute("value")||"",s=Pr(i,"timescale",Ur)||1,u=(i=l(Er(i,"Event"))).next();!u.done;u=i.next()){var h=Pr(u=u.value,"presentationTime",Ur)||0,c=Pr(u,"duration",Ur)||0;c=(h=h/s+t)+c/s,null!=n&&(h=Math.min(h,t+n),c=Math.min(c,t+n)),c<r||(u={schemeIdUri:a,value:o,startTime:h,endTime:c,id:u.getAttribute("id")||"",eventElement:u},e.i.onTimelineRegionAdded(u))}}function rf(e,t){return Qt(t=Ht(e,t))?Ae:e.split("/")[0]}function af(e,t,n,i){return t=e.i.networkingEngine.request(n,t,i),ki(e.G,t),t.promise}function of(){}(i=Kp.prototype).configure=function(e){this.h=e,this.g&&this.g.configure(this.h),this.l&&(this.l.m=this.h.dash.multiTypeVariantsAllowed&&Xe())},i.start=function(e,t){var n,i=this;return L((function(r){if(1==r.g)return i.u=t.isLowLatencyMode(),i.s=[e],i.i=t,_(r,Yp(i),2);if(n=r.h,i.i&&$p(i,n),!i.i)throw new ye(2,7,7001);return r.return(i.j)}))},i.stop=function(){for(var e=l(Object.values(this.m)),t=e.next();!t.done;t=e.next())(t=t.value).segmentIndex&&t.segmentIndex.release();return this.l&&this.l.release(),this.h=this.i=null,this.s=[],this.j=null,this.m={},this.l=null,null!=this.I&&(this.I.stop(),this.I=null),this.g&&this.g.destroy(),this.G.destroy()},i.update=function(){var e,t=this;return L((function(n){return 1==n.g?(S(n,2),_(n,Yp(t),4)):2!=n.g?A(n,0):(e=E(n),t.i&&e?(t.i.onError(e),void w(n)):n.return())}))},i.onExpirationUpdated=function(){},i.onInitialVariantChosen=function(e){if(this.j&&this.j.presentationTimeline.R()){var t=e.video||e.audio;if(t&&t.segmentIndex){e=this.j.presentationTimeline.$b();var n=t.segmentIndex.find(e);null!=n&&(t=t.segmentIndex.get(n))&&(this.H=t.endTime-e,$p(this,0))}}},i.banLocation=function(e){this.g&&this.g.i.set(e,Date.now()+6e4)},G("shaka.dash.DashParser",Kp),va["application/dash+xml"]=function(){return new Kp},va["video/vnd.mpeg.dash.mpd"]=function(){return new Kp},G("shaka.dependencies",of),of.has=function(e){return lf.has(e)},of.add=function(e,t){if(!uf[e])throw Error(e+" is not supported");e==sf?ai("mux.js","mux.js is no longer used in Shaka Player."):lf.set(e,(function(){return t}))};var sf="muxjs",uf={zk:sf,ISOBoxer:"ISOBoxer"};of.Allowed=uf;var lf=new Map([["ISOBoxer",function(){return e.ISOBoxer}]]);function hf(e,t,n){this.type=e,this.g=t,this.segments=n||null}function cf(e,t,n,i){this.id=e,this.name=t,this.g=n,this.value=void 0===i?null:i}function df(e){var t=(new Set).add("AUDIO").add("VIDEO").add("SUBTITLES").add("PATHWAY-ID").add("GROUP-ID").add("URI");return e.toString(t)}function pf(e,t,n){return(e=e.getAttribute(t))?e.value:n||null}function ff(e,t){if(!(e=e.getAttribute(t)))throw new ye(2,4,4023,t);return e.value}function gf(e,t,n){n=void 0===n?[]:n,this.g=t,this.h=e,this.Bb=n}function mf(e,t){this.name=e,this.value=t}function vf(e,t){return e.filter((function(e){return e.name==t}))}function yf(e,t){return e.filter((function(e){return ff(e,"TYPE")==t}))}function bf(e,t){for(var n=(e=l(e)).next();!n.done;n=e.next())if((n=n.value).name===t)return n;return null}function _f(e,t,n){return n=void 0===n?0:n,(e=bf(e,t))?Number(e.value):n}function wf(e,t,n){return t?Sf(e,[t],n):[]}function Sf(e,t,n){if(!t.length)return[];t=_e(e,t),e=[];for(var i=(t=l(t)).next();!i.done;i=t.next()){var r=e,a=r.push,o=i.value;if((i=n)&&i.size){var s=(o=String(o).replace(/%7B/g,"{").replace(/%7D/g,"}")).match(/{\$\w*}/g);if(s)for(var u=(s=l(s)).next();!u.done;u=s.next()){var h=(u=u.value).slice(2,u.length-1),c=i.get(h);if(!c)throw new ye(2,4,4039,h);o=o.replace(u,c)}i=o}else i=o;a.call(r,i)}return e}function Tf(e){this.h=e||"",this.g=0}function Af(e){Ef(e,/[ \t]+/gm)}function Ef(e,t){return t.lastIndex=e.g,t=null==(t=t.exec(e.h))?null:{position:t.index,length:t[0].length,results:t},e.g==e.h.length||null==t||t.position!=e.g?null:(e.g+=t.length,t.results)}function Cf(e){return e.g==e.h.length?null:(e=Ef(e,/[^ \t\n]*/gm))?e[0]:null}function xf(){this.g=0}function If(e,t){var n=(t=(t=qi(t)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim()).split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(n[0]))throw new ye(2,4,4015);t=0;for(var i=!0,r=l(n),a=r.next();!a.done;a=r.next())if(a=a.value,/^#(?!EXT)/m.test(a)||i)i=!1;else{if(a=kf(e,a),--e.g,Mf.includes(a.name)){t=1;break}"EXT-X-STREAM-INF"==a.name&&(i=!0)}for(r=[],i=!0,a=0;a<n.length;a++){var o=n[a],s=n[a+1];if(/^#(?!EXT)/m.test(o)||i)i=!1;else{if(o=kf(e,o),Pf.includes(o.name)){if(1!=t)throw new ye(2,4,4017);o=n.splice(a,n.length-a),n=[],i=[],a=[],s=null;for(var u=(o=l(o)).next();!u.done;u=o.next())u=u.value,/^(#EXT)/.test(u)?(u=kf(e,u),Mf.includes(u.name)?r.push(u):"EXT-X-MAP"==u.name?s=u:"EXT-X-PART"==u.name?a.push(u):"EXT-X-PRELOAD-HINT"==u.name?"PART"==pf(u,"TYPE")?a.push(u):"MAP"==pf(u,"TYPE")&&(u.name="EXT-X-MAP",s=u):i.push(u)):/^#(?!EXT)/m.test(u)||(u=u.trim(),s&&i.push(s),n.push(new gf(u,i,a)),i=[],a=[]);return a.length&&(s&&i.push(s),n.push(new gf("",i,a))),new hf(t,r,n)}r.push(o),"EXT-X-STREAM-INF"==o.name&&(o.g.push(new mf("URI",s)),i=!0)}}return new hf(t,r)}function kf(e,t){e=e.g++;var n=t.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!n)throw new ye(2,4,4016,t);t=n[1];var i,r=n[2];if(n=[],r){var a;(a=Ef(r=new Tf(r),/^([^,=]+)(?:,|$)/g))&&(i=a[1]);for(var o=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;a=Ef(r,o);)n.push(new mf(a[1],a[2]||a[3])),Af(r)}return new cf(e,t,n,i)}cf.prototype.toString=function(e){var t="#"+this.name,n=this.g?this.g.filter((function(t){return!e||!e.has(t.name)})).map((function(e){return e.name+"="+(isNaN(Number(e.value))?'"'+e.value+'"':e.value)})):[];return this.value&&n.unshift(this.value),0<n.length&&(t+=":"+n.join(",")),t},cf.prototype.getAttribute=function(e){var t=this.g.filter((function(t){return t.name==e}));return t.length?t[0]:null};var Mf="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST EXT-X-SERVER-CONTROL EXT-X-SKIP EXT-X-PART-INF".split(" "),Pf="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE EXT-X-MAP".split(" ");function Lf(){}function Df(e){try{var t=Rf(e);return Ei({uri:e,originalUri:e,data:t.data,headers:{"content-type":t.contentType}})}catch(e){return Ti(e)}}function Rf(t){var n=t.split(":");if(2>n.length||"data"!=n[0])throw new ye(2,1,1004,t);if(2>(n=n.slice(1).join(":").split(",")).length)throw new ye(2,1,1004,t);var i=n[0];t=e.decodeURIComponent(n.slice(1).join(",")),n=i.split(";"),i=n[0];var r=!1;return 1<n.length&&"base64"==n[n.length-1]&&(r=!0,n.pop()),{data:r?vr(t):Qi(t),contentType:i}}function Nf(e){var t=Kt(e);return{type:t.split("/")[0],mimeType:t,codecs:e=Yt(e),language:null,height:null,width:null,channelCount:null,sampleRate:null,closedCaptions:new Map}}function Of(e){for(var t=new Set,n=[],i=(e=l(e)).next();!i.done;i=e.next()){var r=Xt(i=i.value);t.has(r)||(n.push(i),t.add(r))}return n}function Uf(){var e=this;this.g=this.i=null,this.C=1,this.s=new Map,this.J=new Map,this.L=new Map,this.L.set("video",new Map),this.L.set("audio",new Map),this.L.set(Ae,new Map),this.L.set("image",new Map),this.va=new Set,this.h=new Map,this.l=null,this.Z="",this.sa=new xf,this.K=-1,this.V=1/0,this.$=this.Xa=!1,this.u=new ln((function(){!function(e){var t,n,i,r,a,o;L((function(s){switch(s.g){case 1:return e.i?(S(s,2),t=Date.now(),_(s,e.update(),4)):s.return();case 4:n=Date.now(),mg(e)&&(i=(n-t)/1e3,e.Ra.sample(1,i),r=e.m,a=Math.max(0,r-Ve(e.Ra)),e.u.S(a)),A(s,3);break;case 2:if(o=E(s),!e.i)return s.return();if(e.g.raiseFatalErrorOnManifestUpdateRequestFailure)return e.i.onError(o),s.return();o.severity=1,e.i.onError(o),e.u.S(.1);case 3:if(!e.i)return s.return();e.i.onManifestUpdated(),w(s)}}))}(e)})),this.aa=Sg,this.G=null,this.ua=0,this.m=1/0,this.ha=this.Aa=this.M=0,this.N=new Ii,this.H=new Map,this.I=new Map,this.W=new Map,this.Wa=this.D=!1,this.Ra=new He(5),this.j=null}function Bf(e,t){return mg(e)?e.L.get(t.type):t.ye}function Ff(e,t){var n,i,r,a,o,s,u,c,d,p,f,g,m,v,y,b,S,T,A,E,C,x,I,k,M,P,D,R;return L((function(L){if(1==L.g){for(n=[],i=l(t.ba()),r=i.next();!r.done;r=i.next())a=r.value,o=new ne(a),s=o.g,t.$d&&(0<=t.rb&&s.add("_HLS_msn",String(t.rb)),0<=t.sb&&s.add("_HLS_part",String(t.sb))),t.ae&&s.add("_HLS_skip","YES"),ve(s)&&oe(o,s),n.push(o.toString());return _(L,gg(e,n,!0),2)}if(u=L.h,!t.stream.segmentIndex)return L.return();if(1!=(c=If(e.sa,u.data)).type)throw new ye(2,4,4017);var N,O;(d=u.uri)==u.originalUri||t.ba().includes(d)||t.jh.push(d),p=vf(c.g,"EXT-X-DEFINE"),f=Vf(e,p,d),g=t.stream,m=Bf(e,t),v=rg(c,g.mimeType),y=v.keyIds,b=v.drmInfos,N=g.keyIds,O=y,N.size===O.size&&[].concat(h(N)).every((function(e){return O.has(e)}))||(g.keyIds=y,g.drmInfos=b,e.i.newDrmInfo(g)),S=cg(e,c,g,m,f,t.ba),T=S.segments,(A=S.bandwidth)&&(g.bandwidth=A),g.segmentIndex.Cd(T,e.l.Ab()),T.length&&(E=_f(c.g,"EXT-X-MEDIA-SEQUENCE",0),x=(C=bf(c.g,"EXT-X-SKIP"))?Number(pf(C,"SKIPPED-SEGMENTS")):0,I=ng(E,T),k=I.rb,M=I.sb,t.rb=k+x,t.sb=M,P=m.get(E),g.segmentIndex.yb(P)),D=T[0],t.yc=D.startTime,R=T[T.length-1],t.Ob=R.endTime,bf(c.g,"EXT-X-ENDLIST")&&(t.vd=!0),og(e,c),w(L)}))}function Gf(e,t,n){t.yc+=n,t.Ob+=n;for(var i=l(e=Bf(e,t)),r=i.next();!r.done;r=i.next()){var a=l(r.value);r=a.next().value,a=a.next().value,e.set(r,a+n)}t.ba()}function jf(e,t,n){var i,r,a,o,s,u,h,c,d,p,f,g,m,v,y,b,w,S;return L((function(T){switch(T.g){case 1:if(i=Nf(e.g.hls.mediaPlaylistFullMimeType),!t.segments.length)return T.return(i);if(r=Math.trunc((t.segments.length-1)/2),a=t.segments[r],o=wf(n(),t.segments[0].h),s=o[0],u=new ne(s),h=u.Ya.split(".").pop(),c=bg[h])return T.return(Nf(c));if(d=Ui,p=null,f=ug(e,t,a.g,n),e.W.clear(),!f){T.F(2);break}return g=Li(f.ba(),e.g.retryParameters),_(T,yg(e,g,d,{type:0}),3);case 3:m=T.h,p=m.data;case 2:return v=Li(o,e.g.retryParameters),_(T,yg(e,v,d,{type:1}),4);case 4:if(y=T.h,(b=y.headers["content-type"])&&(b=b.split(";")[0].toLowerCase()),"ts"==h||"video/mp2t"==b){var A=y.data,E=et(A),C=(E=(new no).parse(E)).sd();E=E.Lf();var x=[],I=!1,k=!1;switch(C.audio){case"aac":x.push("mp4a.40.2"),I=!0;break;case"mp3":x.push("mp4a.40.34"),I=!0;break;case"ac3":x.push("ac-3"),I=!0;break;case"ec3":x.push("ec-3"),I=!0}switch(C.video){case"avc":E.wa?x.push(E.wa):x.push("avc1.42E01E"),k=!0;break;case"hvc":E.wa?x.push(E.wa):x.push("hvc1.1.6.L93.90"),k=!0}if(x.length){if(C=I&&!k,I=new Map,k){(k=new at("video/mp2t")).i(A);for(var M=(A=l(k.j())).next();!M.done;M=A.next())M=M.value,I.set(M,M);k.h()}E={type:C?"audio":"video",mimeType:"video/mp2t",codecs:x.join(", "),language:null,height:E.height,width:E.width,channelCount:null,sampleRate:null,closedCaptions:I}}else E=null;if(w=E)return T.return(w)}else if(("mp4"==h||"cmfv"==h||"m4s"==h||"video/mp4"==b||"audio/mp4"==b||"video/iso.segment"==b)&&(S=function(e,t){function n(e){return i(e.name)}function i(e){switch(e=e.toLowerCase()){case"avc1":case"avc3":r.push(e+".42E01E"),o=!0;break;case"hev1":case"hvc1":r.push(e+".1.6.L93.90"),o=!0;break;case"dvh1":case"dvhe":r.push(e+".05.04"),o=!0;break;case"vp09":r.push(e+".00.10.08"),o=!0;break;case"av01":r.push(e+".0.01M.08"),o=!0;break;case"mp4a":r.push("mp4a.40.2"),a=!0;break;case"ac-3":case"ec-3":case"opus":case"flac":r.push(e),a=!0}}var r=[],a=!1,o=!1,s=null,u=null,h=null,c=null,d=null;if((new rr).box("moov",ar).box("trak",ar).T("tkhd",(function(e){e=ja(e.reader,e.version),u=String(e.height),h=String(e.width)})).box("mdia",ar).T("mdhd",(function(e){s=Fa(e.reader,e.version).language})).box("minf",ar).box("stbl",ar).T("stsd",or).box("mp4a",(function(e){var t=e.reader;t.skip(6),t.skip(2),t.skip(8);var i=t.Ua();t.skip(2),t.skip(2),t.skip(2),t=t.Ua()+t.Ua()/65536,c=i,d=t,e.reader.xa()?ar(e):n(e)})).box("esds",(function(e){e=function(e){for(var t,n,i="mp4a";e.xa();){t=e.ra();for(var r=e.ra();128&r;)r=e.ra();if(3==t)e.Ua(),128&(r=e.ra())&&e.Ua(),64&r&&e.skip(e.ra()),32&r&&e.Ua();else if(4==t)n=e.ra(),e.skip(12);else if(5==t)break}return n&&(i+="."+this.g(n),5==t&&e.xa()&&(31==(n=(248&(t=e.ra()))>>3)&&e.xa()&&(n=32+((7&t)<<3)+((224&e.ra())>>5)),i+="."+n)),{wa:i}}(e.reader),r.push(e.wa),a=!0})).box("ac-3",n).box("ec-3",n).box("opus",n).box("Opus",n).box("fLaC",n).box("avc1",(function(e){e=Ha(e.reader,e.name),r.push(e.wa),o=!0})).box("avc3",(function(e){e=Ha(e.reader,e.name),r.push(e.wa),o=!0})).box("hev1",n).box("hvc1",n).box("dvh1",n).box("dvhe",n).box("vp09",n).box("av01",n).box("enca",sr).box("encv",sr).box("sinf",ar).box("frma",(function(e){i(e=Va(e.reader).wa)})).parse(e||t,!0),!r.length)return null;var p=a&&!o,f=new Map;if(o){var g=new at("video/mp4");for(e&&g.init(e),g.i(t),t=(e=l(g.j())).next();!t.done;t=e.next())t=t.value,f.set(t,t);g.h()}return{type:p?"audio":"video",mimeType:p?"audio/mp4":"video/mp4",codecs:Of(r).join(", "),language:s,height:u,width:h,channelCount:c,sampleRate:d,closedCaptions:f}}(p,y.data)))return T.return(S);return T.return(i)}}))}function Hf(e){if(mg(e)){if(e.aa==Ag){var t=function(e){for(var t=1/0,n=1/0,i=(e=l(e.h.values())).next();!i.done;i=e.next())(i=i.value).stream.segmentIndex&&"text"!=i.stream.type&&(t=Math.min(t,i.Ob),n=Math.min(n,i.yc));return t-n}(e);e.g.hls.useSafariBehaviorForLive&&(t=e.l.s),isNaN(e.g.availabilityWindowOverride)||(t=e.g.availabilityWindowOverride),e.l.Ne(t)}if(!e.l.m)for(var n=(t=l(t=Array.from(e.h.values()).filter((function(e){return e.stream.segmentIndex})))).next();!n.done;n=t.next())("audio"==(n=n.value).type||"video"==n.type)&&(n=n.stream.segmentIndex.get(0))&&n.oa&&e.l.og(n.oa)}else e.l.gb(Qf(e));e.l.ve()}function Vf(e,t,n){n=new ne(n).g;for(var i=new Map,r=(t=l(t)).next();!r.done;r=t.next()){var a=r.value,o=pf(a,"NAME"),s=pf(a,"VALUE");r=pf(a,"QUERYPARAM"),a=pf(a,"IMPORT"),o&&s&&(i.has(o)||i.set(o,s)),r&&(o=n.get(r)[0])&&!i.has(o)&&i.set(r,o),a&&(r=e.s.get(a))&&i.set(a,r)}return i}function Wf(e,t,n,i){for(var r={audio:[],video:[]},a=new Map,o=[],s=!1,u=!1,c=l(t),d=c.next();!d.done;d=c.next()){var p=d.value;d=pf(p,"AUDIO");var f=pf(p,"VIDEO"),g=d||f;g&&(o.includes(g)||o.push(g),(p=pf(p,"PATHWAY-ID"))&&a.set(g,p),d?s=!0:f&&(u=!0))}o.length&&n.length&&function(e,t,n){t=t.filter((function(e){var t=pf(e,"URI")||"";return"SUBTITLES"!=pf(e,"TYPE")&&""!=t}));for(var i={},r=(t=l(t)).next();!r.done;r=t.next()){var a=df(r=r.value);i[a]?i[a].push(r):i[a]=[r]}for(var o in i)Zf(e,i[o],n)}(e,c=n.filter((function(e){return o.includes(ff(e,"GROUP-ID"))})),a),c=(a=o.sort().join(","))&&e.J.has(a)?e.J.get(a):[],s?r.audio.push.apply(r.audio,h(c)):u&&r.video.push.apply(r.video,h(c)),d=!1;var m=t.map((function(e){return ff(e,"URI")}));if(u=r.audio.find((function(e){return e&&e.ba().find((function(e){return m.includes(e)}))})),f=Te("video",s=zf(e,t[0])),(g=Te("audio",s))&&!f?(u="audio",d=0<r.audio.length):!r.audio.length&&!r.video.length&&g&&f?(u="video",s=[[f,g].join()]):r.audio.length&&u?(u="audio",d=!0):u=r.video.length&&!r.audio.length?"audio":"video",!d){var v=p=g=f=d=null;!c.length&&(n=n.find((function(e){var t=pf(e,"URI")||"",n=pf(e,"TYPE");return e=ff(e,"GROUP-ID"),"SUBTITLES"!=n&&""==t&&o.includes(e)})))&&(d=pf(n,"LANGUAGE"),f=pf(n,"NAME"),g=Xf(n),Yf(n),p=pf(n,"CHARACTERISTICS"),v=Kf(n)),e=function(e,t,n,i,r,a,o,s,u){for(var h=e.C++,c=[],d=l(t),p=d.next();!p.done;p=d.next()){var f=p.value;p=ff(f,"URI"),f=pf(f,"PATHWAY-ID"),e.j&&f&&cp(e.j,h,f,p),c.push(p)}if(d=c.sort().join(","),e.h.has(d))return e.h.get(d);e:{if(t=pf(t[0],"CLOSED-CAPTIONS"),"video"==i){if(t&&"NONE"!=t){t=e.H.get(t);break e}if(!t&&e.H.size)for(t=l(e.H.keys()).next();!t.done;){t=e.H.get(t.value);break e}}t=null}return i=Jf(e,h,c,n=Se(i,n),i,r,!1,a,o,t,s,!1,u,!1),e.h.set(d,i),i}(e,t,s,u,d,f,g,p,v),a&&(e.stream.groupId=a),c.length||(e.stream.bandwidth=i),r[e.stream.type]=[e]}return r}function zf(e,t){var n=pf(t,"CODECS")||"";e.$=0<n.length,e.$||e.g.hls.disableCodecGuessing||(t=[],e.g.disableVideo||t.push(e.g.hls.defaultVideoCodec),e.g.disableAudio||t.push(e.g.hls.defaultAudioCodec),n=t.join(",")),e=new Set,t=[];for(var i=(n=l(n.split(/\s*,\s*/))).next();!i.done;i=n.next()){var r=Xt(i=i.value);e.has(r)||(t.push(i),e.add(r))}return t}function Xf(e){return(e=pf(e,"CHANNELS"))?parseInt(e.split("/")[0],10):null}function Kf(e){return(e=pf(e,"SAMPLE-RATE"))?parseInt(e,10):null}function Yf(e){return!!(e=pf(e,"CHANNELS"))&&e.includes("/JOC")}function qf(e,t,n,i,r,a,o,s,u,h,c){for(var d=l(n),p=d.next();!p.done;p=d.next())fg(p.value.stream,r,a,o,s,u);for(r=e.g.disableAudio,t.length&&!r||(t=[null]),r=e.g.disableVideo,n.length&&!r||(n=[null]),r=[],a=(t=l(t)).next();!a.done;a=t.next())for(a=a.value,s=(o=l(n)).next();!s.done;s=o.next()){var f=s.value;(s=a?a.stream:null)&&(s.drmInfos=h,s.keyIds=c),(u=f?f.stream:null)&&(u.drmInfos=h,u.keyIds=c),d=a?a.stream.drmInfos:null,p=f?f.stream.drmInfos:null,f=(f=f?f.ba().sort().join(","):"")+" - "+(a?a.ba().sort().join(","):""),s&&u&&!aa(d,p)||e.va.has(f)||(s={id:e.C++,language:s?s.language:"und",disabledUntilTime:0,primary:!!s&&s.primary||!!u&&u.primary,audio:s,video:u,bandwidth:i,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},r.push(s),e.va.add(f))}return r}function Zf(e,t,n){for(var i=[],r=[],a=new Map,o=l(t),s=o.next();!s.done;s=o.next()){var u=s.value;s=ff(u,"URI"),u=ff(u,"GROUP-ID"),i.push(s),r.push(u),a.set(u,s)}if(o=r.sort().join(","),s=t[0],t="","subtitles"==(u=ff(s,"TYPE").toLowerCase())&&(u=Ae),u==Ae)t=pf(s,"CODECS")||"";else for(var h=(r=l(r)).next();!h.done;h=r.next())if(h=h.value,e.I.has(h)){t=e.I.get(h);break}if(r=i.sort().join(","),e.h.has(r))return e.h.get(r);if(h=e.C++,e.j)for(var c=(a=l(a)).next();!c.done;c=a.next()){var d=l(c.value);c=d.next().value,d=d.next().value,(c=n.get(c))&&cp(e.j,h,c,d)}n=pf(s,"LANGUAGE"),a=pf(s,"NAME"),c="YES"==pf(s,"DEFAULT"),d="audio"==u?Xf(s):null;var p="audio"==u&&Yf(s);return(i=Jf(e,h,i,t,u,n,c,a,d,null,pf(s,"CHARACTERISTICS"),"YES"==pf(s,"FORCED"),s="audio"==u?Kf(s):null,p)).stream&&(i.stream.groupId=o),e.J.has(o)?e.J.get(o).push(i):e.J.set(o,[i]),e.h.set(r,i),i}function Jf(e,t,n,i,r,a,o,s,u,h,c,d,p,f){function g(){return e.j&&1<n.length?dp(e.j,t):v.concat(Sf([e.Z],n,e.s))}var m=ig(e,i,r,a,o,s,u,h,c,d,p,f),v=[],y={stream:m,type:r,jh:v,ba:g,yc:0,Ob:0,ye:new Map,ae:!1,$d:!1,vd:!1,pf:-1,rb:-1,sb:-1,Sf:!1},b=null,S=new AbortController;return m.createSegmentIndex=function(){return b||(S=new AbortController,b=new Promise((function(t){t(function(t){var n,b,S,T,A,E,C,x,I,k,M,P,D,R,N,O,U;return L((function(L){switch(L.g){case 1:return n=y.ba(),_(L,gg(e,y.ba(),!0),2);case 2:if(b=L.h,t.aborted)return L.return();if((S=b.uri)==b.originalUri||n.includes(S)||v.push(S),T=If(e.sa,b.data),A=void 0,e.$||!e.g.hls.disableCodecGuessing){L.F(3);break}return _(L,jf(e,T,g),4);case 4:E=L.h,A=E.mimeType,i=E.codecs;case 3:return C=mg(e),_(L,tg(e,0,T,g,S,i,r,a,o,s,u,h,c,d,p,f,A),5);case 5:if(x=L.h,t.aborted)return L.return();if(I=x.stream,mg(e)&&!C&&sg(e,T),y.yc=x.yc,y.Ob=x.Ob,y.ae=x.ae,y.$d=x.$d,y.vd=x.vd,y.ye=x.ye,y.rb=x.rb,y.sb=x.sb,y.Sf=!0,m.segmentIndex=I.segmentIndex,m.encrypted=I.encrypted,m.drmInfos=I.drmInfos,m.keyIds=I.keyIds,m.mimeType=I.mimeType,m.bandwidth=m.bandwidth||I.bandwidth,m.codecs=m.codecs||I.codecs,m.drmInfos.length&&e.i.newDrmInfo(m),r==(k=Ee).ia||r==k.U)for(M=l(e.h.values()),P=M.next();!P.done;P=M.next())(D=P.value).Sf||D.type!=r||(D.stream.mimeType=I.mimeType);r==k.Da&&(R=I.segmentIndex.get(0))&&R.ka&&(m.mimeType="application/mp4"),function(e){if(!e.G)return!1;for(var t=[],n=[],i=(e=l(e.G.variants)).next();!i.done;i=e.next())(i=i.value).video&&t.push(i.video),i.audio&&n.push(i.audio);return!(0<t.length&&!t.some((function(e){return e.segmentIndex}))||0<n.length&&!n.some((function(e){return e.segmentIndex})))}(e)&&(e.Xa?eg(e,[y]):(e.Xa=!0,N=Array.from(e.h.values()),O=N.filter((function(e){return e.stream.segmentIndex})),eg(e,O),Hf(e),0<(U=e.m)&&e.u.S(U))),w(L)}}))}(S.signal))})))},m.closeSegmentIndex=function(){b&&!m.segmentIndex&&S.abort(),m.segmentIndex&&(m.segmentIndex.release(),m.segmentIndex=null),b=null},y}function Qf(e){for(var t=1/0,n=(e=l(e.h.values())).next();!n.done;n=e.next())(n=n.value).stream.segmentIndex&&"text"!=n.stream.type&&(t=Math.min(t,n.Ob));return t}function $f(e,t){for(var n=[],i=(t=l(t)).next();!i.done;i=t.next())(i=i.value).segmentIndex&&as(i.segmentIndex,(function(e){n.push(e)}));e.l.Dd(n)}function eg(e,t){if(!mg(e))for(var n=Qf(e),i=l(t),r=i.next();!r.done;r=i.next())r.value.stream.segmentIndex.Ic(0,n);$f(e,t.map((function(e){return e.stream}))),e.g.hls.ignoreManifestProgramDateTime?function(e,t){for(var n=-1==e.K,i=l(t),r=i.next();!r.done;r=i.next()){var a=(r=r.value).stream.segmentIndex,o=Bf(e,r);if(a=a.g[0]||null)for(var s=(o=l(o)).next();!s.done;s=o.next()){var u=(s=l(s.value)).next().value;if(s.next().value==a.startTime){n&&(e.K=Math.max(e.K,u)),r.pf=u;break}}}if(!(0>e.K))for(r=(t=l(t)).next();!r.done;r=t.next())(i=(n=r.value).stream.segmentIndex)&&(i.g.splice(0,e.K-n.pf),(i=i.g[0]||null)&&(i=-i.startTime,n.stream.segmentIndex.offset(i),Gf(e,n,i)))}(e,t):function(e,t){if(1/0==e.V)for(var n=(t=l(t)).next();!n.done;n=t.next()){var i=n.value.stream.segmentIndex.g[0]||null;null!=i&&null!=i.oa&&(e.V=Math.min(e.V,i.oa))}if(1/0!=(t=e.V))for(n=(i=l(e.h.values())).next();!n.done;n=i.next()){var r=(n=n.value).stream.segmentIndex;if(null!=r){var a=r.g[0]||null;if(null==a.oa)z("Missing EXT-X-PROGRAM-DATE-TIME for stream",n.ba(),"Expect AV sync issues!");else for(Gf(e,n,a.oa-t-a.startTime),r=(n=l(r)).next();!r.done;r=n.next())r.value.sg(t)}}}(e,t)}function tg(e,t,n,i,r,a,o,s,u,l,h,c,d,p,f,g,m){var v,y,b,w,T,C,x,I,k,M,P,D,R,N,O,U,B,F,G,j,H,V,W;return L((function(t){if(1==t.g){if(1!=n.type)throw new ye(2,4,4017);v=vf(n.g,"EXT-X-DEFINE"),y=Vf(e,v,r);var z=bf(n.g,"EXT-X-PLAYLIST-TYPE"),X=bf(n.g,"EXT-X-ENDLIST");return X=z&&"VOD"==z.value||X,z=z&&"EVENT"==z.value&&!X,z=!X&&!z,vg(e,X?Sg:z?Ag:Tg),mg(e)&&og(e,n),m?t.F(2):_(t,function(e,t,n,i,r,a){var o,s,u,l,h,c,d,p,f,g,m,v,y;return L((function(b){switch(b.g){case 1:return o=Ui,s=Math.trunc((i.segments.length-1)/2),u=wf(a(),i.segments[s].h,r),l=new ne(u[0]),h=l.Ya.split(".").pop(),c=_g[t],(d=c[h])||(d=bg[h])||(d=dg(t,n))?b.return(d):(f=1,g=Li(u,e.g.retryParameters),S(b,2),g.method="HEAD",_(b,yg(e,g,o,{type:f}),4));case 4:m=b.h,p=m.headers["content-type"],A(b,3);break;case 2:if(!(v=E(b))||1002!=v.code&&1001!=v.code){b.F(3);break}return g.method="GET",_(b,yg(e,g,o,{type:f}),6);case 6:y=b.h,p=y.headers["content-type"];case 3:return p?b.return(p.split(";")[0]):b.return(pg(t))}}))}(e,o,a,n,y,i),3)}if(2!=t.g&&(m=t.h),b=rg(n,m),w=b.drmInfos,T=b.keyIds,C=b.encrypted,x=b.Jh,C&&!w.length&&!x)throw new ye(2,4,4026);return(I=ig(e,a,o,s,u,l,h,c,d,p,f,g)).encrypted=C,I.drmInfos=w,I.keyIds=T,I.mimeType=m,k=mg(e)?e.L.get(o):new Map,M=cg(e,n,I,k,y,i),P=M.segments,(D=M.bandwidth)&&(I.bandwidth=D),mg(e)&&og(e,n),R=P[0].startTime,N=P[P.length-1],O=N.endTime,U=new rs(P),I.segmentIndex=U,F=!!(B=bf(n.g,"EXT-X-SERVER-CONTROL"))&&null!=B.getAttribute("CAN-SKIP-UNTIL"),G=!!B&&null!=B.getAttribute("CAN-BLOCK-RELOAD"),j=_f(n.g,"EXT-X-MEDIA-SEQUENCE",0),H=ng(j,P),V=H.rb,W=H.sb,t.return({stream:I,type:o,jh:[],ba:i,yc:R,Ob:O,ae:F,$d:G,vd:!1,pf:-1,rb:V,sb:W,ye:k,Sf:!1})}))}function ng(e,t){e=e+t.length-1;var n=-1;if(!t.length)return{rb:++e,sb:n};var i=(t=t[t.length-1]).g;return t.g.length?(n=i.length-1,i[i.length-1].l||(e++,n=0),{rb:e,sb:n}):(e++,t.m&&(n=0),{rb:e,sb:n})}function ig(e,t,n,i,r,a,o,s,u,h,c,d){var p=dg(n,t)||pg(n),f=[];if(u)for(var g=(u=l(u.split(","))).next();!g.done;g=u.next())f.push(g.value);return u=void 0,g=null,n==Ae?u=f.includes("public.accessibility.transcribes-spoken-dialog")&&f.includes("public.accessibility.describes-music-and-sound")?"caption":"subtitle":f.includes("public.accessibility.describes-video")&&(g="visually impaired"),f.length||"subtitle"!==u||f.push("subtitle"),{id:e.C++,originalId:a,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:p,codecs:t,kind:n==Ae?"subtitle":void 0,encrypted:!1,drmInfos:[],keyIds:new Set,language:Pe(i||"und"),originalLanguage:i,label:a,type:n,primary:r,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:f,forced:h,channelsCount:o,audioSamplingRate:c,spatialAudio:d,closedCaptions:s,hdr:void 0,videoLayout:void 0,tilesLayout:void 0,accessibilityPurpose:g,external:!1,fastSwitching:!1}}function rg(e,t){var n=[];if(e.segments)for(var i=(e=l(e.segments)).next();!i.done;i=e.next())i=vf(i.value.g,"EXT-X-KEY"),n.push.apply(n,h(i));i=e=!1;for(var r=[],a=new Set,o=(n=l(n)).next();!o.done;o=n.next()){var s=ff(o=o.value,"METHOD");if("NONE"!=s)if(e=!0,"AES-128"==s)i=!0;else if(s=pf(o,"KEYFORMAT")||"identity",o=(s=wg[s])?s(o,t):null){if(o.keyIds)for(var u=(s=l(o.keyIds)).next();!u.done;u=s.next())a.add(u.value);r.push(o)}}return{drmInfos:r,keyIds:a,encrypted:e,Jh:i}}function ag(t,n,i,r,a){if(!e.crypto||!e.crypto.subtle)throw X("Web Crypto API is not available to decrypt AES-128. (Web Crypto only exists in secure origins like https)"),new ye(2,4,4042);var o=0,s=pf(n,"IV","");if(s){var u=yr(s.substr(2));if(16!=u.byteLength)throw new ye(2,4,4048)}else o=_f(i.g,"EXT-X-MEDIA-SEQUENCE",0);var l={method:"AES-128",iv:u,firstMediaSequenceNumber:o,fetchKey:function(){var i,o,s,u,h;return L((function(c){if(1==c.g)return i=wf(r(),ff(n,"URI"),a),o=Li(i,t.g.retryParameters),_(c,yg(t,o,6),2);if(3!=c.g){if(!(s=c.h).data||16!=s.data.byteLength)throw new ye(2,4,4049);return u={name:"AES-CBC"},h=l,_(c,e.crypto.subtle.importKey("raw",s.data,u,!0,["decrypt"]),3)}h.cryptoKey=c.h,l.fetchKey=void 0,w(c)}))}};return l}function og(e,t){var n=1/0,i=t.segments;if(i.length)for(var r=i.length-1;0<=r;){var a=bf(i[r].g,"EXTINF");if(a){n=Number(a.value.split(",")[0]);break}r--}if(!(i=bf(t.g,"EXT-X-TARGETDURATION")))throw new ye(2,4,4024,"EXT-X-TARGETDURATION");i=Number(i.value),(r=bf(t.g,"EXT-X-PART-INF"))&&(e.M=Number(ff(r,"PART-TARGET"))),t=bf(t.g,"EXT-X-SERVER-CONTROL"),e.D&&e.M?(e.m=e.Wa?5*e.M<=n?Math.min(e.M,e.m):Math.min(n,e.m):Math.min(e.M,e.m),e.ha=t?Number(ff(t,"PART-HOLD-BACK")):0):(e.m=Math.min(n,e.m),n=t?t.getAttribute("HOLD-BACK"):null,e.Aa=n?Number(n.value):0),e.ua=Math.max(i,e.ua)}function sg(e,t){if(e.g.defaultPresentationDelay)t=e.g.defaultPresentationDelay;else if(e.ha)t=e.ha;else if(e.Aa)t=e.Aa;else{t=t.segments.length;var n=e.g.hls.liveSegmentsDelay;n>t-2&&(n=Math.max(1,t-2)),t=e.ua*n}e.l.og(0),e.l.oh(t),e.l.Vc(!1)}function ug(e,t,n,i,r){var a=bf(n,"EXT-X-MAP");if(!a)return null;var o=ff(a,"URI"),s=wf(i(),o,r);if(o=[s.toString(),pf(a,"BYTERANGE","")].join("-"),!e.W.has(o)){for(var u=void 0,h=null,c=(n=l(n)).next();!c.done;c=n.next())"EXT-X-KEY"==(c=c.value).name?"AES-128"==ff(c,"METHOD")&&c.id<a.id&&(u=ag(e,c,t,i,r)):"EXT-X-BYTERANGE"==c.name&&c.id<a.id&&(h=c);t=function(e,t,n,i){var r=0,a=null;return!(t=pf(t,"BYTERANGE"))&&n&&(t=n.value),t&&(r=t.split("@"),a=Number(r[0]),a=(r=Number(r[1]))+a-1,i&&((n=a+1-r)%16&&(a+=16-n%16))),new wa((function(){return e}),r,a,null,null,null,i)}(s,a,h,u),e.W.set(o,t)}return e.W.get(o)}function lg(t,n,i,r,a,o,s,u,h){var c=r.g,d=bf(c,"EXTINF"),p=0,f=0,g=null;r.Bb.length&&!t.D&&X("Low-latency HLS live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details.");var m=null;if(!t.g.hls.ignoreManifestProgramDateTime){var v=bf(c,"EXT-X-PROGRAM-DATE-TIME");v&&v.value&&(m=Lr(v.value))}var y=Aa;if(bf(c,"EXT-X-GAP")&&(y=2),!d){if(0==r.Bb.length)throw new ye(2,4,4024,"EXTINF");if(!t.D)return null}var b=[];v=!1;var _=null,w=!1,S=!1;if(t.D&&r.Bb.length){p=("video/mp4"==s.mimeType||"audio/mp4"==s.mimeType)&&e.ReadableStream&&t.g.hls.allowLowLatencyByteRangeOptimization;for(var T=m,A={},E=0;E<r.Bb.length;A={hd:A.hd,Ud:A.Ud},E++){var C=r.Bb[E],x=0==E?i:b[b.length-1],I=0==E?a:x.endTime,k=Number(pf(C,"DURATION"))||t.M;if(k){var M=I+k,P=0,L=null;if("EXT-X-PRELOAD-HINT"==C.name?(P=(P=pf(C,"BYTERANGE-START"))?Number(P):0,(x=pf(C,"BYTERANGE-LENGTH"))?L=P+Number(x)-1:P&&(L=Number.MAX_SAFE_INTEGER)):(P=(L=l(hg(x,P=pf(C,"BYTERANGE")))).next().value,L=L.next().value),A.Ud=pf(C,"URI"),A.Ud){x=Aa,"YES"==pf(C,"GAP")&&(x=2,w=!0),A.hd=null;var D=function(e){return function(){return null==e.hd&&(e.hd=wf(u(),e.Ud,o)),e.hd}}(A);p&&0<=P&&null!=L&&(_=D,v=!0),I=new Ta(I,M,D,P,L,n,0,0,1/0,[],"",null,T,x,h),"EXT-X-PRELOAD-HINT"==C.name&&(I.Tf(),S=!0),"YES"!=pf(C,"INDEPENDENT")&&0<E&&I.xe(),b.push(I),T&&(T+=k)}}}}if(d){if(0==(d=Number(d.value.split(",")[0])))return null;p=a+d}else{if(!b.length)return null;p=b[b.length-1].endTime}v&&(w||0!=b[0].hb?(v=!1,_=null):b=[]),(d=bf(c,"EXT-X-BYTERANGE"))?(f=(g=l(hg(i,d.value))).next().value,g=g.next().value):b.length&&(f=b[0].hb,g=b[b.length-1].Na),i="",d=null,"image"==s.type&&(i="1x1",s=bf(c,"EXT-X-TILES"))&&(i=ff(s,"LAYOUT"),(s=pf(s,"DURATION"))&&(d=Number(s)));var R=null;return n=new Ta(a,p,(function(){return _?_():(null==R&&(R=wf(u(),r.h,o)),R||[])}),f,g,n,0,0,1/0,b,i,d,m,y,h,0<b.length&&!!r.h),v&&(t.Wa=!0,n.bh(),S&&n.Tf()),n}function hg(e,t){var n=0,i=null;return t&&(n=t.split("@"),t=Number(n[0]),i=(n=n[1]?Number(n[1]):e.Na+1)+t-1),[n,i]}function cg(e,t,n,i,r,a){var o=t.segments,s=void 0,u=_f(t.g,"EXT-X-DISCONTINUITY-SEQUENCE",0),h=_f(t.g,"EXT-X-MEDIA-SEQUENCE",0),c=bf(t.g,"EXT-X-SKIP"),d=c?Number(pf(c,"SKIPPED-SEGMENTS")):0,p=h+d,f=0;mg(e)&&i.has(p)&&(f=i.get(p)),0===f&&e.aa==Ag&&0<i.size&&!i.has(p)&&(f=e.l.Ab());var g=[],m=null;c=[];for(var v=0;v<o.length;v++){var y=o[v],b=0==v?f:m.endTime;p=h+d+v,bf(y.g,"EXT-X-DISCONTINUITY")&&u++;for(var _=l(y.g),w=_.next();!w.done;w=_.next())"EXT-X-KEY"==(w=w.value).name&&(s="AES-128"==ff(w,"METHOD")?ag(e,w,t,a,r):void 0);i.set(p,b),_=ug(e,t,y.g,a,r),!e.D&&e.i.isAutoLowLatencyMode()&&(e.i.enableLowLatencyMode(),e.D=e.i.isLowLatencyMode()),(b=lg(e,_,m,y,b,r,n,a,s))&&((m=_f(y.g,"EXT-X-BITRATE"))?c.push({bitrate:m,duration:b.endTime-b.startTime}):c.length&&((m=c.pop()).duration+=b.endTime-b.startTime,c.push(m)),m=b,b.i=u,e.g.hls.ignoreManifestProgramDateTime&&null!=e.K&&p<e.K||g.push(b))}if(t=void 0,c.length&&(t=c.reduce((function(e,t){return e+t.duration}),0),t=Math.round(c.reduce((function(e,t){return e+t.bitrate*t.duration}),0)/t*1e3)),c=g.some((function(e){return null!=e.oa})))for(n={},i=0;i<g.length;n={Zc:n.Zc,Yc:n.Yc,Qd:n.Qd,Tb:n.Tb,Xc:n.Xc},i++)if(n.Tb=g[i],null==n.Tb.oa)for(n.Yc=0,n.Zc=i,r=function(e){return function(){var t=g[e.Zc];if(t){if(null!=t.oa)return t.oa+e.Yc;e.Yc-=t.endTime-t.startTime,e.Zc+=1}return null}}(n),n.Xc=0,n.Qd=i,a=function(e){return function(){var t=g[e.Qd];if(t){if(t!=e.Tb&&(e.Xc+=t.endTime-t.startTime),null!=t.oa)return t.oa+e.Xc;--e.Qd}return null}}(n);null==n.Tb.oa;)n.Tb.oa=a(),null==n.Tb.oa&&(n.Tb.oa=r());if(c)for(i=(n=l(g)).next();!i.done;i=n.next())for(i=(r=i.value).oa,a=(r=l(r.g)).next();!a.done;a=r.next())(a=a.value).oa=i,i+=a.endTime-a.startTime;if(e=e.V,c&&1/0!=e)for(i=(c=l(g)).next();!i.done;i=c.next())i.value.sg(e);return{segments:g,bandwidth:t}}function dg(e,t){if(e==Ae){if("vtt"==t||"wvtt"==t)return"text/vtt";if(t&&""!==t)return"application/mp4"}return"image"!=e||t&&"jpeg"!=t?"audio"==e&&"mp4a.40.34"==t?"audio/mpeg":"mjpg"==t?"application/mp4":null:"image/jpeg"}function pg(e){return e==Ae?"text/vtt":_g[e].mp4}function fg(e,t,n,i,r,a){e&&(e.width=Number(t)||void 0,e.height=Number(n)||void 0,e.frameRate=Number(i)||void 0,e.hdr=r||void 0,e.videoLayout=a||void 0)}function gg(e,t,n){return yg(e,Li(t,e.g.retryParameters),0,{type:n?2:3})}function mg(e){return e.aa!=Sg}function vg(e,t){e.aa=t,e.l&&e.l.Vc(!mg(e)),mg(e)||e.u.stop()}function yg(e,t,n,i){if(!e.N)throw new ye(2,7,7001);return t=e.i.networkingEngine.request(n,t,i),ki(e.N,t),t.promise}G("shaka.net.DataUriPlugin",Lf),Lf.parse=Df,Pi("data",Df),(i=Uf.prototype).configure=function(e){this.g=e,this.j&&this.j.configure(this.g)},i.start=function(e,t){var n,i=this;return L((function(r){return 1==r.g?(i.i=t,i.D=t.isLowLatencyMode(),_(r,gg(i,[e]),2)):3!=r.g?(n=r.h,i.Z=n.uri,_(r,function(e,t,n){var i,r,a,o,s,u,c,d,p,f,g,m,v,y,b,T,A,C,x,I,k,M,P,D,R,N,O,U,B,F;return L((function(G){switch(G.g){case 1:return i=If(e.sa,t),r=vf(i.g,"EXT-X-DEFINE"),a=[],o=[],s=[],1==i.type?_(G,jf(e,i,v=function(){return[n]}),6):(function(e,t){for(var n=new ne(e.Z).g,i=(t=l(t)).next();!i.done;i=t.next()){var r=i.value;i=pf(r,"NAME");var a=pf(r,"VALUE");r=pf(r,"QUERYPARAM"),i&&a&&(e.s.has(i)||e.s.set(i,a)),r&&(i=n.get(r)[0])&&!e.s.has(i)&&e.s.set(r,i)}}(e,r),u=vf(i.g,"EXT-X-MEDIA"),c=vf(i.g,"EXT-X-STREAM-INF"),d=vf(i.g,"EXT-X-IMAGE-STREAM-INF"),p=vf(i.g,"EXT-X-I-FRAME-STREAM-INF"),f=vf(i.g,"EXT-X-SESSION-KEY"),g=vf(i.g,"EXT-X-SESSION-DATA"),m=vf(i.g,"EXT-X-CONTENT-STEERING"),function(e,t){for(var n=(t=l(t)).next();!n.done;n=t.next()){var i=n.value,r=pf(i,"DATA-ID");n=pf(i,"URI");var a=pf(i,"LANGUAGE");i=pf(i,"VALUE"),r=(new Map).set("id",r),n&&r.set("uri",wf([e.Z],n,e.s)[0]),a&&r.set("language",a),i&&r.set("value",i),n=new j("sessiondata",r),e.i&&e.i.onEvent(n)}}(e,g),_(G,function(e,t){var n,i,r,a,o,s;return L((function(u){if(!e.i||!e.g)return u.return();for(i=l(t),r=i.next();!r.done;r=i.next())if(a=r.value,o=pf(a,"PATHWAY-ID"),s=pf(a,"SERVER-URI"),o&&s){e.j=new up(e.i),e.j.configure(e.g),e.j.j=[e.Z],e.j.setManifestType("HLS"),e.j.h=o,n=lp(e.j,s);break}return _(u,n,0)}))}(e,m),4));case 4:return function(e,t){for(var n=(t=l(t)).next();!n.done;n=t.next()){var i=n.value,r=pf(i,"AUDIO");n=pf(i,"VIDEO");var a=pf(i,"SUBTITLES");if(i=zf(e,i),a){var o=Te(Ae,i);e.I.set(a,o),lt(i,o)}r&&((a=Te("audio",i))||(a=e.g.hls.defaultAudioCodec),e.I.set(r,a)),n&&((r=Te("video",i))||(r=e.g.hls.defaultVideoCodec),e.I.set(n,r))}}(e,c),function(e,t){for(var n=(t=l(t=yf(t,"CLOSED-CAPTIONS"))).next();!n.done;n=t.next()){var i=n.value,r=pf(i,"LANGUAGE");n=Pe(r||"und"),r||(r=pf(i,"NAME"))&&(n=r),r=ff(i,"GROUP-ID"),i=ff(i,"INSTREAM-ID").replace("SERVICE","svc"),e.H.get(r)||e.H.set(r,new Map),e.H.get(r).set(i,n)}}(e,u),a=function(e,t,n,i){var r=[],a=new Set;if(0<n.length)for(var o=(n=l(n)).next();!o.done;o=n.next()){var s=ff(o=o.value,"METHOD");if("NONE"!=s&&"AES-128"!=s&&(s=pf(o,"KEYFORMAT")||"identity",o=(s=wg[s])?s(o,""):null)){if(o.keyIds)for(var u=(s=l(o.keyIds)).next();!u.done;u=s.next())a.add(u.value);r.push(o)}}for(n={},o=(t=l(t)).next();!o.done;o=t.next())n[s=df(o=o.value)]?n[s].push(o):n[s]=[o];for(var c in t=[],n){var d=(u=n[c])[0];o=pf(d,"FRAME-RATE"),s=Number(pf(d,"AVERAGE-BANDWIDTH"))||Number(ff(d,"BANDWIDTH"));var p=pf(d,"RESOLUTION"),f=l(p?p.split("x"):[null,null]);p=f.next().value,f=f.next().value;var g=pf(d,"VIDEO-RANGE");(d=pf(d,"REQ-VIDEO-LAYOUT"))&&d.includes(",")&&(d=d.split(",").filter((function(e){return"CH-STEREO"==e||"CH-MONO"==e}))[0]),d=d||"CH-MONO",u=Wf(e,u,i,s),t.push.apply(t,h(qf(e,u.audio,u.video,s,p,f,o,g,d,r,a)))}return t.filter((function(e){return null!=e}))}(e,c,f,u),o=function(e,t){var n=yf(t,"SUBTITLES");t=n.map((function(t){if(e.g.disableText)return null;try{return Zf(e,[t],new Map).stream}catch(t){if(e.g.hls.ignoreTextStreamFailures)return null;throw t}}));for(var i=(n=l(n)).next();!i.done;i=n.next()){var r=ff(i.value,"GROUP-ID");if((i=e.I.get(r))&&(r=e.J.get(r)))for(var a=(r=l(r)).next();!a.done;a=r.next())(a=a.value).stream.codecs=i,a.stream.mimeType=dg(Ae,i)||pg(Ae)}return t.filter((function(e){return e}))}(e,u),_(G,function(e,t,n){var i,r;return L((function(a){return 1==a.g?(i=t.map((function(t){var n,i;return L((function(r){if(1==r.g)return e.g.disableThumbnails?r.return(null):(S(r,2),_(r,function(e,t){var n,i,r,a,o,s,u,l,h,c;return L((function(d){return 1==d.g?(n=ff(t,"URI"),i=pf(t,"CODECS","jpeg")||"",e.h.has(n)?d.return(e.h.get(n)):(r=pf(t,"LANGUAGE"),a=pf(t,"NAME"),o=pf(t,"CHARACTERISTICS"),s=Jf(e,e.C++,[n],i,"image",r,!1,a,null,null,o,!1,null,!1),(u=pf(t,"RESOLUTION"))?_(d,s.stream.createSegmentIndex(),3):d.F(2))):(2!=d.g&&(l=s.stream.segmentIndex.get(0),h=l.tilesLayout)&&(s.stream.width=Number(u.split("x")[0])*Number(h.split("x")[0]),s.stream.height=Number(u.split("x")[1])*Number(h.split("x")[1])),(c=pf(t,"BANDWIDTH"))&&(s.stream.bandwidth=Number(c)),e.h.set(n,s),d.return(s))}))}(e,t),4));if(2!=r.g)return n=r.h,r.return(n.stream);if(i=E(r),e.g.hls.ignoreImageStreamFailures)return r.return(null);throw i}))})).concat(n.map((function(t){if(e.g.disableThumbnails)return null;try{var n=ff(t,"URI"),i=pf(t,"CODECS")||"";if(e.h.has(n))var r=e.h.get(n);else{var a=pf(t,"LANGUAGE"),o=pf(t,"NAME"),s=pf(t,"CHARACTERISTICS"),u=Jf(e,e.C++,[n],i,"image",a,!1,o,null,null,s,!1,null,!1),h=pf(t,"RESOLUTION"),c=l(h?h.split("x"):[null,null]),d=c.next().value,p=c.next().value;u.stream.width=Number(d)||void 0,u.stream.height=Number(p)||void 0;var f=pf(t,"BANDWIDTH");f&&(u.stream.bandwidth=Number(f)),e.h.set(n,u),r=u}return"mjpg"!==(t=r).stream.codecs?null:t.stream}catch(t){if(e.g.hls.ignoreImageStreamFailures)return null;throw t}}))),_(a,Promise.all(i),2)):(r=a.h,a.return(r.filter((function(e){return e}))))}))}(e,d,p),5);case 5:s=G.h,G.F(3);break;case 6:return y=G.h,b=y.type,T=y.mimeType,A=y.codecs,C=y.language,x=y.height,I=y.width,k=y.channelCount,M=y.sampleRate,P=y.closedCaptions,_(G,tg(e,e.C++,i,v,n,A,b,C,!0,"Media Playlist",k,P,null,!1,M,!1,T),7);case 7:D=G.h,e.h.set(n,D),"video"==b&&fg(D.stream,I,x,null,null,null),a.push({id:0,language:Pe(C||"und"),disabledUntilTime:0,primary:!0,audio:"audio"==b?D.stream:null,video:"video"==b?D.stream:null,bandwidth:D.stream.bandwidth||0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});case 3:if(!e.i)throw new ye(2,7,7001);if(e.l=new Bo(null,0),e.l.Vc(!0),1==i.type&&(mg(e)&&(sg(e,i),R=e.m,e.u.S(R)),N=Array.from(e.h.values()),eg(e,N),Hf(e)),e.G={presentationTimeline:e.l,variants:a,textStreams:o,imageStreams:s,offlineSessionIds:[],minBufferTime:0,sequenceMode:e.g.hls.sequenceMode,ignoreManifestTimestampsInSegmentsMode:e.g.hls.ignoreManifestTimestampsInSegmentsMode,type:"HLS",serviceDescription:null},e.$||!e.g.hls.disableCodecGuessing){G.F(8);break}for(O=[],U=l(e.G.variants),B=U.next();!B.done;B=U.next())(F=B.value).audio&&""===F.audio.codecs&&O.push(F.audio.createSegmentIndex()),F.video&&""===F.video.codecs&&O.push(F.video.createSegmentIndex());return _(G,Promise.all(O),8);case 8:e.i.makeTextStreamsForClosedCaptions(e.G),w(G)}}))}(i,n.data,e),3)):r.return(i.G)}))},i.stop=function(){this.u&&(this.u.stop(),this.u=null);var e=[];return this.N&&(e.push(this.N.destroy()),this.N=null),this.g=this.i=null,this.va.clear(),this.G=null,this.h.clear(),this.J.clear(),this.I.clear(),this.s.clear(),this.W.clear(),this.j&&this.j.destroy(),Promise.all(e)},i.update=function(){var e,t,n,i,r,a,o,s,u=this;return L((function(c){if(1==c.g){if(!mg(u))return c.return();for(e=[],t=Array.from(u.h.values()),u.m=1/0,n=t.filter((function(e){return e.stream.segmentIndex})),i=l(n),r=i.next();!r.done;r=i.next())a=r.value,e.push(Ff(u,a));return _(c,Promise.all(e),2)}$f(u,n.map((function(e){return e.stream}))),o=n.some((function(e){return 0==e.vd})),n.length&&!o&&(vg(u,Eg.Fh),s=n.map((function(e){return e.Ob})),u.l.gb(Math.min.apply(Math,h(s))),u.i.updateDuration()),o&&Hf(u),w(c)}))},i.onExpirationUpdated=function(){},i.onInitialVariantChosen=function(){},i.banLocation=function(e){this.j&&this.j.i.set(e,Date.now()+6e4)},G("shaka.hls.HlsParser",Uf);var bg={aac:"audio/aac",ac3:"audio/ac3",ec3:"audio/ec3",mp3:"audio/mpeg"},_g={audio:{mp4:"audio/mp4",mp4a:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",m4f:"audio/mp4",cmfa:"audio/mp4",ts:"video/mp2t",tsa:"video/mp2t"},video:{mp4:"video/mp4",mp4v:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",m4f:"video/mp4",cmfv:"video/mp4",ts:"video/mp2t",tsv:"video/mp2t"},text:{mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",m4f:"application/mp4",cmft:"application/mp4",vtt:"text/vtt",webvtt:"text/vtt",ttml:"application/ttml+xml"},image:{jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml",webp:"image/webp",avif:"image/avif"}},wg={"com.apple.streamingkeydelivery":function(t,n){if("video/mp2t"==n)throw new ye(2,4,4040);if(e.shakaMediaKeysPolyfill)throw new ye(2,4,4041);return we("com.apple.fps",[{initDataType:"sinf",initData:new Uint8Array(0),keyId:null}])},"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(e){var t=ff(e,"METHOD");return["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t)?(t=we("com.widevine.alpha",[{initDataType:"cenc",initData:t=et((t=Rf(t=ff(e,"URI"))).data)}]),(e=pf(e,"KEYID"))&&(t.keyIds=new Set([e.toLowerCase().substr(2)])),t):null},"com.microsoft.playready":function(e){var t=ff(e,"METHOD");return["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t)?we("com.microsoft.playready",[{initDataType:"cenc",initData:e=Sr(e=et((e=Rf(e=ff(e,"URI"))).data),t=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),new Set,0)}]):null},identity:function(e){return e=ff(e,"METHOD"),["SAMPLE-AES","SAMPLE-AES-CTR"].includes(e)?we("org.w3.clearkey",null):null}},Sg="VOD",Tg="EVENT",Ag="LIVE",Eg={Fh:Sg,Hj:Tg,Pj:Ag};function Cg(e){if(e=xg(e))e:{for(var t=(e=l(e.getElementsByTagName("DATA"))).next();!t.done;t=e.next())if(t=Tr(t.value,"LA_URL")){e=t.textContent;break e}e=""}else e="";return e}function xg(e){return(e=function(e){var t=0,n=nt(e),i=n.getUint32(t,!0);if(i!=e.byteLength)return[];e:{for(e=t+6,t=[];e<n.byteLength-1;){i=n.getUint16(e,!0),e+=2;var r=n.getUint16(e,!0);if(e+=2,0!=(1&r)||r+e>n.byteLength){n=[];break e}var a=et(n,e,r);t.push({type:i,value:a}),e+=r}n=t}return n}(e=vr(e.textContent)).filter((function(e){return e.type===Ig}))[0])&&(e=jr(e=Zi(e.value,!0),"WRMHEADER"))?e:null}va["application/x-mpegurl"]=function(){return new Uf},va["application/vnd.apple.mpegurl"]=function(){return new Uf};var Ig=1,kg=(new Map).set("com.microsoft.playready",Cg).set("com.microsoft.playready.recommendation",Cg).set("com.microsoft.playready.software",Cg).set("com.microsoft.playready.hardware",Cg);function Mg(e){if(!jg){jg=!0;var t=new Uint8Array([105,115,111,109]),n=new Uint8Array([97,118,99,49]),i=new Uint8Array([0,0,0,1]);$g=Gg("ftyp",t,i,t,n),t=Gg("dref",em),tm=Gg("dinf",t)}this.g=e}function Pg(e){for(var t=[],n=l(e.g),i=n.next();!i.done;i=n.next()){var r=t,a=r.push,o=i.value;i=Gg;var s=o.id+1,u=o.stream.width||0,c=o.stream.height||0;"audio"==o.type&&(c=u=0);var d=o.duration*o.timescale,p=Math.floor(d/(Hg+1));switch(d=Math.floor(d%(Hg+1)),s=Gg("tkhd",s=new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(h(Bg(s,4)),[0,0,0,0],h(Bg(p,4)),h(Bg(d,4)),[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0],h(Bg(u,2)),[0,0],h(Bg(c,2)),[0,0]))),u=Gg,p=o.duration*o.timescale,c=Math.floor(p/(Hg+1)),p=Math.floor(p%(Hg+1)),d=(d=o.stream.language).charCodeAt(0)-96<<10|d.charCodeAt(1)-96<<5|d.charCodeAt(2)-96,c=Gg("mdhd",c=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(h(Bg(o.timescale,4)),h(Bg(c,4)),h(Bg(p,4)),h(Bg(d,2)),[0,0]))),p=o,d=new Uint8Array([]),p.type){case"video":d=Wg;break;case"audio":d=zg}p=Gg("hdlr",d);e:{switch(o.type){case"video":o=Gg("minf",Gg("vmhd",Zg),tm,Lg(o));break e;case"audio":o=Gg("minf",Gg("smhd",Jg),tm,Lg(o));break e}o=new Uint8Array([])}i=i("trak",s,o=u("mdia",c,p,o)),a.call(r,i)}for(t=_r.apply(fr,h(t)),n=Gg,i=(a=e.g[0]).duration*a.timescale,r=Math.floor(i/(Hg+1)),i=Math.floor(i%(Hg+1)),r=Gg("mvhd",r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(h(Bg(a.timescale,4)),h(Bg(r,4)),h(Bg(i,4)),[0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))),i=[],u=(e=l(e.g)).next();!u.done;u=e.next())s=(o=i).push,u=Gg("trex",u=new Uint8Array([0,0,0,0].concat(h(Bg(u.value.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))),s.call(o,u);if(e=Gg("mvex",e=_r.apply(fr,h(i))),i=[],a.encrypted){for(o=(a=l(a.stream.drmInfos)).next();!o.done;o=a.next())if((o=o.value).initData)for(s=(o=l(o.initData)).next();!s.done;s=o.next())i.push(s.value.initData);a=_r.apply(fr,h(i))}else a=new Uint8Array([]);return e=n("moov",r,t,e,a),(t=new Uint8Array($g.byteLength+e.byteLength)).set($g),t.set(e,$g.byteLength),t}function Lg(e){var t=Gg,n=new Uint8Array([]);switch(e.type){case"video":if(e.codecs.includes("avc1")){n=e.stream.width||0;var i=e.stream.height||0;if(0<e.Ca.byteLength)var r=Gg("avcC",e.Ca);else{r=Gg;for(var a=7,o=[],s=[],u=0,l=0,c=0,d=0;d<e.ib.length;d++){var p=Fg(e.ib[d]);switch(31&p[0]){case 7:o.push(p),a+=p.length+2;break;case 8:s.push(p),a+=p.length+2}}for(0<o.length&&(u=o[0][1],c=o[0][2],l=o[0][3]),d=0,(a=new Uint8Array(a))[d++]=1,a[d++]=u,a[d++]=c,a[d++]=l,a[d++]=255,a[d++]=224|o.length,u=0;u<o.length;u++)a[d++]=(65280&o[u].length)>>8,a[d++]=255&o[u].length,a.set(o[u],d),d+=o[u].length;for(a[d++]=s.length,o=0;o<s.length;o++)a[d++]=(65280&s[o].length)>>8,a[d++]=255&s[o].length,a.set(s[o],d),d+=s[o].length;r=r("avcC",a)}n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat(h(Bg(n,2)),h(Bg(i,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),i="avc1",s=Dg(e),o=new Uint8Array([]),e.encrypted&&(o=Ng(e),i="encv"),n=Gg(i,n,r,s,o)}else e.codecs.includes("hvc1")&&(i=e.stream.width||0,r=e.stream.height||0,n=new Uint8Array([]),0<e.Ca.byteLength&&(n=Gg("hvcC",e.Ca)),i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat(h(Bg(i,2)),h(Bg(r,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),r="hvc1",s=Dg(e),o=new Uint8Array([]),e.encrypted&&(o=Ng(e),r="encv"),n=Gg(r,i,n,s,o));break;case"audio":e.codecs.includes("mp3")?e=Gg(".mp3",Rg(e)):e.codecs.includes("ac-3")?(n=Gg("dac3",e.qa),i="ac-3",r=new Uint8Array([]),e.encrypted&&(r=Ng(e),i="enca"),e=Gg(i,Rg(e),n,r)):e.codecs.includes("ec-3")?(n=Gg("dec3",e.qa),i="ec-3",r=new Uint8Array([]),e.encrypted&&(r=Ng(e),i="enca"),e=Gg(i,Rg(e),n,r)):(0<e.qa.byteLength?n=Gg("esds",e.qa):(n=Gg,i=e.id+1,r=e.stream.channelsCount||2,o=e.stream.audioSamplingRate||44100,u=Se("audio",e.codecs.split(",")),s=(l={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12})[o],"mp4a.40.5"!==u&&"mp4a.40.29"!==u||(s=l[2*o]),o=parseInt(u.split(".").pop(),10),n=n("esds",i=new Uint8Array([0,0,0,0,3,25].concat(h(Bg(i,2)),[0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,o<<3|s>>>1,s<<7|r<<3,6,1,2])))),i="mp4a",r=new Uint8Array([]),e.encrypted&&(r=Ng(e),i="enca"),e=Gg(i,Rg(e),n,r)),n=e}return t("stbl",e=Gg("stsd",Qg,n),Gg("stts",Xg),Gg("stsc",Kg),Gg("stsz",qg),Gg("stco",Yg))}function Dg(e){if(!e.Ja&&!e.La)return new Uint8Array([]);var t=e.La;return Gg("pasp",e=new Uint8Array([].concat(h(Bg(e.Ja,4)),h(Bg(t,4)))))}function Rg(e){return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.stream.channelsCount||2,0,16,0,0,0,0].concat(h(Bg(e.stream.audioSamplingRate||44100,2)),[0,0]))}function Ng(e){for(var t=Gg,n=e.codecs.substring(0,e.codecs.indexOf(".")),i=0,r=0;r<n.length;r+=1)i|=n.charCodeAt(r)<<8*(n.length-r-1);n=Gg("frma",n=new Uint8Array([].concat(h(Bg(i,4))))),i=Gg("schm",i=new Uint8Array([0,0,0,0,99,101,110,99,0,1,0,0])),r=Gg;for(var a=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),o=(e=l(e.stream.drmInfos)).next();!o.done;o=e.next())if((o=o.value)&&o.keyIds&&o.keyIds.size)for(var s=(o=l(o.keyIds)).next();!s.done;s=o.next())a=Fg(s.value);return t("sinf",n,i,r("schi",a=Gg("tenc",e=new Uint8Array([0,0,0,0,0,0,1,8]),a)))}function Og(e){for(var t=[],n=(e=l(e.g)).next();!n.done;n=e.next()){n=n.value;var i,r=t.push,a=r.apply,o=Gg,s=new Uint8Array([0,0,0,0].concat(h(Bg(n.data?n.data.Cb:0,4))));s=Gg("mfhd",s);var u=n.data?n.data.fb:[],c=new Uint8Array(4+u.length);for(i=0;i<u.length;i++){var d=u[i].flags;c[i+4]=d.$a<<4|d.bb<<2|d.ab}var p=(u=Gg("sdtp",c)).length+92;c=Gg,i=Gg("tfhd",i=new Uint8Array([0,0,0,58].concat(h(Bg(n.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]))),d=n.data?n.data.baseMediaDecodeTime:0;var f=Math.floor(d%(Hg+1));d=Gg("tfdt",d=new Uint8Array([1,0,0,0].concat(h(Bg(Math.floor(d/(Hg+1)),4)),h(Bg(f,4)))));var g=p,m=12+16*(f=(p=n.data?n.data.fb:[]).length),v=new Uint8Array(m);for(g+=8+m,v.set(["video"===n.type?1:0,0,15,1].concat(h(Bg(f,4)),h(Bg(g,4))),0),g=0;g<f;g++){var y=p[g];m=Bg(y.duration,4);var b=Bg(y.size,4),_=y.flags;y=Bg(y.kb,4),v.set([].concat(h(m),h(b),[_.ob<<2|_.$a,_.bb<<6|_.ab<<4|_.pb,61440&_.Za,15&_.Za],h(y)),12+16*g)}o=o("moof",s,u=c("traf",i,d,p=Gg("trun",v),u)),a.call(r,t,[o,Ug(n)])}return _r.apply(fr,h(t))}function Ug(e){return e=(e.data?e.data.fb:[]).map((function(e){return e.data})),Gg("mdat",e=_r.apply(fr,h(e)))}function Bg(e,t){var n=[];for(--t;0<=t;t--)n.push(e>>8*t&255);return n}function Fg(e){for(var t=new Uint8Array(e.length/2),n=0;n<e.length/2;n+=1)t[n]=parseInt(String(e[2*n]+e[2*n+1]),16);return t}function Gg(e){var t=D.apply(1,arguments),n=Vg[e];n||(n=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)],Vg[e]=n);for(var i=8,r=t.length-1;0<=r;r--)i+=t[r].byteLength;for((r=new Uint8Array(i))[0]=i>>24&255,r[1]=i>>16&255,r[2]=i>>8&255,r[3]=255&i,r.set(n,4),n=0,i=8;n<t.length;n++)r.set(t[n],i),i+=t[n].byteLength;return r}var jg=!1,Hg=Math.pow(2,32)-1,Vg={},Wg=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),zg=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),Xg=new Uint8Array([0,0,0,0,0,0,0,0]),Kg=new Uint8Array([0,0,0,0,0,0,0,0]),Yg=new Uint8Array([0,0,0,0,0,0,0,0]),qg=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Zg=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Jg=new Uint8Array([0,0,0,0,0,0,0,0]),Qg=new Uint8Array([0,0,0,0,0,0,0,1]),$g=new Uint8Array([]),em=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),tm=new Uint8Array([]);function nm(){var e=this;this.h=this.g=null,this.l=[],this.j=null,this.u=1,this.i=null,this.D=new He(5),this.s=new ln((function(){!function(e){var t;L((function(n){switch(n.g){case 1:return S(n,2),_(n,im(e),4);case 4:A(n,3);break;case 2:t=E(n),e.h&&(t.severity=1,e.h.onError(t));case 3:if(!e.h)return n.return();w(n)}}))}(e)})),this.C=new Ii,this.m=new Map}function im(e){var t,n,i,r,a,o,s;return L((function(u){if(1==u.g)return t=Li(e.l,e.g.retryParameters),n=e.h.networkingEngine,i=Date.now(),r=n.request(0,t,{type:5}),ki(e.C,r),_(u,r.promise,2);if(a=u.h,!e.h)return u.return();a.uri&&!e.l.includes(a.uri)&&e.l.unshift(a.uri);var c=a.uri,d=Hr(a.data,"SmoothStreamingMedia");if(!d)throw new ye(2,4,4046,c);if((c=e.g.mss.manifestPreprocessor)&&c(d),e.i||(e.i=new Bo(null,0)),c=Pr(d,"IsLive",Fr,!1))throw new ye(2,4,4047);e.i.Vc(!c);var p=Pr(d,"TimeScale",Ur,1e7),f=Pr(d,"DVRWindowLength",Ur);c&&(0===f||isNaN(f))&&(f=1/0);var g,m=Pr(d,"CanSeek",Fr,!1);for(0===f&&m&&(f=1/0),m=null,f&&0<f&&(m=f/p),c&&!isNaN(e.g.availabilityWindowOverride)&&(m=e.g.availabilityWindowOverride),null==m&&(m=1/0),e.i.Ne(m),f=Pr(d,"Duration",Ur,1/0),c||e.i.gb(f/p),c={variants:[],textStreams:[],timescale:p,duration:f/p},m=Er(d,"Protection"),p=e.g.mss.keySystemsBySystemId,f=[],g=(m=l(m)).next();!g.done;g=m.next())f=f.concat(Er(g.value,"ProtectionHeader"));if(f.length){for(m=[],g=0;g<f.length;g++){var v=f[g],y=v.getAttribute("SystemID").toLowerCase(),b=p[y];if(b){var S=xg(v);if(S)e:{for(var T=(S=l(S.getElementsByTagName("DATA"))).next();!T.done;T=S.next())if(T=Tr(T.value,"KID")){S=vr(T.textContent),S=br(S=new Uint8Array([S[3],S[2],S[1],S[0],S[5],S[4],S[7],S[6]].concat(h(S.slice(8)))));break e}S=null}else S=null;y=we(b,y=[{initData:Sr(T=vr(v.textContent),y=yr(y.replace(/-/g,"")),new Set,0),initDataType:"cenc",keyId:S}]),S&&y.keyIds.add(S),(b=kg.get(b))&&(y.licenseServerUri=b(v)),m.push(y)}}p=m}else p=[];for(g=p,m=[],p=[],f=[],v=(d=l(d=Er(d,"StreamIndex"))).next();!v.done;v=d.next()){b=Er(v=v.value,"QualityLevel"),y=c.timescale,S=c.duration,T=Er(v,"c");for(var A=[],E=0,C=0;C<T.length;++C){var x=T[C],I=T[C+1],k=Pr(x,"t",Ur),M=Pr(x,"d",Ur);if(x=Pr(x,"r",Nr),!M)break;if(k=null!=k?k:E,0>(x=x||0))if(I){if(null==(I=Pr(I,"t",Ur)))break;if(k>=I)break;x=Math.ceil((I-k)/M)-1}else{if(1/0==S)break;if(k/y>=S)break;x=Math.ceil((S*y-k)/M)-1}for(I=0;I<=x;++I)E=k+M,A.push({start:k/y,end:E/y,zg:k}),k=E}for(y=A,S=(b=l(b)).next();!S.done;S=b.next())(S=rm(e,v,S.value,y,g,c))&&("audio"!=S.type||e.g.disableAudio?"video"!=S.type||e.g.disableVideo?S.type!=Ae||e.g.disableText||f.push(S):p.push(S):m.push(S))}for(d=[],g=(m=l(0<m.length?m:[null])).next();!g.done;g=m.next())for(g=g.value,S=(v=l(0<p.length?p:[null])).next();!S.done;S=v.next())y=(b=d).push,S=S.value,T=0,g&&g.bandwidth&&0<g.bandwidth&&(T+=g.bandwidth),S&&S.bandwidth&&0<S.bandwidth&&(T+=S.bandwidth),S={id:e.u++,language:g?g.language:"und",disabledUntilTime:0,primary:!!g&&g.primary||!!S&&S.primary,audio:g,video:S,bandwidth:T,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},y.call(b,S);c.variants=d,c.textStreams=f,e.j?(e.j.variants=c.variants,e.j.textStreams=c.textStreams,e.h.filter(e.j)):(e.j={presentationTimeline:e.i,variants:c.variants,textStreams:c.textStreams,imageStreams:[],offlineSessionIds:[],minBufferTime:0,sequenceMode:e.g.mss.sequenceMode,ignoreManifestTimestampsInSegmentsMode:!1,type:"MSS",serviceDescription:null},e.i.ve()),Promise.resolve(),o=Date.now(),s=(o-i)/1e3,e.D.sample(1,s),w(u)}))}function rm(e,t,n,i,r,a){var o=t.getAttribute("Type");if("audio"!==o&&"video"!==o&&"text"!==o)return X("Ignoring unrecognized type:",o),null;var s=t.getAttribute("Language"),u=e.u++,h=Pr(n,"Bitrate",Or),c=Pr(n,"MaxWidth",Or),d=Pr(n,"MaxHeight",Or),p=Pr(n,"Channels",Or),f=Pr(n,"SamplingRate",Or),g=a.duration;i.length&&(g=i[i.length-1].end-i[0].start);var m=e.i.getDuration();e.i.gb(Math.min(g,m));var v={id:u,originalId:t.getAttribute("Name")||String(u),groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:"",codecs:"",frameRate:void 0,pixelAspectRatio:void 0,bandwidth:h||0,width:c||void 0,height:d||void 0,kind:"",encrypted:0<r.length,drmInfos:r,keyIds:new Set,language:Pe(s||"und"),originalLanguage:s,label:"",type:"",primary:!1,trickModeVideo:null,emsgSchemeIdUris:[],roles:[],forced:!1,channelsCount:p,audioSamplingRate:f,spatialAudio:!1,closedCaptions:null,hdr:void 0,videoLayout:void 0,tilesLayout:void 0,matchedStreams:[],mssPrivateData:{duration:g,timescale:a.timescale,codecPrivateData:null},accessibilityPurpose:null,external:!1,fastSwitching:!1};if((r=t.getAttribute("Subtype"))&&((r=om[r])&&v.roles.push(r),"main"===r&&(v.primary=!0)),null!==(r=n.getAttribute("FourCC"))&&""!==r||(r=t.getAttribute("FourCC")),!r)if("audio"===o)r="AAC";else if("video"===o)return X('FourCC is not defined whereas it is required for a QualityLevel element for a StreamIndex of type "video"'),null;if(!am.includes(r.toUpperCase()))return X("Codec not supported:",r),null;switch(n=function(e,t,n,i){if(e=e.getAttribute("CodecPrivateData"))return e;if("audio"!==t)return null;t=i.channelsCount||2;var r={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12};return i=r[e=i.audioSamplingRate||44100],"AACH"===n?(n=new Uint8Array(4),e=r[2*e],n[0]=40|i>>1,n[1]=i<<7|t<<3|e>>1,n[2]=e<<7|8,n[3]=0,(t=new Uint16Array(2))[0]=(n[0]<<8)+n[1],t[1]=(n[2]<<8)+n[3],t[0].toString(16)+t[1].toString(16)):((n=new Uint8Array(2))[0]=16|i>>1,n[1]=i<<7|t<<3,(t=new Uint16Array(1))[0]=(n[0]<<8)+n[1],t[0].toString(16))}(n,o,r,v),v.mssPrivateData.codecPrivateData=n,o){case"audio":if(!n)return X("Quality unsupported without CodecPrivateData",o),null;v.type="audio",v.mimeType="mss/audio/mp4",v.codecs=function(e,t){var n=0;return"AACH"===e&&(n=5),t?0===n&&(n=(248&parseInt(t.substr(0,2),16))>>3):(n=2,"AACH"===e&&(n=5)),"mp4a.40."+n}(r,n);break;case"video":if(!n)return X("Quality unsupported without CodecPrivateData",o),null;v.type="video",v.mimeType="mss/video/mp4",v.codecs=function(e){var t=/00000001[0-9]7/.exec(e);return t.length&&e?"avc1."+e.substr(e.indexOf(t[0])+10,6):""}(n);break;case"text":v.type=Ae,v.mimeType="application/mp4",("TTML"===r||"DFXP"===r)&&(v.codecs="stpp")}return v.createSegmentIndex=function(){if(v.segmentIndex)return Promise.resolve();if(e.m.has(v.id))var n=e.m.get(v.id);else n=[],"video"==v.type&&(n=v.mssPrivateData.codecPrivateData.split("00000001").slice(1)),n=Pg(new Mg([n={id:v.id,type:v.type,codecs:v.codecs,encrypted:v.encrypted,timescale:v.mssPrivateData.timescale,duration:v.mssPrivateData.duration,ib:n,qa:new Uint8Array([]),Ca:new Uint8Array([]),Ja:0,La:0,data:null,stream:v}])),e.m.set(v.id,n);return n=function(e,t,n,i,r){var a=i.getAttribute("Url").replace("{bitrate}",String(n.bandwidth));i=[];for(var o={},s=(r=l(r)).next();!s.done;o={gd:o.gd},s=r.next())o.gd=s.value,i.push(new Ta(o.gd.start,o.gd.end,function(t){return function(){return _e(e.l,[a.replace("{start time}",String(t.gd.zg))])}}(o),0,null,t,0,0,n.mssPrivateData.duration));return i}(e,new wa((function(){return[]}),0,null,null,void 0,n),v,t,i),v.segmentIndex=new rs(n),Promise.resolve()},v.closeSegmentIndex=function(){v.segmentIndex&&(v.segmentIndex.release(),v.segmentIndex=null)},v}(i=nm.prototype).configure=function(e){this.g=e},i.start=function(e,t){var n=this;return L((function(i){if(1==i.g)return n.l=[e],n.h=t,_(i,im(n),2);if(!n.h)throw new ye(2,7,7001);return i.return(n.j)}))},i.stop=function(){return this.g=this.h=null,this.l=[],this.j=null,null!=this.s&&(this.s.stop(),this.s=null),this.m.clear(),this.C.destroy()},i.update=function(){var e,t=this;return L((function(n){return 1==n.g?(S(n,2),_(n,im(t),4)):2!=n.g?A(n,0):(e=E(n),t.h&&e?(t.h.onError(e),void w(n)):n.return())}))},i.onExpirationUpdated=function(){},i.onInitialVariantChosen=function(){},i.banLocation=function(){},G("shaka.mss.MssParser",nm);var am="AAC AACL AACH AACP AVC1 H264 TTML DFXP".split(" "),om={CAPT:"main",SUBT:"alternate",DESC:"main"};function sm(e,t,n,i,r,a){if(200<=n&&299>=n&&202!=n)return{uri:r||i,originalUri:i,data:t,status:n,headers:e,fromCache:!!e["x-shaka-from-cache"]};r=null;try{r=Ji(t)}catch(e){}throw new ye(401==n||403==n?2:1,1,1001,i,n,r,e,a)}function um(){}function lm(e,t,n,i,r){var a=new gm;Xi(t.headers).forEach((function(e,t){a.append(t,e)}));var o=new pm,s={Hg:!1,xh:!1};if(e=function(e,t,n,i,r,a,o){var s,u,l,h,c,d,p,f,g,m,v,y;return L((function(b){switch(b.g){case 1:return s=dm,u=fm,d=c=0,p=Date.now(),S(b,2),_(b,s(e,n),4);case 4:if(l=b.h,a(hm(l.headers)),"HEAD"==n.method){b.F(5);break}return f=l.clone().body.getReader(),m=(g=l.headers.get("Content-Length"))?parseInt(g,10):0,new u({start:function(e){!function t(){var n,i;return L((function(a){switch(a.g){case 1:return S(a,2),_(a,f.read(),4);case 4:n=a.h,A(a,3);break;case 2:return E(a),a.return();case 3:if(n.done){a.F(5);break}if(c+=n.value.byteLength,!o){a.F(5);break}return _(a,o(n.value),5);case 5:(100<(i=Date.now())-p||n.done)&&(r(i-p,c-d,m-c),d=c,p=i),n.done?e.close():(e.enqueue(n.value),t()),w(a)}}))}()}}),_(b,l.arrayBuffer(),6);case 6:h=b.h;case 5:A(b,3);break;case 2:if(v=E(b),i.Hg)throw new ye(1,1,7001,e,t);if(i.xh)throw new ye(1,1,1003,e,t);throw new ye(1,1,1002,e,v,t);case 3:return y=hm(l.headers),b.return(sm(y,h,l.status,e,l.url,t))}}))}(e,n,{body:t.body||void 0,headers:a,method:t.method,signal:o.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},s,i,r,t.streamDataCallback),e=new Si(e,(function(){return s.Hg=!0,o.abort(),Promise.resolve()})),t=t.retryParameters.timeout){var u=new ln((function(){s.xh=!0,o.abort()}));u.S(t/1e3),e.finally((function(){u.stop()}))}return e}function hm(e){var t={};return e.forEach((function(e,n){t[n.trim()]=e})),t}function cm(){if(!e.ReadableStream)return!1;try{new ReadableStream({})}catch(e){return!1}return!!e.Response&&!!new Response("").body&&!(!e.fetch||!e.AbortController)}va["application/vnd.ms-sstr+xml"]=function(){return new nm},G("shaka.net.HttpFetchPlugin",um),um.isSupported=cm,um.parse=lm;var dm=e.fetch,pm=e.AbortController,fm=e.ReadableStream,gm=e.Headers;function mm(){}function vm(e,t,n,i,r){var a=new bm,o=Date.now(),s=0;return new Si(new Promise((function(u,l){a.open(t.method,e,!0),a.responseType="arraybuffer",a.timeout=t.retryParameters.timeout,a.withCredentials=t.allowCrossSiteCredentials,a.onabort=function(){l(new ye(1,1,7001,e,n))};var h=!1;for(var c in a.onreadystatechange=function(){if(2==a.readyState&&!h){var e=ym(a);r(e),h=!0}},a.onload=function(){var t=ym(a),i=a.response;try{var r=sm(t,i,a.status,e,a.responseURL,n);u(r)}catch(e){l(e)}},a.onerror=function(t){l(new ye(1,1,1002,e,t,n))},a.ontimeout=function(){l(new ye(1,1,1003,e,n))},a.onprogress=function(e){var t=Date.now();(100<t-o||e.lengthComputable&&e.loaded==e.total)&&(i(t-o,e.loaded-s,e.total-e.loaded),s=e.loaded,o=t)},t.headers)a.setRequestHeader(c.toLowerCase(),t.headers[c]);a.send(t.body)})),(function(){return a.abort(),Promise.resolve()}))}function ym(e){var t=e.getAllResponseHeaders().trim().split("\r\n");e={};for(var n=(t=l(t)).next();!n.done;n=t.next())e[(n=n.value.split(": "))[0].toLowerCase()]=n.slice(1).join(": ");return e}cm()&&(Pi("http",lm,2,!0),Pi("https",lm,2,!0),Pi("blob",lm,2,!0)),G("shaka.net.HttpXHRPlugin",mm),mm.parse=vm;var bm=e.XMLHttpRequest;function _m(e,t,n,i){this.g=e,this.i=t,this.groupId=n,this.h=i}function wm(e){return e.ba().map((function(e){return"{"+encodeURI(e)+"}"})).join("")+":"+e.hb+":"+e.Na}function Sm(e,t){return Es(e.g.ba(),e.g.hb,e.g.Na,t.streaming.retryParameters)}function Tm(){this.h=this.j=this.i=0,this.g=new Map,this.l=0}function Am(e,t){e.i+=t;var n=e.l;return e.l++,e.g.set(n,t),n}function Em(e){var t=this;this.s=e,this.j=new Map,this.i=new Gi((function(){return Cm(t).catch((function(){}))})),this.h=[],this.m=function(){},this.l=function(){},this.g=new Tm}function Cm(e){var t=e.h.map((function(e){return e()}));return e.h=[],Promise.all(t)}function xm(e,t,n,i,r,a){ji(e.i);var o=(e.j.get(t)||Promise.resolve()).then((function(){var t,o,s,u,l,h,c;return L((function(d){if(1==d.g)return _(d,function(e,t){var n,i,r,a;return L((function(o){return 1==o.g?(n=Ui,i=e.s.request(n,t),r=function(){return i.abort()},e.h.push(r),_(o,i.promise,2)):(a=o.h,lt(e.h,r),o.return(a.data))}))}(e,n),2);if(t=d.h,e.i.g)throw new ye(2,9,7001);if(r)for(u in o=et(t),(s=new wr(o)).data)l=Number(u),h=s.data[l],c=s.g[l],e.l(h,c);e.g.close(i,t.byteLength);var p=e.g;return e.m(0==p.i?0:p.j/p.i,e.g.h),d.return(a(t))}))}));e.j.set(t,o)}function Im(e,t){var n=this;this.i=e,this.h=e.objectStore(t),this.g=new wi,e.onabort=function(e){e.preventDefault(),n.g.reject()},e.onerror=function(e){e.preventDefault(),n.g.reject()},e.oncomplete=function(){n.g.resolve()}}function km(e,t){return new Promise((function(n,i){var r=e.h.openCursor();r.onerror=i,r.onsuccess=function(){var e;return L((function(i){if(1==i.g)return null==r.result?(n(),i.return()):(e=r.result,_(i,t(e.key,e.value,e),2));e.continue(),w(i)}))}}))}function Mm(e){this.h=e,this.g=[]}function Pm(e,t){return Lm(e,t,"readwrite")}function Lm(e,t,n){var i=new Im(n=e.h.transaction([t],n),t);return e.g.push(i),i.promise().then((function(){lt(e.g,i)}),(function(){lt(e.g,i)})),i}function Dm(e,t,n){this.h=new Mm(e),this.i=t,this.g=n}function Rm(e){return Promise.reject(new ye(2,9,9011,"Cannot add new value to "+e))}function Nm(e,t,n,i){t=(e=Pm(e.h,t)).store();for(var r={},a=(n=l(n)).next();!a.done;r={Td:r.Td},a=n.next())r.Td=a.value,t.delete(r.Td).onsuccess=function(e){return function(){return i(e.Td)}}(r);return e.promise()}function Om(e,t,n){var i,r,a,o,s,u,h;return L((function(c){if(1==c.g){for(i=Lm(e.h,t,"readonly"),r=i.store(),a={},o=[],s={},u=l(n),h=u.next();!h.done;s={ed:s.ed,bd:s.bd},h=u.next())s.bd=h.value,s.ed=r.get(s.bd),s.ed.onsuccess=function(e){return function(){null==e.ed.result&&o.push(e.bd),a[e.bd]=e.ed.result}}(s);return _(c,i.promise(),2)}if(o.length)throw new ye(2,9,9012,"Could not find values for "+o);return c.return(n.map((function(e){return a[e]})))}))}function Um(e){this.g=new Mm(e)}function Bm(){this.g=new Map}function Fm(e){var t=null;if(e.g.forEach((function(e,n){e.getCells().forEach((function(e,i){e.hasFixedKeySpace()||t||(t={path:{qb:n,Ma:i},Ma:e})}))})),t)return t;throw new ye(2,9,9013,"Could not find a cell that supports add-operations")}function Gm(e,t,n){if(!(e=e.g.get(t)))throw new ye(2,9,9013,"Could not find mechanism with name "+t);if(!(t=e.getCells().get(n)))throw new ye(2,9,9013,"Could not find cell with name "+n);return t}function jm(e,t){Hm.set(e,t)}Pi("http",vm,1,!0),Pi("https",vm,1,!0),Pi("blob",vm,1,!0),Tm.prototype.close=function(e,t){if(this.g.has(e)){var n=this.g.get(e);this.g.delete(e),this.j+=n,this.h+=t}},Em.prototype.destroy=function(){return this.i.destroy()},Im.prototype.abort=function(){var e=this;return L((function(t){if(1==t.g){try{e.i.abort()}catch(e){}return S(t,2),_(t,e.g,4)}if(2!=t.g)return A(t,0);E(t),w(t)}))},Im.prototype.store=function(){return this.h},Im.prototype.promise=function(){return this.g},Mm.prototype.destroy=function(){return Promise.all(this.g.map((function(e){return e.abort()})))},(i=Dm.prototype).destroy=function(){return this.h.destroy()},i.hasFixedKeySpace=function(){return!0},i.addSegments=function(){return Rm(this.i)},i.removeSegments=function(e,t){return Nm(this,this.i,e,t)},i.getSegments=function(e){var t,n=this;return L((function(i){return 1==i.g?_(i,Om(n,n.i,e),2):(t=i.h,i.return(t.map((function(e){return n.Lg(e)}))))}))},i.addManifests=function(){return Rm(this.g)},i.updateManifest=function(){return Promise.reject(new ye(2,9,9016,"Cannot modify values in "+this.g))},i.updateManifestExpiration=function(e,t){var n=Pm(this.h,this.g),i=n.store();return i.get(e).onsuccess=function(n){(n=n.target.result)&&(n.expiration=t,i.put(n,e))},n.promise()},i.removeManifests=function(e,t){return Nm(this,this.g,e,t)},i.getManifests=function(e){var t,n=this;return L((function(i){return 1==i.g?_(i,Om(n,n.g,e),2):(t=i.h,i.return(Promise.all(t.map((function(e){return n.qd(e)})))))}))},i.getAllManifests=function(){var e,t,n=this;return L((function(i){return 1==i.g?(e=Lm(n.h,n.g,"readonly"),t=new Map,_(i,km(e,(function(e,i){var r;return L((function(a){if(1==a.g)return _(a,n.qd(i),2);r=a.h,t.set(e,r),w(a)}))})),2)):3!=i.g?_(i,e.promise(),3):i.return(t)}))},i.Lg=function(e){return e},i.qd=function(e){return Promise.resolve(e)},i.add=function(e,t){var n,i,r,a,o,s,u,h=this;return L((function(c){if(1==c.g){for(n=Pm(h.h,e),i=n.store(),r=[],a={},o=l(t),s=o.next();!s.done;a={Vd:a.Vd},s=o.next())u=s.value,a.Vd=i.add(u),a.Vd.onsuccess=function(e){return function(){r.push(e.Vd.result)}}(a);return _(c,n.promise(),2)}return c.return(r)}))},Um.prototype.destroy=function(){return this.g.destroy()},Um.prototype.getAll=function(){var e,t,n=this;return L((function(i){return 1==i.g?(e=Lm(n.g,"session-ids","readonly"),t=[],_(i,km(e,(function(e,n){t.push(n)})),2)):3!=i.g?_(i,e.promise(),3):i.return(t)}))},Um.prototype.add=function(e){for(var t=Pm(this.g,"session-ids"),n=t.store(),i=(e=l(e)).next();!i.done;i=e.next())n.add(i.value);return t.promise()},Um.prototype.remove=function(e){var t,n=this;return L((function(i){return 1==i.g?_(i,km(t=Pm(n.g,"session-ids"),(function(t,n,i){e.includes(n.sessionId)&&i.delete()})),2):_(i,t.promise(),0)}))},Bm.prototype.destroy=function(){for(var e=[],t=l(this.g.values()),n=t.next();!n.done;n=t.next())e.push(n.value.destroy());return this.g.clear(),Promise.all(e)},Bm.prototype.init=function(){var e=this;Hm.forEach((function(t,n){(t=t())&&e.g.set(n,t)}));for(var t=[],n=l(this.g.values()),i=n.next();!i.done;i=n.next())t.push(i.value.init());return Promise.all(t)},G("shaka.offline.StorageMuxer",Bm),Bm.unregister=function(e){Hm.delete(e)},Bm.register=jm,Bm.prototype.destroy=Bm.prototype.destroy;var Hm=new Map;function Vm(){Dm.apply(this,arguments)}function Wm(e,t){!function(e){var t=e.streams.filter((function(e){return"audio"==e.contentType}));if(e=e.streams.filter((function(e){return"video"==e.contentType})),!t.every((function(e){return e.variantIds}))||!e.every((function(e){return e.variantIds}))){for(var n=l(t),i=n.next();!i.done;i=n.next())i.value.variantIds=[];for(i=(n=l(e)).next();!i.done;i=n.next())i.value.variantIds=[];if(n=0,e.length&&!t.length){var r=n++,a=l(e);for(i=a.next();!i.done;i=a.next())i.value.variantIds.push(r)}if(!e.length&&t.length)for(r=n++,i=(a=l(t)).next();!i.done;i=a.next())i.value.variantIds.push(r);if(e.length&&t.length)for(i=(t=l(t)).next();!i.done;i=t.next())for(i=i.value,a=(r=l(e)).next();!a.done;a=r.next()){a=a.value;var o=n++;i.variantIds.push(o),a.variantIds.push(o)}}}(e);for(var n=l(e.streams),i=n.next();!i.done;i=n.next());return e.streams.map((function(n){return function(e,t,n){var i=e.initSegmentUri?zm(e.initSegmentUri):null,r=t+e.presentationTimeOffset,a=t+n;return{id:e.id,originalId:null,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:void 0,hdr:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,initSegmentKey:i,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map((function(e){var n=zm(e.uri);return{startTime:t+e.startTime,endTime:t+e.endTime,dataKey:n,initSegmentKey:i,appendWindowStart:t,appendWindowEnd:a,timestampOffset:r,tilesLayout:""}})),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1}}(n,e.startTime,t)}))}function zm(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new ye(2,9,9004,"Could not parse uri "+e)}function Xm(){Dm.apply(this,arguments)}function Km(e,t,n){return{id:e.id,originalId:e.originalId,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:e.pixelAspectRatio,hdr:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map((function(i){return{startTime:t+i.startTime,endTime:t+i.endTime,initSegmentKey:e.initSegmentKey,appendWindowStart:t,appendWindowEnd:n,timestampOffset:t-e.presentationTimeOffset,dataKey:i.dataKey,tilesLayout:""}})),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1}}function Ym(){Dm.apply(this,arguments)}function qm(){this.m=this.j=this.i=this.h=this.g=this.l=null}function Zm(e,t,n,i){this.g=e,this.i=t,this.h=n,this.l=i,this.j=["offline:",e,"/",t,"/",n,"/",i].join("")}function Jm(e){if(null==(e=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e)))return null;var t=e[1];if("manifest"!=t&&"segment"!=t)return null;var n=e[2];if(!n)return null;var i=e[3];return i&&null!=t?new Zm(t,n,i,Number(e[4])):null}function Qm(e,t){this.h=e,this.g=t}function $m(e,t){var n=new Bo(null,0);n.gb(t.duration);var i=t.streams.filter((function(e){return"audio"==e.type})),r=t.streams.filter((function(e){return"video"==e.type}));i=function(e,t,n,i){for(var r=new Set,a=l(t),o=a.next();!o.done;o=a.next()){var s=l(o.value.variantIds);for(o=s.next();!o.done;o=s.next())r.add(o.value)}for(o=(a=l(n)).next();!o.done;o=a.next())for(o=(s=l(o.value.variantIds)).next();!o.done;o=s.next())r.add(o.value);for(a=new Map,o=(r=l(r)).next();!o.done;o=r.next())o=o.value,a.set(o,{id:o,language:"",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});for(r=(t=l(t)).next();!r.done;r=t.next())for(o=ev(e,r=r.value,i),r=(s=l(r.variantIds)).next();!r.done;r=s.next())(r=a.get(r.value)).language=o.language,r.primary=r.primary||o.primary,r.audio=o;for(t=(n=l(n)).next();!t.done;t=n.next())for(t=ev(e,r=t.value,i),r=(o=l(r.variantIds)).next();!r.done;r=o.next())(r=a.get(r.value)).primary=r.primary||t.primary,r.video=t;return a}(e,i,r,n),r=t.streams.filter((function(e){return e.type==Ae})).map((function(t){return ev(e,t,n)}));var a=t.streams.filter((function(e){return"image"==e.type})).map((function(t){return ev(e,t,n)})),o=t.drmInfo?[t.drmInfo]:[];if(t.drmInfo)for(var s=l(i.values()),u=s.next();!u.done;u=s.next())(u=u.value).audio&&u.audio.encrypted&&(u.audio.drmInfos=o),u.video&&u.video.encrypted&&(u.video.drmInfos=o);return{presentationTimeline:n,minBufferTime:2,offlineSessionIds:t.sessionIds,variants:Array.from(i.values()),textStreams:r,imageStreams:a,sequenceMode:t.sequenceMode||!1,ignoreManifestTimestampsInSegmentsMode:!1,type:t.type||"UNKNOWN",serviceDescription:null}}function ev(e,t,n){var i=t.segments.map((function(t){return function(e,t){var n=new Zm("segment",e.h,e.g,t.dataKey);return new Ta(t.startTime,t.endTime,(function(){return[n.toString()]}),0,null,null!=t.initSegmentKey?function(e,t){var n=new Zm("segment",e.h,e.g,t);return new wa((function(){return[n.toString()]}),0,null)}(e,t.initSegmentKey):null,t.timestampOffset,t.appendWindowStart,t.appendWindowEnd,[],t.tilesLayout||"")}(e,t)}));return n.Dd(i),{id:t.id,originalId:t.originalId,groupId:t.groupId,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new rs(i),mimeType:t.mimeType,codecs:t.codecs,width:t.width||void 0,height:t.height||void 0,frameRate:t.frameRate,pixelAspectRatio:t.pixelAspectRatio,hdr:t.hdr,videoLayout:t.videoLayout,kind:t.kind,encrypted:t.encrypted,drmInfos:[],keyIds:t.keyIds,language:t.language,originalLanguage:t.originalLanguage||null,label:t.label,type:t.type,primary:t.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:t.roles,forced:t.forced,channelsCount:t.channelsCount,audioSamplingRate:t.audioSamplingRate,spatialAudio:t.spatialAudio,closedCaptions:t.closedCaptions,tilesLayout:t.tilesLayout,accessibilityPurpose:null,external:t.external,fastSwitching:t.fastSwitching}}function tv(){this.g=null}function nv(){}function iv(e){var t=Jm(e);return e=t&&"manifest"==t.g?Ei(e={uri:e,originalUri:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}}):t&&"segment"==t.g?function(e,t){var n=new Bm;return Ei(void 0).Fa((function(){return n.init()})).Fa((function(){return Gm(n,t.qb(),t.Ma())})).Fa((function(e){return e.getSegments([t.key()])})).Fa((function(e){return{uri:t,data:e[0].data,headers:{}}})).finally((function(){return n.destroy()}))}(t.key(),t):Ti(new ye(2,1,9004,e))}function rv(e,t,n){var i,r,a,o,s,u;return L((function(h){switch(h.g){case 1:i=[];for(var c=[],d=l(n),p=d.next();!p.done;p=d.next()){p=p.value;for(var f=!1,g=l(c),m=g.next();!m.done;m=g.next())if(av((m=m.value).info,p)){m.sessionIds.push(p.sessionId),f=!0;break}f||c.push({info:p,sessionIds:[p.sessionId]})}r=l(c),a=r.next();case 2:if(a.done){h.F(4);break}return o=a.value,s=function(e,t,n){var i,r;return L((function(a){switch(a.g){case 1:return i=new Wr({zc:t,onError:function(){},Fe:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),S(a,2),i.configure(e),_(a,function(e,t,n,i,r,a){var o=new Map;return(r={audioCapabilities:r,videoCapabilities:a,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:t}).drmInfos=[{keySystem:t,licenseServerUri:n,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:i,serverCertificateUri:"",initData:null,keyIds:null}],o.set(t,r),Qr(e,o,[])}(i,n.info.keySystem,n.info.licenseUri,n.info.serverCertificate,n.info.audioCapabilities,n.info.videoCapabilities),4);case 4:A(a,3);break;case 2:return E(a),_(a,i.destroy(),5);case 5:return a.return([]);case 3:return r=[],_(a,Promise.all(n.sessionIds.map((function(e){return L((function(t){return 1==t.g?(S(t,2),_(t,function(e,t){var n,i,r;return L((function(a){return 1==a.g?_(a,ta(e,t,{initData:null,initDataType:null}),2):3!=a.g?(n=a.h)?(i=[],(r=e.i.get(n))&&(r.Db=new wi,i.push(r.Db)),i.push(n.remove()),_(a,Promise.all(i),3)):a.return():(e.i.delete(n),void w(a))}))}(i,e),4)):2!=t.g?(r.push(e),A(t,0)):(E(t),void w(t))}))}))),6);case 6:return _(a,i.destroy(),7);case 7:return a.return(r)}}))}(e,t,o),_(h,s,5);case 5:u=h.h,i=i.concat(u),a=r.next(),h.F(2);break;case 4:return h.return(i)}}))}function av(e,t){function n(e,t){return e.robustness==t.robustness&&e.contentType==t.contentType}return e.keySystem==t.keySystem&&e.licenseUri==t.licenseUri&&ht(e.audioCapabilities,t.audioCapabilities,n)&&ht(e.videoCapabilities,t.videoCapabilities,n)}function ov(e,t){var n=$m(new Qm(e.qb(),e.Ma()),t),i=t.appMetadata||{};return n=sv(n),{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:n,appMetadata:i,isIncomplete:t.isIncomplete||!1}}function sv(e){for(var t=[],n=zn(e.variants),i=(n=l(n)).next();!i.done;i=n.next())t.push(Un(i.value));for(n=(e=l(e.textStreams)).next();!n.done;n=e.next())t.push(Bn(n.value));return t}function uv(){this.g={}}function lv(e,t){var n=t.audio,i=t.video;if(n&&!i&&(e.g[n.id]=n.bandwidth||t.bandwidth),!n&&i&&(e.g[i.id]=i.bandwidth||t.bandwidth),n&&i){var r=n.bandwidth||393216,a=i.bandwidth||t.bandwidth-r;0>=a&&(a=t.bandwidth),e.g[n.id]=r,e.g[i.id]=a}}function hv(e,t){e.g[t.id]=t.bandwidth||2048}function cv(e,t){return null==(e=e.g[t])&&(e=0),e}function dv(e){var t=this;if(e&&e.constructor!=Ku)throw new ye(2,9,9008);this.g=this.h=null,e?(this.h=e.g,this.g=e.Yb()):(this.h=Gu(),this.g=new Mi),this.i=[],this.j=[];var n=!e;this.l=new Gi((function(){var e,i,r,a,o;return L((function(s){switch(s.g){case 1:return _(s,Promise.all(t.j.map((function(e){return Cm(e)}))),2);case 2:for(e=function(){},i=[],r=l(t.i),a=r.next();!a.done;a=r.next())o=a.value,i.push(o.then(e,e));return _(s,Promise.all(i),3);case 3:if(!n){s.F(4);break}return _(s,t.g.destroy(),4);case 4:t.h=null,t.g=null,w(s)}}))}))}function pv(){if(hn())e:{for(var e=l(Hm.values()),t=e.next();!t.done;t=e.next())if(t=(t=t.value)()){t.destroy(),e=!0;break e}e=!1}else e=!1;return e}function fv(e){var t,n,i;return L((function(r){switch(r.g){case 1:return _(r,(t=new Bm).init(),2);case 2:return _(r,Fm(t),3);case 3:return n=r.h,i=new Zm("manifest",n.path.qb,n.path.Ma,e),_(r,t.destroy(),4);case 4:return _(r,(new dv).remove(i.toString()),0)}}))}function gv(e,t,n,i,r,a){var o,s,u,h,c,d,p,f,g,m,v;return L((function(y){switch(y.g){case 1:for(o=!1,S(y,2),s=!0,u=l(n.streams),h=u.next();!h.done;h=u.next())for(c=h.value,d=l(c.segments),p=d.next();!p.done;p=d.next())f=p.value,null!=(g=f.pendingSegmentRefId?i[f.pendingSegmentRefId]:null)&&(f.dataKey=g,f.pendingSegmentRefId=void 0),null!=(g=f.pendingInitSegmentRefId?i[f.pendingInitSegmentRefId]:null)&&(f.initSegmentKey=g,f.pendingInitSegmentRefId=void 0),f.pendingSegmentRefId&&(s=!1),f.pendingInitSegmentRefId&&(s=!1);return n.size+=r,s&&(n.isIncomplete=!1),_(y,e.updateManifest(t,n),4);case 4:o=!0,a(),A(y,0);break;case 2:return m=E(y),_(y,fv(t),5);case 5:if(o){y.F(6);break}return v=Object.values(i),_(y,e.removeSegments(v,(function(){})),6);case 6:throw m}}))}function mv(e){return e.variants.some((function(e){var t=e.audio&&e.audio.encrypted;return e.video&&e.video.encrypted||t}))}function vv(e){return e.variants.some((function(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[]).some((function(e){return e.initData&&e.initData.length}))}))}function yv(e,t,n,i){if(t.expiration=n.td(),n=Jr(n),t.sessionIds=i.offline.usePersistentLicense?n:[],mv(e)&&i.offline.usePersistentLicense&&!n.length)throw new ye(2,9,9007)}function bv(e,t){for(var n=[],i=l(e.streams),r=i.next();!r.done;r=i.next())r=r.value,t&&"video"==r.type?n.push({contentType:Ht(r.mimeType,r.codecs),robustness:e.drmInfo.videoRobustness}):t||"audio"!=r.type||n.push({contentType:Ht(r.mimeType,r.codecs),robustness:e.drmInfo.audioRobustness});return n}function _v(e,t,n){return L((function(i){return _(i,function(e,t,n,i){var r,a,o;return L((function(s){return 1==s.g?i.drmInfo?(r=function(e){var t=Array.from(e.g.keys());if(!t.length)throw new ye(2,9,9e3,"No supported storage mechanisms found");return e.g.get(t[0]).getEmeSessionCell()}(n),a=i.sessionIds.map((function(e){return{sessionId:e,keySystem:i.drmInfo.keySystem,licenseUri:i.drmInfo.licenseServerUri,serverCertificate:i.drmInfo.serverCertificate,audioCapabilities:bv(i,!1),videoCapabilities:bv(i,!0)}})),_(s,rv(t,e,a),2)):s.return():3!=s.g?(o=s.h,_(s,r.remove(o),3)):_(s,r.add(a.filter((function(e){return!o.includes(e.sessionId)}))),0)}))}(e.g,e.h.drm,n,t),0)}))}function wv(e,t,n){function i(){}var r=function(e){for(var t=new Set,n=(e=l(e.streams)).next();!n.done;n=e.next())for(var i=(n=l(n.value.segments)).next();!i.done;i=n.next())null!=(i=i.value).initSegmentKey&&t.add(i.initSegmentKey),t.add(i.dataKey);return Array.from(t)}(n);return ov(t,n),Promise.all([e.removeSegments(r,i),e.removeManifests([t.key()],i)])}function Sv(e,t,n,i,r,a){var o={id:i.id,originalId:i.originalId,groupId:i.groupId,primary:i.primary,type:i.type,mimeType:i.mimeType,codecs:i.codecs,frameRate:i.frameRate,pixelAspectRatio:i.pixelAspectRatio,hdr:i.hdr,videoLayout:i.videoLayout,kind:i.kind,language:i.language,originalLanguage:i.originalLanguage,label:i.label,width:i.width||null,height:i.height||null,encrypted:i.encrypted,keyIds:i.keyIds,segments:[],variantIds:[],roles:i.roles,forced:i.forced,channelsCount:i.channelsCount,audioSamplingRate:i.audioSamplingRate,spatialAudio:i.spatialAudio,closedCaptions:i.closedCaptions,tilesLayout:i.tilesLayout,external:i.external,fastSwitching:i.fastSwitching},s=r.offline.numberOfParallelDownloads,u=0;return function(e,t,n){if(null!=(t=e.segmentIndex.find(t)))for(var i=e.segmentIndex.get(t);i;)n(i),i=e.segmentIndex.get(++t)}(i,n.presentationTimeline.Ab(),(function(n){var r=wm(n),l=void 0;if(!a.has(r)){var h=n.endTime-n.startTime;h=cv(t,i.id)*h,h=Am(e.g,h),a.set(r,new _m(n,h,u,!1))}n.ka&&(l=wm(n.ka),a.has(l)||(h=.5*cv(t,i.id),h=Am(e.g,h),a.set(l,new _m(n.ka,h,u,!0)))),o.segments.push({pendingInitSegmentRefId:l,initSegmentKey:l?0:null,startTime:n.startTime,endTime:n.endTime,appendWindowStart:n.appendWindowStart,appendWindowEnd:n.appendWindowEnd,timestampOffset:n.timestampOffset,tilesLayout:n.tilesLayout,pendingSegmentRefId:r,dataKey:0}),u=(u+1)%s})),o}function Tv(e){if(e.l.g)throw new ye(2,9,7001)}function Av(){if(!pv())throw new ye(2,9,9e3)}function Ev(e,t){return L((function(n){return 1==n.g?(e.i.push(t),T(n,2),_(n,t,4)):2!=n.g?n.return(n.h):(C(n),lt(e.i,t),x(n,0))}))}function Cv(e){for(var t=new Set,n=l(e.textStreams),i=n.next();!i.done;i=n.next())t.add(i.value);for(i=(n=l(e.imageStreams)).next();!i.done;i=n.next())t.add(i.value);for(n=(e=l(e.variants)).next();!n.done;n=e.next())(n=n.value).audio&&t.add(n.audio),n.video&&t.add(n.video);return t}m(Vm,Dm),Vm.prototype.updateManifestExpiration=function(e,t){var n,i,r,a=this;return L((function(o){return n=Pm(a.h,a.g),i=n.store(),r=new wi,i.get(e).onsuccess=function(n){(n=n.target.result)?(n.expiration=t,i.put(n),r.resolve()):r.reject(new ye(2,9,9012,"Could not find values for "+e))},_(o,Promise.all([n.promise(),r]),0)}))},Vm.prototype.qd=function(e){var t,n,i,r,a,o;return L((function(s){if(1==s.g){for(t=[],n=0;n<e.periods.length;++n)i=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,r=i-e.periods[n].startTime,a=Wm(e.periods[n],r),t.push(a);return _(s,gp(t),2)}return o=s.h,s.return({creationTime:0,originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:null==e.expiration?1/0:e.expiration,streams:o,sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata,sequenceMode:!1})}))},Vm.prototype.Lg=function(e){return{data:e.data}},m(Xm,Dm),Xm.prototype.qd=function(e){var t,n,i,r,a,o;return L((function(s){if(1==s.g){for(t=[],n=0;n<e.periods.length;++n){i=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,r=i-e.periods[n].startTime;for(var u=e.periods[n],h=[],c=l(u.streams),d=c.next();!d.done;d=c.next())0!=(d=d.value).variantIds.length&&h.push(Km(d,u.startTime,u.startTime+r));a=h,t.push(a)}return _(s,gp(t),2)}return o=s.h,s.return({appMetadata:e.appMetadata,creationTime:0,drmInfo:e.drmInfo,duration:e.duration,expiration:null==e.expiration?1/0:e.expiration,originalManifestUri:e.originalManifestUri,sessionIds:e.sessionIds,size:e.size,streams:o,sequenceMode:!1})}))},m(Ym,Dm),(i=Ym.prototype).hasFixedKeySpace=function(){return!1},i.addSegments=function(e){return this.add(this.i,e)},i.addManifests=function(e){return this.add(this.g,e)},i.updateManifest=function(e,t){return function(e,t,n){var i=(e=Pm(e.h,e.g)).store();return i.get(t).onsuccess=function(){i.put(n,t)},e.promise()}(this,e,t)},i.qd=function(e){return null==e.expiration&&(e.expiration=1/0),Promise.resolve(e)},(i=qm.prototype).init=function(){var t=this,n=new wi,i=!1,r=new ln((function(){i=!0,n.reject(new ye(2,9,9017))}));r.S(5);var a=e.indexedDB.open("shaka_offline_db",5);return a.onsuccess=function(){if(!i){var e=a.result;t.l=e;var o=e.objectStoreNames;o=o.contains("manifest")&&o.contains("segment")?new Vm(e,"segment","manifest"):null,t.g=o,o=(o=e.objectStoreNames).contains("manifest-v2")&&o.contains("segment-v2")?new Xm(e,"segment-v2","manifest-v2"):null,t.h=o,o=(o=e.objectStoreNames).contains("manifest-v3")&&o.contains("segment-v3")?new Xm(e,"segment-v3","manifest-v3"):null,t.i=o,o=(o=e.objectStoreNames).contains("manifest-v5")&&o.contains("segment-v5")?new Ym(e,"segment-v5","manifest-v5"):null,t.j=o,e=e.objectStoreNames.contains("session-ids")?new Um(e):null,t.m=e,r.stop(),n.resolve()}},a.onupgradeneeded=function(){for(var e=a.result,t=l(["segment-v5","manifest-v5","session-ids"]),n=t.next();!n.done;n=t.next())n=n.value,e.objectStoreNames.contains(n)||e.createObjectStore(n,{autoIncrement:!0})},a.onerror=function(e){i||(n.reject(new ye(2,9,9001,a.error)),r.stop(),e.preventDefault())},n},i.destroy=function(){var e=this;return L((function(t){switch(t.g){case 1:if(!e.g){t.F(2);break}return _(t,e.g.destroy(),2);case 2:if(!e.h){t.F(4);break}return _(t,e.h.destroy(),4);case 4:if(!e.i){t.F(6);break}return _(t,e.i.destroy(),6);case 6:if(!e.j){t.F(8);break}return _(t,e.j.destroy(),8);case 8:if(!e.m){t.F(10);break}return _(t,e.m.destroy(),10);case 10:e.l&&e.l.close(),w(t)}}))},i.getCells=function(){var e=new Map;return this.g&&e.set("v1",this.g),this.h&&e.set("v2",this.h),this.i&&e.set("v3",this.i),this.j&&e.set("v5",this.j),e},i.getEmeSessionCell=function(){return this.m},i.erase=function(){var t=this;return L((function(n){switch(n.g){case 1:if(!t.g){n.F(2);break}return _(n,t.g.destroy(),2);case 2:if(!t.h){n.F(4);break}return _(n,t.h.destroy(),4);case 4:if(!t.i){n.F(6);break}return _(n,t.i.destroy(),6);case 6:if(!t.j){n.F(8);break}return _(n,t.j.destroy(),8);case 8:return t.l&&t.l.close(),_(n,function(){var t=new wi,n=e.indexedDB.deleteDatabase("shaka_offline_db");return n.onblocked=function(){},n.onsuccess=function(){t.resolve()},n.onerror=function(e){t.reject(new ye(2,9,9001,n.error)),e.preventDefault()},t}(),10);case 10:return t.l=null,t.g=null,t.h=null,t.i=null,t.j=null,_(n,t.init(),0)}}))},jm("idb",(function(){return yn()||pn()||!e.indexedDB?null:new qm})),Zm.prototype.qb=function(){return this.i},Zm.prototype.Ma=function(){return this.h},Zm.prototype.key=function(){return this.l},Zm.prototype.toString=function(){return this.j},(i=tv.prototype).configure=function(){},i.start=function(e,t){var n,i,r,a,o,s,u=this;return L((function(l){switch(l.g){case 1:if(n=Jm(e),u.g=n,null==n||"manifest"!=n.g)throw new ye(2,1,9004,e);return i=new Bm,T(l,2),_(l,i.init(),4);case 4:return _(l,Gm(i,n.qb(),n.Ma()),5);case 5:return _(l,l.h.getManifests([n.key()]),6);case 6:return r=l.h,a=r[0],o=new Qm(n.qb(),n.Ma()),s=$m(o,a),t.makeTextStreamsForClosedCaptions(s),l.return(s);case 2:return C(l),_(l,i.destroy(),7);case 7:x(l,0)}}))},i.stop=function(){return Promise.resolve()},i.update=function(){},i.onExpirationUpdated=function(e,t){var n,i,r,a,o,s,u,l=this;return L((function(h){switch(h.g){case 1:return n=l.g,i=new Bm,S(h,2,3),_(h,i.init(),5);case 5:return _(h,Gm(i,n.qb(),n.Ma()),6);case 6:return _(h,(r=h.h).getManifests([n.key()]),7);case 7:if(a=h.h,o=a[0],s=o.sessionIds.includes(e),u=null==o.expiration||o.expiration>t,!s||!u){h.F(3);break}return _(h,r.updateManifestExpiration(n.key(),t),3);case 3:return C(h),_(h,i.destroy(),10);case 10:x(h,0);break;case 2:E(h),h.F(3)}}))},i.onInitialVariantChosen=function(){},i.banLocation=function(){},va["application/x-offline-manifest"]=function(){return new tv},G("shaka.offline.OfflineScheme",nv),nv.plugin=iv,Pi("offline",iv),(i=dv.prototype).destroy=function(){return this.l.destroy()},i.configure=function(e,t){return 2==arguments.length&&"string"==typeof e&&(e=Mu(e,t)),ju(this.h,e)},i.getConfiguration=function(){var e=Gu();return ju(e,this.h,Gu()),e},i.Yb=function(){return this.g},i.store=function(e,t,n){var i=this,r=this.getConfiguration(),a=new Em(this.g);return this.j.push(a),t=function(e,t,n,i,r,a){var o,s,u,h,c,d,p,f,g,m,v,y,b;return L((function(T){switch(T.g){case 1:return Av(),s=o=null,u=new Bm,d=c=h=null,S(T,2,3),_(T,i(),5);case 5:return o=T.h,_(T,function(e,t,n,i){var r,a,o,s,u;return L((function(l){if(1==l.g)return r=null,a=e.g,o={networkingEngine:a,filter:function(){return Promise.resolve()},makeTextStreamsForClosedCaptions:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(e){r=e},isLowLatencyMode:function(){return!1},isAutoLowLatencyMode:function(){return!1},enableLowLatencyMode:function(){},updateDuration:function(){},newDrmInfo:function(){},onManifestUpdated:function(){},getBandwidthEstimate:function(){return i.abr.defaultBandwidthEstimate}},n.configure(i.manifest),Tv(e),_(l,n.start(t,o),2);if(3!=l.g)return s=l.h,Tv(e),u=Cv(s),_(l,Promise.all(Q(u,(function(e){return e.createSegmentIndex()}))),3);if(Tv(e),r)throw r;return l.return(s)}))}(e,t,o,r),6);case 6:if(p=T.h,Tv(e),p.presentationTimeline.R()||p.presentationTimeline.wc())throw new ye(2,9,9005,t);return _(T,function(e,t,n,i){var r;return L((function(a){return 1==a.g?((r=new Wr({zc:e.g,onError:n,Fe:function(){},onExpirationUpdated:function(){},onEvent:function(){}})).configure(i.drm),_(a,function(e,t,n){return e.ha=!0,e.C=new Map,e.M=n,Xr(e,t)}(r,t.variants,i.offline.usePersistentLicense),2)):3!=a.g?_(a,Yr(r),3):a.return(r)}))}(e,p,(function(e){d=d||e}),r),7);case 7:if(s=T.h,Tv(e),d)throw d;return _(T,function(e,t,n){var i,r,a,o,s,u,h,c,d,p,f,g,m,v,y,b,T,C,x,I,k,M,P,D,R,N,O;return L((function(L){switch(L.g){case 1:return i={width:1/0,height:1/0},function(e,t,n){e.variants=e.variants.filter((function(e){return In(e,t,n)}))}(e,n.restrictions,i),_(L,Mn(t,e,n.offline.usePersistentLicense),2);case 2:for(r=[],a=n.preferredDecodingAttributes,o=n.preferredVideoCodecs,s=n.preferredAudioCodecs,xn(e,o,s,a),u=l(e.variants),h=u.next();!h.done;h=u.next())c=h.value,r.push(Un(c));for(d=l(e.textStreams),p=d.next();!p.done;p=d.next())f=p.value,r.push(Bn(f));for(g=l(e.imageStreams),m=g.next();!m.done;m=g.next())v=m.value,r.push(Fn(v));return _(L,n.offline.trackSelectionCallback(r),3);case 3:for(y=L.h,b=e.presentationTimeline.getDuration(),T=0,C=l(y),x=C.next();!x.done;x=C.next())I=x.value,k=I.bandwidth*b/8,T+=k;return S(L,4),_(L,n.offline.downloadSizeCallback(T),6);case 6:if(!L.h)throw new ye(2,9,9014);A(L,5);break;case 4:if((M=E(L))instanceof ye)throw M;throw new ye(2,9,9015);case 5:for(P=new Set,D=new Set,R=new Set,N=l(y),x=N.next();!x.done;x=N.next())"variant"==(O=x.value).type&&P.add(O.id),"text"==O.type&&D.add(O.id),"image"==O.type&&R.add(O.id);e.variants=e.variants.filter((function(e){return P.has(e.id)})),e.textStreams=e.textStreams.filter((function(e){return D.has(e.id)})),e.imageStreams=e.imageStreams.filter((function(e){return R.has(e.id)})),function(e){e.variants.map((function(e){return e.video}));var t=new Set(e.variants.map((function(e){return e.audio})));e=e.textStreams;for(var n=l(t),i=n.next();!i.done;i=n.next())for(var r=(i=l(t)).next();!r.done;r=i.next());for(n=(t=l(e)).next();!n.done;n=t.next())for(i=(n=l(e)).next();!i.done;i=n.next());}(e),w(L)}}))}(p,s,r),8);case 8:return _(T,u.init(),9);case 9:return Tv(e),_(T,Fm(u),10);case 10:return h=T.h,Tv(e),f=function(e,t,n,i,r,a){var o=function(e,t,n){return{offlineUri:null,originalManifestUri:e,duration:t.presentationTimeline.getDuration(),size:0,expiration:1/0,tracks:t=sv(t),appMetadata:n,isIncomplete:!1}}(n,t,i),s=r.offline.progressCallback;!function(e,t,n){e.m=function(e,t){o.size=t,s(o,e)},e.l=n}(a,0,(function(t,n){u&&r.offline.usePersistentLicense&&h==n&&qr(e,"cenc",t)}));var u=mv(t)&&!vv(t),h=null;u&&(h=xv.get(e.g.keySystem));for(var c=new uv,d=l(t.textStreams),p=d.next();!p.done;p=d.next())c.g[p.value.id]=52;for(p=(d=l(t.imageStreams)).next();!p.done;p=d.next())hv(c,p.value);for(d=(p=l(t.variants)).next();!d.done;d=p.next())lv(c,d.value);return c=function(e,t,n,i){for(var r=new Map,a=Cv(n),o=new Map,s=(a=l(a)).next();!s.done;s=a.next()){var u=Sv(e,t,n,s=s.value,i,r);o.set(s.id,u)}for(t=(e=l(n.variants)).next();!t.done;t=e.next())(t=t.value).audio&&o.get(t.audio.id).variantIds.push(t.id),t.video&&o.get(t.video.id).variantIds.push(t.id);return{streams:Array.from(o.values()),vg:Array.from(r.values())}}(a,c,t,r),a=c.streams,c=c.vg,p=e.g,d=r.offline.usePersistentLicense,p&&d&&(p.initData=[]),{Si:{creationTime:Date.now(),originalManifestUri:n,duration:t.presentationTimeline.getDuration(),size:0,expiration:e.td(),streams:a,sessionIds:d?Jr(e):[],drmInfo:p,appMetadata:i,isIncomplete:!0,sequenceMode:t.sequenceMode,type:t.type},vg:c}}(s,p,t,n,r,a),g=f.Si,m=f.vg,_(T,h.Ma.addManifests([g]),11);case 11:if(v=T.h,Tv(e),c=v[0],Tv(e),d)throw d;return _(T,function(e,t,n,i,r,a,o,s,u){var h,c,d,p,f,g,m,v,y,b;return L((function(T){switch(T.g){case 1:if(h={},c=0,d=function(t,d){var p,f,g,m,v,y,b;return L((function(S){if(1==S.g){for(p={},f=l(t),g=f.next();!g.done;p={kc:p.kc},g=f.next())p.kc=g.value,m=Sm(p.kc,a),v=p.kc.i,y=p.kc.h,b=function(t){return function(n){var i,r,a;return L((function(s){if(1==s.g)return _(s,o.addSegments([{data:n}]),2);i=s.h,Tv(e),r=t.kc.g,a=wm(r),h[a]=i[0],c+=n.byteLength,w(s)}))}}(p),xm(r,p.kc.groupId,m,v,y,b);return _(S,function(e){return L((function(t){return 1==t.g?_(t,Promise.all(e.j.values()),2):t.return(e.g.h)}))}(r),2)}return d?(Tv(e),yv(s,i,u,a),_(S,o.updateManifest(n,i),0)):S.F(0)}))},p=!1,S(T,2),!mv(s)||!p||vv(s)){T.F(4);break}return _(T,d(t.filter((function(e){return e.h})),!0),5);case 5:return Tv(e),t=t.filter((function(e){return!e.h})),f=h,g=c,h={},c=0,_(T,gv(o,n,i,f,g,(function(){return Tv(e)})),6);case 6:Tv(e);case 4:if(p){T.F(7);break}return _(T,d(t,!1),8);case 8:return Tv(e),m=h,v=c,h={},c=0,_(T,gv(o,n,i,m,v,(function(){return Tv(e)})),9);case 9:Tv(e);case 7:A(T,0);break;case 2:return y=E(T),b=Object.values(h),_(T,o.removeSegments(b,(function(){})),10);case 10:throw y}}))}(e,m,c,g,a,r,h.Ma,p,s),12);case 12:return Tv(e),yv(p,g,s,r),_(T,h.Ma.updateManifest(c,g),13);case 13:return Tv(e),y=new Zm("manifest",h.path.qb,h.path.Ma,c),T.return(ov(y,g));case 3:return C(T),_(T,u.destroy(),14);case 14:if(!o){T.F(15);break}return _(T,o.stop(),15);case 15:if(!s){T.F(17);break}return _(T,s.destroy(),17);case 17:x(T,0);break;case 2:if(b=E(T),null==c){T.F(19);break}return _(T,fv(c),19);case 19:throw d||b}}))}(this,e,t||{},(function(){var t;return L((function(a){return 1==a.g?n?a.F(2):_(a,Ws(e,i.g,r.manifest.retryParameters),3):(2!=a.g&&(n=a.h),t=ma(e,n||null),a.return(t()))}))}),r,a),(t=new Si(t,(function(){return Cm(a)}))).finally((function(){lt(i.j,a)})),function(e,t){var n=t.promise;return e.i.push(n),t.finally((function(){lt(e.i,n)}))}(this,t)},i.remove=function(e){return Ev(this,function(e,t){var n,i,r,a,o,s;return L((function(u){switch(u.g){case 1:if(Av(),null==(n=Jm(t))||"manifest"!=n.g)throw new ye(2,9,9004,t);return i=n,r=new Bm,T(u,2),_(u,r.init(),4);case 4:return _(u,Gm(r,i.qb(),i.Ma()),5);case 5:return _(u,(a=u.h).getManifests([i.key()]),6);case 6:return o=u.h,s=o[0],_(u,Promise.all([_v(e,s,r),wv(a,i,s)]),2);case 2:return C(u),_(u,r.destroy(),8);case 8:x(u,0)}}))}(this,e))},i.fj=function(){return Ev(this,function(e){var t,n,i,r,a,o,s,u,h,c;return L((function(d){switch(d.g){case 1:return Av(),t=e.g,n=e.h.drm,i=new Bm,r=!1,T(d,2),_(d,i.init(),4);case 4:a=[],function(e,t){e.g.forEach((function(e){var t;t=e.getEmeSessionCell(),a.push(t)}))}(i),o=l(a),s=o.next();case 5:if(s.done){d.F(2);break}return _(d,(u=s.value).getAll(),8);case 8:return h=d.h,_(d,rv(n,t,h),9);case 9:return c=d.h,_(d,u.remove(c),10);case 10:c.length!=h.length&&(r=!0),s=o.next(),d.F(5);break;case 2:return C(d),_(d,i.destroy(),11);case 11:x(d,3);break;case 3:return d.return(!r)}}))}(this))},i.list=function(){return Ev(this,L((function(i){switch(i.g){case 1:return Av(),e=[],t=new Bm,T(i,2),_(i,t.init(),4);case 4:return n=Promise.resolve(),function(e,t){e.g.forEach((function(e,n){e.getCells().forEach((function(e,i){t({qb:n,Ma:i},e)}))}))}(t,(function(t,i){n=n.then((function(){return L((function(n){if(1==n.g)return _(n,i.getAllManifests(),2);n.h.forEach((function(n,i){n=ov(new Zm("manifest",t.qb,t.Ma,i),n),e.push(n)})),w(n)}))}))})),_(i,n,2);case 2:return C(i),_(i,t.destroy(),6);case 6:x(i,3);break;case 3:return i.return(e)}})));var e,t,n},G("shaka.offline.Storage",dv),dv.deleteAll=function(){var e;return L((function(t){return 1==t.g?(e=new Bm,T(t,2),_(t,function(e){var t,n;return L((function(i){return 1==i.g?(t=Array.from(e.g.values()),(n=0<t.length)||Hm.forEach((function(e){(e=e())&&t.push(e)})),_(i,Promise.all(t.map((function(e){return e.erase()}))),2)):n?i.F(0):_(i,Promise.all(t.map((function(e){return e.destroy()}))),0)}))}(e),2)):5!=t.g?(C(t),_(t,e.destroy(),5)):x(t,0)}))},dv.prototype.list=dv.prototype.list,dv.prototype.removeEmeSessions=dv.prototype.fj,dv.prototype.remove=dv.prototype.remove,dv.prototype.store=dv.prototype.store,dv.prototype.getNetworkingEngine=dv.prototype.Yb,dv.prototype.getConfiguration=dv.prototype.getConfiguration,dv.prototype.configure=dv.prototype.configure,dv.prototype.destroy=dv.prototype.destroy,dv.support=pv;var xv=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.recommendation","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.software","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.hardware","9a04f07998404286ab92e65be0885f95").set("com.adobe.primetime","f239e769efa348509c16a903c6932efb");function Iv(){}function kv(){for(var e=l(Pv),t=e.next();!t.done;t=e.next()){t=t.value;try{t.callback()}catch(e){X("Error installing polyfill!",e)}}}function Mv(e,t){for(e={priority:t||0,callback:e},t=0;t<Pv.length;t++)if(Pv[t].priority<e.priority)return void Pv.splice(t,0,e);Pv.push(e)}Zl.offline=pv,G("shaka.polyfill",Iv),Iv.register=Mv,Iv.installAll=kv;var Pv=[];function Lv(){this.g=new Rv}function Dv(){e.AbortController||(e.AbortController=Lv,e.AbortSignal=Rv)}function Rv(){J.call(this),this.h=!1,this.g=void 0,this.onabort=null}function Nv(){}function Ov(){if(!Object.getOwnPropertyDescriptor(Element.prototype,"ariaHidden"))for(var e=l(["ariaHidden","ariaLabel","ariaPressed","ariaSelected"]),t=e.next();!t.done;t=e.next())Uv(t.value)}function Uv(e){var t="aria-"+e.toLowerCase().replace(/^aria/,"");Object.defineProperty(Element.prototype,e,{get:function(){return this.getAttribute(t)},set:function(e){null==e||null==e?this.removeAttribute(t):this.setAttribute(t,e)}})}function Bv(){}function Fv(){Z_()}function Gv(){}function jv(){if(e.Document){var t=Element.prototype;t.requestFullscreen=t.requestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen||t.webkitRequestFullscreen,(t=Document.prototype).exitFullscreen=t.exitFullscreen||t.mozCancelFullScreen||t.msExitFullscreen||t.webkitCancelFullScreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",Hv),document.addEventListener("webkitfullscreenerror",Hv),document.addEventListener("mozfullscreenchange",Hv),document.addEventListener("mozfullscreenerror",Hv),document.addEventListener("MSFullscreenChange",Hv),document.addEventListener("MSFullscreenError",Hv)}}function Hv(e){var t=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),n=document.createEvent("Event");n.initEvent(t,e.bubbles,e.cancelable),e.target.dispatchEvent(n)}function Vv(){}function Wv(){var e=!0;(bn()||Sn("PlayStation 5")||_n()||Sn("Web0S")||fn()||yn()||Sn("PC=EOS")||Sn("Hisense")||Sn("VIDAA"))&&(e=!1),e&&navigator.mediaCapabilities||(navigator.mediaCapabilities||(navigator.mediaCapabilities={}),Xv=navigator.mediaCapabilities,navigator.mediaCapabilities.decodingInfo=zv)}function zv(t){var n,i,r,a,o,s,u,l,h,c,d,p,f,g,m;return L((function(v){switch(v.g){case 1:if(n={supported:!1,powerEfficient:!0,smooth:!0,keySystemAccess:null,configuration:t},!t)return v.return(n);if(i=t.video,r=t.audio,"media-source"==t.type){if(!hn())return v.return(n);if(i){if(yn())if(e.cast&&cast.__platform__&&cast.__platform__.canDisplayType){var y=i.contentType;i.width&&i.height&&(y+="; width="+i.width+"; height="+i.height),i.framerate&&(y+="; framerate="+i.framerate),"pq"===i.transferFunction&&(y+="; eotf=smpte2084"),a=cast.__platform__.canDisplayType(y)}else a=ze(i.contentType);else fn()?(o=i.contentType,i.width&&i.height&&(o+="; width="+i.width,o+="; height="+i.height),i.framerate&&(o+="; framerate="+i.framerate),i.bitrate&&(o+="; bitrate="+i.bitrate),a=ze(o)):a=ze(i.contentType);if(!a)return v.return(n)}if(r&&(yn()&&r.spatialRendering?(u=r.contentType+"; spatialRendering=true",s=ze(u)):s=ze(r.contentType),!s))return v.return(n)}else{if("file"!=t.type)return v.return(n);if(i&&!cn(i.contentType)||r&&!cn(r.contentType))return v.return(n)}if(!t.keySystemConfiguration)return n.supported=!0,v.return(Promise.resolve(n));if(l=t.keySystemConfiguration,h=[],c=[],l.audio&&(d={robustness:l.audio.robustness||"",contentType:t.audio.contentType},fn()&&t.audio.contentType.includes('codecs="ac-3"')&&(d={robustness:d.robustness,contentType:'audio/mp4; codecs="ec-3"'}),h.push(d)),l.video&&(p={robustness:l.video.robustness||"",contentType:t.video.contentType},c.push(p)),f={initDataTypes:[l.initDataType],distinctiveIdentifier:l.distinctiveIdentifier,persistentState:l.persistentState,sessionTypes:l.sessionTypes},h.length&&(f.audioCapabilities=h),c.length&&(f.videoCapabilities=c),g=(t.video?t.video.contentType:"")+"#"+(t.audio?t.audio.contentType:"")+"#"+t.keySystemConfiguration.keySystem,S(v,3),g in $v){m=$v[g],v.F(5);break}return _(v,navigator.requestMediaKeySystemAccess(l.keySystem,[f]),6);case 6:m=v.h,$v[g]=m;case 5:A(v,4);break;case 3:E(v);case 4:m&&(n.supported=!0,n.keySystemAccess=m);case 2:return v.return(n)}}))}Lv.prototype.abort=function(e){var t=this.g;t.h||(t.h=!0,t.g=e,void 0===t.g&&(t.g=new DOMException("signal is aborted without reason","AbortError")),e=new j("abort"),t.onabort&&t.onabort(e),t.dispatchEvent(e))},o.Object.defineProperties(Lv.prototype,{signal:{configurable:!0,enumerable:!0,get:function(){return this.g}}}),Iv.AbortController=Lv,Lv.install=Dv,m(Rv,J),o.Object.defineProperties(Rv.prototype,{aborted:{configurable:!0,enumerable:!0,get:function(){return this.h}},reason:{configurable:!0,enumerable:!0,get:function(){return this.g}}}),Mv(Dv),Iv.Aria=Nv,Nv.install=Ov,Mv(Ov),Iv.EncryptionScheme=Bv,Bv.install=Fv,Mv(Fv,-2),Iv.Fullscreen=Gv,Gv.install=jv,Mv(jv),Iv.MediaCapabilities=Vv,Vv.install=Wv;var Xv=null;Vv.originalMcap=Xv;var Kv,Yv,qv,Zv,Jv,Qv,$v={};function ey(){}function ty(){var t=wn();e.MediaSource&&(e.cast&&cast.__platform__&&cast.__platform__.canDisplayType?function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){var n=t.split(/ *; */);return n.shift(),n.some((function(e){return e.startsWith("codecs=")}))?cast.__platform__.canDisplayType(t):e(t)}}():t?10>=t?e.MediaSource=null:12>=t?(ny(),function(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,n){return e.call(this,t,n-.001)}}()):15>=t&&ny():dn()?function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){return"mp2t"!=t.split(";")[0].split("/")[1]&&e(t)}}():(mn()||gn()||Sn("Tizen 4"))&&function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){return"opus"!=Xt(t)&&e(t)}}()),e.MediaSource&&MediaSource.isTypeSupported('video/webm; codecs="vp9"')&&!MediaSource.isTypeSupported('video/webm; codecs="vp09.00.10.08"')&&function(){var e=MediaSource.isTypeSupported;Sn("Web0S")||(MediaSource.isTypeSupported=function(t){var n=t.split(/ *; */),i=n.findIndex((function(e){return e.startsWith("codecs=")}));if(0>i)return e(t);var r=n[i].replace("codecs=","").replace(/"/g,"").split(/\s*,\s*/),a=r.findIndex((function(e){return e.startsWith("vp09")}));return 0<=a&&(r[a]="vp9",n[i]='codecs="'+r.join(",")+'"',t=n.join("; ")),e(t)})}()}function ny(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(){var t=e.apply(this,D.apply(0,arguments));return t.abort=function(){},t}}function iy(){}function ry(){screen.orientation&&screen.orientation.unlock||(null!=screen.orientation?(void 0===screen.orientation.lock&&(screen.orientation.lock=function(){return Promise.resolve()}),void 0===screen.orientation.unlock&&(screen.orientation.unlock=function(){})):null!=e.orientation&&function(){function t(){switch(e.orientation){case-90:n.type="landscape-secondary",n.angle=270;break;case 0:n.type="portrait-primary",n.angle=0;break;case 90:n.type="landscape-primary",n.angle=90;break;case 180:n.type="portrait-secondary",n.angle=180}}var n=new ay;screen.orientation=n,t(),e.addEventListener("orientationchange",(function(){t();var e=new j("change");n.dispatchEvent(e)}))}())}function ay(){J.call(this),this.type="",this.angle=0}function oy(){}function sy(e,t){try{var n=new hy(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function uy(e){var t=this.mediaKeys;return t&&t!=e&&dy(t,null),delete this.mediaKeys,(this.mediaKeys=e)?dy(e,this):Promise.resolve()}function ly(e){if(nt(e=et(e.initData)).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");e=Qi(e=Zi(e.subarray(4),!0));var t=new Event("encrypted");t.initDataType="skd",t.initData=$e(e),this.dispatchEvent(t)}function hy(e,t){if(this.keySystem=e,e.startsWith("com.apple.fps"))for(t=(e=l(t)).next();!t.done;t=e.next()){var n=t.value;if("required"==n.persistentState)t=null;else{t={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:n.initDataTypes,sessionTypes:["temporary"],label:n.label};var i=!1,r=!1;if(n.audioCapabilities)for(var a=l(n.audioCapabilities),o=a.next();!o.done;o=a.next())(o=o.value).contentType&&(i=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,o.contentType.split(";")[0])&&(t.audioCapabilities.push(o),r=!0));if(n.videoCapabilities)for(o=(n=l(n.videoCapabilities)).next();!o.done;o=n.next())(a=o.value).contentType&&(i=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,a.contentType.split(";")[0])&&(t.videoCapabilities.push(a),r=!0));i||(r=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),t=r?t:null}if(t)return void(this.g=t)}throw(e=Error("Unsupported keySystem")).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}function cy(e){this.h=new WebKitMediaKeys(e),this.g=new Hi}function dy(e,t){if(e.g.ub(),!t)return Promise.resolve();e.g.o(t,"webkitneedkey",ly);try{return Wo(t,HTMLMediaElement.HAVE_METADATA,e.g,(function(){t.webkitSetMediaKeys(e.h)})),Promise.resolve()}catch(e){return Promise.reject(e)}}function py(e){J.call(this),this.i=null,this.l=e,this.g=this.h=null,this.j=new Hi,this.sessionId="",this.expiration=NaN,this.closed=new wi,this.keyStatuses=new gy}function fy(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.g=t,t=new j("keystatuseschange"),e.dispatchEvent(t)}function gy(){this.size=0,this.g=void 0}function my(){}function vy(){!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(navigator.requestMediaKeySystemAccess=yy,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=by,e.MediaKeys=_y,e.MediaKeySystemAccess=wy,e.shakaMediaKeysPolyfill=!0)}function yy(){return Promise.reject(Error("The key system specified is not supported."))}function by(e){return null==e?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function _y(){throw new TypeError("Illegal constructor.")}function wy(){throw this.keySystem="",new TypeError("Illegal constructor.")}function Sy(){}function Ty(){if(!(!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)Oy="webkit";else if(!HTMLMediaElement.prototype.generateKeyRequest)return;navigator.requestMediaKeySystemAccess=Ey,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Cy,e.MediaKeys=Iy,e.MediaKeySystemAccess=xy,e.shakaMediaKeysPolyfill=!0}}function Ay(e){return Oy?Oy+e.charAt(0).toUpperCase()+e.slice(1):e}function Ey(e,t){try{var n=new xy(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function Cy(e){var t=this.mediaKeys;return t&&t!=e&&ky(t,null),delete this.mediaKeys,(this.mediaKeys=e)&&ky(e,this),Promise.resolve()}function xy(e,t){this.g=this.keySystem=e;var n=!1;"org.w3.clearkey"==e&&(this.g="webkit-org.w3.clearkey",n=!1);var i=!1,r=document.getElementsByTagName("video");r=r.length?r[0]:document.createElement("video");for(var a=(t=l(t)).next();!a.done;a=t.next()){var o={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:(a=a.value).initDataTypes,sessionTypes:["temporary"],label:a.label},s=!1;if(a.audioCapabilities)for(var u=l(a.audioCapabilities),h=u.next();!h.done;h=u.next())(h=h.value).contentType&&(s=!0,r.canPlayType(h.contentType.split(";")[0],this.g)&&(o.audioCapabilities.push(h),i=!0));if(a.videoCapabilities)for(h=(u=l(a.videoCapabilities)).next();!h.done;h=u.next())(h=h.value).contentType&&(s=!0,r.canPlayType(h.contentType,this.g)&&(o.videoCapabilities.push(h),i=!0));if(s||(i=r.canPlayType("video/mp4",this.g)||r.canPlayType("video/webm",this.g)),"required"==a.persistentState&&(n?(o.persistentState="required",o.sessionTypes=["persistent-license"]):i=!1),i)return void(this.h=o)}throw n="Unsupported keySystem","org.w3.clearkey"!=e&&"com.widevine.alpha"!=e||(n="None of the requested configurations were supported."),(e=Error(n)).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}function Iy(e){this.l=e,this.h=null,this.g=new Hi,this.i=[],this.j=new Map}function ky(e,t){e.h=t,e.g.ub();var n=Oy;t&&(e.g.o(t,n+"needkey",(function(t){var n=new CustomEvent("encrypted");n.initDataType="cenc",n.initData=$e(t.initData),e.h.dispatchEvent(n)})),e.g.o(t,n+"keymessage",(function(t){var n=My(e,t.sessionId);n&&(t=new j("message",t=(new Map).set("messageType",null==n.keyStatuses.sc()?"licenserequest":"licenserenewal").set("message",t.message)),n.h&&(n.h.resolve(),n.h=null),n.dispatchEvent(t))})),e.g.o(t,n+"keyadded",(function(t){(t=My(e,t.sessionId))&&(Ry(t,"usable"),t.g&&t.g.resolve(),t.g=null)})),e.g.o(t,n+"keyerror",(function(t){var n=My(e,t.sessionId);if(n){var i=Error("EME v0.1b key error"),r=t.errorCode;r.systemCode=t.systemCode,i.errorCode=r,!t.sessionId&&n.h?(45==t.systemCode&&(i.message="Unsupported session type."),n.h.reject(i),n.h=null):t.sessionId&&n.g?(n.g.reject(i),n.g=null):(i=t.systemCode,t.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Ry(n,"output-restricted"):Ry(n,1==i?"expired":"internal-error"))}})))}function My(e,t){var n=e.j.get(t);return n||((n=e.i.shift())?(n.sessionId=t,e.j.set(t,n),n):null)}function Py(e,t,n){J.call(this),this.j=e,this.m=!1,this.g=this.h=null,this.i=t,this.l=n,this.sessionId="",this.expiration=NaN,this.closed=new wi,this.keyStatuses=new Ny}function Ly(e,t,n){if(e.m)return Promise.reject(Error("The session is already initialized."));e.m=!0;try{if("persistent-license"==e.l)if(n)var i=et(Qi("LOAD_SESSION|"+n));else{var r=Qi("PERSISTENT|");i=_r(r,t)}else i=et(t)}catch(e){return Promise.reject(e)}e.h=new wi;var a=Ay("generateKeyRequest");try{e.j[a](e.i,i)}catch(t){if("InvalidStateError"!=t.name)return e.h=null,Promise.reject(t);new ln((function(){try{e.j[a](e.i,i)}catch(t){e.h.reject(t),e.h=null}})).S(.01)}return e.h}function Dy(e,t,n){if(e.g)e.g.then((function(){return Dy(e,t,n)})).catch((function(){return Dy(e,t,n)}));else{if(e.g=t,"webkit-org.w3.clearkey"==e.i){var i=qi(n),r=JSON.parse(i);"oct"!=r.keys[0].kty&&(e.g.reject(Error("Response is not a valid JSON Web Key Set.")),e.g=null),i=vr(r.keys[0].k),r=vr(r.keys[0].kid)}else i=et(n),r=null;var a=Ay("addKey");try{e.j[a](e.i,i,r,e.sessionId)}catch(t){e.g.reject(t),e.g=null}}}function Ry(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.g=t,t=new j("keystatuseschange"),e.dispatchEvent(t)}function Ny(){this.size=0,this.g=void 0}Vv.memoizedMediaKeySystemAccessRequests_=$v,Mv(Wv,-1),Iv.MediaSource=ey,ey.install=ty,Mv(ty),Iv.Orientation=iy,iy.install=ry,m(ay,J),ay.prototype.lock=function(e){function t(e){return screen.lockOrientation?screen.lockOrientation(e):screen.mozLockOrientation?screen.mozLockOrientation(e):!!screen.msLockOrientation&&screen.msLockOrientation(e)}var n=!1;switch(e){case"natural":n=t("default");break;case"any":n=!0,this.unlock();break;default:n=t(e)}return n?Promise.resolve():((e=Error("screen.orientation.lock() is not available on this device")).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,Promise.reject(e))},ay.prototype.unlock=function(){screen.unlockOrientation?screen.unlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()},Mv(ry),Iv.PatchedMediaKeysApple=oy,oy.uninstall=function(){Kv&&(Kv=!1,Object.defineProperty(HTMLMediaElement.prototype,"mediaKeys",Yv),HTMLMediaElement.prototype.setMediaKeys=qv,e.MediaKeys=Zv,e.MediaKeySystemAccess=Jv,navigator.requestMediaKeySystemAccess=Qv,Yv=Qv=qv=Jv=Zv=null,e.shakaMediaKeysPolyfill=!1)},oy.install=function(t){e.HTMLVideoElement&&e.WebKitMediaKeys&&(void 0!==t&&t&&(Kv=!0,Yv=Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"mediaKeys"),qv=HTMLMediaElement.prototype.setMediaKeys,Zv=e.MediaKeys,Jv=e.MediaKeySystemAccess,Qv=navigator.requestMediaKeySystemAccess),delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=uy,e.MediaKeys=cy,e.MediaKeySystemAccess=hy,navigator.requestMediaKeySystemAccess=sy,e.shakaMediaKeysPolyfill=!0)},hy.prototype.createMediaKeys=function(){var e=new cy(this.keySystem);return Promise.resolve(e)},hy.prototype.getConfiguration=function(){return this.g},cy.prototype.createSession=function(e){if("temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new py(this.h,e)},cy.prototype.setServerCertificate=function(){return Promise.resolve(!1)},cy.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")},m(py,J),(i=py.prototype).generateRequest=function(e,t){var n=this;this.h=new wi;try{var i=this.l.createSession("video/mp4",et(t));this.i=i,this.sessionId=i.sessionId||"",this.j.o(this.i,"webkitkeymessage",(function(e){n.h&&(n.h.resolve(),n.h=null),e=new j("message",e=(new Map).set("messageType",null==n.keyStatuses.sc()?"license-request":"license-renewal").set("message",$e(e.message))),n.dispatchEvent(e)})),this.j.o(i,"webkitkeyadded",(function(){n.g&&(fy(n,"usable"),n.g.resolve(),n.g=null)})),this.j.o(i,"webkitkeyerror",(function(){var e=Error("EME PatchedMediaKeysApple key error");if(e.errorCode=n.i.error,null!=n.h)n.h.reject(e),n.h=null;else if(null!=n.g)n.g.reject(e),n.g=null;else switch(n.i.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:fy(n,"output-not-allowed");break;default:fy(n,"internal-error")}})),fy(this,"status-pending")}catch(e){this.h.reject(e)}return this.h},i.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},i.update=function(e){this.g=new wi;try{this.i.update(et(e))}catch(e){this.g.reject(e)}return this.g},i.close=function(){try{this.i.close(),this.closed.resolve(),this.j.ub()}catch(e){this.closed.reject(e)}return this.closed},i.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},(i=gy.prototype).sc=function(){return this.g},i.forEach=function(e){this.g&&e(this.g,fa.value())},i.get=function(e){if(this.has(e))return this.g},i.has=function(e){var t=fa.value();return!(!this.g||!Je(e,t))},i.entries=function(){},i.keys=function(){},i.values=function(){},Iv.PatchedMediaKeysNop=my,my.install=vy,_y.prototype.createSession=function(){},_y.prototype.setServerCertificate=function(){},_y.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")},wy.prototype.getConfiguration=function(){},wy.prototype.createMediaKeys=function(){},Mv(vy,-10),Iv.PatchedMediaKeysWebkit=Sy,Sy.install=Ty,xy.prototype.createMediaKeys=function(){var e=new Iy(this.g);return Promise.resolve(e)},xy.prototype.getConfiguration=function(){return this.h},Iy.prototype.createSession=function(e){if("temporary"!=(e=e||"temporary")&&"persistent-license"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=this.h||document.createElement("video");return t.src||(t.src="about:blank"),e=new Py(t,this.l,e),this.i.push(e),e},Iy.prototype.setServerCertificate=function(){return Promise.resolve(!1)},Iy.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")},m(Py,J),(i=Py.prototype).generateRequest=function(e,t){return Ly(this,t,null)},i.load=function(e){return"persistent-license"==this.l?Ly(this,null,e):Promise.reject(Error("Not a persistent session."))},i.update=function(e){var t=new wi;return Dy(this,t,e),t},i.close=function(){if("persistent-license"!=this.l){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var e=Ay("cancelKeyRequest");try{this.j[e](this.i,this.sessionId)}catch(e){}}return this.closed.resolve(),this.closed},i.remove=function(){return"persistent-license"!=this.l?Promise.reject(Error("Not a persistent session.")):this.close()},(i=Ny.prototype).sc=function(){return this.g},i.forEach=function(e){this.g&&e(this.g,fa.value())},i.get=function(e){if(this.has(e))return this.g},i.has=function(e){var t=fa.value();return!(!this.g||!Je(e,t))},i.entries=function(){},i.keys=function(){},i.values=function(){};var Oy="";function Uy(){}function By(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;t.requestPictureInPicture&&document.exitPictureInPicture||!t.webkitSupportsPresentationMode||(document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,t.requestPictureInPicture=Gy,Object.defineProperty(t,"disablePictureInPicture",{get:Hy,set:Vy,enumerable:!0,configurable:!0}),document.exitPictureInPicture=jy,document.addEventListener("webkitpresentationmodechanged",Fy,!0))}}function Fy(e){if("picture-in-picture"==(e=e.target).webkitPresentationMode){document.pictureInPictureElement=e;var t=new Event("enterpictureinpicture");e.dispatchEvent(t)}else document.pictureInPictureElement==e&&(document.pictureInPictureElement=null),t=new Event("leavepictureinpicture"),e.dispatchEvent(t)}function Gy(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function jy(){var e=document.pictureInPictureElement;return e?(e.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function Hy(){return!!this.hasAttribute("disablePictureInPicture")||!this.webkitSupportsPresentationMode("picture-in-picture")}function Vy(e){e?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")}function Wy(){}function zy(){e.crypto&&("randomUUID"in e.crypto||(e.crypto.randomUUID=Xy))}function Xy(){var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.substr(t.lastIndexOf("/")+1)}function Ky(){}function Yy(){navigator.storage&&navigator.storage.estimate||!navigator.webkitTemporaryStorage||!navigator.webkitTemporaryStorage.queryUsageAndQuota||("storage"in navigator||(navigator.storage={}),navigator.storage.estimate=qy)}function qy(){return new Promise((function(e,t){navigator.webkitTemporaryStorage.queryUsageAndQuota((function(t,n){e({usage:t,quota:n})}),t)}))}function Zy(){}function Jy(){var e=Symbol.prototype;"description"in e||Object.defineProperty(e,"description",{get:Qy})}function Qy(){var e=/\((.*)\)/.exec(this.toString());return e?e[1]:void 0}function $y(){}function eb(){if(e.HTMLMediaElement){var t=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var e=t.apply(this);return e&&e.catch((function(){})),e}}}function tb(){}function nb(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;!t.getVideoPlaybackQuality&&("webkitDroppedFrameCount"in t||vn())&&(t.getVideoPlaybackQuality=ib)}}function ib(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function rb(){}function ab(){if(!e.VTTCue&&e.TextTrackCue){var t=null,n=TextTrackCue.length;if(3==n)t=ob;else if(6==n)t=sb;else{try{var i=!!ob(1,2,"")}catch(e){i=!1}i&&(t=ob)}t&&(e.VTTCue=function(e,n,i){return t(e,n,i)})}}function ob(t,n,i){return new e.TextTrackCue(t,n,i)}function sb(t,n,i){return new e.TextTrackCue(t+"-"+n+"-"+i,t,n,i)}function ub(){}Mv(Ty),Iv.PiPWebkit=Uy,Uy.install=By,Mv(By),Iv.RandomUUID=Wy,Wy.install=zy,Mv(zy),Iv.StorageEstimate=Ky,Ky.install=Yy,Mv(Yy),Iv.Symbol=Zy,Zy.install=Jy,Mv(Jy),Iv.VideoPlayPromise=$y,$y.install=eb,Mv(eb),Iv.VideoPlaybackQuality=tb,tb.install=nb,Mv(nb),Iv.VTTCue=rb,rb.install=ab,Mv(ab),ub.prototype.parseInit=function(){},ub.prototype.setSequenceMode=function(){},ub.prototype.setManifestType=function(){},ub.prototype.parseMedia=function(e,t){for(var n=null,i=[],r=(e=l(e=qi(e).split(/\r?\n/))).next();!r.done;r=e.next())if((r=r.value)&&!/^\s+$/.test(r)&&(r=lb.exec(r))){var a=hb.exec(r[1]);r=new dt(a=60*parseInt(a[1],10)+parseFloat(a[2].replace(",",".")),t.segmentEnd?t.segmentEnd:a+2,r[2]),n&&(n.endTime=a,i.push(n)),n=r}return n&&i.push(n),i},G("shaka.text.LrcTextParser",ub),ub.prototype.parseMedia=ub.prototype.parseMedia,ub.prototype.setManifestType=ub.prototype.setManifestType,ub.prototype.setSequenceMode=ub.prototype.setSequenceMode,ub.prototype.parseInit=ub.prototype.parseInit;var lb=/^\[(\d{1,2}:\d{1,2}(?:[.,]\d{1,3})?)\](.*)/,hb=/^(\d+):(\d{1,2}(?:[.,]\d{1,3})?)$/;function cb(){}function db(e,t,n,i,r,a,o,s,u,h,c,d){var p=e.parentNode;if(e.nodeType==Node.COMMENT_NODE)return null;if(e.nodeType==Node.TEXT_NODE){if(!c)return null;var f=document.createElement("span");f.textContent=e.textContent}else f=e;for(var g=null,m=l(Bb),v=m.next();!v.done&&!(g=yb(f,"backgroundImage",i,"#",v.value)[0]);v=m.next());m=null;var y=Ir(f,Bb,"backgroundImage");if(d&&y&&!y.startsWith("#")&&(v=new ne(d),y=new ne(y),(v=v.resolve(y).toString())&&(m=v)),("p"==e.nodeName||g||m)&&(c=!0),e=c,v="default"==(f.getAttribute("xml:space")||(s?"default":"preserve")),s=[],!(y=Array.from(f.childNodes).every((function(e){return e.nodeType==Node.TEXT_NODE}))))for(var b=l(f.childNodes),_=b.next();!_.done;_=b.next())(_=db(_.value,t,n,i,r,a,o,v,u,f,c,d))&&s.push(_);if(i=null!=h,d=/\S/.test(f.textContent),!((_=f.hasAttribute("begin")||f.hasAttribute("end")||f.hasAttribute("dur"))||d||"br"==f.tagName||0!=s.length||i&&!v))return null;for(d=(b=_b(f,n)).start,b=b.end;p&&p.nodeType==Node.ELEMENT_NODE&&"tt"!=p.tagName;)d=(b=bb(p,n,d,b)).start,b=b.end,p=p.parentNode;if(null==d&&(d=0),d+=t.periodStart,b=null==b?1/0:b+t.periodStart,d=Math.max(d,t.segmentStart),b=Math.min(b,t.segmentEnd),!_&&0<s.length)for(d=1/0,b=0,n=(t=l(s)).next();!n.done;n=t.next())n=n.value,d=Math.min(d,n.startTime),b=Math.max(b,n.endTime);if("br"==f.tagName)return(r=new dt(d,b,"")).lineBreak=!0,r;if(t="",y&&(t=f.textContent,v&&(t=(t=t.trim()).replace(/\s+/g," "))),(t=new dt(d,b,t)).nestedCues=s,c||(t.isContainer=!0),u&&(t.cellResolution=u),u=yb(f,"region",a,"")[0],f.hasAttribute("region")&&u&&u.getAttribute("xml:id")){var w=u.getAttribute("xml:id");t.region=o.filter((function(e){return e.id==w}))[0]}return o=u,h&&i&&!f.getAttribute("region")&&!f.getAttribute("style")&&(o=yb(h,"region",a,"")[0]),function(e,t,n,i,r,a,o,s){if("rtl"==fb(t,n,a,"direction",o=o||s)&&(e.direction="rtl"),"tb"==(s=fb(t,n,a,"writingMode",o))||"tblr"==s?e.writingMode="vertical-lr":"tbrl"==s?e.writingMode="vertical-rl":"rltb"==s||"rl"==s?e.direction="rtl":s&&(e.direction=_t),(s=fb(t,n,a,"textAlign",!0))?(e.positionAlign=Nb[s],e.lineAlign=Rb[s],e.textAlign=vt[s.toUpperCase()]):e.textAlign=mt,(s=fb(t,n,a,"displayAlign",!0))&&(e.displayAlign=bt[s.toUpperCase()]),(s=fb(t,n,a,"color",o))&&(e.color=s),(s=fb(t,n,a,"backgroundColor",o))&&(e.backgroundColor=s),(s=fb(t,n,a,"border",o))&&(e.border=s),s=fb(t,n,a,"fontFamily",o))switch(s){case"monospaceSerif":e.fontFamily="Courier New,Liberation Mono,Courier,monospace";break;case"proportionalSansSerif":e.fontFamily="Arial,Helvetica,Liberation Sans,sans-serif";break;case"sansSerif":e.fontFamily="sans-serif";break;case"monospaceSansSerif":e.fontFamily="Consolas,monospace";break;case"proportionalSerif":e.fontFamily="serif";break;default:e.fontFamily=s}switch((s=fb(t,n,a,"fontWeight",o))&&"bold"==s&&(e.fontWeight=700),s=fb(t,n,a,"wrapOption",o),e.wrapLine=!s||"noWrap"!=s,(s=fb(t,n,a,"lineHeight",o))&&s.match(Cb)&&(e.lineHeight=s),(s=fb(t,n,a,"fontSize",o))&&(s.match(Cb)||s.match(Eb))&&(e.fontSize=s),(s=fb(t,n,a,"fontStyle",o))&&(e.fontStyle=kt[s.toUpperCase()]),i?(r=i.getAttribute("imageType")||i.getAttribute("imagetype"),s=i.getAttribute("encoding"),i=i.textContent.trim(),"PNG"==r&&"Base64"==s&&i&&(e.backgroundImage="data:image/png;base64,"+i)):r&&(e.backgroundImage=r),(i=fb(t,n,a,"textOutline",o))&&((i=i.split(" "))[0].match(Cb)?e.textStrokeColor=e.color:(e.textStrokeColor=i[0],i.shift()),i[0]&&i[0].match(Cb)?e.textStrokeWidth=i[0]:e.textStrokeColor=""),(i=fb(t,n,a,"letterSpacing",o))&&i.match(Cb)&&(e.letterSpacing=i),(i=fb(t,n,a,"linePadding",o))&&i.match(Cb)&&(e.linePadding=i),(i=fb(t,n,a,"opacity",o))&&(e.opacity=parseFloat(i)),(i=gb(n,a,"textDecoration"))&&pb(e,i),(i=mb(t,a,"textDecoration"))&&pb(e,i),(i=fb(t,n,a,"textCombine",o))&&(e.textCombineUpright=i),fb(t,n,a,"ruby",o)){case"container":e.rubyTag="ruby";break;case"text":e.rubyTag="rt"}}(t,f,o,g,m,r,e,0==s.length),t}function pb(e,t){for(var n=(t=l(t.split(" "))).next();!n.done;n=t.next())switch(n.value){case"underline":e.textDecoration.includes("underline")||e.textDecoration.push("underline");break;case"noUnderline":e.textDecoration.includes("underline")&&lt(e.textDecoration,"underline");break;case"lineThrough":e.textDecoration.includes("lineThrough")||e.textDecoration.push("lineThrough");break;case"noLineThrough":e.textDecoration.includes("lineThrough")&&lt(e.textDecoration,"lineThrough");break;case"overline":e.textDecoration.includes("overline")||e.textDecoration.push("overline");break;case"noOverline":e.textDecoration.includes("overline")&&lt(e.textDecoration,"overline")}}function fb(e,t,n,i,r){return r=void 0===r||r,(e=mb(e,n,i))?e:r?gb(t,n,i):null}function gb(e,t,n){return e?Ir(e,Ub,n)||vb(e,t,n):null}function mb(e,t,n){return Ir(e,Ub,n)||vb(e,t,n)}function vb(e,t,n){e=yb(e,"style",t,"");for(var i=null,r=0;r<e.length;r++){var a=xr(e[r],"urn:ebu:tt:style",n);a||(a=Ir(e[r],Ub,n)),a||(a=mb(e[r],t,n)),a&&(i=a)}return i}function yb(e,t,n,i,r){var a=[];if(!e||1>n.length)return a;var o=e;for(e=null;o&&!(e=r?xr(o,r,t):o.getAttribute(t))&&(o=o.parentNode)instanceof Element;);if(t=e)for(r=(t=l(t.split(" "))).next();!r.done;r=t.next())for(r=r.value,o=(e=l(n)).next();!o.done;o=e.next())if(i+(o=o.value).getAttribute("xml:id")==r){a.push(o);break}return a}function bb(e,t,n,i){return e=_b(e,t),null==n?n=e.start:null!=e.start&&(n+=e.start),null==i?i=e.end:null!=e.start&&(i+=e.start),{start:n,end:i}}function _b(e,t){var n=wb(e.getAttribute("begin"),t),i=wb(e.getAttribute("end"),t);return e=wb(e.getAttribute("dur"),t),null==i&&null!=e&&(i=n+e),{start:n,end:i}}function wb(e,t){var n=null;if(Ib.test(e)){e=Ib.exec(e),n=Number(e[1]);var i=Number(e[2]),r=Number(e[3]),a=Number(e[4]);n=(r+=(a+=(Number(e[5])||0)/t.h)/t.frameRate)+60*i+3600*n}else if(kb.test(e))n=Sb(kb,e);else if(Mb.test(e))n=Sb(Mb,e);else if(Pb.test(e))e=Pb.exec(e),n=Number(e[1])/t.frameRate;else if(Lb.test(e))e=Lb.exec(e),n=Number(e[1])/t.g;else if(Db.test(e))n=Sb(Db,e);else if(e)throw new ye(2,2,2001,"Could not parse cue time range in TTML");return n}function Sb(e,t){return null==(e=e.exec(t))||""==e[0]?null:(Number(e[4])||0)/1e3+(Number(e[3])||0)+60*(Number(e[2])||0)+3600*(Number(e[1])||0)}function Tb(e,t,n,i){this.frameRate=Number(e)||30,this.h=Number(t)||1,this.g=Number(i),0==this.g&&(this.g=e?this.frameRate*this.h:1),n&&(e=/^(\d+) (\d+)$/g.exec(n))&&(this.frameRate*=Number(e[1])/Number(e[2]))}tn["application/x-subtitle-lrc"]=function(){return new ub},cb.prototype.parseInit=function(){},cb.prototype.setSequenceMode=function(){},cb.prototype.setManifestType=function(){},cb.prototype.parseMedia=function(e,t,n){var i=qi(e);if(e=[],""==i)return e;var r=jr(i,"tt");if(!r)throw new ye(2,2,2005,"Failed to parse TTML.");if(!(i=r.getElementsByTagName("body")[0]))return[];var a=Ir(r,Ob,"frameRate"),o=Ir(r,Ob,"subFrameRate"),s=Ir(r,Ob,"frameRateMultiplier"),u=Ir(r,Ob,"tickRate"),h=Ir(r,Ob,"cellResolution"),c=r.getAttribute("xml:space")||"default",d=Ir(r,Ub,"extent");if("default"!=c&&"preserve"!=c)throw new ye(2,2,2005,"Invalid xml:space value: "+c);c="default"==c,a=new Tb(a,o,s,u),h=h&&(h=/^(\d+) (\d+)$/.exec(h))?{mc:parseInt(h[1],10),rows:parseInt(h[2],10)}:null,o=(o=r.getElementsByTagName("metadata")[0])?function(e){return Array.from(e.childNodes).filter((function(e){return e instanceof Element}))}(o):[],s=Array.from(r.getElementsByTagName("style")),u=[];for(var p=l(r=Array.from(r.getElementsByTagName("region"))),f=p.next();!f.done;f=p.next()){var g=f.value;f=new Mt;var m=g.getAttribute("xml:id");if(m){f.id=m;var v=null;d&&(v=Ab.exec(d)||xb.exec(d)),m=v?Number(v[1]):null,v=v?Number(v[2]):null;var y,b=gb(g,s,"extent");if(b){var _=(y=Ab.exec(b))||xb.exec(b);null!=_&&(f.width=Number(_[1]),f.height=Number(_[2]),y||(null!=m&&(f.width=100*f.width/m),null!=v&&(f.height=100*f.height/v)),f.widthUnits=y||null!=m?Pt:0,f.heightUnits=y||null!=v?Pt:0)}(g=gb(g,s,"origin"))&&null!=(_=(y=Ab.exec(g))||xb.exec(g))&&(f.viewportAnchorX=Number(_[1]),f.viewportAnchorY=Number(_[2]),y?b||(f.width=100-f.viewportAnchorX,f.widthUnits=Pt,f.height=100-f.viewportAnchorY,f.heightUnits=Pt):(null!=v&&(f.viewportAnchorY=100*f.viewportAnchorY/v),null!=m&&(f.viewportAnchorX=100*f.viewportAnchorX/m)),f.viewportAnchorUnits=y||null!=m?Pt:0)}else f=null;f&&u.push(f)}if(Er(i,"p").length)throw new ye(2,2,2001,"<p> can only be inside <div> in TTML");for(p=(d=l(Er(i,"div"))).next();!p.done;p=d.next())if(Er(p.value,"span").length)throw new ye(2,2,2001,"<span> can only be inside <p> in TTML");return(t=db(i,t,a,o,s,r,u,c,h,null,!1,n))&&(t.backgroundColor||(t.backgroundColor="transparent"),e.push(t)),e},G("shaka.text.TtmlTextParser",cb),cb.prototype.parseMedia=cb.prototype.parseMedia,cb.prototype.setManifestType=cb.prototype.setManifestType,cb.prototype.setSequenceMode=cb.prototype.setSequenceMode,cb.prototype.parseInit=cb.prototype.parseInit;var Ab=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,Eb=/^(\d{1,2}(?:\.\d+)?|100)%$/,Cb=/^(\d+px|\d+em|\d*\.?\d+c)$/,xb=/^(\d+)px (\d+)px$/,Ib=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,kb=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,Mb=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,Pb=/^(\d*(?:\.\d*)?)f$/,Lb=/^(\d*(?:\.\d*)?)t$/,Db=RegExp("^(?:(\\d*(?:\\.\\d*)?)h)?(?:(\\d*(?:\\.\\d*)?)m)?(?:(\\d*(?:\\.\\d*)?)s)?(?:(\\d*(?:\\.\\d*)?)ms)?$"),Rb={left:Tt,center:"center",right:"end",start:Tt,end:"end"},Nb={left:"line-left",center:"center",right:"line-right"},Ob=["http://www.w3.org/ns/ttml#parameter","http://www.w3.org/2006/10/ttaf1#parameter"],Ub=["http://www.w3.org/ns/ttml#styling","http://www.w3.org/2006/10/ttaf1#styling"],Bb=["http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt","http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"];function Fb(){this.g=new cb}function Gb(){this.h=!1,this.g="UNKNOWN"}function jb(e){for(var t=l(Object.entries(Et)),n=t.next();!n.done;n=t.next()){var i=l(n.value);n=i.next().value,i=i.next().value;var r=new dt(0,0,"");r.color=i,e.set("."+n,r)}for(n=(t=l(Object.entries(Ct))).next();!n.done;n=t.next())n=(i=l(n.value)).next().value,i=i.next().value,(r=new dt(0,0,"")).backgroundColor=i,e.set("."+n,r)}function Hb(e,t,n){if(e.includes("<")){0===n.size&&jb(n);e:{for(var i=[],r=-1,a="",o=0;o<e.length;o++)if("/"===e[o]&&0<o&&"<"===e[o-1]){var s=e.indexOf(">",o);if(s<=o)break e;if((s=e.substring(o+1,s))&&"c"===s){var u=i.pop();u?u===s?(a+="/"+s+">",o+=s.length+1):u.startsWith("c.")?(o+=s.length+1,a+="/"+u+">"):a+=e[o]:a+=e[o]}else a+=e[o]}else"<"===e[o]?"c"!=e[r=o+1]&&(r=-1):">"===e[o]&&0<r&&(i.push(e.substr(r,o-r)),r=-1),a+=e[o];e=a}for(i=e,e=[],a=-1,r=0;r<i.length;r++)"<"===i[r]?a=r+1:">"===i[r]&&0<a&&((a=i.substr(a,r-a)).match(Yb)&&e.push(a),a=-1);for(r=(e=l(e)).next();!r.done;r=e.next())r=r.value,i=i.replace("<"+r+">",'<div time="'+r+'">'),i+="</div>";e:{for(r=e=i,a=[],o=-1,e="",i=!1,s=0;s<r.length;s++)if("/"===r[s]){if(-1===(u=r.indexOf(">",s))){e=r;break e}if((u=r.substring(s+1,u))&&"v"==u){i=!0;var h=null;if(a.length&&(h=a[a.length-1]),h){if(h===u)e+="/"+u+">";else{if(!h.startsWith("v")){e+=r[s];continue}e+="/"+h+">"}s+=u.length+1}else e+=r[s]}else e+=r[s]}else"<"===r[s]?"v"!=r[o=s+1]&&(o=-1):">"===r[s]&&0<o&&(a.push(r.substr(o,s-o)),o=-1),e+=r[s];for(a=(r=l(a)).next();!a.done;a=r.next())o=(a=a.value).replace(" ",".voice-"),e=(e=e.replace("<"+a+">","<"+o+">")).replace("</"+a+">","</"+o+">"),i||(e+="</"+o+">")}if(i=jr("<span>"+e+"</span>","span")){if(1==(i=i.childNodes).length&&((r=i[0]).nodeType==Node.TEXT_NODE||r.nodeType==Node.CDATA_SECTION_NODE))return void(t.payload=Kb(e));for(i=(e=l(i)).next();!i.done;i=e.next())Wb(i.value,t,n)}else t.payload=Kb(e)}else t.payload=Kb(e)}function Vb(e,t){return e&&0<e.length?e:t}function Wb(e,t,n){var i=t.clone();if(i.nestedCues=[],i.payload="",i.rubyTag="",i.line=null,i.region=new Mt,i.position=null,i.size=0,e.nodeType===Node.ELEMENT_NODE&&e.nodeName)for(var r=l(e.nodeName.split(/(?=[ .])+/g)),a=r.next();!a.done;a=r.next()){var o=a=a.value;if(o.startsWith(".voice-")){var s=o.split("-").pop();o='v[voice="'+s+'"]',n.has(o)||(o="v[voice="+s+"]")}switch(n.has(o)&&(o=n.get(o))&&(i.backgroundColor=Vb(o.backgroundColor,i.backgroundColor),i.color=Vb(o.color,i.color),i.fontFamily=Vb(o.fontFamily,i.fontFamily),i.fontSize=Vb(o.fontSize,i.fontSize),i.fontWeight=o.fontWeight,i.fontStyle=o.fontStyle,i.opacity=o.opacity,i.rubyTag=o.rubyTag,i.textCombineUpright=o.textCombineUpright,i.textShadow=o.textShadow,i.wrapLine=o.wrapLine),a){case"br":return i=pt(i.startTime,i.endTime),void t.nestedCues.push(i);case"b":i.fontWeight=700;break;case"i":i.fontStyle="italic";break;case"u":i.textDecoration.push("underline");break;case"font":(a=e.getAttribute("color"))&&(i.color=a);break;case"div":if(!(a=e.getAttribute("time")))break;(a=Xb(new Tf(a)))&&(i.startTime=a);break;case"ruby":case"rp":case"rt":i.rubyTag=a}}if(r=e.childNodes,Mr(e)||1==r.length&&Mr(r[0]))for(r=!0,n=l(e.textContent.split("\n")),e=n.next();!e.done;e=n.next())e=e.value,r||(r=pt(i.startTime,i.endTime),t.nestedCues.push(r)),0<e.length&&((r=i.clone()).payload=Kb(e),t.nestedCues.push(r)),r=!1;else for(t.nestedCues.push(i),e=(t=l(r)).next();!e.done;e=t.next())Wb(e.value,i,n)}function zb(e,t,n){var i;(i=/^align:(start|middle|center|end|left|right)$/.exec(t))?(t=i[1],e.textAlign="middle"==t?mt:vt[t.toUpperCase()]):(i=/^vertical:(lr|rl)$/.exec(t))?e.writingMode="lr"==i[1]?"vertical-lr":"vertical-rl":(i=/^size:([\d.]+)%$/.exec(t))?e.size=Number(i[1]):(i=/^position:([\d.]+)%(?:,(line-left|line-right|middle|center|start|end|auto))?$/.exec(t))?(e.position=Number(i[1]),i[2]&&(t=i[2],e.positionAlign="line-left"==t||"start"==t?"line-left":"line-right"==t||"end"==t?"line-right":"center"==t||"middle"==t?"center":gt)):(i=/^region:(.*)$/.exec(t))?(t=function(e,t){return e=e.filter((function(e){return e.id==t})),e.length?e[0]:null}(n,i[1]))&&(e.region=t):(n=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))?(e.lineInterpretation=1,e.line=Number(n[1]),n[2]&&(e.lineAlign=At[n[2].toUpperCase()])):(n=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t))&&(e.lineInterpretation=St,e.line=Number(n[1]),n[2]&&(e.lineAlign=At[n[2].toUpperCase()]))}function Xb(e){if(null==(e=Ef(e,Yb)))return null;var t=Number(e[2]),n=Number(e[3]);return 59<t||59<n?null:Number(e[4])/1e3+n+60*t+3600*(Number(e[1])||0)}function Kb(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&nbsp;":"","&lrm;":"","&rlm;":""},n=/&(?:amp|lt|gt|quot|#(0+)?39|nbsp|lrm|rlm);/g,i=RegExp(n.source);return e&&i.test(e)?e.replace(n,(function(e){return t[e]||"'"})):e||""}tn["application/ttml+xml"]=function(){return new cb},Fb.prototype.parseInit=function(e){var t=!1;if((new rr).box("moov",ar).box("trak",ar).box("mdia",ar).box("minf",ar).box("stbl",ar).T("stsd",or).box("stpp",(function(e){t=!0,e.parser.stop()})).parse(e),!t)throw new ye(2,2,2007)},Fb.prototype.setSequenceMode=function(){},Fb.prototype.setManifestType=function(){},Fb.prototype.parseMedia=function(e,t,n){var i=this,r=!1,a=[];if((new rr).box("mdat",ur((function(e){r=!0,a=a.concat(i.g.parseMedia(e,t,n))}))).parse(e,!1),!r)throw new ye(2,2,2007);return a},G("shaka.text.Mp4TtmlParser",Fb),Fb.prototype.parseMedia=Fb.prototype.parseMedia,Fb.prototype.setManifestType=Fb.prototype.setManifestType,Fb.prototype.setSequenceMode=Fb.prototype.setSequenceMode,Fb.prototype.parseInit=Fb.prototype.parseInit,tn['application/mp4; codecs="stpp"']=function(){return new Fb},tn['application/mp4; codecs="stpp.ttml"']=function(){return new Fb},tn['application/mp4; codecs="stpp.ttml.im1t"']=function(){return new Fb},tn['application/mp4; codecs="stpp.TTML.im1t"']=function(){return new Fb},Gb.prototype.parseInit=function(){},Gb.prototype.setSequenceMode=function(e){this.h=e},Gb.prototype.setManifestType=function(e){this.g=e},Gb.prototype.parseMedia=function(e,t){var n=(e=(e=qi(e)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n")).split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(n[0]))throw new ye(2,2,2e3);if(e=t.vttOffset,n[0].includes("X-TIMESTAMP-MAP")&&this.h){var i=n[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),r=n[0].match(/MPEGTS:(\d+)/m);if(i&&r){if(null==(e=Xb(new Tf(i[1]))))throw new ye(2,2,2e3);for(r=Number(r[1]),i=t.segmentStart-t.periodStart;95443.7176888889<=i;)i-=95443.7176888889,r+=8589934592;e=t.periodStart+r/9e4-e}}else n[0].includes("X-TIMESTAMP-MAP")&&"HLS"==this.g&&(e=t.segmentStart);for(t=[],i=(r=l(n[0].split("\n"))).next();!i.done;i=r.next())if(i=i.value,/^Region:/.test(i)){i=new Tf(i);var a=new Mt;Cf(i),Af(i);for(var o=Cf(i);o;){var s=a,u=o;(o=/^id=(.*)$/.exec(u))?s.id=o[1]:(o=/^width=(\d{1,2}|100)%$/.exec(u))?s.width=Number(o[1]):(o=/^lines=(\d+)$/.exec(u))?(s.height=Number(o[1]),s.heightUnits=2):(o=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(u))?(s.regionAnchorX=Number(o[1]),s.regionAnchorY=Number(o[2])):(o=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(u))?(s.viewportAnchorX=Number(o[1]),s.viewportAnchorY=Number(o[2])):/^scroll=up$/.exec(u)&&(s.scroll="up"),Af(i),o=Cf(i)}t.push(a)}for(jb(r=new Map),i=[],a=(n=l(n.slice(1))).next();!a.done;a=n.next()){if((1!=(a=a.value.split("\n")).length||a[0])&&!/^NOTE($|[ \t])/.test(a[0])&&"STYLE"==a[0]){for(s=[],o=-1,u=1;u<a.length;u++)a[u].includes("::cue")&&(s.push([]),o=s.length-1),-1!=o&&(s[o].push(a[u]),a[u].includes("}")&&(o=-1));for(o=(s=l(s)).next();!o.done;o=s.next()){var h=o.value;o="global",(u=h[0].match(/\((.*)\)/))&&(o=u.pop()),u=h.slice(1,-1),h[0].includes("}")&&(h=/\{(.*?)\}/.exec(h[0]))&&(u=h[1].split(";")),(h=r.get(o))||(h=new dt(0,0,""));for(var c=!1,d=0;d<u.length;d++){var p=/^\s*([^:]+):\s*(.*)/.exec(u[d]);if(p){var f=p[2].trim().replace(";","");switch(p[1].trim()){case"background-color":case"background":c=!0,h.backgroundColor=f;break;case"color":c=!0,h.color=f;break;case"font-family":c=!0,h.fontFamily=f;break;case"font-size":c=!0,h.fontSize=f;break;case"font-weight":(700<=parseInt(f,10)||"bold"==f)&&(c=!0,h.fontWeight=700);break;case"font-style":switch(f){case"normal":c=!0,h.fontStyle=It;break;case"italic":c=!0,h.fontStyle="italic";break;case"oblique":c=!0,h.fontStyle="oblique"}break;case"opacity":c=!0,h.opacity=parseFloat(f);break;case"text-combine-upright":c=!0,h.textCombineUpright=f;break;case"text-shadow":c=!0,h.textShadow=f;break;case"white-space":c=!0,h.wrapLine="noWrap"!=f}}}c&&r.set(o,h)}}if(c=e,1==a.length&&!a[0]||/^NOTE($|[ \t])/.test(a[0])||"STYLE"==a[0]||"REGION"==a[0])a=null;else if(s=null,a[0].includes("--\x3e")||(s=a[0],a.splice(0,1)),u=Xb(o=new Tf(a[0])),d=Ef(o,/[ \t]+--\x3e[ \t]+/g),h=Xb(o),null==u||null==d||null==h)X("Failed to parse VTT time code. Cue skipped:",s,a),a=null;else{for(u+=c,h+=c,a=a.slice(1).join("\n").trim(),r.has("global")?((c=r.get("global").clone()).startTime=u,c.endTime=h,c.payload=""):c=new dt(u,h,""),Af(o),u=Cf(o);u;)zb(c,u,t),Af(o),u=Cf(o);Hb(a,c,r),null!=s&&(c.id=s),a=c}a&&i.push(a)}return i},G("shaka.text.VttTextParser",Gb),Gb.prototype.parseMedia=Gb.prototype.parseMedia,Gb.prototype.setManifestType=Gb.prototype.setManifestType,Gb.prototype.setSequenceMode=Gb.prototype.setSequenceMode,Gb.prototype.parseInit=Gb.prototype.parseInit;var Yb=/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g;function qb(){this.g=null}function Zb(e,t,n){var i,r,a;return(new rr).box("payl",ur((function(e){i=qi(e)}))).box("iden",ur((function(e){r=qi(e)}))).box("sttg",ur((function(e){a=qi(e)}))).parse(e),i?function(e,t,n,i,r){if(Hb(e,i=new dt(i,r,""),new Map),t&&(i.id=t),n)for(t=Cf(e=new Tf(n));t;)zb(i,t,[]),Af(e),t=Cf(e);return i}(i,r,a,t,n):null}function Jb(){}function Qb(e){if(null==(e=Ef(e,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g)))return null;var t=Number(e[2]),n=Number(e[3]);return 59<t||59<n?null:Number(e[4])/1e3+n+60*t+3600*(Number(e[1])||0)}function $b(){this.g=new Gb}function e_(e){var t="WEBVTT\n\n";if(""==e)return t;for(var n=(e=l((e=(e=e.replace(/\r+/g,"")).trim()).split("\n\n"))).next();!n.done;n=e.next())(n=n.value.split(/\n/))[0].match(/\d+/)&&n.shift(),n[0]=n[0].replace(/,/g,"."),t+=n.join("\n").replace(/{b}/g,"<b>").replace(/{\/b}/g,"</b>").replace(/{i}/g,"<i>").replace(/{\/i}/g,"</i>").replace(/{u}/g,"<u>").replace(/{\/u}/g,"</u>")+"\n\n";return t}function t_(){}function n_(e,t){var n=t.Fontname;if(n&&(e.fontFamily=n),(n=t.Fontsize)&&(e.fontSize=n+"px"),(n=t.PrimaryColour)&&(n=i_(n))&&(e.color=n),(n=t.BackColour)&&(n=i_(n))&&(e.backgroundColor=n),t.Bold&&(e.fontWeight=700),t.Italic&&(e.fontStyle="italic"),t.Underline&&e.textDecoration.push("underline"),(n=t.Spacing)&&(e.letterSpacing=n+"px"),n=t.Alignment)switch(parseInt(n,10)){case 1:e.displayAlign=yt,e.textAlign="start";break;case 2:e.displayAlign=yt,e.textAlign=mt;break;case 3:e.displayAlign=yt,e.textAlign="end";break;case 5:e.displayAlign="before",e.textAlign="start";break;case 6:e.displayAlign="before",e.textAlign=mt;break;case 7:e.displayAlign="before",e.textAlign="end";break;case 9:e.displayAlign="center",e.textAlign="start";break;case 10:e.displayAlign="center",e.textAlign=mt;break;case 11:e.displayAlign="center",e.textAlign="end"}(t=t.AlphaLevel)&&(e.opacity=parseFloat(t))}function i_(e){return 0<=(e=parseInt(e.replace("&H",""),16))?"rgba("+(255&e)+","+(e>>8&255)+","+(e>>16&255)+","+(e>>24&255^255)/255+")":null}function r_(e){return 3600*((e=u_.exec(e))[1]?parseInt(e[1].replace(":",""),10):0)+60*parseInt(e[2],10)+parseFloat(e[3])}tn["text/vtt"]=function(){return new Gb},tn['text/vtt; codecs="vtt"']=function(){return new Gb},tn['text/vtt; codecs="wvtt"']=function(){return new Gb},qb.prototype.parseInit=function(e){var t=this,n=!1;if((new rr).box("moov",ar).box("trak",ar).box("mdia",ar).T("mdhd",(function(e){e=Fa(e.reader,e.version),t.g=e.timescale})).box("minf",ar).box("stbl",ar).T("stsd",or).box("wvtt",(function(){n=!0})).parse(e),!this.g)throw new ye(2,2,2008);if(!n)throw new ye(2,2,2008)},qb.prototype.setSequenceMode=function(){},qb.prototype.setManifestType=function(){},qb.prototype.parseMedia=function(e,t){if(!e.length)return[];if(!this.g)throw new ye(2,2,2008);var n,i=0,r=[],a=[],o=!1,s=!1,u=!1,h=null;if((new rr).box("moof",ar).box("traf",ar).T("tfdt",(function(e){o=!0,i=Ba(e.reader,e.version).baseMediaDecodeTime})).T("tfhd",(function(e){h=Ua(e.reader,e.flags).Og})).T("trun",(function(e){s=!0,r=Ga(e.reader,e.version,e.flags).lh})).box("mdat",ur((function(e){u=!0,n=e}))).parse(e,!1),!u&&!o&&!s)throw new ye(2,2,2008);e=i;for(var c=new tr(n,0),d=l(r),p=d.next();!p.done;p=d.next()){var f=(p=p.value).gg||h,g=p.Ke?i+p.Ke:e;e=g+(f||0);var m=0;do{var v=c.O();m+=v;var y=null;"vttc"==hr(c.O())?8<v&&(y=c.Qb(v-8)):c.skip(v-8),f&&y&&(v=Zb(y,t.periodStart+g/this.g,t.periodStart+e/this.g),a.push(v))}while(p.sampleSize&&m<p.sampleSize)}return a.filter(an)},G("shaka.text.Mp4VttParser",qb),qb.prototype.parseMedia=qb.prototype.parseMedia,qb.prototype.setManifestType=qb.prototype.setManifestType,qb.prototype.setSequenceMode=qb.prototype.setSequenceMode,qb.prototype.parseInit=qb.prototype.parseInit,tn['application/mp4; codecs="wvtt"']=function(){return new qb},Jb.prototype.parseInit=function(){},Jb.prototype.setSequenceMode=function(){},Jb.prototype.setManifestType=function(){},Jb.prototype.parseMedia=function(e){var t=qi(e).replace(/\r+/g,"");if(e=[],""==(t=t.trim()))return e;for(var n=(t=l(t.split("\n\n"))).next();!n.done;n=t.next()){var i=new Tf((n=n.value.split("\n"))[0]),r=Qb(i),a=Ef(i,/,/g);if(i=Qb(i),null==r||null==a||null==i)throw new ye(2,2,2001,"Could not parse cue time range in SubViewer");e.push(new dt(r,i,n.slice(1).join("\n").trim()))}return e},G("shaka.text.SbvTextParser",Jb),Jb.prototype.parseMedia=Jb.prototype.parseMedia,Jb.prototype.setManifestType=Jb.prototype.setManifestType,Jb.prototype.setSequenceMode=Jb.prototype.setSequenceMode,Jb.prototype.parseInit=Jb.prototype.parseInit,tn["text/x-subviewer"]=function(){return new Jb},$b.prototype.parseInit=function(){},$b.prototype.setSequenceMode=function(){},$b.prototype.setManifestType=function(){},$b.prototype.parseMedia=function(e,t,n){return e=et(Qi(e=e_(e=qi(e)))),this.g.parseMedia(e,t,n)},G("shaka.text.SrtTextParser",$b),$b.srt2webvtt=e_,$b.prototype.parseMedia=$b.prototype.parseMedia,$b.prototype.setManifestType=$b.prototype.setManifestType,$b.prototype.setSequenceMode=$b.prototype.setSequenceMode,$b.prototype.parseInit=$b.prototype.parseInit,tn["text/srt"]=function(){return new $b},t_.prototype.parseInit=function(){},t_.prototype.setSequenceMode=function(){},t_.prototype.setManifestType=function(){},t_.prototype.parseMedia=function(e){for(var t="",n="",i=(e=l(e=qi(e).split(/\r?\n\s*\r?\n/))).next();!i.done;i=e.next()){var r=a_.exec(i.value);r&&(i=r[1],r=r[2],"V4 Styles"==i||"V4+ Styles"==i?t=r:"Events"==i&&(n=r))}e=[],i=null;for(var a=(t=l(t.split(/\r?\n/))).next();!a.done;a=t.next())if(r=a.value,!/^\s*;/.test(r)&&(a=o_.exec(r)))if(r=a[1].trim(),a=a[2].trim(),"Format"==r)i=a.split(s_);else if("Style"==r){r=a.split(s_),a={};for(var o=0;o<i.length&&o<r.length;o++)a[i[o]]=r[o];e.push(a)}for(i=[],t=null,r={},a=(n=l(n.split(/\r?\n/))).next();!a.done;r={Ze:r.Ze},a=n.next())if(a=a.value,!/^\s*;/.test(a)&&(o=o_.exec(a)))if(a=o[1].trim(),o=o[2].trim(),"Format"==a)t=o.split(s_);else if("Dialogue"==a){o=o.split(s_),a={};for(var s=0;s<t.length&&s<o.length;s++)a[t[s]]=o[s];o=new dt(s=r_(a.Start),r_(a.End),o.slice(t.length-1).join(",").replace(/\\N/g,"\n").replace(/\{[^}]+\}/g,"")),r.Ze=a.Style,(a=e.find(function(e){return function(t){return t.Name==e.Ze}}(r)))&&n_(o,a),i.push(o)}return i},G("shaka.text.SsaTextParser",t_),t_.prototype.parseMedia=t_.prototype.parseMedia,t_.prototype.setManifestType=t_.prototype.setManifestType,t_.prototype.setSequenceMode=t_.prototype.setSequenceMode,t_.prototype.parseInit=t_.prototype.parseInit;var a_=/^\s*\[([^\]]+)\]\r?\n([\s\S]*)/,o_=/^\s*([^:]+):\s*(.*)/,s_=/\s*,\s*/,u_=/^(\d+:)?(\d{1,2}):(\d{1,2}(?:[.]\d{1,3})?)?$/;function l_(e,t){var n=1&e[t+1]?7:9;return t+n<=e.length&&0<(e=((3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5)-n)?{me:n,X:e}:null}function h_(e,t){var n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],i=(60&e[t+2])>>>2;if(i>n.length-1)return null;var r=1+((192&e[t+2])>>>6),a=(1&e[t+2])<<2;return a|=(192&e[t+3])>>>6,{sampleRate:n[i],channelCount:a,wa:"mp4a.40."+r}}function c_(e,t){if(t+1<e.length&&255===e[t]&&240==(246&e[t+1])){var n=1&e[t+1]?7:9;if(t+n>=e.length)return!1;var i=(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5;return!(i<=n)&&((t+=i)===e.length||t+1<e.length&&255===e[t]&&240==(246&e[t+1]))}return!1}function d_(e){this.i=e,this.h=0,this.g=new Map}function p_(e,t){if(t+8>e.length||11!==e[t]||119!==e[t+1])return null;var n=e[t+4]>>6;if(3<=n)return null;var i=63&e[t+4],r=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*i+n];if(t+r>e.length)return null;var a=e[t+6]>>5,o=0;2===a?o+=2:(1&a&&1!==a&&(o+=2),4&a&&(o+=2)),o=(e[t+6]<<8|e[t+7])>>12-o&1;var s=7&e[t+5];return e=new Uint8Array([n<<6|e[t+5]>>3<<1|s>>2,(3&s)<<6|a<<3|o<<2|i>>4,i<<4&224]),{sampleRate:[48e3,44100,32e3][n],channelCount:[2,1,2,3,3,4,4,5][a]+o,qa:e,X:r}}function f_(e,t){if(11===e[t]&&119===e[t+1]){var n,i,r=0,a=5;for(t+=a;0<a;){i=e[t];var o=Math.min(a,8),s=8-o;n=(i&(n=4278190080>>>24+s<<s))>>s,r=r?r<<o|n:n,t+=1,a-=o}if(16>r)return!0}return!1}function g_(e){this.i=e,this.h=0,this.g=new Map}function m_(e,t){if(t+8>e.length||2935!=(e[t]<<8|e[t+1]<<0))return null;var n=new Wa(e.subarray(t+2));Xa(n,2),Xa(n,3);var i=Ka(n,11)+1<<1,r=Ka(n,2);if(3==r){r=[24e3,22060,16e3][r=Ka(n,2)];var a=3}else r=[48e3,44100,32e3][r],a=Ka(n,2);var o=Ka(n,3),s=Ka(n,1);return n=Ka(n,5),t+i>e.byteLength?null:(e=Math.floor(i*r/(16*[1,2,3,6][a])),e=new Uint8Array([(8160&e)>>5,(31&e)<<3,r<<6|n<<1|0,0|o<<1|s<<0,0]),{sampleRate:r,channelCount:[2,1,2,3,3,4,4,5][o]+s,qa:e,X:i})}function v_(e){this.i=e,this.h=0,this.g=new Map}function y_(e){for(var t=!1,n=[],i=e.find((function(e){return 7==e.type})),r=!1,a=(e=l(e)).next();!a.done;a=e.next()){var o=!1;switch((a=a.value).type){case 1:o=r=!0;var s=a.data;i&&4<s.length&&(2===(s=to(new Wa(s)))||4===s||7===s||9===s)&&(t=!0);break;case 5:t=o=r=!0;break;case 6:case 7:case 8:case 12:o=!0;break;case 9:r=o=!0;break;default:o=!1}r&&o&&(o=a.fullData.byteLength,(s=new Uint8Array(4))[0]=o>>24&255,s[1]=o>>16&255,s[2]=o>>8&255,s[3]=255&o,n.push(_r(s,a.fullData)))}return n.length?{data:_r.apply(fr,h(n)),Bd:t}:null}tn["text/x-ssa"]=function(){return new t_},(i=d_.prototype).destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/aac"==e.toLowerCase().split(";")[0]&&ze(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/aac"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="'+(Yt(t)||"mp4a.40.2")+'"':t},i.getOriginalMimeType=function(){return this.i},i.transmux=function(e,t,n,i){for(var r=et(e),a=Oa(r),o=a.length;o<r.length&&!c_(r,o);o++);if(e=1e3*n.endTime,(a=Na(a)).length&&n&&(n=a.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&(e=n.data),!(n=h_(r,o)))return Promise.reject(new ye(2,3,3018));for(t.audioSamplingRate=n.sampleRate,t.channelsCount=n.channelCount,a=[];o<r.length;){var s=l_(r,o);if(!s)return Promise.reject(new ye(2,3,3018));var u=s.me+s.X;o+u<=r.length&&a.push({data:r.subarray(o+s.me,o+u),size:s.X,duration:1024,kb:0,flags:{ob:0,bb:0,ab:0,Za:0,$a:2,pb:0}}),o+=u}return r=n.sampleRate,e=Math.floor(e*r/1e3),e=new Mg([i={id:t.id,type:"audio",codecs:n.wa,encrypted:t.encrypted&&0<t.drmInfos.length,timescale:r,duration:i,ib:[],qa:new Uint8Array([]),Ca:new Uint8Array([]),Ja:0,La:0,data:{Cb:this.h,baseMediaDecodeTime:e,fb:a},stream:t}]),this.g.has(t.id)?i=this.g.get(t.id):(i=Pg(e),this.g.set(t.id,i)),t=Og(e),this.h++,t=_r(i,t),Promise.resolve(t)},G("shaka.transmuxer.AacTransmuxer",d_),d_.prototype.transmux=d_.prototype.transmux,d_.prototype.getOriginalMimeType=d_.prototype.getOriginalMimeType,d_.prototype.convertCodecs=d_.prototype.convertCodecs,d_.prototype.isSupported=d_.prototype.isSupported,d_.prototype.destroy=d_.prototype.destroy,Rt("audio/aac",(function(){return new d_("audio/aac")}),Ut),(i=g_.prototype).destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/ac3"==e.toLowerCase().split(";")[0]&&ze(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/ac3"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="ac-3"':t},i.getOriginalMimeType=function(){return this.i},i.transmux=function(e,t,n,i){for(var r=Oa(e=et(e)),a=r.length;a<e.length&&!f_(e,a);a++);var o=1e3*n.endTime;(r=Na(r)).length&&n&&(n=r.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&(o=n.data),n=0,r=new Uint8Array([]);for(var s=[];a<e.length;){var u=p_(e,a);if(!u)return Promise.reject(new ye(2,3,3018));t.audioSamplingRate=u.sampleRate,t.channelsCount=u.channelCount,n=u.sampleRate,r=u.qa,s.push({data:e.subarray(a,a+u.X),size:u.X,duration:1536,kb:0,flags:{ob:0,bb:0,ab:0,Za:0,$a:2,pb:0}}),a+=u.X}return e=Math.floor(o*n/1e3),e=new Mg([i={id:t.id,type:"audio",codecs:"ac-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:n,duration:i,ib:[],qa:r,Ca:new Uint8Array([]),Ja:0,La:0,data:{Cb:this.h,baseMediaDecodeTime:e,fb:s},stream:t}]),this.g.has(t.id)?i=this.g.get(t.id):(i=Pg(e),this.g.set(t.id,i)),t=Og(e),this.h++,t=_r(i,t),Promise.resolve(t)},G("shaka.transmuxer.Ac3Transmuxer",g_),g_.prototype.transmux=g_.prototype.transmux,g_.prototype.getOriginalMimeType=g_.prototype.getOriginalMimeType,g_.prototype.convertCodecs=g_.prototype.convertCodecs,g_.prototype.isSupported=g_.prototype.isSupported,g_.prototype.destroy=g_.prototype.destroy,Rt("audio/ac3",(function(){return new g_("audio/ac3")}),Ut),(i=v_.prototype).destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/ec3"==e.toLowerCase().split(";")[0]&&ze(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/ec3"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="ec-3"':t},i.getOriginalMimeType=function(){return this.i},i.transmux=function(e,t,n,i){for(var r=Oa(e=et(e)),a=r.length;a<e.length&&2935!=(e[a]<<8|e[a+1]<<0);a++);var o=1e3*n.endTime;(r=Na(r)).length&&n&&(n=r.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&(o=n.data),n=0,r=new Uint8Array([]);for(var s=[];a<e.length;){var u=m_(e,a);if(!u)return Promise.reject(new ye(2,3,3018));t.audioSamplingRate=u.sampleRate,t.channelsCount=u.channelCount,n=u.sampleRate,r=u.qa,s.push({data:e.subarray(a,a+u.X),size:u.X,duration:1536,kb:0,flags:{ob:0,bb:0,ab:0,Za:0,$a:2,pb:0}}),a+=u.X}return e=Math.floor(o*n/1e3),e=new Mg([i={id:t.id,type:"audio",codecs:"ec-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:n,duration:i,ib:[],qa:r,Ca:new Uint8Array([]),Ja:0,La:0,data:{Cb:this.h,baseMediaDecodeTime:e,fb:s},stream:t}]),this.g.has(t.id)?i=this.g.get(t.id):(i=Pg(e),this.g.set(t.id,i)),t=Og(e),this.h++,t=_r(i,t),Promise.resolve(t)},G("shaka.transmuxer.Ec3Transmuxer",v_),v_.prototype.transmux=v_.prototype.transmux,v_.prototype.getOriginalMimeType=v_.prototype.getOriginalMimeType,v_.prototype.convertCodecs=v_.prototype.convertCodecs,v_.prototype.isSupported=v_.prototype.isSupported,v_.prototype.destroy=v_.prototype.destroy,Rt("audio/ec3",(function(){return new v_("audio/ec3")}),Ut);var b_=[100,110,122,244,44,83,86,118,128,138,139,134];function __(e,t){var n=e[t+1]>>3&3,i=e[t+1]>>1&3,r=e[t+2]>>4&15,a=e[t+2]>>2&3;if(1!==n&&0!==r&&15!==r&&3!==a){var o=e[t+3]>>6;r=1e3*S_[14*(3===n?3-i:3===i?3:4)+r-1],a=T_[3*(3===n?0:2===n?1:2)+a],n=A_[n][i];var s=E_[i],u=Math.floor(n*r/a+(e[t+2]>>1&1))*s,l=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);return(l=l?parseInt(l[1],10):0)&&87>=l&&2===i&&224e3<=r&&0===o&&(e[t+3]|=128),{sampleRate:a,channelCount:3===o?1:2,X:u,kj:8*n*s}}return null}function w_(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])}var S_=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],T_=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],A_=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],E_=[0,1,1,4];function C_(e){this.i=e,this.h=0,this.g=new Map}function x_(e){this.h=e,this.g=null}function I_(e){this.h=e,(this.g=lf.get("ISOBoxer")())&&function(e){function t(){this._procFullBox(),1&this.flags&&(this._procField("AlgorithmID","uint",24),this._procField("IV_size","uint",8),this._procFieldArray("KID",16,"uint",8)),this._procField("sample_count","uint",32),this._procEntries("entry",this.sample_count,(function(e){this._procEntryField(e,"InitializationVector","data",8),2&this.flags&&(this._procEntryField(e,"NumberOfEntries","uint",16),this._procSubEntries(e,"clearAndCryptedData",e.NumberOfEntries,(function(e){this._procEntryField(e,"BytesOfClearData","uint",16),this._procEntryField(e,"BytesOfEncryptedData","uint",32)})))}))}e.g.addBoxProcessor("saio",(function(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("entry_count","uint",32),this._procFieldArray("offset",this.entry_count,"uint",1===this.version?64:32)})),e.g.addBoxProcessor("saiz",(function(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("default_sample_info_size","uint",8),this._procField("sample_count","uint",32),0===this.default_sample_info_size&&this._procFieldArray("sample_info_size",this.sample_count,"uint",8)})),e.g.addBoxProcessor("senc",t),e.g.addBoxProcessor("uuid",(function(){for(var e=!0,n=0;16>n;n++)this.usertype[n]!==M_[n]&&(e=!1);e&&(this._parsing&&(this.type="sepiff"),t.call(this))}))}(this)}function k_(e,t){for(var n=8,i=0;i<e.boxes.length&&e.boxes[i].type!==t;i++)n+=e.boxes[i].size;return n}(i=C_.prototype).destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/mpeg"==e.toLowerCase().split(";")[0]&&ze(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/mpeg"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="mp3"':t},i.getOriginalMimeType=function(){return this.i},i.transmux=function(e,t,n,i){for(n=Oa(e=et(e)).length;n<e.length;n++){var r=n;if(r+1<e.length&&w_(e,r)){var a=__(e,r),o=4;a&&a.X&&(o=a.X),r=(r+=o)===e.length||r+1<e.length&&w_(e,r)}else r=!1;if(r)break}var s;for(r=[];n<e.length;){if(!(a=__(e,n)))return Promise.reject(new ye(2,3,3018));s||(s=a),n+a.X<=e.length&&r.push({data:e.subarray(n,n+a.X),size:a.X,duration:1152,kb:0,flags:{ob:0,bb:0,ab:0,Za:0,$a:2,pb:0}}),n+=a.X}return s?(e=9e4*s.kj/s.sampleRate*this.h,s=new Mg([i={id:t.id,type:"audio",codecs:"mp3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:s.sampleRate,duration:i,ib:[],qa:new Uint8Array([]),Ca:new Uint8Array([]),Ja:0,La:0,data:{Cb:this.h,baseMediaDecodeTime:e,fb:r},stream:t}]),this.g.has(t.id)?i=this.g.get(t.id):(i=Pg(s),this.g.set(t.id,i)),t=Og(s),this.h++,t=_r(i,t),Promise.resolve(t)):Promise.reject(new ye(2,3,3018))},G("shaka.transmuxer.Mp3Transmuxer",C_),C_.prototype.transmux=C_.prototype.transmux,C_.prototype.getOriginalMimeType=C_.prototype.getOriginalMimeType,C_.prototype.convertCodecs=C_.prototype.convertCodecs,C_.prototype.isSupported=C_.prototype.isSupported,C_.prototype.destroy=C_.prototype.destroy,Rt("audio/mpeg",(function(){return new C_("audio/mpeg")}),Ut),(i=x_.prototype).destroy=function(){},i.isSupported=function(e){if("video/mp2t"!=e.toLowerCase().split(";")[0])return!1;var t=Yt(e).split(","),n=Te("audio",t);return t=Te("video",t),!(!n||t||"mp3"!=zt(n))&&ze(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"video/mp2t"==t.toLowerCase().split(";")[0]?"audio/mpeg":t},i.getOriginalMimeType=function(){return this.h},i.transmux=function(e,t,n,i,r){if(this.g?this.g.clearData():this.g=new no,e=et(e),"mp3"!=(e=this.g.parse(e)).sd().audio||"audio"!=r)return Promise.reject(new ye(2,3,3018));for(r=new Uint8Array([]),t=(e=l(e.qc())).next();!t.done;t=e.next())if(t=t.value.data)for(n=0;n<t.length;)(i=__(t,n))?(n+i.X<=t.length&&(r=_r(r,t.subarray(n,n+i.X))),n+=i.X):n++;return Promise.resolve(r)},G("shaka.transmuxer.MpegTsTransmuxer",x_),x_.prototype.transmux=x_.prototype.transmux,x_.prototype.getOriginalMimeType=x_.prototype.getOriginalMimeType,x_.prototype.convertCodecs=x_.prototype.convertCodecs,x_.prototype.isSupported=x_.prototype.isSupported,x_.prototype.destroy=x_.prototype.destroy,Rt("video/mp2t",(function(){return new x_("video/mp2t")}),Bt),(i=I_.prototype).destroy=function(){},i.isSupported=function(e,t){var n=e.startsWith("mss/");return!(!this.g||!n)&&(t?ze(this.convertCodecs(t,e)):(t=this.convertCodecs("audio",e),e=this.convertCodecs("video",e),ze(t)||ze(e)))},i.convertCodecs=function(e,t){return t.replace("mss/","")},i.getOriginalMimeType=function(){return this.h},i.transmux=function(e,t,n){if(!n)return Promise.resolve(et(e));if(!t.mssPrivateData)return Promise.reject(new ye(2,3,3020));try{var i,r=this.g.parseBuffer(e),a=r.fetch("tfhd");a.track_ID=t.id+1;var o=r.fetch("tfdt"),s=r.fetch("traf");null===o&&((o=this.g.createFullBox("tfdt",s,a)).version=1,o.flags=0,o.baseMediaDecodeTime=Math.floor(n.startTime*t.mssPrivateData.timescale));var u=r.fetch("trun"),l=r.fetch("tfxd");l&&l._parent.boxes.splice(l._parent.boxes.indexOf(l),1);var h=r.fetch("tfrf");h&&h._parent.boxes.splice(h._parent.boxes.indexOf(h),1);var c=r.fetch("sepiff");if(null!==c){c.type="senc",c.usertype=void 0;var d=r.fetch("saio");if(null===d){(d=this.g.createFullBox("saio",s)).version=0,d.flags=0,d.entry_count=1,d.offset=[0];var p=this.g.createFullBox("saiz",s);if(p.version=0,p.flags=0,p.sample_count=c.sample_count,p.default_sample_info_size=0,p.sample_info_size=[],2&c.flags)for(i=0;i<c.sample_count;i+=1)p.sample_info_size[i]=10+6*c.entry[i].NumberOfEntries;else p.default_sample_info_size=8}}a.flags&=16777214,a.flags|=131072,u.flags|=1;var f=r.fetch("moof");u.data_offset=f.getLength()+8;var g=r.fetch("saio");null!==g&&(g.offset[0]=k_(f,"traf")+k_(s,"senc")+16);var m=et(r.write());return Promise.resolve(m)}catch(e){return e instanceof ye?Promise.reject(e):Promise.reject(new ye(2,3,3022))}},G("shaka.transmuxer.MssTransmuxer",I_),I_.prototype.transmux=I_.prototype.transmux,I_.prototype.getOriginalMimeType=I_.prototype.getOriginalMimeType,I_.prototype.convertCodecs=I_.prototype.convertCodecs,I_.prototype.isSupported=I_.prototype.isSupported,I_.prototype.destroy=I_.prototype.destroy;var M_=new Uint8Array([162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244]);function P_(e){this.j=e,this.g=0,this.h=new Map,this.i=null}Rt("mss/audio/mp4",(function(){return new I_("mss/audio/mp4")}),Ut),Rt("mss/video/mp4",(function(){return new I_("mss/video/mp4")}),Ut),(i=P_.prototype).destroy=function(){this.h.clear()},i.isSupported=function(e,t){if("video/mp2t"!=e.toLowerCase().split(";")[0])return!1;var n=e;t&&(n=this.convertCodecs(t,e));var i=Yt(n).split(",");return n=Te("audio",i),i=Te("video",i),!(n&&(n=zt(n),!R_.includes(n))||i&&(n=zt(i),!N_.includes(n)))&&(t?ze(this.convertCodecs(t,e)):(t=this.convertCodecs("audio",e),e=this.convertCodecs("video",e),ze(t)||ze(e)))},i.convertCodecs=function(e,t){return"video/mp2t"==t.toLowerCase().split(";")[0]?(t=Yt(t).replace("mp4a.40.34","mp3").split(",").map(this.ai).join(","),"audio"==e?'audio/mp4; codecs="'+t+'"':'video/mp4; codecs="'+t+'"'):t},i.ai=function(e){if(e.includes("avc1")){var t=e.split(".");if(3==t.length)return e=t.shift()+".",(e+=parseInt(t.shift(),10).toString(16))+("000"+parseInt(t.shift(),10).toString(16)).slice(-4)}return e},i.getOriginalMimeType=function(){return this.j},i.transmux=function(e,t,n,i,r){this.i?this.i.clearData():this.i=new no,e=et(e);var a=this.i.parse(e);e=[];var o=a.sd();try{var s=null;if("video"==r){switch(o.video){case"avc":var u=[],c=null,d=[],p=a.Oc();if(!p.length)throw new ye(2,3,3023);for(var f=0;f<p.length;f++){var g=p[f],m=g.nalus;d.push.apply(d,h(m));var v=y_(m);if(v){null==c&&(c=g.dts);var y=void 0;y=f+1<p.length?(p[f+1].dts||0)-(g.dts||0):1<p.length?(g.dts||0)-(p[f-1].dts||0):9e4*(n.endTime-n.startTime),u.push({data:v.data,size:v.data.byteLength,duration:y,kb:Math.round((g.pts||0)-(g.dts||0)),flags:{ob:0,bb:0,ab:0,Za:0,$a:v.Bd?2:1,pb:v.Bd?0:1}})}}var b=function(e){if(!e.length)return null;var t=e.find((function(e){return 7==e.type}));if(e=e.find((function(e){return 8==e.type})),!t||!e)return null;var n=new Wa(t.data),i=$a(n);if($a(n),$a(n),qa(n),b_.includes(i)&&(3===(i=Za(n))&&Xa(n,1),qa(n),qa(n),Xa(n,1),Qa(n))){i=3!==i?8:12;for(var r=0;r<i;r++)Qa(n)&&eo(n,6>r?16:64)}if(qa(n),0===(i=Za(n)))Za(n);else if(1===i)for(Xa(n,1),qa(n),qa(n),i=Za(n),r=0;r<i;r++)qa(n);qa(n),Xa(n,1);var a=Za(n),o=Za(n),s=Ka(n,1);0===s&&Xa(n,1),Xa(n,1);var u=0,l=0,c=0,d=0;if(Qa(n)&&(u=Za(n),l=Za(n),c=Za(n),d=Za(n)),r=i=1,Qa(n)&&Qa(n)){var p=$a(n);0<p&&16>p?(i=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][p-1],r=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][p-1]):255===p&&(i=Ka(n,16),r=Ka(n,16))}return n=(2-s)*(o+1)*16-2*c-2*d,a=16*(a+1)-2*u-2*l,u=[],t=t.fullData,u.push(t.byteLength>>>8&255),u.push(255&t.byteLength),u=u.concat.apply(u,h(t)),t=[],e=e.fullData,t.push(e.byteLength>>>8&255),t.push(255&e.byteLength),t=t.concat.apply(t,h(e)),{height:n,width:a,Ca:e=new Uint8Array([1,u[3],u[4],u[5],255,225].concat(u,[1],t)),Ja:i,La:r}}(d);if(!b||null==c)throw new ye(2,3,3018);t.height=b.height,t.width=b.width,s={id:t.id,type:"video",codecs:"avc1",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:9e4,duration:i,ib:[],qa:new Uint8Array([]),Ca:b.Ca,Ja:b.Ja,La:b.La,data:{Cb:this.g,baseMediaDecodeTime:c,fb:u},stream:t};break;case"hvc":if(p=[],g=null,m=[],!(u=a.Oc()).length)throw new ye(2,3,3023);for(v=0;v<u.length;v++){d=(c=u[v]).nalus,m.push.apply(m,h(d)),b=!1;var _=[],w=!1;for(y=(f=l(d)).next();!y.done;y=f.next()){var S=y.value;switch(S.type){case 1:case 0:var T=w=!0;break;case 19:case 20:case 21:b=T=w=!0;break;case 32:case 33:case 34:case 39:case 40:T=!0;break;case 35:w=T=!0;break;default:T=!1}if(w&&T){var A=S.fullData.byteLength,E=new Uint8Array(4);E[0]=A>>24&255,E[1]=A>>16&255,E[2]=A>>8&255,E[3]=255&A,_.push(_r(E,S.fullData))}}var C=_.length?{data:_r.apply(fr,h(_)),Bd:b}:null;C&&(null==g&&null!=c.dts&&(g=c.dts),b=void 0,b=v+1<u.length?(u[v+1].dts||0)-(c.dts||0):1<u.length?(c.dts||0)-(u[v-1].dts||0):9e4*(n.endTime-n.startTime),p.push({data:C.data,size:C.data.byteLength,duration:b,kb:Math.round((c.pts||0)-(c.dts||0)),flags:{ob:0,bb:0,ab:0,Za:0,$a:C.Bd?2:1,pb:C.Bd?0:1}}))}var x=function(e){if(!e.length)return null;var t=e.find((function(e){return 32==e.type})),n=e.find((function(e){return 33==e.type})),i=e.find((function(e){return 34==e.type}));if(!t||!n||!i)return null;var r=function(e){var t=new Wa(e,!0);return $a(t),$a(t),Ka(t,4),Ka(t,2),Ka(t,6),{Xf:(e=Ka(t,3))+1,ug:t=Qa(t)}}(t.fullData);e=function(e){$a(e=new Wa(e,!0)),$a(e);var t=0,n=0,i=0,r=0;Ka(e,4);var a=Ka(e,3);Qa(e);for(var o=Ka(e,2),s=Ka(e,1),u=Ka(e,5),l=$a(e),h=$a(e),c=$a(e),d=$a(e),p=$a(e),f=$a(e),g=$a(e),m=$a(e),v=$a(e),y=$a(e),b=$a(e),_=[],w=[],S=0;S<a;S++)_.push(Qa(e)),w.push(Qa(e));if(0<a)for(S=a;8>S;S++)Ka(e,2);for(S=0;S<a;S++)_[S]&&Ka(e,88),w[S]&&$a(e);Za(e),3==(_=Za(e))&&Ka(e,1),w=Za(e),S=Za(e),Qa(e)&&(t+=Za(e),n+=Za(e),i+=Za(e),r+=Za(e));var T=Za(e),A=Za(e),E=Za(e);if(Qa(e))for(var C=0;C<=a;C++)Za(e),Za(e),Za(e);else Za(e),Za(e),Za(e);if(Za(e),Za(e),Za(e),Za(e),Za(e),Za(e),Qa(e)&&Qa(e))for(C=0;4>C;C++)for(var x=0;x<(3===C?2:6);x++)if(Qa(e)){var I=Math.min(64,1<<4+(C<<1));1<C&&Ja(e);for(var k=0;k<I;k++)Ja(e)}else Za(e);for(Qa(e),Qa(e),Qa(e)&&($a(e),Za(e),Za(e),Qa(e)),C=Za(e),I=x=0;I<C;I++)if(k=!1,0!==I&&(k=Qa(e)),k){I===C&&Za(e),Qa(e),Za(e);for(var M=k=0;M<=x;M++){var P=Qa(e),L=!1;P||(L=Qa(e)),(P||L)&&k++}x=k}else{for(x=(M=Za(e))+(k=Za(e)),P=0;P<M;P++)Za(e),Qa(e);for(M=0;M<k;M++)Za(e),Qa(e)}if(Qa(e))for(C=Za(e),x=0;x<C;x++){for(I=0;I<E+4;I++)Ka(e,1);Ka(e,1)}if(C=E=1,x=0,Qa(e),Qa(e),Qa(e)){if(Qa(e)&&(k=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],M=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1],0<(I=$a(e))&&16>I?(E=k[I-1],C=M[I-1]):255===I&&(E=Ka(e,16),C=Ka(e,16))),Qa(e)&&Qa(e),Qa(e)&&(Ka(e,3),Qa(e),Qa(e)&&($a(e),$a(e),$a(e))),Qa(e)&&(Za(e),Za(e)),Qa(e),Qa(e),Qa(e),(I=Qa(e))&&(Za(e),Za(e),Za(e),Za(e)),Qa(e)&&(Ka(e,32),Ka(e,32),Qa(e)&&Za(e),Qa(e)))for(M=!1,I=Qa(e),k=Qa(e),(I||k)&&((M=Qa(e))&&($a(e),Ka(e,5),Qa(e),Ka(e,5)),Ka(e,4),Ka(e,4),M&&Ka(e,4),Ka(e,5),Ka(e,5),Ka(e,5)),P=0;P<=a;P++){var D=!0;L=1,Qa(e)||(D=Qa(e));var R=!1;if(D?Za(e):R=Qa(e),R||(L=Za(e)+1),I){for(D=0;D<L;D++)Za(e),Za(e),M&&(Za(e),Za(e));Qa(e)}if(k){for(D=0;D<L;D++)Za(e),Za(e),M&&(Za(e),Za(e));Qa(e)}}Qa(e)&&(Qa(e),Qa(e),Qa(e),x=Za(e),Za(e),Za(e),Za(e),Za(e))}return{xf:b,Df:o,Ef:s,Cf:u,yf:l,zf:h,Af:c,Bf:d,qf:p,rf:f,tf:g,uf:m,vf:v,wf:y,Ae:x,mf:0,lf:_,jf:T,hf:A,width:w-(t+n)*(1===_||2===_?2:1),height:S-(i+r)*(1===_?2:1),mj:E,lj:C}}(n.fullData);var a=function(e){var t=new Wa(e,!0);$a(t),$a(t),Za(t),Za(t),Qa(t),Qa(t),Ka(t,3),Qa(t),Qa(t),Za(t),Za(t),Ja(t),Qa(t),Qa(t),Qa(t)&&Za(t),Ja(t),Ja(t),Qa(t),Qa(t),Qa(t),Qa(t),e=Qa(t);var n=1;return(t=Qa(t))&&e?n=0:t?n=3:e&&(n=2),{$f:n}}(i.fullData);return t=function(e,t,n,i){var r=new Uint8Array(23+(5+e.byteLength)+(5+t.byteLength)+(5+n.byteLength));return r[0]=1,r[1]=(3&i.Df)<<6|(i.Ef?1:0)<<5|31&i.Cf,r[2]=i.yf,r[3]=i.zf,r[4]=i.Af,r[5]=i.Bf,r[6]=i.qf,r[7]=i.rf,r[8]=i.tf,r[9]=i.uf,r[10]=i.vf,r[11]=i.wf,r[12]=i.xf,r[13]=240|(3840&i.Ae)>>8,r[14]=255&i.Ae,r[15]=252|3&i.$f,r[16]=252|3&i.lf,r[17]=248|7&i.jf,r[18]=248|7&i.hf,r[19]=0,r[20]=0,r[21]=(3&i.mf)<<6|(7&i.Xf)<<3|(i.ug?1:0)<<2|3,r[22]=3,r[23]=160,r[24]=0,r[25]=1,r[26]=(65280&e.byteLength)>>8,r[27]=(255&e.byteLength)>>0,r.set(e,28),r[23+(5+e.byteLength)]=161,r[e.byteLength+29]=0,r[e.byteLength+30]=1,r[e.byteLength+31]=(65280&t.byteLength)>>8,r[e.byteLength+32]=(255&t.byteLength)>>0,r.set(t,e.byteLength+33),r[23+(e.byteLength+10+t.byteLength)]=162,r[e.byteLength+10+t.byteLength+24]=0,r[e.byteLength+10+t.byteLength+25]=1,r[e.byteLength+10+t.byteLength+26]=(65280&n.byteLength)>>8,r[e.byteLength+10+t.byteLength+27]=(255&n.byteLength)>>0,r.set(n,e.byteLength+10+t.byteLength+28),r}(t.fullData,n.fullData,i.fullData,{Xf:r.Xf,ug:r.ug,Df:e.Df,Ef:e.Ef,xf:e.xf,Cf:e.Cf,yf:e.yf,zf:e.zf,Af:e.Af,Bf:e.Bf,qf:e.qf,rf:e.rf,tf:e.tf,uf:e.uf,vf:e.vf,wf:e.wf,mf:e.mf,Ae:e.Ae,lf:e.lf,jf:e.jf,hf:e.hf,$f:a.$f}),{height:e.height,width:e.width,Ca:t,Ja:e.mj,La:e.lj}}(m);if(!x||null==g)throw new ye(2,3,3018);t.height=x.height,t.width=x.width,s={id:t.id,type:"video",codecs:"hvc1",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:9e4,duration:i,ib:[],qa:new Uint8Array([]),Ca:x.Ca,Ja:x.Ja,La:x.La,data:{Cb:this.g,baseMediaDecodeTime:g,fb:p},stream:t}}s&&(e.push(s),s=null)}if("audio"==r){switch(o.audio){case"aac":for(var I,k=[],M=null,P=l(a.qc()),L=P.next();!L.done;L=P.next()){var D=L.value,R=D.data;if(R){var N=0;if(!(I=h_(R,N)))throw new ye(2,3,3018);for(t.audioSamplingRate=I.sampleRate,t.channelsCount=I.channelCount,null==M&&null!==D.pts&&(M=D.pts);N<R.length;){var O=l_(R,N);if(O){var U=O.me+O.X;N+U<=R.length&&k.push({data:R.subarray(N+O.me,N+U),size:O.X,duration:1024,kb:0,flags:{ob:0,bb:0,ab:0,Za:0,$a:2,pb:0}}),N+=U}else N++}}}if(!I||null==M){if(!a.Oc().length)throw new ye(2,3,3018);M=9e4*n.startTime;var B=Te("audio",t.codecs.split(","));if(!B||!t.channelsCount||!t.audioSamplingRate)throw new ye(2,3,3018);I={sampleRate:t.audioSamplingRate,channelCount:t.channelsCount,wa:B};var F=function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t||3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}(B,t.channelsCount);if(!F)throw new ye(2,3,3018);var G=M+9e4*(n.endTime-n.startTime);for(a=M;a<G;)k.push({data:F,size:F.byteLength,duration:1024,kb:0,flags:{ob:0,bb:0,ab:0,Za:0,$a:2,pb:0}}),a+=1024/I.sampleRate*9e4}var j=I.sampleRate;a=M/9e4*j,s={id:t.id,type:"audio",codecs:I.wa,encrypted:t.encrypted&&0<t.drmInfos.length,timescale:j,duration:i,ib:[],qa:new Uint8Array([]),Ca:new Uint8Array([]),Ja:0,La:0,data:{Cb:this.g,baseMediaDecodeTime:a,fb:k},stream:t};break;case"ac3":I=[],j=0,k=new Uint8Array([]),M=null;for(var H=(N=l(a.qc())).next();!H.done;H=N.next()){var V=H.value,W=V.data;for(null==M&&null!==V.pts&&(M=V.pts),a=0;a<W.length;){var z=p_(W,a);z?(t.audioSamplingRate=z.sampleRate,t.channelsCount=z.channelCount,j=z.sampleRate,k=z.qa,I.push({data:W.subarray(a,a+z.X),size:z.X,duration:1536,kb:0,flags:{ob:0,bb:0,ab:0,Za:0,$a:2,pb:0}}),a+=z.X):a++}}if(0==j||0==k.byteLength||null==M)throw new ye(2,3,3018);a=M/9e4*j,s={id:t.id,type:"audio",codecs:"ac-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:j,duration:i,ib:[],qa:k,Ca:new Uint8Array([]),Ja:0,La:0,data:{Cb:this.g,baseMediaDecodeTime:a,fb:I},stream:t};break;case"ec3":I=[],j=0,M=new Uint8Array([]),k=null;for(var X=l(a.qc()),K=X.next();!K.done;K=X.next()){var Y=K.value,q=Y.data;for(null==k&&null!==Y.pts&&(k=Y.pts),a=0;a<q.length;){var Z=m_(q,a);Z?(t.audioSamplingRate=Z.sampleRate,t.channelsCount=Z.channelCount,j=Z.sampleRate,M=Z.qa,I.push({data:q.subarray(a,a+Z.X),size:Z.X,duration:1536,kb:0,flags:{ob:0,bb:0,ab:0,Za:0,$a:2,pb:0}}),a+=Z.X):a++}}if(0==j||0==M.byteLength||null==k)throw new ye(2,3,3018);a=k/9e4*j,s={id:t.id,type:"audio",codecs:"ec-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:j,duration:i,ib:[],qa:M,Ca:new Uint8Array([]),Ja:0,La:0,data:{Cb:this.g,baseMediaDecodeTime:a,fb:I},stream:t};break;case"mp3":var J;I=[],j=null;for(var Q=l(a.qc()),$=Q.next();!$.done;$=Q.next()){var ee=$.value,te=ee.data;if(te)for(null==j&&null!==ee.pts&&(j=ee.pts),a=0;a<te.length;){var ne=__(te,a);ne?(J||(J=ne),a+ne.X<=te.length&&I.push({data:te.subarray(a,a+ne.X),size:ne.X,duration:1152,kb:0,flags:{ob:0,bb:0,ab:0,Za:0,$a:2,pb:0}}),a+=ne.X):a++}}if(!J||null==j)throw new ye(2,3,3018);var ie=J.sampleRate;a=j/9e4*ie,s={id:t.id,type:"audio",codecs:"mp3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:ie,duration:i,ib:[],qa:new Uint8Array([]),Ca:new Uint8Array([]),Ja:0,La:0,data:{Cb:this.g,baseMediaDecodeTime:a,fb:I},stream:t}}s&&e.push(s)}}catch(e){return e&&3023==e.code?Promise.resolve(new Uint8Array([])):Promise.reject(e)}return e.length?(e=new Mg(e),this.h.has(t.id)?i=this.h.get(t.id):(i=Pg(e),this.h.set(t.id,i)),t=Og(e),this.g++,t=_r(i,t),Promise.resolve(t)):Promise.reject(new ye(2,3,3018))},G("shaka.transmuxer.TsTransmuxer",P_),P_.prototype.transmux=P_.prototype.transmux,P_.prototype.getOriginalMimeType=P_.prototype.getOriginalMimeType,P_.prototype.convertCodecs=P_.prototype.convertCodecs,P_.prototype.isSupported=P_.prototype.isSupported,P_.prototype.destroy=P_.prototype.destroy;var L_,D_,R_=["aac","ac-3","ec-3","mp3"],N_=["avc","hevc"];function O_(){}function U_(){L_?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(L_=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=B_):console.debug("EmeEncryptionSchemePolyfill: EME not found")}function B_(e,t){var n,i=this;return L((function(r){return 1==r.g?(console.assert(i==navigator,'bad "this" for requestMediaKeySystemAccess'),_(r,L_.call(i,e,t),2)):Y_(n=r.h)?(console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=L_,r.return(n)):(console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.requestMediaKeySystemAccess=F_,r.return(F_.call(i,e,t)))}))}function F_(e,t){var n,i,r,a,o,s,u,h,c,d,p=this;return L((function(f){if(1==f.g){for(console.assert(p==navigator,'bad "this" for requestMediaKeySystemAccess'),n=K_(e),i=[],r=l(t),a=r.next();!a.done;a=r.next())o=a.value,s=G_(o.videoCapabilities,n),u=G_(o.audioCapabilities,n),o.videoCapabilities&&o.videoCapabilities.length&&!s.length||o.audioCapabilities&&o.audioCapabilities.length&&!u.length||((h=Object.assign({},o)).videoCapabilities=s,h.audioCapabilities=u,i.push(h));if(!i.length)throw(c=Error("Unsupported keySystem or supportedConfigurations.")).name="NotSupportedError",c.code=DOMException.NOT_SUPPORTED_ERR,c;return _(f,L_.call(p,e,i),2)}return d=f.h,f.return(new X_(d,n))}))}function G_(e,t){return e?e.filter((function(e){return!e.encryptionScheme||e.encryptionScheme==t})):e}function j_(){}function H_(){D_?console.debug("McEncryptionSchemePolyfill: Already installed."):navigator.mediaCapabilities?(D_=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=V_):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}function V_(e){var t,n,i,r=this;return L((function(a){switch(a.g){case 1:return console.assert(r==navigator.mediaCapabilities,'bad "this" for decodingInfo'),_(a,D_.call(r,e),2);case 2:if(t=a.h,!e.keySystemConfiguration)return a.return(t);if((n=t.keySystemAccess)&&Y_(n))return console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=D_,a.return(t);if(console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=W_,n){a.F(3);break}return i=t,_(a,z_(e),4);case 4:return i.keySystemAccess=a.h,a.return(t);case 3:return a.return(W_.call(r,e))}}))}function W_(e){var t,n,i,r,a,o,s,u,l=this;return L((function(h){switch(h.g){case 1:return console.assert(l==navigator.mediaCapabilities,'bad "this" for decodingInfo'),t=null,e.keySystemConfiguration&&(n=e.keySystemConfiguration,i=n.keySystem,r=n.audio&&n.audio.encryptionScheme,a=n.video&&n.video.encryptionScheme,t=K_(i),o={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:e},r&&r!=t||a&&a!=t)?h.return(o):_(h,D_.call(l,e),2);case 2:if((s=h.h).keySystemAccess){s.keySystemAccess=new X_(s.keySystemAccess,t),h.F(3);break}if(!e.keySystemConfiguration){h.F(3);break}return u=s,_(h,z_(e),5);case 5:u.keySystemAccess=h.h;case 3:return h.return(s)}}))}function z_(e){var t,n;return L((function(i){if(1==i.g){var r=e.keySystemConfiguration,a=[],o=[];return r.audio&&a.push({robustness:r.audio.robustness||"",contentType:e.audio.contentType}),r.video&&o.push({robustness:r.video.robustness||"",contentType:e.video.contentType}),r={initDataTypes:r.initDataType?[r.initDataType]:[],distinctiveIdentifier:r.distinctiveIdentifier,persistentState:r.persistentState,sessionTypes:r.sessionTypes},a.length&&(r.audioCapabilities=a),o.length&&(r.videoCapabilities=o),t=r,_(i,navigator.requestMediaKeySystemAccess(e.keySystemConfiguration.keySystem,[t]),2)}return n=i.h,i.return(n)}))}function X_(e,t){this.h=e,this.g=t,this.keySystem=e.keySystem}function K_(e){return e.startsWith("com.widevine")||e.startsWith("com.microsoft")||e.startsWith("com.chromecast")||e.startsWith("com.adobe")||e.startsWith("org.w3")?"cenc":e.startsWith("com.apple")?"cbcs-1-9":(console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",e,"Please contribute!"),null)}function Y_(e){var t=(e=e.getConfiguration()).audioCapabilities&&e.audioCapabilities[0];return!(!(e=e.videoCapabilities&&e.videoCapabilities[0]||t)||void 0===e.encryptionScheme)}function q_(){}function Z_(){U_(),H_()}Rt("video/mp2t",(function(){return new P_("video/mp2t")}),Ft),G("EmeEncryptionSchemePolyfill",O_),O_.install=U_,G("McEncryptionSchemePolyfill",j_),j_.install=H_,X_.prototype.getConfiguration=function(){var e=this.h.getConfiguration();if(e.videoCapabilities)for(var t=l(e.videoCapabilities),n=t.next();!n.done;n=t.next())n.value.encryptionScheme=this.g;if(e.audioCapabilities)for(n=(t=l(e.audioCapabilities)).next();!n.done;n=t.next())n.value.encryptionScheme=this.g;return e},X_.prototype.createMediaKeys=function(){return this.h.createMediaKeys()},G("EncryptionSchemePolyfills",q_),q_.install=Z_,void 0!==n&&n.exports&&(n.exports=q_);for(var J_={ach:{A:"Lwo",B:"Acholi"},ady:{A:"",B:"Adyghe"},af:{A:"Afrikaans",B:"Afrikaans"},"af-NA":{A:"Afrikaans (Namibia)",B:"Afrikaans (Namibia)"},"af-ZA":{A:"Afrikaans (South Africa)",B:"Afrikaans (South Africa)"},ak:{A:"Ti",B:"Akan"},ar:{A:"",B:"Arabic"},"ar-AR":{A:"",B:"Arabic"},"ar-MA":{A:"",B:"Arabic (Morocco)"},"ar-SA":{A:" ()",B:"Arabic (Saudi Arabia)"},"ay-BO":{A:"Aymar aru",B:"Aymara"},az:{A:"Azrbaycan dili",B:"Azerbaijani"},"az-AZ":{A:"Azrbaycan dili",B:"Azerbaijani"},"be-BY":{A:"",B:"Belarusian"},bg:{A:"",B:"Bulgarian"},"bg-BG":{A:"",B:"Bulgarian"},bn:{A:"",B:"Bengali"},"bn-IN":{A:" ()",B:"Bengali (India)"},"bn-BD":{A:"()",B:"Bengali (Bangladesh)"},"bs-BA":{A:"Bosanski",B:"Bosnian"},ca:{A:"Catal",B:"Catalan"},"ca-ES":{A:"Catal",B:"Catalan"},cak:{A:"Maya Kaqchikel",B:"Kaqchikel"},"ck-US":{A:" (tsalagi)",B:"Cherokee"},cs:{A:"etina",B:"Czech"},"cs-CZ":{A:"etina",B:"Czech"},cy:{A:"Cymraeg",B:"Welsh"},"cy-GB":{A:"Cymraeg",B:"Welsh"},da:{A:"Dansk",B:"Danish"},"da-DK":{A:"Dansk",B:"Danish"},de:{A:"Deutsch",B:"German"},"de-AT":{A:"Deutsch (sterreich)",B:"German (Austria)"},"de-DE":{A:"Deutsch (Deutschland)",B:"German (Germany)"},"de-CH":{A:"Deutsch (Schweiz)",B:"German (Switzerland)"},dsb:{A:"Dolnoserbina",B:"Lower Sorbian"},el:{A:"",B:"Greek"},"el-GR":{A:"",B:"Greek (Greece)"},en:{A:"English",B:"English"},"en-GB":{A:"English (UK)",B:"English (UK)"},"en-AU":{A:"English (Australia)",B:"English (Australia)"},"en-CA":{A:"English (Canada)",B:"English (Canada)"},"en-IE":{A:"English (Ireland)",B:"English (Ireland)"},"en-IN":{A:"English (India)",B:"English (India)"},"en-PI":{A:"English (Pirate)",B:"English (Pirate)"},"en-UD":{A:"English (Upside Down)",B:"English (Upside Down)"},"en-US":{A:"English (US)",B:"English (US)"},"en-ZA":{A:"English (South Africa)",B:"English (South Africa)"},"en@pirate":{A:"English (Pirate)",B:"English (Pirate)"},eo:{A:"Esperanto",B:"Esperanto"},"eo-EO":{A:"Esperanto",B:"Esperanto"},es:{A:"Espaol",B:"Spanish"},"es-AR":{A:"Espaol (Argentine)",B:"Spanish (Argentina)"},"es-419":{A:"Espaol (Latinoamrica)",B:"Spanish (Latin America)"},"es-CL":{A:"Espaol (Chile)",B:"Spanish (Chile)"},"es-CO":{A:"Espaol (Colombia)",B:"Spanish (Colombia)"},"es-EC":{A:"Espaol (Ecuador)",B:"Spanish (Ecuador)"},"es-ES":{A:"Espaol (Espaa)",B:"Spanish (Spain)"},"es-LA":{A:"Espaol (Latinoamrica)",B:"Spanish (Latin America)"},"es-NI":{A:"Espaol (Nicaragua)",B:"Spanish (Nicaragua)"},"es-MX":{A:"Espaol (Mxico)",B:"Spanish (Mexico)"},"es-US":{A:"Espaol (Estados Unidos)",B:"Spanish (United States)"},"es-VE":{A:"Espaol (Venezuela)",B:"Spanish (Venezuela)"},et:{A:"eesti keel",B:"Estonian"},"et-EE":{A:"Eesti (Estonia)",B:"Estonian (Estonia)"},eu:{A:"Euskara",B:"Basque"},"eu-ES":{A:"Euskara",B:"Basque"},fa:{A:"",B:"Persian"},"fa-IR":{A:"",B:"Persian"},"fb-LT":{A:"Leet Speak",B:"Leet"},ff:{A:"Fulah",B:"Fulah"},fi:{A:"Suomi",B:"Finnish"},"fi-FI":{A:"Suomi",B:"Finnish"},"fo-FO":{A:"Froyskt",B:"Faroese"},fr:{A:"Franais",B:"French"},"fr-CA":{A:"Franais (Canada)",B:"French (Canada)"},"fr-FR":{A:"Franais (France)",B:"French (France)"},"fr-BE":{A:"Franais (Belgique)",B:"French (Belgium)"},"fr-CH":{A:"Franais (Suisse)",B:"French (Switzerland)"},"fy-NL":{A:"Frysk",B:"Frisian (West)"},ga:{A:"Gaeilge",B:"Irish"},"ga-IE":{A:"Gaeilge (Gaelic)",B:"Irish (Gaelic)"},gl:{A:"Galego",B:"Galician"},"gl-ES":{A:"Galego",B:"Galician"},"gn-PY":{A:"Avae'",B:"Guarani"},"gu-IN":{A:"",B:"Gujarati"},"gx-GR":{A:" ",B:"Classical Greek"},he:{A:"",B:"Hebrew"},"he-IL":{A:"",B:"Hebrew"},hi:{A:"",B:"Hindi"},"hi-IN":{A:"",B:"Hindi"},hr:{A:"Hrvatski",B:"Croatian"},"hr-HR":{A:"Hrvatski",B:"Croatian"},hsb:{A:"Hornjoserbina",B:"Upper Sorbian"},ht:{A:"Kreyl",B:"Haitian Creole"},hu:{A:"Magyar",B:"Hungarian"},"hu-HU":{A:"Magyar",B:"Hungarian"},"hy-AM":{A:"",B:"Armenian"},id:{A:"Bahasa Indonesia",B:"Indonesian"},"id-ID":{A:"Bahasa Indonesia",B:"Indonesian"},is:{A:"slenska",B:"Icelandic"},"is-IS":{A:"slenska (Iceland)",B:"Icelandic (Iceland)"},it:{A:"Italiano",B:"Italian"},"it-IT":{A:"Italiano",B:"Italian"},ja:{A:"",B:"Japanese"},"ja-JP":{A:"",B:"Japanese"},"jv-ID":{A:"Basa Jawa",B:"Javanese"},"ka-GE":{A:"",B:"Georgian"},"kk-KZ":{A:"",B:"Kazakh"},km:{A:"",B:"Khmer"},"km-KH":{A:"",B:"Khmer"},kab:{A:"Taqbaylit",B:"Kabyle"},kn:{A:"",B:"Kannada"},"kn-IN":{A:" (India)",B:"Kannada (India)"},ko:{A:"",B:"Korean"},"ko-KR":{A:" ()",B:"Korean (Korea)"},ku:{A:"Kurd",B:"Kurdish"},"ku-TR":{A:"Kurd",B:"Kurdish"},la:{A:"Latin",B:"Latin"},"la-VA":{A:"Latin",B:"Latin"},lb:{A:"Ltzebuergesch",B:"Luxembourgish"},"li-NL":{A:"Lmbrgs",B:"Limburgish"},lt:{A:"Lietuvi",B:"Lithuanian"},"lt-LT":{A:"Lietuvi",B:"Lithuanian"},lv:{A:"Latvieu",B:"Latvian"},"lv-LV":{A:"Latvieu",B:"Latvian"},mai:{A:", ",B:"Maithili"},"mg-MG":{A:"Malagasy",B:"Malagasy"},mk:{A:"",B:"Macedonian"},"mk-MK":{A:" ()",B:"Macedonian (Macedonian)"},ml:{A:"",B:"Malayalam"},"ml-IN":{A:"",B:"Malayalam"},"mn-MN":{A:"",B:"Mongolian"},mr:{A:"",B:"Marathi"},"mr-IN":{A:"",B:"Marathi"},ms:{A:"Bahasa Melayu",B:"Malay"},"ms-MY":{A:"Bahasa Melayu",B:"Malay"},mt:{A:"Malti",B:"Maltese"},"mt-MT":{A:"Malti",B:"Maltese"},my:{A:"",B:"Burmese"},nb:{A:"Norsk (bokml)",B:"Norwegian (bokmal)"},"nb-NO":{A:"Norsk (bokml)",B:"Norwegian (bokmal)"},ne:{A:"",B:"Nepali"},"ne-NP":{A:"",B:"Nepali"},nl:{A:"Nederlands",B:"Dutch"},"nl-BE":{A:"Nederlands (Belgi)",B:"Dutch (Belgium)"},"nl-NL":{A:"Nederlands (Nederland)",B:"Dutch (Netherlands)"},"nn-NO":{A:"Norsk (nynorsk)",B:"Norwegian (nynorsk)"},no:{A:"Norsk",B:"Norwegian"},oc:{A:"Occitan",B:"Occitan"},"or-IN":{A:"",B:"Oriya"},pa:{A:"",B:"Punjabi"},"pa-IN":{A:" ( )",B:"Punjabi (India)"},pl:{A:"Polski",B:"Polish"},"pl-PL":{A:"Polski",B:"Polish"},"ps-AF":{A:"",B:"Pashto"},pt:{A:"Portugus",B:"Portuguese"},"pt-BR":{A:"Portugus (Brasil)",B:"Portuguese (Brazil)"},"pt-PT":{A:"Portugus (Portugal)",B:"Portuguese (Portugal)"},"qu-PE":{A:"Qhichwa",B:"Quechua"},"rm-CH":{A:"Rumantsch",B:"Romansh"},ro:{A:"Romn",B:"Romanian"},"ro-RO":{A:"Romn",B:"Romanian"},ru:{A:"",B:"Russian"},"ru-RU":{A:"",B:"Russian"},"sa-IN":{A:"",B:"Sanskrit"},"se-NO":{A:"Davvismegiella",B:"Northern Smi"},"si-LK":{A:"",B:"Sinhala (Sri Lanka)"},sk:{A:"Slovenina",B:"Slovak"},"sk-SK":{A:"Slovenina (Slovakia)",B:"Slovak (Slovakia)"},sl:{A:"Slovenina",B:"Slovenian"},"sl-SI":{A:"Slovenina",B:"Slovenian"},"so-SO":{A:"Soomaaliga",B:"Somali"},sq:{A:"Shqip",B:"Albanian"},"sq-AL":{A:"Shqip",B:"Albanian"},sr:{A:"",B:"Serbian"},"sr-RS":{A:" (Serbia)",B:"Serbian (Serbia)"},su:{A:"Basa Sunda",B:"Sundanese"},sv:{A:"Svenska",B:"Swedish"},"sv-SE":{A:"Svenska",B:"Swedish"},sw:{A:"Kiswahili",B:"Swahili"},"sw-KE":{A:"Kiswahili",B:"Swahili (Kenya)"},ta:{A:"",B:"Tamil"},"ta-IN":{A:"",B:"Tamil"},te:{A:"",B:"Telugu"},"te-IN":{A:"",B:"Telugu"},tg:{A:" ",B:"Tajik"},"tg-TJ":{A:"",B:"Tajik"},th:{A:"",B:"Thai"},"th-TH":{A:" ()",B:"Thai (Thailand)"},tl:{A:"Filipino",B:"Filipino"},"tl-PH":{A:"Filipino",B:"Filipino"},tlh:{A:"tlhIngan-Hol",B:"Klingon"},tr:{A:"Trke",B:"Turkish"},"tr-TR":{A:"Trke",B:"Turkish"},"tt-RU":{A:"",B:"Tatar"},uk:{A:"",B:"Ukrainian"},"uk-UA":{A:"",B:"Ukrainian"},ur:{A:"",B:"Urdu"},"ur-PK":{A:"",B:"Urdu"},uz:{A:"O'zbek",B:"Uzbek"},"uz-UZ":{A:"O'zbek",B:"Uzbek"},vi:{A:"Ting Vit",B:"Vietnamese"},"vi-VN":{A:"Ting Vit",B:"Vietnamese"},"xh-ZA":{A:"isiXhosa",B:"Xhosa"},yi:{A:"",B:"Yiddish"},"yi-DE":{A:" (German)",B:"Yiddish (German)"},zh:{A:"",B:"Chinese"},"zh-HANS":{A:"",B:"Chinese Simplified"},"zh-HANT":{A:"",B:"Chinese Traditional"},"zh-CN":{A:"",B:"Chinese Simplified (China)"},"zh-HK":{A:"",B:"Chinese Traditional (Hong Kong)"},"zh-SG":{A:"",B:"Chinese Simplified (Singapore)"},"zh-TW":{A:"",B:"Chinese Traditional (Taiwan)"},"zu-ZA":{A:"isiZulu",B:"Zulu"}},Q_=l(Object.keys(J_)),$_=Q_.next();!$_.done;$_=Q_.next()){var ew=$_.value;J_[ew.toLowerCase()]=J_[ew]}function tw(e,t){var n=this;this.parent=e,this.controls=t,this.eventManager=new Hi,this.localization=this.controls.va,this.player=this.controls.Mc(),this.video=this.controls.cc(),this.adManager=this.player.ee(),this.ad=t.getAd(),this.eventManager.o(this.adManager,"ad-started",(function(e){n.ad=e.ad})),this.eventManager.o(this.adManager,"ad-stopped",(function(){n.ad=null}))}function nw(e){return iw(e,"shaka-back-to-overflow-button")}function iw(e,t){return(e=e.getElementsByClassName(t)).length?e[0]:null}function rw(e){e&&(e=iw(e,"shaka-chosen-item"))&&e.parentElement.focus()}function aw(){var e=eu("i");return e.classList.add("material-icons-round"),e.classList.add("shaka-chosen-item"),e.textContent="done",e.ariaHidden="true",e}function ow(e,t){e&&(t?e.classList.remove("shaka-hidden"):e.classList.add("shaka-hidden"))}function sw(e,t){var n=Math.floor(e/3600),i=Math.floor(e/60%60);return 10>(e=Math.floor(e%60))&&(e="0"+e),e=i+":"+e,t&&(10>i&&(e="0"+e),e=n+":"+e),e}function uw(e,t){tw.call(this,e,t);var n=this;this.i=eu("div"),this.i.classList.add("shaka-ad-counter"),this.parent.appendChild(this.i),this.h=eu("span"),this.h.classList.add("shaka-ad-counter-span"),this.i.appendChild(this.h),this.g=new ln((function(){var e=Math.round(n.ad.getRemainingTime()),t=n.ad.getDuration();-1!=e&&-1!=t&&(0<e?(e=sw(t-e,!1)+" / "+sw(t,!1),1<n.ad.getSequenceLength()?n.h.textContent=e:(t=n.localization.resolve("AD_TIME"),n.h.textContent=t.replace("[AD_TIME]",e))):(n.g.stop(),n.h.textContent=""))})),this.eventManager.o(this.localization,"locale-updated",(function(){})),this.eventManager.o(this.localization,"locale-changed",(function(){})),this.eventManager.o(this.adManager,"ad-started",(function(){n.g.Qa(),n.g.za(.5)})),this.eventManager.o(this.adManager,"ad-stopped",(function(){n.g.stop(),n.h.textContent=""})),this.ad&&(this.g.Qa(),this.g.za(.5))}function lw(e,t){tw.call(this,e,t);var n=this;this.g=eu("div"),this.g.classList.add("shaka-ad-position"),ow(this.g,!1),this.parent.appendChild(this.g),this.h=eu("span"),this.h.classList.add("shaka-ad-position-span"),this.g.appendChild(this.h),this.eventManager.o(this.localization,"locale-updated",(function(){n.ad&&hw(n)})),this.eventManager.o(this.localization,"locale-changed",(function(){n.ad&&hw(n)})),this.eventManager.o(this.adManager,"ad-started",(function(){hw(n)})),this.eventManager.o(this.adManager,"ad-stopped",(function(){n.h.textContent="",ow(n.g,!1)})),this.ad&&hw(this)}function hw(e){var t=e.ad.getSequenceLength();if(1<t){var n=e.ad.getPositionInSequence();e.h.textContent=e.localization.resolve("AD_PROGRESS").replace("[AD_ON]",String(n)).replace("[NUM_ADS]",String(t)),ow(e.g,!0)}}function cw(e,t){tw.call(this,e,t);var n=this;this.button=tu(),this.parent.appendChild(this.button),this.eventManager.o(this.localization,"locale-updated",(function(){n.g()})),this.eventManager.o(this.localization,"locale-changed",(function(){n.g()})),this.eventManager.o(this.video,"play",(function(){n.g(),n.h()})),this.eventManager.o(this.video,"pause",(function(){n.g(),n.h()})),this.eventManager.o(this.video,"seeking",(function(){n.g(),n.h()})),this.eventManager.o(this.adManager,"ad-paused",(function(){n.g(),n.h()})),this.eventManager.o(this.adManager,"ad-resumed",(function(){n.g(),n.h()})),this.eventManager.o(this.adManager,"ad-started",(function(){n.g(),n.h()})),this.eventManager.o(this.adManager,"ad-stopped",(function(){n.g(),n.h()})),this.eventManager.o(this.button,"click",(function(){n.ad&&n.ad.isLinear()?Ow(n.controls):Nw(n.controls)})),this.ad&&(this.g(),this.h())}function dw(e,t){cw.call(this,e,t),this.button.classList.add("shaka-play-button"),this.button.classList.add("shaka-no-propagation"),this.h(),this.g()}function pw(t,n){tw.call(this,t,n);var i=this;this.j=this.controls.g,this.h=this.controls.h,this.i=[],this.g=eu("div"),this.g.classList.add("shaka-no-propagation"),this.g.classList.add("shaka-context-menu"),this.g.classList.add("shaka-hidden"),this.h.appendChild(this.g),this.eventManager.o(this.h,"contextmenu",(function(e){if(i.g.classList.contains("shaka-hidden")){e.preventDefault();var t=i.h.getBoundingClientRect();i.g.style.left=e.clientX-t.left+"px",i.g.style.top=e.clientY-t.top+"px",ow(i.g,!0)}else ow(i.g,!1)})),this.eventManager.o(e,"click",(function(){ow(i.g,!1)})),function(e){for(var t=l(e.j.contextMenuElements),n=t.next();!n.done;n=t.next()){n=n.value;var i=gw.get(n);i?e.i.push(i.create(e.g,e.controls)):X("Unrecognized context menu element:",n)}}(this)}function fw(e,t){gw.set(e,t)}tw.prototype.release=function(){this.eventManager.release(),this.ad=this.adManager=this.video=this.player=this.localization=this.eventManager=this.controls=this.parent=null},G("shaka.ui.Element",tw),tw.prototype.release=tw.prototype.release,m(uw,tw),uw.prototype.release=function(){this.g.stop(),this.g=null,tw.prototype.release.call(this)},G("shaka.ui.AdCounter",uw),m(lw,tw),G("shaka.ui.AdPosition",lw),m(cw,tw),cw.prototype.isPaused=function(){if(this.ad&&this.ad.isLinear())var e=this.ad.isPaused();else e=(e=this.controls).u.paused&&!e.W;return e},cw.prototype.isEnded=function(){return(!this.ad||!this.ad.isLinear())&&this.video.ended},cw.prototype.g=function(){},cw.prototype.h=function(){},G("shaka.ui.PlayButton",cw),m(dw,cw),dw.prototype.h=function(){this.isPaused()?this.button.setAttribute("icon","play"):this.button.setAttribute("icon","pause")},dw.prototype.g=function(){var e=this.isPaused()?"PLAY":"PAUSE";this.button.ariaLabel=this.localization.resolve(e)},G("shaka.ui.BigPlayButton",dw),m(pw,tw),pw.prototype.release=function(){this.h=null;for(var e=l(this.i),t=e.next();!t.done;t=e.next())t.value.release();this.i=[],tw.prototype.release.call(this)},G("shaka.ui.ContextMenu",pw),pw.registerElement=fw;var gw=new Map;function mw(e,t){tw.call(this,e,t);var n=this;this.m=null,this.s=!1,this.j=new ln((function(){0!=parseInt(n.h.textContent,10)&&(n.video.currentTime=n.controls.Hf()+parseInt(n.h.textContent,10)),n.g.style.opacity="0",n.s=!1,n.h.textContent="0s"})),this.g=eu("div"),this.parent.appendChild(this.g),this.eventManager.o(this.g,"touchend",(function(e){n.controls.dc()&&(n.controls.nd()?(e.preventDefault(),n.controls.uc()):0<n.controls.g.tapSeekDistance&&(e.preventDefault(),e=n.controls.g.tapSeekDistance,n.s?n.m+1e3>Date.now()&&(n.j.stop(),n.m=Date.now(),n.h.textContent=(n.l?parseInt(n.h.textContent,10)-e:parseInt(n.h.textContent,10)+e).toString()+"s",n.g.style.opacity="1",n.j.S(1)):(n.s=!0,n.m=Date.now(),n.j.S(1))))})),this.h=eu("span"),this.h.textContent="0s",this.g.appendChild(this.h),this.i=eu("span"),this.i.classList.add("shaka-forward-rewind-container-icon"),this.g.appendChild(this.i),this.l=!1}function vw(e,t){mw.call(this,e,t),this.g.classList.add("shaka-fast-foward-container"),this.i.textContent="fast_forward",this.l=!1}function yw(e,t){mw.call(this,e,t),this.g.classList.add("shaka-rewind-container"),this.i.textContent="fast_rewind",this.l=!0}function bw(e,t,n,i){tw.call(this,e,t);var r=this;this.container=eu("div"),this.container.classList.add("shaka-range-container"),this.container.classList.add.apply(this.container.classList,h(n)),this.h=!1,this.bar=document.createElement("input"),this.G=new ln((function(){r.onChangeEnd(),r.h=!1})),this.bar.classList.add("shaka-range-element"),this.bar.classList.add.apply(this.bar.classList,h(i)),this.bar.type="range",this.bar.step="any",this.bar.min="0",this.bar.max="1",this.bar.value="0",this.container.appendChild(this.bar),this.parent.appendChild(this.container),this.eventManager.o(this.bar,"mousedown",(function(){r.controls.dc()&&(r.h=!0,r.onChangeStart())})),this.eventManager.o(this.bar,"touchstart",(function(e){r.controls.dc()&&(r.h=!0,_w(r,e),r.onChangeStart())})),this.eventManager.o(this.bar,"input",(function(){r.onChange()})),this.eventManager.o(this.bar,"touchmove",(function(e){r.h&&(_w(r,e),r.onChange())})),this.eventManager.o(this.bar,"touchend",(function(e){r.h&&(r.h=!1,_w(r,e),r.onChangeEnd())})),this.eventManager.o(this.bar,"touchcancel",(function(e){r.h&&(r.h=!1,_w(r,e),r.onChangeEnd())})),this.eventManager.o(this.bar,"mouseup",(function(){r.h&&(r.h=!1,r.onChangeEnd())})),this.eventManager.o(this.bar,"blur",(function(){r.h&&(r.h=!1,r.onChangeEnd())})),this.eventManager.o(this.bar,"contextmenu",(function(e){e.preventDefault(),e.stopPropagation()}))}function _w(e,t){t.preventDefault();var n=t.changedTouches[0],i=e.bar.getBoundingClientRect();t=parseFloat(e.bar.min);var r=parseFloat(e.bar.max);(n=t+(r-t)/i.width*(n.clientX-i.left))<t?n=t:n>r&&(n=r),e.bar.value=n}function ww(e,t){bw.call(this,e,t,["shaka-seek-bar-container"],["shaka-seek-bar","shaka-no-propagation","shaka-show-controls-on-mouse-over"]);var n=this;this.D=eu("div"),this.D.classList.add("shaka-ad-markers"),this.container.insertBefore(this.D,this.container.childNodes[0]),this.H=this.controls.g,this.s=new ln((function(){var e=n.getValue();n.player.R()||e==n.video.duration&&(e-=.001),n.video.currentTime=e})),this.I=new ln((function(){Sw(n)})),this.K=!1,this.i=eu("div"),this.i.id="shaka-player-ui-thumbnail-container",this.g=eu("img"),this.g.id="shaka-player-ui-thumbnail-image",this.g.draggable=!1,this.u=eu("div"),this.u.id="shaka-player-ui-thumbnail-time",this.i.appendChild(this.g),this.i.appendChild(this.u),this.container.appendChild(this.i),this.j=this.l=null,this.J=!1,this.m=new ln((function(){xw(n)})),this.C=[],this.eventManager.o(this.localization,"locale-updated",(function(){return Ew(n)})),this.eventManager.o(this.localization,"locale-changed",(function(){return Ew(n)})),this.eventManager.o(this.adManager,"ad-started",(function(){Aw(n)||ow(n.container,!1)})),this.eventManager.o(this.adManager,"ad-stopped",(function(){Aw(n)&&ow(n.container,!0)})),this.eventManager.o(this.adManager,"ad-cue-points-changed",(function(e){n.C=e.cuepoints,Tw(n)})),this.eventManager.o(this.player,"unloading",(function(){n.C=[],Tw(n),n.j&&(n.j.abort(),n.j=null),n.l=null,xw(n)})),this.eventManager.o(this.bar,"mousemove",(function(e){if(n.player.fe().length){var t=n.bar.getBoundingClientRect(),i=parseFloat(n.bar.min);e=e.clientX-t.left,Cw(n,e,Math.round(i+(parseFloat(n.bar.max)-i)/t.width*e))}else xw(n)})),this.eventManager.o(this.container,"mouseleave",(function(){n.m.stop(),n.m.S(.25)})),this.setValue(this.video.currentTime),this.update(),Ew(this),this.ad&&ow(this.container,!1)}function Sw(e){if(e.C.length){for(var t=e.player.Ha(),n=t.end-t.start,i=["to right"],r=[],a=e.H.seekBarColors.adBreaks,o=!1,s=l(e.C),u=s.next();!u.done;u=s.next())if(-1!=(u=u.value).start||u.end||(o=!0),u.start>=t.start&&u.start<t.end&&!(u.end&&u.end>t.end)){var h=(u.start-t.start)/n||0,c=h+.01;u.end&&(c=(u.end-t.start)/n||0),r.push({start:h,end:c})}for(u=(t=l(r)).next();!u.done;u=t.next())n=u.value,i.push("transparent "+100*n.start+"%"),i.push(a+" "+100*n.start+"%"),i.push(a+" "+100*n.end+"%"),i.push("transparent "+100*n.end+"%");o&&(i.push("transparent 99%"),i.push(a+" 99%")),e.D.style.background="linear-gradient("+i.join(",")+")"}else e.D.style.background="transparent"}function Tw(e){Sw(e);var t=e.player.Ha();t=t.end-t.start,e.player.R()&&5<t&&e.I.za(1)}function Aw(e){var t=e.player.Ha();return t=t.end-t.start,!(e.player.R()&&5>t||null!=e.ad&&e.ad.isLinear())}function Ew(e){e.bar.ariaLabel=e.localization.resolve("SEEK")}function Cw(e,t,n){var i,r,a,o,s,u,h,c,d,p,f,g,m,v,y,b,T;L((function(C){switch(C.g){case 1:return i=function(e){var t=e.player.fe();if(!t.length)return null;for(var n={},i=l(["image/avif","image/webp","image/jpeg","image/png","image/svg+xml"]),r=i.next();!r.done;n={Ve:n.Ve,Te:n.Te},r=i.next())if(n.Ve=r.value,n.Te=e.player.getStats().estimatedBandwidth,(r=t.filter(function(e){return function(t){return t.mimeType.toLowerCase()===e.Ve&&t.bandwidth<.01*e.Te}}(n)).sort((function(e,t){return t.bandwidth-e.bandwidth})))&&r.length)return r[0];return t.find((function(e){return"application/mp4"==e.mimeType&&"mjpg"==e.codecs}))||t[0]}(e),i?(0>n&&(n=0),r=e.player.Ha(),a=Math.max(Math.ceil(r.start),Math.min(Math.floor(r.end),n)),_(C,e.player.Kf(i.id,a),2)):(xw(e),C.return());case 2:if(!(o=C.h)||!o.uris.length)return xw(e),C.return();if(e.player.R()?(s=r.end-n,e.u.textContent=1>s?e.localization.resolve("LIVE"):"-"+Iw(s)):e.u.textContent=Iw(n),u=-10,h=e.i.clientWidth,c=Math.floor(9*h/16),e.i.style.height=c+"px",e.i.style.top=-(c-u)+"px",d=Math.min(e.bar.offsetWidth-h,Math.max(0,t-h/2)),e.i.style.left=d+"px",e.i.style.visibility="visible",p=o.uris[0].split("#xywh=")[0],e.l&&p===e.l.uris[0].split("#xywh=")[0]&&o.segment.ac()==e.l.segment.ac()&&o.segment.Xb()==e.l.segment.Xb()){C.F(3);break}if(e.l=o,e.j&&(e.j.abort(),e.j=null),"mjpg"!=i.codecs&&!p.startsWith("offline:")){C.F(4);break}return e.g.src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg"/>',S(C,5),f=Ui,g=Es(o.segment.ba(),o.segment.ac(),o.segment.Xb(),e.player.getConfiguration().streaming.retryParameters),e.j=e.player.Yb().request(f,g,{type:1}),_(C,e.j.promise,7);case 7:m=C.h,e.j=null,"mjpg"==i.codecs?(new rr).box("mdat",ur((function(e){p=URL.createObjectURL(new Blob([e],{type:"image/jpeg"}))}))).parse(m.data,!1):(v=i.mimeType||"image/jpeg",y=new Blob([m.data],{type:v}),p=URL.createObjectURL(y)),A(C,4);break;case 5:if(7001==(b=E(C)).code)return C.return();throw b;case 4:try{e.i.removeChild(e.g)}catch(e){}e.g=eu("img"),e.g.id="shaka-player-ui-thumbnail-image",e.g.draggable=!1,e.g.src=p,e.g.onload=function(){p.startsWith("blob:")&&URL.revokeObjectURL(p)},e.i.insertBefore(e.g,e.i.firstChild);case 3:T=h/o.width,o.imageHeight?e.g.height=o.imageHeight:o.sprite||(e.g.style.height="100%",e.g.style.objectFit="contain"),o.imageWidth?e.g.width=o.imageWidth:o.sprite||(e.g.style.width="100%",e.g.style.objectFit="contain"),e.g.style.left="-"+T*o.positionX+"px",e.g.style.top="-"+T*o.positionY+"px",e.g.style.transform="scale("+T+")",e.g.style.transformOrigin="left top",c=Math.floor(h*o.height/o.width),e.i.style.height=c+"px",e.i.style.top=-(c-u)+"px",w(C)}}))}function xw(e){e.i.style.visibility="hidden",e.u.textContent=""}function Iw(e){var t=Math.round(e);e=Math.floor(t/3600);var n=Math.floor((t-3600*e)/60);return 10>(t=t-3600*e-60*n)&&(t="0"+t),0<e?(10>n&&(n="0"+n),e+":"+n+":"+t):n+":"+t}function kw(){}function Mw(t,n,i,r){J.call(this);var a=this;this.N=!0,this.g=r,this.C=new zh(i,t,this.g.castReceiverAppId,this.g.castAndroidReceiverCompatible),this.ua=!0,this.u=this.C.cc(),this.s=i,this.G=this.C.Mc(),this.sa=t,this.j=n,this.Wa=this.G.ee(),this.l=this.m=null,this.W=!1,this.H=[],this.Vb=[],this.Ib=!1,this.Z=new ln((function(){a.j.style.cursor="none",a.Ib=!1,Bw(a)})),this.aa=new ln((function(){a.h.removeAttribute("shown"),a.I.S(2)})),this.I=new ln((function(){for(var e=l(a.H),t=e.next();!t.done;t=e.next())ow(t.value,!1)})),this.Ra=new ln((function(){a.dc()&&Vw(a)})),this.J=null,this.D=[],this.va=function(){var e=new Be("en");return e.ya("ar",new Map([["AD_DURATION"," "],["AD_PROGRESS"," [AD_ON]  [NUM_ADS]"],["AD_TIME",": [AD_TIME]"],["AUTO_QUALITY",""],["BACK",""],["CAPTIONS"," "],["CAST","..."],["ENTER_LOOP_MODE","  "],["ENTER_PICTURE_IN_PICTURE",'   "  "'],["EXIT_FULL_SCREEN","   "],["EXIT_LOOP_MODE","   "],["EXIT_PICTURE_IN_PICTURE",'   "  "'],["FAST_FORWARD"," "],["FULL_SCREEN"," "],["LANGUAGE",""],["LIVE",""],["LOOP",""],["MORE_SETTINGS","  "],["MULTIPLE_LANGUAGES"," "],["MUTE"," "],["NOT_APPLICABLE"," "],["OFF",""],["ON",""],["PAUSE"," "],["PICTURE_IN_PICTURE","  "],["PLAY",""],["PLAYBACK_RATE"," "],["RESOLUTION"," "],["REWIND",""],["SEEK"," "],["SKIP_AD"," "],["SKIP_TO_LIVE","   "],["UNDETERMINED_LANGUAGE"," "],["UNMUTE"," "],["UNRECOGNIZED_LANGUAGE"," "],["VOLUME"," "]])),e.ya("de",new Map([["AD_DURATION","Dauer der Werbeanzeige"],["AD_PROGRESS","Werbung[AD_ON] von[NUM_ADS]"],["AD_TIME","Werbeanzeige: [AD_TIME]"],["AUTO_QUALITY","Automatisch"],["BACK","Zurck"],["CAPTIONS","Untertitel"],["CAST","Streamen..."],["ENTER_LOOP_MODE","In Endlosschleife spielen"],["ENTER_PICTURE_IN_PICTURE","Bild-im-Bild-Modus aktivieren"],["EXIT_FULL_SCREEN","Vollbildmodus beenden"],["EXIT_LOOP_MODE","Endlosschleife stoppen"],["EXIT_PICTURE_IN_PICTURE","Bild-im-Bild-Modus beenden"],["FAST_FORWARD","Vorspulen"],["FULL_SCREEN","Vollbildmodus"],["LANGUAGE","Sprache"],["LIVE","Live"],["LOOP","Schleife"],["MORE_SETTINGS","Weitere Einstellungen"],["MULTIPLE_LANGUAGES","Mehrere Sprachen"],["MUTE","Stummschalten"],["NOT_APPLICABLE","Nicht zutreffend"],["OFF","Aus"],["ON","Ein"],["PAUSE","Pause"],["PICTURE_IN_PICTURE","Bild im Bild"],["PLAY","Wiedergabe"],["PLAYBACK_RATE","Geschwindigkeit"],["RESOLUTION","Auflsung"],["REWIND","Zurckspulen"],["SEEK","Suche"],["SKIP_AD","berspringen"],["SKIP_TO_LIVE","Zum Live-Videostream wechseln"],["UNDETERMINED_LANGUAGE","Unbestimmt"],["UNMUTE","Stummschaltung aufheben"],["UNRECOGNIZED_LANGUAGE","Unbekannt"],["VOLUME","Lautstrke"]])),e.ya("en",new Map([["AD_DURATION","Ad duration"],["AD_PROGRESS","Ad [AD_ON] of [NUM_ADS]"],["AD_TIME","Ad: [AD_TIME]"],["AIRPLAY","AirPlay"],["AUTO_QUALITY","Auto"],["BACK","Back"],["CAPTIONS","Captions"],["CAST","Cast..."],["ENTER_LOOP_MODE","Loop the current video"],["ENTER_PICTURE_IN_PICTURE","Enter Picture-in-Picture"],["EXIT_FULL_SCREEN","Exit full screen"],["EXIT_LOOP_MODE","Stop looping the current video"],["EXIT_PICTURE_IN_PICTURE","Exit Picture-in-Picture"],["FAST_FORWARD","Fast-forward"],["FULL_SCREEN","Full screen"],["LANGUAGE","Language"],["LIVE","Live"],["LOOP","Loop"],["MORE_SETTINGS","More settings"],["MULTIPLE_LANGUAGES","Multiple languages"],["MUTE","Mute"],["NOT_APPLICABLE","Not applicable"],["OFF","Off"],["ON","On"],["PAUSE","Pause"],["PICTURE_IN_PICTURE","Picture-in-Picture"],["PLAY","Play"],["PLAYBACK_RATE","Playback speed"],["QUALITY","Quality"],["REPLAY","Replay"],["RESOLUTION","Resolution"],["REWIND","Rewind"],["SEEK","Seek"],["SKIP_AD","Skip Ad"],["SKIP_TO_LIVE","Skip ahead to live"],["STATISTICS","Statistics"],["SUBTITLE_FORCED","Forced"],["SURROUND","Surround"],["UNDETERMINED_LANGUAGE","Undetermined"],["UNMUTE","Unmute"],["UNRECOGNIZED_LANGUAGE","Unrecognized"],["VOLUME","Volume"]])),e.ya("en-GB",new Map([["AD_DURATION","Ad duration"],["AD_PROGRESS","Ad [AD_ON] of [NUM_ADS]"],["AD_TIME","Ad: [AD_TIME]"],["AUTO_QUALITY","Auto"],["BACK","Back"],["CAPTIONS","Captions"],["CAST","Cast..."],["ENTER_LOOP_MODE","Loop the current video"],["ENTER_PICTURE_IN_PICTURE","Enter picture-in-picture"],["EXIT_FULL_SCREEN","Exit full screen"],["EXIT_LOOP_MODE","Stop looping the current video"],["EXIT_PICTURE_IN_PICTURE","Exit picture-in-picture"],["FAST_FORWARD","Fast-forward"],["FULL_SCREEN","Full screen"],["LANGUAGE","Language"],["LIVE","Live"],["LOOP","Loop"],["MORE_SETTINGS","More settings"],["MULTIPLE_LANGUAGES","Multiple languages"],["MUTE","Mute"],["NOT_APPLICABLE","Not applicable"],["OFF","Off"],["ON","On"],["PAUSE","Pause"],["PICTURE_IN_PICTURE","Picture-in-picture"],["PLAY","Play"],["PLAYBACK_RATE","Playback speed"],["RESOLUTION","Resolution"],["REWIND","Rewind"],["SEEK","Seek"],["SKIP_AD","Skip ad"],["SKIP_TO_LIVE","Skip ahead to live"],["UNDETERMINED_LANGUAGE","Undetermined"],["UNMUTE","Unmute"],["UNRECOGNIZED_LANGUAGE","Unrecognised"],["VOLUME","volume"]])),e.ya("es",new Map([["AD_DURATION","Duracin del anuncio"],["AD_PROGRESS","Anuncio [AD_ON] de [NUM_ADS]"],["AD_TIME","Anuncio: [AD_TIME]"],["AUTO_QUALITY","Automtico"],["BACK","Atrs"],["CAPTIONS","Subttulos"],["CAST","Enviar..."],["ENTER_LOOP_MODE","Reproducir en bucle el vdeo actual"],["ENTER_PICTURE_IN_PICTURE","Activar el modo imagen en imagen"],["EXIT_FULL_SCREEN","Salir del modo de pantalla completa"],["EXIT_LOOP_MODE","Dejar de reproducir en bucle el vdeo actual"],["EXIT_PICTURE_IN_PICTURE","Salir del modo imagen en imagen"],["FAST_FORWARD","Avanzar rpidamente"],["FULL_SCREEN","Pantalla completa"],["LANGUAGE","Idioma"],["LIVE","En directo"],["LOOP","Reproducir en bucle"],["MORE_SETTINGS","Ms ajustes"],["MULTIPLE_LANGUAGES","Varios idiomas"],["MUTE","Silenciar"],["NOT_APPLICABLE","No aplicable"],["OFF","Desactivado"],["ON","Activado"],["PAUSE","Pausar"],["PICTURE_IN_PICTURE","Imagen en imagen"],["PLAY","Reproducir"],["PLAYBACK_RATE","Velocidad de reproduccin"],["RESOLUTION","Resolucin"],["REWIND","Rebobinar"],["SEEK","Buscar"],["SKIP_AD","Saltar anuncio"],["SKIP_TO_LIVE","Ir al vdeo en directo"],["SUBTITLE_FORCED","Forzado"],["SURROUND","Envolvente"],["UNDETERMINED_LANGUAGE","Sin especificar"],["UNMUTE","Activar sonido"],["UNRECOGNIZED_LANGUAGE","No reconocida"],["VOLUME","Volumen"]])),e.ya("es-419",new Map([["AD_DURATION","Duracin del anuncio"],["AD_PROGRESS","Anuncio [AD_ON] de [NUM_ADS]"],["AD_TIME","Anuncio: [AD_TIME]"],["AUTO_QUALITY","Automtico"],["BACK","Atrs"],["CAPTIONS","Subttulos"],["CAST","Transmitir..."],["ENTER_LOOP_MODE","Repetir indefinidamente el video actual"],["ENTER_PICTURE_IN_PICTURE","Ingresar al modo de pantalla en pantalla"],["EXIT_FULL_SCREEN","Salir de pantalla completa"],["EXIT_LOOP_MODE","Detener la repeticin indefinida del video actual"],["EXIT_PICTURE_IN_PICTURE","Salir del modo de pantalla en pantalla"],["FAST_FORWARD","Avanzar"],["FULL_SCREEN","Pantalla completa"],["LANGUAGE","Idioma"],["LIVE","En directo"],["LOOP","Repetir indefinidamente"],["MORE_SETTINGS","Ms opciones de configuracin"],["MULTIPLE_LANGUAGES","Varios idiomas"],["MUTE","Silenciar"],["NOT_APPLICABLE","No aplicable"],["OFF","Desactivado"],["ON","Activado"],["PAUSE","Detener"],["PICTURE_IN_PICTURE","Pantalla en pantalla"],["PLAY","Reproducir"],["PLAYBACK_RATE","Velocidad de reproduccin"],["RESOLUTION","Resolucin"],["REWIND","Retroceder"],["SEEK","Buscar"],["SKIP_AD","Omitir anuncio"],["SKIP_TO_LIVE","Adelantar hasta la transmisin en vivo"],["SUBTITLE_FORCED","Forzado"],["SURROUND","Envolvente"],["UNDETERMINED_LANGUAGE","Sin especificar"],["UNMUTE","Dejar de silenciar"],["UNRECOGNIZED_LANGUAGE","No reconocida"],["VOLUME","Volumen"]])),e.ya("fr",new Map([["AD_DURATION","Dure de l'annonce"],["AD_PROGRESS","Annonce[AD_ON] sur[NUM_ADS]"],["AD_TIME","Annonce: [AD_TIME]"],["AUTO_QUALITY","Automatique"],["BACK","Retour"],["CAPTIONS","Sous-titres"],["CAST","Caster"],["ENTER_LOOP_MODE","Lire en boucle la vido en cours"],["ENTER_PICTURE_IN_PICTURE","Utiliser le mode Picture-in-Picture"],["EXIT_FULL_SCREEN","Quitter le mode plein cran"],["EXIT_LOOP_MODE","Arrter la lecture en boucle de la vido en cours"],["EXIT_PICTURE_IN_PICTURE","Quitter le modePIP (Picture-in-picture)"],["FAST_FORWARD","Avance rapide"],["FULL_SCREEN","Plein cran"],["LANGUAGE","Langue"],["LIVE","En direct"],["LOOP","Rpter"],["MORE_SETTINGS","Plus de paramtres"],["MULTIPLE_LANGUAGES","Plusieurs langues"],["MUTE","Couper le son"],["NOT_APPLICABLE","Non applicable"],["OFF","Dsactive"],["ON","Active"],["PAUSE","Pause"],["PICTURE_IN_PICTURE","Picture-in-Picture"],["PLAY","Visionner"],["PLAYBACK_RATE","Vitesse de lecture"],["RESOLUTION","Rsolution"],["REWIND","Retour arrire"],["SEEK","Chercher"],["SKIP_AD","Passer l'annonce"],["SKIP_TO_LIVE","Accder  la partie la plus rcente du direct"],["UNDETERMINED_LANGUAGE","Langue indtermine"],["UNMUTE","Ractiver le son"],["UNRECOGNIZED_LANGUAGE","Non reconnu"],["VOLUME","Volume"]])),e.ya("it",new Map([["AD_DURATION","Durata dell'annuncio"],["AD_PROGRESS","Annuncio [AD_ON] di [NUM_ADS]"],["AD_TIME","Annuncio: [AD_TIME]"],["AUTO_QUALITY","Automatica"],["BACK","Indietro"],["CAPTIONS","Sottotitoli"],["CAST","Trasmetti..."],["ENTER_LOOP_MODE","Riproduci in loop il video corrente"],["ENTER_PICTURE_IN_PICTURE","Attiva Picture in picture"],["EXIT_FULL_SCREEN","Esci da schermo intero"],["EXIT_LOOP_MODE","Interrompi riproduzione in loop del video corrente"],["EXIT_PICTURE_IN_PICTURE","Esci da Picture in picture"],["FAST_FORWARD","Avanti veloce"],["FULL_SCREEN","Schermo intero"],["LANGUAGE","Lingua"],["LIVE","Dal vivo"],["LOOP","Riproduci in loop"],["MORE_SETTINGS","Altre impostazioni"],["MULTIPLE_LANGUAGES","Pi lingue"],["MUTE","Disattiva audio"],["NOT_APPLICABLE","Non applicabile"],["OFF","Disattivo"],["ON","Attivo"],["PAUSE","Metti in pausa"],["PICTURE_IN_PICTURE","Picture in picture"],["PLAY","Riproduci"],["PLAYBACK_RATE","Velocit di riproduzione"],["RESOLUTION","Risoluzione"],["REWIND","Riavvolgi"],["SEEK","Cerca"],["SKIP_AD","Salta annuncio"],["SKIP_TO_LIVE","Passa alla trasmissione dal vivo"],["UNDETERMINED_LANGUAGE","Indeterminata"],["UNMUTE","Riattiva audio"],["UNRECOGNIZED_LANGUAGE","Non riconosciuto"],["VOLUME","Volume"]])),e.ya("ja",new Map([["AD_DURATION",""],["AD_PROGRESS","[AD_ON]  [NUM_ADS] "],["AD_TIME",": [AD_TIME]"],["AUTO_QUALITY",""],["BACK",""],["CAPTIONS",""],["CAST","..."],["ENTER_LOOP_MODE",""],["ENTER_PICTURE_IN_PICTURE","  "],["EXIT_FULL_SCREEN",""],["EXIT_LOOP_MODE",""],["EXIT_PICTURE_IN_PICTURE","  "],["FAST_FORWARD",""],["FULL_SCREEN",""],["LANGUAGE",""],["LIVE",""],["LOOP",""],["MORE_SETTINGS",""],["MULTIPLE_LANGUAGES",""],["MUTE",""],["NOT_APPLICABLE",""],["OFF",""],["ON",""],["PAUSE",""],["PICTURE_IN_PICTURE","  "],["PLAY",""],["PLAYBACK_RATE",""],["RESOLUTION",""],["REWIND",""],["SEEK",""],["SKIP_AD",""],["SKIP_TO_LIVE",""],["UNDETERMINED_LANGUAGE",""],["UNMUTE",""],["UNRECOGNIZED_LANGUAGE",""],["VOLUME",""]])),e.ya("ko",new Map([["AD_DURATION"," "],["AD_PROGRESS"," [AD_ON]/[NUM_ADS]"],["AD_TIME",": [AD_TIME]"],["AUTO_QUALITY",""],["BACK",""],["CAPTIONS",""],["CAST","..."],["ENTER_LOOP_MODE","   "],["ENTER_PICTURE_IN_PICTURE","PIP  "],["EXIT_FULL_SCREEN"," "],["EXIT_LOOP_MODE","    "],["EXIT_PICTURE_IN_PICTURE","PIP  "],["FAST_FORWARD"," "],["FULL_SCREEN",""],["LANGUAGE",""],["LIVE",""],["LOOP"," "],["MORE_SETTINGS"," "],["MULTIPLE_LANGUAGES"," "],["MUTE",""],["NOT_APPLICABLE","  "],["OFF"," "],["ON",""],["PAUSE",""],["PICTURE_IN_PICTURE","PIP "],["PLAY",""],["PLAYBACK_RATE"," "],["RESOLUTION",""],["REWIND",""],["SEEK",""],["SKIP_AD"," "],["SKIP_TO_LIVE","  "],["UNDETERMINED_LANGUAGE",""],["UNMUTE"," "],["UNRECOGNIZED_LANGUAGE","  "],["VOLUME",""]])),e.ya("nl",new Map([["AD_DURATION","Advertentieduur"],["AD_PROGRESS","Advertentie [AD_ON] van [NUM_ADS]"],["AD_TIME","Advertentie: [AD_TIME]"],["AUTO_QUALITY","Automatisch"],["BACK","Terug"],["CAPTIONS","Ondertiteling"],["CAST","Casten..."],["ENTER_LOOP_MODE","De huidige video lussen"],["ENTER_PICTURE_IN_PICTURE","Scherm-in-scherm openen"],["EXIT_FULL_SCREEN","Volledig scherm sluiten"],["EXIT_LOOP_MODE","De huidige video niet meer lussen"],["EXIT_PICTURE_IN_PICTURE","Scherm-in-scherm afsluiten"],["FAST_FORWARD","Vooruitspoelen"],["FULL_SCREEN","Volledig scherm"],["LANGUAGE","Taal"],["LIVE","Live"],["LOOP","Lussen"],["MORE_SETTINGS","Meer instellingen"],["MULTIPLE_LANGUAGES","Meerdere talen"],["MUTE","Dempen"],["NOT_APPLICABLE","Niet van toepassing"],["OFF","Uit"],["ON","Aan"],["PAUSE","Onderbreken"],["PICTURE_IN_PICTURE","Scherm-in-scherm"],["PLAY","Afspelen"],["PLAYBACK_RATE","Afspeelsnelheid"],["RESOLUTION","Resolutie"],["REWIND","Terugspoelen"],["SEEK","Zoeken"],["SKIP_AD","Advertentie overslaan"],["SKIP_TO_LIVE","Doorgaan naar live"],["UNDETERMINED_LANGUAGE","Onbepaald"],["UNMUTE","Dempen opheffen"],["UNRECOGNIZED_LANGUAGE","Onbekend"],["VOLUME","Volume"]])),e.ya("pl",new Map([["AD_DURATION","Czas trwania reklamy"],["AD_PROGRESS","Reklama[AD_ON] z[NUM_ADS]"],["AD_TIME","Reklama: [AD_TIME]"],["AUTO_QUALITY","Automatycznie"],["BACK","Wstecz"],["CAPTIONS","Napisy"],["CAST","Przesyaj..."],["ENTER_LOOP_MODE","Odtwarzaj biecy film wptli"],["ENTER_PICTURE_IN_PICTURE","Wcz tryb obrazu wobrazie"],["EXIT_FULL_SCREEN","Zamknij peny ekran"],["EXIT_LOOP_MODE","Wycz odtwarzanie biecego filmu wptli"],["EXIT_PICTURE_IN_PICTURE","Wycz tryb obrazu wobrazie"],["FAST_FORWARD","Przewi do przodu"],["FULL_SCREEN","Peny ekran"],["LANGUAGE","Jzyk"],["LIVE","Na ywo"],["LOOP","Odtwarzaj wptli"],["MORE_SETTINGS","Wicej ustawie"],["MULTIPLE_LANGUAGES","Wiele jzykw"],["MUTE","Wycisz"],["NOT_APPLICABLE","Nie dotyczy"],["OFF","Wyczone"],["ON","Wczone"],["PAUSE","Wstrzymaj"],["PICTURE_IN_PICTURE","Obraz wobrazie"],["PLAY","Odtwrz"],["PLAYBACK_RATE","Szybko odtwarzania"],["RESOLUTION","Rozdzielczo"],["REWIND","Przewi do tyu"],["SEEK","Szukaj"],["SKIP_AD","Pomi reklam"],["SKIP_TO_LIVE","Przejd do transmisji na ywo"],["UNDETERMINED_LANGUAGE","Nie okrelono"],["UNMUTE","Wycz wyciszenie"],["UNRECOGNIZED_LANGUAGE","Nierozpoznany"],["VOLUME","Gono"]])),e.ya("pt-BR",new Map([["AD_DURATION","Durao do anncio"],["AD_PROGRESS","Anncio [AD_ON] de [NUM_ADS]"],["AD_TIME","Anncio: [AD_TIME]"],["AUTO_QUALITY","Automtica"],["BACK","Voltar"],["CAPTIONS","Legendas"],["CAST","Transmitir..."],["ENTER_LOOP_MODE","Repetir o vdeo atual"],["ENTER_PICTURE_IN_PICTURE","Entrar no modo picture-in-picture"],["EXIT_FULL_SCREEN","Sair do modo tela cheia"],["EXIT_LOOP_MODE","Parar repetio do vdeo atual"],["EXIT_PICTURE_IN_PICTURE","Sair de picture-in-picture"],["FAST_FORWARD","Avanar"],["FULL_SCREEN","Tela cheia"],["LANGUAGE","Idioma"],["LIVE","Ao vivo"],["LOOP","Repetir"],["MORE_SETTINGS","Mais definies"],["MULTIPLE_LANGUAGES","Vrios idiomas"],["MUTE","Desativar som"],["NOT_APPLICABLE","No relevante"],["OFF","Desativado"],["ON","Ativado"],["PAUSE","Pausar"],["PICTURE_IN_PICTURE","Picture-in-picture"],["PLAY","Reproduzir"],["PLAYBACK_RATE","Velocidade da reproduo"],["RESOLUTION","Resoluo"],["REWIND","Retroceder"],["SEEK","Procurar"],["SKIP_AD","Pular anncio"],["SKIP_TO_LIVE","Pular para transmisso ao vivo"],["UNDETERMINED_LANGUAGE","Indeterminado"],["UNMUTE","Ativar som"],["UNRECOGNIZED_LANGUAGE","No reconhecido"],["VOLUME","Volume"]])),e.ya("ru",new Map([["AD_DURATION"," "],["AD_PROGRESS"," [AD_ON]  [NUM_ADS]"],["AD_TIME",": [AD_TIME]"],["AUTO_QUALITY",""],["BACK",""],["CAPTIONS",""],["CAST","..."],["ENTER_LOOP_MODE","  "],["ENTER_PICTURE_IN_PICTURE",'   "  "'],["EXIT_FULL_SCREEN"," "],["EXIT_LOOP_MODE","   "],["EXIT_PICTURE_IN_PICTURE",'   "  "'],["FAST_FORWARD"," "],["FULL_SCREEN"," "],["LANGUAGE",""],["LIVE"," "],["LOOP",""],["MORE_SETTINGS"," "],["MULTIPLE_LANGUAGES"," "],["MUTE"," "],["NOT_APPLICABLE",""],["OFF","."],["ON","."],["PAUSE",""],["PICTURE_IN_PICTURE","  "],["PLAY",""],["PLAYBACK_RATE"," "],["RESOLUTION",""],["REWIND"," "],["SEEK",""],["SKIP_AD",""],["SKIP_TO_LIVE","     "],["UNDETERMINED_LANGUAGE"," "],["UNMUTE"," "],["UNRECOGNIZED_LANGUAGE"," "],["VOLUME",""]])),e.ya("th",new Map([["AD_DURATION",""],["AD_PROGRESS"," [AD_ON]  [NUM_ADS] "],["AD_TIME",": [AD_TIME]"],["AUTO_QUALITY",""],["BACK",""],["CAPTIONS",""],["CAST","..."],["ENTER_LOOP_MODE",""],["ENTER_PICTURE_IN_PICTURE",""],["EXIT_FULL_SCREEN",""],["EXIT_LOOP_MODE",""],["EXIT_PICTURE_IN_PICTURE",""],["FAST_FORWARD",""],["FULL_SCREEN",""],["LANGUAGE",""],["LIVE",""],["LOOP",""],["MORE_SETTINGS",""],["MULTIPLE_LANGUAGES",""],["MUTE",""],["NOT_APPLICABLE",""],["OFF",""],["ON",""],["PAUSE",""],["PICTURE_IN_PICTURE",""],["PLAY",""],["PLAYBACK_RATE",""],["RESOLUTION",""],["REWIND",""],["SEEK",""],["SKIP_AD",""],["SKIP_TO_LIVE",""],["UNDETERMINED_LANGUAGE",""],["UNMUTE",""],["UNRECOGNIZED_LANGUAGE",""],["VOLUME",""]])),e.ya("tr",new Map([["AD_DURATION","Reklam sresi"],["AD_PROGRESS","[AD_ON]/[NUM_ADS] reklam"],["AD_TIME","Reklam: [AD_TIME]"],["AUTO_QUALITY","Otomatik"],["BACK","Geri"],["CAPTIONS","Altyazlar"],["CAST","Yaynla..."],["ENTER_LOOP_MODE","Mevcut videoyu dngye al"],["ENTER_PICTURE_IN_PICTURE","Pencere iinde Pencere moduna gir"],["EXIT_FULL_SCREEN","Tam ekrandan k"],["EXIT_LOOP_MODE","Mevcut videonun dngsn durdur"],["EXIT_PICTURE_IN_PICTURE","Pencere inde Pencereden k"],["FAST_FORWARD","leri sar"],["FULL_SCREEN","Tam ekran"],["LANGUAGE","Dil"],["LIVE","Canl"],["LOOP","Dng"],["MORE_SETTINGS","Daha fazla ayar"],["MULTIPLE_LANGUAGES","Birden ok dil"],["MUTE","Sesi kapat"],["NOT_APPLICABLE","Geerli deil"],["OFF","Kapal"],["ON","Ak"],["PAUSE","Duraklat"],["PICTURE_IN_PICTURE","Pencere inde Pencere"],["PLAY","Oynat"],["PLAYBACK_RATE","alma hz"],["RESOLUTION","znrlk"],["REWIND","Geri sar"],["SEEK","Ara"],["SKIP_AD","Reklam Atla"],["SKIP_TO_LIVE","Canl yayna atla"],["UNDETERMINED_LANGUAGE","Belirsiz"],["UNMUTE","Sesi a"],["UNRECOGNIZED_LANGUAGE","Tannmayan"],["VOLUME","Ses"]])),e.ya("zh",new Map([["AD_DURATION",""],["AD_PROGRESS"," [AD_ON]/[NUM_ADS]"],["AD_TIME","[AD_TIME]"],["AUTO_QUALITY",""],["BACK",""],["CAPTIONS",""],["CAST",""],["ENTER_LOOP_MODE",""],["ENTER_PICTURE_IN_PICTURE",""],["EXIT_FULL_SCREEN",""],["EXIT_LOOP_MODE",""],["EXIT_PICTURE_IN_PICTURE",""],["FAST_FORWARD",""],["FULL_SCREEN",""],["LANGUAGE",""],["LIVE",""],["LOOP",""],["MORE_SETTINGS",""],["MULTIPLE_LANGUAGES",""],["MUTE",""],["NOT_APPLICABLE",""],["OFF",""],["ON",""],["PAUSE",""],["PICTURE_IN_PICTURE",""],["PLAY",""],["PLAYBACK_RATE",""],["RESOLUTION",""],["REWIND",""],["SEEK",""],["SKIP_AD",""],["SKIP_TO_LIVE",""],["UNDETERMINED_LANGUAGE",""],["UNMUTE",""],["UNRECOGNIZED_LANGUAGE",""],["VOLUME",""]])),e.ya("zh-TW",new Map([["AD_DURATION",""],["AD_PROGRESS"," [AD_ON]/[NUM_ADS]"],["AD_TIME","[AD_TIME]"],["AUTO_QUALITY",""],["BACK",""],["CAPTIONS",""],["CAST","..."],["ENTER_LOOP_MODE",""],["ENTER_PICTURE_IN_PICTURE",""],["EXIT_FULL_SCREEN",""],["EXIT_LOOP_MODE",""],["EXIT_PICTURE_IN_PICTURE",""],["FAST_FORWARD",""],["FULL_SCREEN",""],["LANGUAGE",""],["LIVE",""],["LOOP",""],["MORE_SETTINGS",""],["MULTIPLE_LANGUAGES",""],["MUTE",""],["NOT_APPLICABLE",""],["OFF",""],["ON",""],["PAUSE",""],["PICTURE_IN_PICTURE",""],["PLAY",""],["PLAYBACK_RATE",""],["RESOLUTION",""],["REWIND",""],["SEEK",""],["SKIP_AD",""],["SKIP_TO_LIVE",""],["UNDETERMINED_LANGUAGE",""],["UNMUTE",""],["UNRECOGNIZED_LANGUAGE",""],["VOLUME",""]])),e.Ig(navigator.languages||[]),e}(),this.i=new Hi,this.configure(this.g),function(t){t.i.o(t.G,"buffering",(function(){t.N&&ow(t.$,t.G.yd())})),t.N&&ow(t.$,t.G.yd()),t.i.o(e,"keydown",(function(n){!function(t,n){t.ha.add(n.key);var i=t.nd();"Tab"==n.key&&(t.h.classList.add("shaka-keyboard-navigation"),Bw(t),t.i.o(e,"mousedown",(function(){t.i.hc(e,"mousedown")}))),"Escape"==n.key&&t.I.Qa(),i&&t.ha.has("Tab")&&function(e,t){var n=e.H.filter((function(e){return!e.classList.contains("shaka-hidden")}));if(n.length){var i=n[0];if(i.childNodes.length){for(n=i.firstElementChild;n&&n.classList.contains("shaka-hidden");)n=n.nextElementSibling;for(i=i.lastElementChild;i&&i.classList.contains("shaka-hidden");)i=i.previousElementSibling;var r=document.activeElement;e.ha.has("Shift")?r==n&&(t.preventDefault(),i.focus()):r==i&&(t.preventDefault(),n.focus())}}}(t,n)}(t,n)})),t.i.o(e,"click",(function(){return t.uc()})),t.i.o(t,"submenuopen",(function(){t.uc()})),t.i.o(t.u,"play",(function(){Bw(t)})),t.i.o(t.u,"pause",(function(){Bw(t)})),t.i.o(t.j,"mousemove",(function(e){Uw(t,e)})),t.i.o(t.j,"touchmove",(function(e){Uw(t,e)}),{passive:!0}),t.i.o(t.j,"touchend",(function(e){Uw(t,e)}),{passive:!0}),t.i.o(t.j,"mouseleave",(function(){t.J||t.Z.Qa()})),t.i.o(t.C,"caststatuschanged",(function(){jw(t)})),t.i.o(t.j,"keydown",(function(e){var n=document.activeElement,i=!(!n||!n.classList)&&n.classList.contains("shaka-volume-bar"),r=n&&n.classList&&n.classList.contains("shaka-seek-bar");if(t.h.contains(n)&&Uw(t,e),t.g.enableKeyboardPlaybackControls){n=t.g.keyboardSeekDistance;var a=t.g.keyboardLargeSeekDistance;switch(e.key){case"ArrowLeft":t.l&&!i&&0<n&&(e.preventDefault(),Hw(t,t.l.getValue()-n));break;case"ArrowRight":t.l&&!i&&0<n&&(e.preventDefault(),Hw(t,t.l.getValue()+n));break;case"PageDown":t.l&&r&&0<n&&(e.preventDefault(),Hw(t,t.l.getValue()-a));break;case"PageUp":t.l&&r&&0<n&&(e.preventDefault(),Hw(t,t.l.getValue()+a));break;case"Home":t.l&&Hw(t,t.G.Ha().start);break;case"End":t.l&&Hw(t,t.G.Ha().end);break;case"f":t.zd()&&t.Pe();break;case"m":t.m&&t.m.isLinear()?t.m.setMuted(!t.m.isMuted()):t.s.muted=!t.s.muted;break;case"p":t.qe()&&t.Od();break;case" ":r&&Gw(t)}}})),t.i.o(t.j,"keyup",(function(e){t.ha.delete(e.key)})),t.i.o(t.Wa,"ad-started",(function(e){t.m=e.ad,t.uh()})),t.i.o(t.Wa,"ad-stopped",(function(){t.m=null,t.Wg()})),screen.orientation&&t.i.o(screen.orientation,"change",(function(){return L((function(e){return _(e,function(e){return L((function(t){return e.u&&0!=e.u.readyState&&!e.C.Ba()&&e.g.enableFullscreenOnRotation&&e.zd()?screen.orientation.type.includes("landscape")&&!e.Qc()?_(t,Dw(e),0):screen.orientation.type.includes("portrait")&&e.Qc()?_(t,Rw(e),0):t.F(0):t.return()}))}(t),0)}))}))}(this),this.ha=new Set,jw(this),this.Ra.za(.125),this.i.o(this.va,"locale-changed",(function(e){a.Wa.setLocale(e.locales[0])}))}function Pw(e){for(var t=l(e.D),n=t.next();!n.done;n=t.next())n.value.release();e.D=[]}function Lw(e,t){Ww.set(e,t)}function Dw(e){var t,n;return L((function(i){switch(i.g){case 1:if(S(i,2),!document.fullscreenEnabled){(t=e.s).webkitSupportsFullscreen&&t.webkitEnterFullscreen(),i.F(4);break}if(!document.pictureInPictureElement){i.F(5);break}return _(i,document.exitPictureInPicture(),5);case 5:return _(i,e.g.fullScreenElement.requestFullscreen({navigationUI:"hide"}),7);case 7:if(!e.g.forceLandscapeOnFullscreen||!screen.orientation){i.F(4);break}return S(i,9),_(i,screen.orientation.lock("landscape"),11);case 11:A(i,4,2);break;case 9:E(i,2);case 4:A(i,0);break;case 2:n=E(i),e.dispatchEvent(new j("error",(new Map).set("detail",n))),w(i)}}))}function Rw(e){var t;return L((function(n){return document.fullscreenEnabled?(screen.orientation&&screen.orientation.unlock(),_(n,document.exitFullscreen(),0)):((t=e.s).webkitSupportsFullscreen&&t.webkitExitFullscreen(),n.F(0))}))}function Nw(e){e.N&&e.u.duration&&(e.G.od(),e.u.paused&&!e.W?e.u.play():e.u.pause())}function Ow(e){e.m&&e.m.isPaused()?e.m.play():e.m&&e.m.pause()}function Uw(e,t){"mousemove"==t.type&&(e.h.classList.remove("shaka-keyboard-navigation"),Bw(e)),"touchstart"==t.type||"touchmove"==t.type||"touchend"==t.type||"keyup"==t.type?e.J=Date.now():e.J+1e3<Date.now()&&(e.J=null),e.J&&"mousemove"==t.type||(e.j.style.cursor="",e.Ib=!0,e.I.stop(),e.dc()||(Vw(e),Bw(e)),e.Z.stop(),"touchend"!=t.type&&"keyup"!=t.type&&e.J||e.Z.S(3))}function Bw(t){var n=!!t.m&&t.m.isPaused(),i=t.u.paused&&!t.W,r=t.h.classList.contains("shaka-keyboard-navigation");n||(!t.m||!t.m.isLinear())&&i||t.Ib||r||function(t){return!!e.matchMedia("hover: hover").matches&&t.Vb.some((function(e){return e.matches(":hover")}))}(t)?(Vw(t),t.h.setAttribute("shown","true"),t.aa.stop()):t.aa.S(t.g.fadeDelay)}function Fw(e){e.N&&(e.nd()?e.I.Qa():e.g.singleClickForPlayAndPause&&Gw(e))}function Gw(e){e.m&&e.m.isLinear()?Ow(e):Nw(e)}function jw(e){var t=e.C.Ba();e.dispatchEvent(new j("caststatuschanged",(new Map).set("newStatus",t))),t?e.h.setAttribute("casting","true"):e.h.removeAttribute("casting")}function Hw(e,t){e.l.changeTo(t),e.dc()&&Vw(e)}function Vw(e){if(e.l)if(e.l.setValue(e.u.currentTime),e.l.update(),e.l.isShowing())for(var t=l(e.H),n=t.next();!n.done;n=t.next())n.value.classList.remove("shaka-low-position");else for(n=(t=l(e.H)).next();!n.done;n=t.next())n.value.classList.add("shaka-low-position");e.dispatchEvent(new j("timeandseekrangeupdated"))}m(mw,tw),G("shaka.ui.HiddenSeekButton",mw),m(vw,mw),G("shaka.ui.HiddenFastForwardButton",vw),m(yw,mw),G("shaka.ui.HiddenRewindButton",yw),m(bw,tw),(i=bw.prototype).release=function(){this.G&&(this.G.stop(),this.G=null),tw.prototype.release.call(this)},i.setRange=function(e,t){this.bar.min=e,this.bar.max=t},i.onChangeStart=function(){},i.onChange=function(){},i.onChangeEnd=function(){},i.changeTo=function(e){this.h||(this.h=!0,this.onChangeStart());var t=parseFloat(this.bar.min),n=parseFloat(this.bar.max);this.bar.value=e>n?n:e<t?t:e,this.onChange(),this.G.S(.5)},i.getValue=function(){return parseFloat(this.bar.value)},i.setValue=function(e){this.h||(this.bar.value=e)},G("shaka.ui.RangeElement",bw),bw.prototype.setValue=bw.prototype.setValue,bw.prototype.getValue=bw.prototype.getValue,bw.prototype.changeTo=bw.prototype.changeTo,bw.prototype.onChangeEnd=bw.prototype.onChangeEnd,bw.prototype.onChange=bw.prototype.onChange,bw.prototype.onChangeStart=bw.prototype.onChangeStart,bw.prototype.setRange=bw.prototype.setRange,m(ww,bw),(i=ww.prototype).release=function(){this.s&&(this.s.stop(),this.s=null,this.I.stop(),this.I=null),bw.prototype.release.call(this)},i.onChangeStart=function(){this.K=!this.video.paused,this.controls.qg(!0),this.video.pause(),this.m.stop(),this.J=!0},i.onChange=function(){if(this.video.duration)if(this.update(),this.s.S(.125),this.player.fe().length){var e=parseFloat(this.bar.min),t=parseFloat(this.bar.max),n=this.bar.getBoundingClientRect(),i=Math.round(this.getValue());Cw(this,(i-e)/((t-e)/n.width),i)}else xw(this)},i.onChangeEnd=function(){this.s.Qa(),this.controls.qg(!1),this.K&&this.video.play(),this.J&&(this.J=!1,this.m.stop(),this.m.S(.25))},i.isShowing=function(){return!this.container.classList.contains("shaka-hidden")},i.update=function(){var e=this.H.seekBarColors,t=this.getValue(),n=this.video.buffered.length,i=n?this.video.buffered.start(0):0,r=n?this.video.buffered.end(n-1):0,a=this.player.Ha(),o=a.end-a.start;this.setRange(a.start,a.end),Aw(this)?(ow(this.container,!0),0==n?this.container.style.background=e.base:(n=(Math.max(i,a.start)-a.start)/o||0,r=(Math.min(r,a.end)-a.start)/o||0,t=(Math.min(Math.max(t,a.start),a.end)-a.start)/o||0,this.container.style.background="linear-gradient("+["to right",(this.H.showUnbufferedStart?e.base:e.played)+" "+100*n+"%",e.played+" "+100*n+"%",e.played+" "+100*t+"%",e.buffered+" "+100*t+"%",e.buffered+" "+100*r+"%",e.base+" "+100*r+"%"].join()+")")):ow(this.container,!1)},G("shaka.ui.SeekBar",ww),kw.prototype.create=function(e,t){return new ww(e,t)},ww.Factory=kw,m(Mw,J),(i=Mw.prototype).destroy=function(){var e=this;return L((function(t){switch(t.g){case 1:if(document.pictureInPictureElement!=e.s){t.F(2);break}return _(t,document.exitPictureInPicture(),2);case 2:if(e.i&&(e.i.release(),e.i=null),e.Z&&(e.Z.stop(),e.Z=null),e.aa&&(e.aa.stop(),e.aa=null),e.I&&(e.I.stop(),e.I=null),e.Ra&&(e.Ra.stop(),e.Ra=null),Pw(e),e.h&&(e.j.removeChild(e.h),e.h=null),!e.C){t.F(4);break}return _(t,e.C.destroy(),5);case 5:e.C=null;case 4:if(!e.sa){t.F(6);break}return _(t,e.sa.destroy(),7);case 7:e.sa=null;case 6:e.G=null,e.s=null,e.u=null,e.va=null,e.ha.clear(),J.prototype.release.call(e),w(t)}}))},i.Kh=function(e){this.ua=e,jw(this)},i.Ri=function(){Bw(this)},i.configure=function(e){this.g=e,this.C.Jg(e.castReceiverAppId,e.castAndroidReceiverCompatible),this.l&&(this.l=null),this.Fb&&(this.Fb=null),this.Xa&&(this.Xa=null),this.h?(nu(this.h),Pw(this)):(function(e){e.h=eu("div"),e.h.classList.add("shaka-controls-container"),e.j.appendChild(e.h),e.j.setAttribute("shaka-controls","true"),e.i.o(e.h,"touchstart",(function(t){e.u.duration&&(e.dc()?e.J=Date.now():(Uw(e,t),t.cancelable&&t.preventDefault()))}),{passive:!1}),e.i.o(e.h,"click",(function(){Fw(e)})),e.i.o(e.h,"dblclick",(function(){e.g.doubleClickForFullscreen&&e.zd()&&e.Pe()}))}(this),function(e){e.M=eu("div"),e.M.classList.add("shaka-client-side-ad-container"),ow(e.M,!1),e.i.o(e.M,"click",(function(){Fw(e)})),e.j.appendChild(e.M)}(this)),this.j.classList.add("shaka-video-container"),this.s.classList.add("shaka-video"),function(e){var t=eu("div");t.classList.add("shaka-scrim-container"),e.h.appendChild(t)}(this),this.g.addBigPlayButton&&function(e){var t=eu("div");t.classList.add("shaka-play-button-container"),e.h.appendChild(t),e.Fb=new dw(t,e),e.D.push(e.Fb)}(this),this.g.customContextMenu&&(this.Xa=new pw(this.V,this),this.D.push(this.Xa)),this.$||function(e){e.$=eu("div"),e.$.classList.add("shaka-spinner-container"),e.j.appendChild(e.$);var t=eu("div");t.classList.add("shaka-spinner"),e.$.appendChild(t),(e=document.createElementNS("http://www.w3.org/2000/svg","svg")).classList.add("shaka-spinner-svg"),e.setAttribute("viewBox","0 0 30 30"),t.appendChild(e),(t=document.createElementNS("http://www.w3.org/2000/svg","circle")).classList.add("shaka-spinner-path"),t.setAttribute("cx","15"),t.setAttribute("cy","15"),t.setAttribute("r","14.5"),t.setAttribute("fill","none"),t.setAttribute("stroke-width","1"),t.setAttribute("stroke-miterlimit","10"),e.appendChild(t)}(this),this.g.seekOnTaps&&(function(e){var t=eu("div");t.classList.add("shaka-hidden-fast-forward-container"),e.h.appendChild(t),e.nc=new vw(t,e),e.D.push(e.nc)}(this),function(e){var t=eu("div");t.classList.add("shaka-hidden-rewind-container"),e.h.appendChild(t),e.tc=new yw(t,e),e.D.push(e.tc)}(this)),this.xb=eu("div"),this.xb.classList.add("shaka-server-side-ad-container"),this.h.appendChild(this.xb),function(e){e.L=eu("div"),e.L.classList.add("shaka-bottom-controls"),e.L.classList.add("shaka-no-propagation"),e.h.appendChild(e.L),e.i.o(e.L,"click",(function(t){t.target.closest(".shaka-overflow-button")||e.uc()})),function(e){e.K=eu("div"),e.K.classList.add("shaka-ad-controls");var t=null!=e.m&&e.m.isLinear();ow(e.K,t),e.L.appendChild(e.K),t=new lw(e.K,e),e.D.push(t),t=new uw(e.K,e),e.D.push(t)}(e),e.V=eu("div"),e.V.classList.add("shaka-controls-button-panel"),e.V.classList.add("shaka-show-controls-on-mouse-over"),e.g.enableTooltips&&e.V.classList.add("shaka-tooltips-on"),e.L.appendChild(e.V);for(var t=l(e.g.controlPanelElements),n=t.next();!n.done;n=t.next())n=n.value,Ww.get(n)?(n=Ww.get(n).create(e.V,e),e.D.push(n)):X("Unrecognized control panel element requested:",n)}(this),this.H=Array.from(this.j.getElementsByClassName("shaka-settings-menu")),this.H.push.apply(this.H,h(Array.from(this.j.getElementsByClassName("shaka-overflow-menu")))),function(e){if(e.g.addSeekBar)e.l=zw.create(e.L,e),e.D.push(e.l);else for(var t=(e=l(e.H)).next();!t.done;t=e.next())t.value.classList.add("shaka-low-position")}(this),this.Vb=Array.from(this.j.getElementsByClassName("shaka-show-controls-on-mouse-over")),Bw(this);for(var t=(e=l(this.j.getElementsByClassName("shaka-no-propagation"))).next();!t.done;t=e.next()){t=t.value;var n=function(e){return e.stopPropagation()};this.i.o(t,"click",n),this.i.o(t,"dblclick",n)}},i.lg=function(e){(this.N=e)?(this.j.setAttribute("shaka-controls","true"),this.s.tabIndex=-1,this.s.controls=!1):this.j.removeAttribute("shaka-controls"),Bw(this)},i.ph=function(e){this.s.controls=e,this.s.tabIndex=e?0:-1,e&&this.lg(!1)},i.getAd=function(){return this.m},i.Vh=function(){return this.C},i.ji=function(){return this.va},i.Di=function(){return this.j},i.cc=function(){return this.u},i.ii=function(){return this.s},i.Mc=function(){return this.G},i.gi=function(){return this.sa},i.$h=function(){return this.h},i.ti=function(){return this.xb},i.Xh=function(){return this.M},i.Yh=function(){return this.g},i.Oi=function(){return this.W},i.qg=function(e){this.W=e},i.Ii=function(){return this.ua},i.Hf=function(){return this.l?this.l.getValue():this.u.currentTime},i.qh=function(e){this.J=e},i.nd=function(){return this.H.some((function(e){return!e.classList.contains("shaka-hidden")}))},i.uc=function(){this.I.Qa()},i.zd=function(){return!(!document.fullscreenEnabled&&!this.s.webkitSupportsFullscreen)},i.Qc=function(){if(document.fullscreenEnabled)return!!document.fullscreenElement;var e=this.s;return!!e.webkitSupportsFullscreen&&e.webkitDisplayingFullscreen},i.Pe=function(){var e=this;return L((function(t){return e.Qc()?_(t,Rw(e),0):_(t,Dw(e),0)}))},i.qe=function(){return!this.C.Ba()&&!!("documentPictureInPicture"in e&&this.g.preferDocumentPictureInPicture||document.pictureInPictureEnabled)&&!this.s.disablePictureInPicture},i.re=function(){return"documentPictureInPicture"in e&&this.g.preferDocumentPictureInPicture?!!e.documentPictureInPicture.window:!!document.pictureInPictureElement},i.Od=function(){var t,n=this;return L((function(i){return 1==i.g?(S(i,2),"documentPictureInPicture"in e&&n.g.preferDocumentPictureInPicture?_(i,function(t){var n,i,r,a,o,s;return L((function(u){if(1==u.g)return e.documentPictureInPicture.window?(e.documentPictureInPicture.window.close(),u.return()):(n=t.j,i=n.getBoundingClientRect(),_(u,e.documentPictureInPicture.requestWindow({width:i.width,height:i.height}),2));(function(e){var t=[].concat(h(document.styleSheets)).map((function(t){try{return[].concat(h(t.cssRules)).map((function(e){return e.cssText})).join("")}catch(i){var n=document.createElement("link");n.rel="stylesheet",n.type=t.type,n.media=t.media,n.href=t.href,e.document.head.appendChild(n)}return""})).filter(Boolean).join("\n"),n=document.createElement("style");n.textContent=t,e.document.head.appendChild(n)})(r=u.h),a=n.parentNode||document.body,(o=t.j.cloneNode(!0)).style.visibility="hidden",o.style.height=getComputedStyle(n).height,a.appendChild(o),(s=document.createElement("style")).append("[data-shaka-player-container] {\n      width: 100% !important; max-height: 100%}"),r.document.head.append(s),r.document.body.append(n),t.i.na(r,"pagehide",(function(){o.replaceWith(n)})),w(u)}))}(n),5):document.pictureInPictureElement?_(i,document.exitPictureInPicture(),5):(document.fullscreenElement&&document.exitFullscreen(),_(i,n.s.requestPictureInPicture(),5))):2!=i.g?A(i,0):(t=E(i),n.dispatchEvent(new j("error",(new Map).set("detail",t))),void w(i))}))},i.uh=function(){ow(this.K,!0),ow(this.M,!0),this.h.setAttribute("ad-active","true")},i.Wg=function(){ow(this.K,!1),ow(this.M,!1),this.h.removeAttribute("ad-active")},i.dc=function(){return!!this.N&&(null!=this.h.getAttribute("shown")||null!=this.h.getAttribute("casting"))},G("shaka.ui.Controls",Mw),Mw.prototype.isOpaque=Mw.prototype.dc,Mw.prototype.hideAdUI=Mw.prototype.Wg,Mw.prototype.showAdUI=Mw.prototype.uh,Mw.prototype.togglePiP=Mw.prototype.Od,Mw.prototype.isPiPEnabled=Mw.prototype.re,Mw.prototype.isPiPAllowed=Mw.prototype.qe,Mw.prototype.toggleFullScreen=Mw.prototype.Pe,Mw.prototype.isFullScreenEnabled=Mw.prototype.Qc,Mw.prototype.isFullScreenSupported=Mw.prototype.zd,Mw.prototype.hideSettingsMenus=Mw.prototype.uc,Mw.prototype.anySettingsMenusAreOpen=Mw.prototype.nd,Mw.prototype.setLastTouchEventTime=Mw.prototype.qh,Mw.prototype.getDisplayTime=Mw.prototype.Hf,Mw.prototype.isCastAllowed=Mw.prototype.Ii,Mw.prototype.setSeeking=Mw.prototype.qg,Mw.prototype.isSeeking=Mw.prototype.Oi,Mw.prototype.getConfig=Mw.prototype.Yh,Mw.prototype.getClientSideAdContainer=Mw.prototype.Xh,Mw.prototype.getServerSideAdContainer=Mw.prototype.ti,Mw.prototype.getControlsContainer=Mw.prototype.$h,Mw.prototype.getLocalPlayer=Mw.prototype.gi,Mw.prototype.getPlayer=Mw.prototype.Mc,Mw.prototype.getLocalVideo=Mw.prototype.ii,Mw.prototype.getVideo=Mw.prototype.cc,Mw.prototype.getVideoContainer=Mw.prototype.Di,Mw.prototype.getLocalization=Mw.prototype.ji,Mw.prototype.getCastProxy=Mw.prototype.Vh,Mw.prototype.getAd=Mw.prototype.getAd,Mw.prototype.setEnabledNativeControls=Mw.prototype.ph,Mw.prototype.setEnabledShakaControls=Mw.prototype.lg,Mw.prototype.configure=Mw.prototype.configure,Mw.prototype.loadComplete=Mw.prototype.Ri,Mw.prototype.allowCast=Mw.prototype.Kh,Mw.registerSeekBar=function(e){zw=e},Mw.registerElement=Lw,Mw.prototype.destroy=Mw.prototype.destroy;var Ww=new Map,zw=new kw;function Xw(e,t){tw.call(this,e,t);var n=this;this.l=this.controls.g,this.j=this.controls.h,this.i=[],this.g=tu(),this.g.classList.add("shaka-overflow-menu-button"),this.g.classList.add("shaka-no-propagation"),this.g.classList.add("material-icons-round"),this.g.classList.add("shaka-tooltip"),this.g.textContent="more_vert",this.parent.appendChild(this.g),this.h=eu("div"),this.h.classList.add("shaka-overflow-menu"),this.h.classList.add("shaka-no-propagation"),this.h.classList.add("shaka-show-controls-on-mouse-over"),this.h.classList.add("shaka-hidden"),this.j.appendChild(this.h),function(e){for(var t=l(e.l.overflowMenuButtons),n=t.next();!n.done;n=t.next())n=n.value,Zw.get(n)?(n=Zw.get(n),e.i.push(n.create(e.h,e.controls))):X("Unrecognized overflow menu element requested:",n)}(this),this.eventManager.o(this.localization,"locale-updated",(function(){Yw(n)})),this.eventManager.o(this.localization,"locale-changed",(function(){Yw(n)})),this.eventManager.o(this.adManager,"ad-started",(function(){n.ad&&n.ad.isLinear()&&ow(n.g,!1)})),this.eventManager.o(this.adManager,"ad-stopped",(function(){ow(n.g,!0)})),this.eventManager.o(this.controls,"submenuopen",(function(){ow(n.h,!1)})),this.eventManager.o(this.h,"touchstart",(function(e){n.controls.qh(Date.now()),e.stopPropagation()})),this.eventManager.o(this.g,"click",(function(){!function(e){if(e.controls.nd())e.controls.uc();else{ow(e.h,!0),Bw(e.controls);var t=function(e){return 0==e.classList.contains("shaka-hidden")};$(e.h.childNodes,t)&&ee(e.h.childNodes,t)[0].focus()}}(n)})),Yw(this),this.ad&&this.ad.isLinear()&&ow(this.g,!1)}function Kw(e,t){Zw.set(e,t)}function Yw(e){e.g.ariaLabel=e.localization.resolve("MORE_SETTINGS")}function qw(){}m(Xw,tw),Xw.prototype.release=function(){this.j=null;for(var e=l(this.i),t=e.next();!t.done;t=e.next())t.value.release();this.i=[],tw.prototype.release.call(this)},G("shaka.ui.OverflowMenu",Xw),Xw.registerElement=Kw,qw.prototype.create=function(e,t){return new Xw(e,t)},Lw("overflow_menu",new qw);var Zw=new Map;function Jw(t,n){tw.call(this,t,n);var i=this;this.g=tu(),this.g.classList.add("shaka-airplay-button"),this.g.classList.add("shaka-tooltip"),this.g.ariaPressed="false",this.h=eu("i"),this.h.classList.add("material-icons-round"),this.h.textContent="airplay",this.g.appendChild(this.h),e.WebKitPlaybackTargetAvailabilityEvent||this.g.classList.add("shaka-hidden"),(t=eu("label")).classList.add("shaka-overflow-button-label"),t.classList.add("shaka-overflow-menu-only"),this.j=eu("span"),t.appendChild(this.j),this.i=eu("span"),this.i.classList.add("shaka-current-selection-span"),t.appendChild(this.i),this.g.appendChild(t),this.parent.appendChild(this.g),$w(this),Qw(this),this.eventManager.o(this.localization,"locale-updated",(function(){$w(i)})),this.eventManager.o(this.localization,"locale-changed",(function(){$w(i)})),this.eventManager.o(this.g,"click",(function(){i.controls.cc().webkitShowPlaybackTargetPicker()})),t=this.controls.cc(),this.eventManager.o(t,"webkitplaybacktargetavailabilitychanged",(function(e){var t=i.player.ie()==Kl;ow(i.g,"available"==e.availability&&t)})),this.eventManager.o(t,"webkitcurrentplaybacktargetiswirelesschanged",(function(){Qw(i)}))}function Qw(e){var t=e.controls.cc();e.g.ariaPressed=t&&t.webkitCurrentPlaybackTargetIsWireless?"true":"false"}function $w(e){e.g.ariaLabel=e.localization.resolve("AIRPLAY"),e.j.textContent=e.localization.resolve("AIRPLAY")}function eS(){}function tS(e,t,n){this.i=e,this.j=t,this.h=nS(this),t.dataset.shakaPlayerContainer="",t.ui=this,this.Nf()&&t.classList.add("shaka-mobile"),this.g=new Mw(e,t,n,this.h),this.configure({}),n.controls||e.rg(t),t.ui=this,n.ui=this}function nS(t){var n={controlPanelElements:"play_pause time_and_duration spacer mute volume fullscreen overflow_menu".split(" "),overflowMenuButtons:"captions quality language picture_in_picture cast playback_rate".split(" "),statisticsList:"width height corruptedFrames decodedFrames droppedFrames drmTimeSeconds licenseTime liveLatency loadLatency bufferingTime manifestTimeSeconds estimatedBandwidth streamBandwidth maxSegmentDuration pauseTime playTime completionPercent".split(" "),contextMenuElements:["loop","picture_in_picture","statistics"],playbackRates:[.5,.75,1,1.25,1.5,1.75,2],fastForwardRates:[2,4,8,1],rewindRates:[-1,-2,-4,-8],addSeekBar:!0,addBigPlayButton:!1,customContextMenu:!1,castReceiverAppId:"",castAndroidReceiverCompatible:!1,clearBufferOnQualityChange:!0,showUnbufferedStart:!1,seekBarColors:{base:"rgba(255, 255, 255, 0.3)",buffered:"rgba(255, 255, 255, 0.54)",played:"rgb(255, 255, 255)",adBreaks:"rgb(255, 204, 0)"},volumeBarColors:{base:"rgba(255, 255, 255, 0.54)",level:"rgb(255, 255, 255)"},trackLabelFormat:oS,fadeDelay:0,doubleClickForFullscreen:!0,singleClickForPlayAndPause:!0,enableKeyboardPlaybackControls:!0,enableFullscreenOnRotation:!0,forceLandscapeOnFullscreen:!0,enableTooltips:!1,keyboardSeekDistance:5,keyboardLargeSeekDistance:60,fullScreenElement:t.j,preferDocumentPictureInPicture:!0,showAudioChannelCountVariants:!0,seekOnTaps:!0,tapSeekDistance:10};return"remote"in HTMLMediaElement.prototype?n.overflowMenuButtons.push("remote"):e.WebKitPlaybackTargetAvailabilityEvent&&n.overflowMenuButtons.push("airplay"),t.Nf()&&(n.addBigPlayButton=!0,n.controlPanelElements=n.controlPanelElements.filter((function(e){return"play_pause"!=e&&"volume"!=e}))),n}function iS(){var e,t,n,i,r,a,o,s,u,h,c,d,p,f,g,m,v,y,b,T;return L((function(C){switch(C.g){case 1:if(kv(),!Zu())return rS("shaka-ui-load-failed",sS),C.return();if(e=document.querySelectorAll("[data-shaka-player-container]"),t=document.querySelectorAll("[data-shaka-player]"),n=document.querySelectorAll("[data-shaka-player-canvas]"),!t.length&&!e.length){C.F(2);break}if(t.length&&!e.length){for(i=l(t),r=i.next();!r.done;r=i.next())if(!(a=r.value).ui){for(o=document.createElement("div"),a.parentElement.replaceChild(o,a),o.appendChild(a),s=null,u=l(n),h=u.next();!h.done;h=u.next())if((c=h.value).parentElement==o){s=c;break}s||((s=document.createElement("canvas")).classList.add("shaka-canvas-container"),o.appendChild(s)),aS(o,a,s)}C.F(2);break}d=l(e),p=d.next();case 4:if(p.done){C.F(2);break}if((f=p.value).ui){C.F(5);break}for(g=null,m=l(t),r=m.next();!r.done;r=m.next())if((v=r.value).parentElement==f){g=v;break}for(g||((g=document.createElement("video")).setAttribute("playsinline",""),f.appendChild(g)),y=null,b=l(n),h=b.next();!h.done;h=b.next())if((T=h.value).parentElement==f){y=T;break}return y||((y=document.createElement("canvas")).classList.add("shaka-canvas-container"),f.appendChild(y)),S(C,7),_(C,aS(f,g,y),9);case 9:A(C,5);break;case 7:return E(C),rS("shaka-ui-load-failed",uS),C.return();case 5:p=d.next(),C.F(4);break;case 2:rS("shaka-ui-loaded"),w(C)}}))}function rS(e,t){var n=null;null!=t&&(n={reasonCode:t}),e=new CustomEvent(e,{detail:n}),document.dispatchEvent(e)}function aS(e,t,n){var i,r,a,o,s,u,h,c,d;return L((function(p){switch(p.g){case 1:i=new Ku,r=new tS(i,e,t),i.Eg(n),a="",o=!1,e.dataset&&e.dataset.shakaPlayerCastReceiverId?(a=e.dataset.shakaPlayerCastReceiverId,o="true"===e.dataset.shakaPlayerCastAndroidReceiverCompatible):t.dataset&&t.dataset.shakaPlayerCastReceiverId&&(a=t.dataset.shakaPlayerCastReceiverId,o="true"===t.dataset.shakaPlayerCastAndroidReceiverCompatible),a.length&&r.configure({castReceiverAppId:a,castAndroidReceiverCompatible:o}),t.controls&&r.g.ph(!0),(s=t.getAttribute("src"))&&((u=document.createElement("source")).setAttribute("src",s),t.appendChild(u),t.removeAttribute("src")),h=l(t.querySelectorAll("source")),c=h.next();case 2:if(c.done){p.F(4);break}return d=c.value,S(p,5),_(p,r.g.Mc().load(d.getAttribute("src")),7);case 7:p.F(4);break;case 5:E(p);case 3:c=h.next(),p.F(2);break;case 4:return _(p,i.Gc(t),0)}}))}m(Jw,tw),G("shaka.ui.AirPlayButton",Jw),eS.prototype.create=function(e,t){return new Jw(e,t)},Kw("airplay",new eS),Lw("airplay",new eS),(i=tS.prototype).destroy=function(){var e=this;return L((function(t){return 1==t.g?e.g?_(t,e.g.destroy(),2):t.F(2):4!=t.g?(e.g=null,e.i?_(t,e.i.destroy(),4):t.F(4)):(e.i=null,void w(t))}))},i.Nf=function(){return!!/(?:iPhone|iPad|iPod|Android)/.test(navigator.userAgent)||bn()&&1<navigator.maxTouchPoints},i.getConfiguration=function(){var e=nS(this);return ku(e,this.h,nS(this),{},""),e},i.configure=function(e,t){2==arguments.length&&"string"==typeof e&&(e=Mu(e,t)),ku(this.h,e,nS(this),{},""),this.h.castReceiverAppId&&!this.h.overflowMenuButtons.includes("cast")&&this.h.overflowMenuButtons.push("cast"),this.g.configure(this.h),this.g.dispatchEvent(new j("uiupdated"))},i.Zh=function(){return this.g},i.tj=function(e){this.g.lg(e)},G("shaka.ui.Overlay",tS),tS.prototype.setEnabled=tS.prototype.tj,tS.prototype.getControls=tS.prototype.Zh,tS.prototype.configure=tS.prototype.configure,tS.prototype.getConfiguration=tS.prototype.getConfiguration,tS.prototype.isMobile=tS.prototype.Nf,tS.prototype.destroy=tS.prototype.destroy;var oS=0;tS.TrackLabelFormat={LANGUAGE:oS,ROLE:1,LANGUAGE_ROLE:2,LABEL:3};var sS=0,uS=1;function lS(e,t,n,i,r,a,o,s){function u(e){var t="";return 5<=e&&(t=" "+a.resolve("SURROUND")),t}function h(e,t,n,i){return e=[e,t],s&&null!=i&&e.push(i),n&&3==o&&e.push(n),e.join(": ")}function c(e){return"variant"==e.type?e.audioRoles?e.audioRoles.join(", "):void 0:e.roles.join(", ")}var d=e.find((function(e){return 1==e.active})),p=nw(t);nu(t),t.appendChild(p),p=new Map;for(var f=l(e),g=f.next();!g.done;g=f.next())g=g.value,p.has(g.language)||p.set(g.language,new Set),p.get(g.language).add(c(g));for(p=new Set,d=d?h(d.language,c(d),d.label,d.channelsCount):"",f={},g=(e=l(e)).next();!g.done;f={vb:f.vb},g=e.next()){f.vb=g.value,g=f.vb.language;var m=f.vb.forced,v=a.resolve("SUBTITLE_FORCED"),y=c(f.vb),b=f.vb.label,_=f.vb.channelsCount,w=h(g,y,b,_);if(!p.has(w)){p.add(w);var S=tu();S.addEventListener("click",function(e){return function(){n(e.vb)}}(f));var T=eu("span");switch(S.appendChild(T),T.textContent=hS(g,a),o){case oS:s&&(T.textContent+=u(_)),m&&(T.textContent+=" ("+v+")");break;case 1:s&&(T.textContent+=u(_)),y?T.textContent=y:(X("Track #"+f.vb.id+" does not have a role, but the UI is configured to only show role."),T.textContent="?"),m&&(T.textContent+=" ("+v+")");break;case 2:s&&(T.textContent+=u(_)),y&&(T.textContent+=": "+y),m&&(T.textContent+=" ("+v+")");break;case 3:b?T.textContent=b:(X("Track #"+f.vb.id+" does not have a label, but the UI is configured to only show labels."),T.textContent="?")}i&&w==d&&(S.appendChild(aw()),T.classList.add("shaka-chosen-item"),S.ariaSelected="true",r.textContent=T.textContent),t.appendChild(S)}}}function hS(e,t){if(!e&&!t)return"";switch(e){case"mul":return t.resolve("MULTIPLE_LANGUAGES");case"und":return t.resolve("UNDETERMINED_LANGUAGE");case"zxx":return t.resolve("NOT_APPLICABLE")}var n=Re(e);return e in J_?J_[e].A:n in J_?J_[n].A+" ("+e+")":t.resolve("UNRECOGNIZED_LANGUAGE")+" ("+e+")"}function cS(e,t,n){tw.call(this,e,t);var i=this;!function(e,t){e.button=tu(),e.button.classList.add("shaka-overflow-button"),e.icon=eu("i"),e.icon.classList.add("material-icons-round"),e.icon.textContent=t,e.button.appendChild(e.icon),(t=eu("label")).classList.add("shaka-overflow-button-label"),t.classList.add("shaka-overflow-menu-only"),e.nameSpan=eu("span"),t.appendChild(e.nameSpan),e.currentSelection=eu("span"),e.currentSelection.classList.add("shaka-current-selection-span"),t.appendChild(e.currentSelection),e.button.appendChild(t),e.parent.appendChild(e.button)}(this,n),function(e){e.menu=eu("div"),e.menu.classList.add("shaka-no-propagation"),e.menu.classList.add("shaka-show-controls-on-mouse-over"),e.menu.classList.add("shaka-settings-menu"),e.menu.classList.add("shaka-hidden"),e.backButton=tu(),e.backButton.classList.add("shaka-back-to-overflow-button"),e.menu.appendChild(e.backButton),e.eventManager.o(e.backButton,"click",(function(){e.controls.uc()}));var t=eu("i");t.classList.add("material-icons-round"),t.textContent="close",e.backButton.appendChild(t),e.backSpan=eu("span"),e.backButton.appendChild(e.backSpan),e.controls.h.appendChild(e.menu)}(this),function(e){e.parent.classList.contains("shaka-overflow-menu")&&(e.backButton.firstChild.textContent="arrow_back",e.eventManager.o(e.backButton,"click",(function(){function t(e){return 0==e.classList.contains("shaka-hidden")}ow(e.parent,!0),$(e.parent.childNodes,t)&&ee(e.parent.childNodes,t)[0].focus(),Bw(e.controls)})))}(this),this.eventManager.o(this.button,"click",(function(){i.menu.classList.contains("shaka-hidden")?(i.controls.dispatchEvent(new j("submenuopen")),ow(i.menu,!0),rw(i.menu)):ow(i.menu,!1)}))}function dS(e,t){cS.call(this,e,t,"language");var n=this;this.button.classList.add("shaka-language-button"),this.button.classList.add("shaka-tooltip-status"),this.menu.classList.add("shaka-audio-languages"),this.eventManager.o(this.localization,"locale-updated",(function(){fS(n)})),this.eventManager.o(this.localization,"locale-changed",(function(){fS(n)})),this.eventManager.o(this.player,"trackschanged",(function(){var e=0<n.player.mb().length;ow(n.button,e),pS(n)})),this.eventManager.o(this.player,"variantchanged",(function(){pS(n)})),fS(this),pS(this)}function pS(e){lS(e.player.mb(),e.menu,(function(t){t.channelsCount&&e.controls.g.showAudioChannelCountVariants?e.player.Le(t.language,t.roles[0],t.channelsCount):e.player.Le(t.language,t.roles[0])}),!0,e.currentSelection,e.localization,e.controls.g.trackLabelFormat,e.controls.g.showAudioChannelCountVariants),rw(e.menu),e.controls.dispatchEvent(new j("languageselectionupdated")),e.button.setAttribute("shaka-status",e.currentSelection.innerText),ow(e.button,2<e.menu.getElementsByTagName("button").length)}function fS(e){e.backButton.ariaLabel=e.localization.resolve("BACK"),e.button.ariaLabel=e.localization.resolve("LANGUAGE"),e.nameSpan.textContent=e.localization.resolve("LANGUAGE"),e.backSpan.textContent=e.localization.resolve("LANGUAGE")}function gS(){}function mS(e,t){tw.call(this,e,t);var n=this;this.h=this.controls.C,this.g=tu(),this.g.classList.add("shaka-cast-button"),this.g.classList.add("shaka-tooltip"),this.g.ariaPressed="false",this.i=eu("i"),this.i.classList.add("material-icons-round"),this.i.textContent="cast",this.g.appendChild(this.i),(e=eu("label")).classList.add("shaka-overflow-button-label"),e.classList.add("shaka-overflow-menu-only"),this.l=eu("span"),e.appendChild(this.l),this.j=eu("span"),this.j.classList.add("shaka-current-selection-span"),e.appendChild(this.j),this.g.appendChild(e),this.parent.appendChild(this.g),bS(this),vS(this),this.eventManager.o(this.localization,"locale-updated",(function(){bS(n)})),this.eventManager.o(this.localization,"locale-changed",(function(){bS(n)})),this.eventManager.o(this.g,"click",(function(){!function(e){var t;L((function(n){return 1==n.g?e.h.Ba()?(e.h.vh(),n.F(0)):(S(n,3),e.g.disabled=!0,_(n,e.h.cast(),5)):3!=n.g?(e.g.disabled=!1,A(n,0)):(t=E(n),e.g.disabled=!1,8004!=t.code&&e.controls.dispatchEvent(new j("error",(new Map).set("detail",t))),void w(n))}))}(n)})),this.eventManager.o(this.controls,"caststatuschanged",(function(){vS(n)}))}function vS(e){var t=e.h.kf()&&e.controls.ua,n=e.h.Ba();ow(e.g,t),e.i.textContent=n?"cast_connected":"cast",t&&(e.g.ariaPressed=n?"true":"false"),yS(e)}function yS(e){e.j.textContent=e.h.Ba()?e.h.Je():e.localization.resolve("OFF")}function bS(e){e.g.ariaLabel=e.localization.resolve("CAST"),e.l.textContent=e.localization.resolve("CAST"),yS(e)}function _S(){}function wS(e,t){tw.call(this,e,t);var n=this;this.g=tu(),this.g.classList.add("material-icons-round"),this.g.classList.add("shaka-fast-forward-button"),this.g.classList.add("shaka-tooltip-status"),this.g.setAttribute("shaka-status","1x"),this.g.textContent="fast_forward",this.parent.appendChild(this.g),SS(this),this.h=this.controls.g.fastForwardRates,this.eventManager.o(this.localization,"locale-updated",(function(){SS(n)})),this.eventManager.o(this.localization,"locale-changed",(function(){SS(n)})),this.eventManager.o(this.g,"click",(function(){if(n.video.duration){var e=n.h.indexOf(n.player.Mb())+1;e=e!=n.h.length?n.h[e]:n.h[0],n.player.Pd(e),n.g.setAttribute("shaka-status",e+"x")}}))}function SS(e){e.g.ariaLabel=e.localization.resolve("FAST_FORWARD")}function TS(){}function AS(e,t){tw.call(this,e,t);var n=this;this.h=this.controls.s,this.g=tu(),this.g.classList.add("shaka-fullscreen-button"),this.g.classList.add("material-icons-round"),this.g.classList.add("shaka-tooltip"),ES(this),this.g.textContent="fullscreen",this.parent.appendChild(this.g),CS(this),this.eventManager.o(this.localization,"locale-updated",(function(){CS(n)})),this.eventManager.o(this.localization,"locale-changed",(function(){CS(n)})),this.eventManager.o(this.g,"click",(function(){return L((function(e){return _(e,n.controls.Pe(),0)}))})),this.eventManager.o(document,"fullscreenchange",(function(){n.g.textContent=n.controls.Qc()?"fullscreen_exit":"fullscreen",CS(n)})),this.eventManager.o(this.h,"loadedmetadata",(function(){ES(n)})),this.eventManager.o(this.h,"loadeddata",(function(){ES(n)}))}function ES(e){e.controls.zd()?e.g.classList.remove("shaka-hidden"):e.g.classList.add("shaka-hidden")}function CS(e){e.g.ariaLabel=e.localization.resolve(e.controls.Qc()?"EXIT_FULL_SCREEN":"FULL_SCREEN")}function xS(){}function IS(e,t){tw.call(this,e,t);var n=this;this.g=tu(),this.g.classList.add("shaka-loop-button"),this.g.classList.add("shaka-tooltip"),this.i=eu("i"),this.i.classList.add("material-icons-round"),this.i.textContent="repeat",this.g.appendChild(this.i),(e=eu("label")).classList.add("shaka-overflow-button-label"),e.classList.add("shaka-overflow-menu-only"),this.j=eu("span"),this.j.textContent=this.localization.resolve("LOOP"),e.appendChild(this.j),this.l=eu("span"),this.l.classList.add("shaka-current-selection-span"),e.appendChild(this.l),this.g.appendChild(e),kS(this),this.parent.appendChild(this.g),this.eventManager.o(this.localization,"locale-updated",(function(){kS(n)})),this.eventManager.o(this.localization,"locale-changed",(function(){kS(n)})),this.eventManager.o(this.g,"click",(function(){n.video.loop=!n.video.loop,n.h.Qa(),n.h.za(1)})),this.m=this.video.loop,this.h=new ln((function(){n.m!=n.video.loop&&(kS(n),n.m=n.video.loop)})),this.h.za(1)}function kS(e){e.j.textContent=e.localization.resolve("LOOP"),e.l.textContent=e.localization.resolve(e.video.loop?"ON":"OFF"),e.i.textContent=e.video.loop?"repeat_on":"repeat",e.g.ariaLabel=e.localization.resolve(e.video.loop?"EXIT_LOOP_MODE":"ENTER_LOOP_MODE")}function MS(){}function PS(e,t){tw.call(this,e,t);var n=this;this.g=tu(),this.g.classList.add("shaka-mute-button"),this.g.classList.add("material-icons-round"),this.g.classList.add("shaka-tooltip"),this.parent.appendChild(this.g),LS(this),DS(this),this.eventManager.o(this.localization,"locale-updated",(function(){LS(n)})),this.eventManager.o(this.localization,"locale-changed",(function(){LS(n)})),this.eventManager.o(this.g,"click",(function(){n.ad&&n.ad.isLinear()?n.ad.setMuted(!n.ad.isMuted()):n.video.muted=!n.video.muted})),this.eventManager.o(this.video,"volumechange",(function(){LS(n),DS(n)})),this.eventManager.o(this.adManager,"ad-volume-changed",(function(){LS(n),DS(n)})),this.eventManager.o(this.adManager,"ad-muted",(function(){LS(n),DS(n)})),this.eventManager.o(this.adManager,"ad-stopped",(function(){n.ad=null,LS(n),DS(n)}))}function LS(e){var t=e.ad?e.ad.isMuted()?"UNMUTE":"MUTE":e.video.muted?"UNMUTE":"MUTE";e.g.ariaLabel=e.localization.resolve(t)}function DS(e){var t=e.ad?e.ad.isMuted()?"volume_off":"volume_up":e.video.muted?"volume_off":"volume_up";e.g.textContent=t}function RS(){}function NS(t,n){tw.call(this,t,n);var i=this;this.l=this.controls.s,this.g=tu(),this.g.classList.add("shaka-pip-button"),this.g.classList.add("shaka-tooltip"),this.i=eu("i"),this.i.classList.add("material-icons-round"),this.i.textContent="picture_in_picture_alt",this.g.appendChild(this.i),(t=eu("label")).classList.add("shaka-overflow-button-label"),t.classList.add("shaka-overflow-menu-only"),this.j=eu("span"),this.j.textContent=this.localization.resolve("PICTURE_IN_PICTURE"),t.appendChild(this.j),this.h=eu("span"),this.h.classList.add("shaka-current-selection-span"),t.appendChild(this.h),this.g.appendChild(t),BS(this),this.parent.appendChild(this.g),this.controls.qe()||ow(this.g,!1),this.eventManager.o(this.localization,"locale-updated",(function(){BS(i)})),this.eventManager.o(this.localization,"locale-changed",(function(){BS(i)})),this.eventManager.o(this.g,"click",(function(){i.controls.Od()})),this.eventManager.o(this.l,"enterpictureinpicture",(function(){OS(i)})),this.eventManager.o(this.l,"leavepictureinpicture",(function(){US(i)})),this.eventManager.o(this.controls,"caststatuschanged",(function(){FS(i)})),this.eventManager.o(this.player,"trackschanged",(function(){FS(i)})),"documentPictureInPicture"in e&&this.eventManager.o(e.documentPictureInPicture,"enter",(function(e){OS(i),i.eventManager.na(e.window,"pagehide",(function(){US(i)}))}))}function OS(e){e.i.textContent="branding_watermark",e.g.ariaLabel=e.localization.resolve("EXIT_PICTURE_IN_PICTURE"),e.h.textContent=e.localization.resolve("ON")}function US(e){e.i.textContent="picture_in_picture_alt",e.g.ariaLabel=e.localization.resolve("ENTER_PICTURE_IN_PICTURE"),e.h.textContent=e.localization.resolve("OFF")}function BS(e){e.j.textContent=e.localization.resolve("PICTURE_IN_PICTURE");var t=e.controls.re();e.g.ariaLabel=e.localization.resolve(t?"EXIT_PICTURE_IN_PICTURE":"ENTER_PICTURE_IN_PICTURE"),e.h.textContent=e.localization.resolve(t?"ON":"OFF")}function FS(e){L((function(t){return e.controls.qe()?e.player&&e.player.Pc()?(ow(e.g,!1),e.controls.re()?_(t,e.controls.Od(),0):t.F(0)):(ow(e.g,!0),t.F(0)):(ow(e.g,!1),e.controls.re()?_(t,e.controls.Od(),0):t.F(0))}))}function GS(){}function jS(e,t){cS.call(this,e,t,"slow_motion_video");var n=this;this.button.classList.add("shaka-playbackrate-button"),this.menu.classList.add("shaka-playback-rates"),this.button.classList.add("shaka-tooltip-status"),this.eventManager.o(this.localization,"locale-updated",(function(){HS(n)})),this.eventManager.o(this.localization,"locale-changed",(function(){HS(n)})),this.eventManager.o(this.player,"loaded",(function(){VS(n,n.player.Mb())})),this.eventManager.o(this.player,"ratechange",(function(){VS(n,n.player.Mb())})),this.g=new Map(this.controls.g.playbackRates.map((function(e){return[e+"x",e]}))),HS(this),function(e){for(var t={},n=l(e.g.keys()),i=n.next();!i.done;t={cd:t.cd},i=n.next()){t.cd=i.value,i=tu();var r=eu("span");r.textContent=t.cd,i.appendChild(r),e.eventManager.o(i,"click",function(t){return function(){e.video.playbackRate=e.g.get(t.cd),e.video.defaultPlaybackRate=e.g.get(t.cd)}}(t)),e.menu.appendChild(i)}rw(e.menu)}(this),VS(this,this.player.Mb())}function HS(e){e.backButton.ariaLabel=e.localization.resolve("BACK"),e.button.ariaLabel=e.localization.resolve("PLAYBACK_RATE"),e.nameSpan.textContent=e.localization.resolve("PLAYBACK_RATE"),e.backSpan.textContent=e.localization.resolve("PLAYBACK_RATE")}function VS(e,t){var n=iw(e.menu,"material-icons-round shaka-chosen-item");if(n){var i=n.parentElement;i.removeAttribute("aria-selected"),i.getElementsByTagName("span")[0].classList.remove("shaka-chosen-item"),i.removeChild(n)}(n=Array.from(e.menu.querySelectorAll("span")).find((function(n){return e.g.get(n.textContent)==t})))&&((i=n.parentElement).appendChild(aw()),i.ariaSelected="true",n.classList.add("shaka-chosen-item")),e.currentSelection.textContent=t+"x",e.button.setAttribute("shaka-status",t+"x")}function WS(){}function zS(e,t){tw.call(this,e,t);var n=this;this.g=tu(),this.g.classList.add("shaka-current-time"),XS(this,"0:00"),this.parent.appendChild(this.g),this.eventManager.o(this.g,"click",(function(){n.player.R()&&(n.video.currentTime=n.player.Ha().end)})),this.eventManager.o(this.controls,"timeandseekrangeupdated",(function(){var e=n.controls.W,t=n.controls.Hf(),i=n.player.Ha(),r=i.end-i.start;n.player.R()?(r=3600<=r,1<=(t=Math.max(0,Math.floor(i.end-t)))||e?(XS(n,"- "+sw(t,r)),n.g.disabled=!1):(XS(n,n.localization.resolve("LIVE")),n.g.disabled=!0)):(e=3600<=r,t=sw(Math.max(0,t-i.start),e),r&&(t+=" / "+sw(r,e)),XS(n,t),n.g.disabled=!0)})),this.eventManager.o(this.player,"trackschanged",(function(){n.player.R()&&(n.g.ariaLabel=n.localization.resolve("SKIP_TO_LIVE"))}))}function XS(e,t){t!=e.g.textContent&&(e.g.textContent=t)}function KS(){}function YS(e,t){tw.call(this,e,t);var n=this;this.g=tu(),this.g.classList.add("shaka-remote-button"),this.g.classList.add("shaka-tooltip"),this.g.ariaPressed="false",this.i=eu("i"),this.i.classList.add("material-icons-round"),e="cast",(t=wn())&&13<=t&&(e="airplay"),this.i.textContent=e,this.g.appendChild(this.i),(e=eu("label")).classList.add("shaka-overflow-button-label"),e.classList.add("shaka-overflow-menu-only"),this.l=eu("span"),e.appendChild(this.l),this.j=eu("span"),this.j.classList.add("shaka-current-selection-span"),e.appendChild(this.j),this.g.appendChild(e),this.parent.appendChild(this.g),this.h=-1,ZS(this),ow(this.g,!1),!this.video.remote||this.video.disableRemotePlayback?this.g.classList.add("shaka-hidden"):(this.eventManager.o(this.localization,"locale-updated",(function(){ZS(n)})),this.eventManager.o(this.localization,"locale-changed",(function(){ZS(n)})),this.eventManager.o(this.controls,"caststatuschanged",(function(){qS(n)})),this.eventManager.o(this.g,"click",(function(){n.video.remote.prompt()})),this.eventManager.o(this.video.remote,"connect",(function(){qS(n)})),this.eventManager.o(this.video.remote,"connecting",(function(){qS(n)})),this.eventManager.o(this.video.remote,"disconnect",(function(){qS(n)})),this.eventManager.o(this.player,"loaded",(function(){qS(n)})),qS(this))}function qS(e){var t,n;L((function(i){switch(i.g){case 1:if(e.controls.C.kf()&&e.controls.ua){ow(e.g,!1),-1!=e.h&&(e.video.remote.cancelWatchAvailability(e.h),e.h=-1),i.F(0);break}if("disconnected"==e.video.remote.state){if(t=function(t){e.player?ow(e.g,e.player.ie()==Kl&&t):ow(e.g,!1)},S(i,7),-1==e.h){i.F(9);break}return _(i,e.video.remote.cancelWatchAvailability(e.h),10)}if(-1==e.h){i.F(0);break}return _(i,e.video.remote.cancelWatchAvailability(e.h),6);case 6:e.h=-1,i.F(0);break;case 10:e.h=-1;case 9:A(i,8);break;case 7:E(i);case 8:return S(i,11),_(i,e.video.remote.watchAvailability(t),13);case 13:n=i.h,e.h=n,A(i,0);break;case 11:E(i),t(!0),w(i)}}))}function ZS(e){var t=e.localization.resolve("CAST"),n=wn();n&&13<=n&&(t=e.localization.resolve("AIRPLAY")),e.g.ariaLabel=t,e.l.textContent=t}function JS(){}function QS(e,t){cS.call(this,e,t,"settings");var n=this;this.button.classList.add("shaka-resolution-button"),this.button.classList.add("shaka-tooltip-status"),this.menu.classList.add("shaka-resolutions"),this.eventManager.o(this.localization,"locale-updated",(function(){tT(n)})),this.eventManager.o(this.localization,"locale-changed",(function(){tT(n)})),this.eventManager.o(this.player,"variantchanged",(function(){$S(n)})),this.eventManager.o(this.player,"trackschanged",(function(){$S(n)})),this.eventManager.o(this.player,"abrstatuschanged",(function(){$S(n)})),$S(this)}function $S(e){var t=[];e.player.ie()!=Kl&&(t=e.player.mb());var n=t.find((function(e){return e.active}));n&&(t=t.filter((function(e){return e.language==n.language&&e.channelsCount==n.channelsCount}))),t=t.filter((function(n,i){return(e.player.Pc()?t.findIndex((function(e){return e.bandwidth==n.bandwidth})):t.findIndex((function(e){return e.height==n.height&&e.frameRate==n.frameRate&&e.hdr==n.hdr&&e.videoLayout==n.videoLayout})))==i})),e.player.Pc()?t.sort((function(e,t){return t.bandwidth-e.bandwidth})):t.sort((function(e,t){return t.height-e.height}));var i=nw(e.menu);nu(e.menu),e.menu.appendChild(i),i=e.player.getConfiguration().abr.enabled;for(var r={},a=l(t),o=a.next();!o.done;r={Hb:r.Hb},o=a.next()){r.Hb=o.value,(o=tu()).classList.add("explicit-resolution"),e.eventManager.o(o,"click",function(t){return function(){var n=t.Hb;e.player.configure({abr:{enabled:!1}}),e.player.Me(n,e.controls.g.clearBufferOnQualityChange)}}(r));var s=eu("span");s.textContent=e.player.Pc()&&r.Hb.bandwidth?Math.round(r.Hb.bandwidth/1e3)+" kbits/s":r.Hb.height&&r.Hb.width?eT(r.Hb):"Unknown",o.appendChild(s),i||r.Hb!=n||(o.ariaSelected="true",o.appendChild(aw()),s.classList.add("shaka-chosen-item"),e.currentSelection.textContent=s.textContent),e.menu.appendChild(o)}(r=tu()).classList.add("shaka-enable-abr-button"),e.eventManager.o(r,"click",(function(){e.player.configure({abr:{enabled:!0}}),$S(e)})),e.g=eu("span"),e.g.classList.add("shaka-auto-span"),e.g.textContent=e.localization.resolve("AUTO_QUALITY"),r.appendChild(e.g),i&&(r.ariaSelected="true",r.appendChild(aw()),e.g.classList.add("shaka-chosen-item"),e.currentSelection.textContent=e.localization.resolve("AUTO_QUALITY")),e.button.setAttribute("shaka-status",e.currentSelection.textContent),e.menu.appendChild(r),rw(e.menu),e.controls.dispatchEvent(new j("resolutionselectionupdated")),tT(e),ow(e.button,0<t.length)}function eT(e){var t=e.height||0,n=e.width||0,i=t;return n/t>16/9&&(i=Math.round(9*n/16)),t=i+"p",2160==i&&(t="4K"),(i=e.frameRate)&&(50<=i||20>=i)&&(t+=Math.round(e.frameRate)),"PQ"!=e.hdr&&"HLG"!=e.hdr||(t+=" (HDR)"),"CH-STEREO"==e.videoLayout&&(t+=" (3D)"),t}function tT(e){var t=e.player.Pc()?"QUALITY":"RESOLUTION";e.button.ariaLabel=e.localization.resolve(t),e.backButton.ariaLabel=e.localization.resolve(t),e.backSpan.textContent=e.localization.resolve(t),e.nameSpan.textContent=e.localization.resolve(t),e.g.textContent=e.localization.resolve("AUTO_QUALITY"),e.player.getConfiguration().abr.enabled&&(e.currentSelection.textContent=e.localization.resolve("AUTO_QUALITY"))}function nT(){}function iT(e,t){tw.call(this,e,t);var n=this;this.g=tu(),this.g.classList.add("material-icons-round"),this.g.classList.add("shaka-rewind-button"),this.g.classList.add("shaka-tooltip-status"),this.g.setAttribute("shaka-status",this.localization.resolve("OFF")),this.g.textContent="fast_rewind",this.parent.appendChild(this.g),rT(this),this.h=this.controls.g.rewindRates,this.eventManager.o(this.localization,"locale-updated",(function(){rT(n)})),this.eventManager.o(this.localization,"locale-changed",(function(){rT(n)})),this.eventManager.o(this.g,"click",(function(){if(n.video.duration){var e=n.h.indexOf(n.player.Mb())+1;e=e!=n.h.length?n.h[e]:n.h[0],n.player.Pd(e),n.g.setAttribute("shaka-status",e+"x")}}))}function rT(e){e.g.ariaLabel=e.localization.resolve("REWIND")}function aT(){}function oT(e,t){tw.call(this,e,t);var n=this;this.j=eu("div"),this.j.classList.add("shaka-skip-ad-container"),this.parent.appendChild(this.j),this.h=eu("div"),this.h.classList.add("shaka-skip-ad-counter"),ow(this.h,!1),this.j.appendChild(this.h),this.g=tu(),this.g.classList.add("shaka-skip-ad-button"),this.g.disabled=!0,ow(this.g,!1),this.g.classList.add("shaka-no-propagation"),this.j.appendChild(this.g),sT(this),this.i=new ln((function(){var e=Math.round(n.ad.getTimeUntilSkippable());0<e?n.h.textContent=e:(n.i.stop(),ow(n.h,!1))})),this.eventManager.o(this.localization,"locale-updated",(function(){sT(n)})),this.eventManager.o(this.localization,"locale-changed",(function(){sT(n)})),this.eventManager.o(this.adManager,"ad-started",(function(){uT(n)})),this.eventManager.o(this.adManager,"ad-skip-state-changed",(function(){n.ad.canSkipNow()&&(n.g.disabled=!1,n.i.stop(),ow(n.h,!1))})),this.eventManager.o(this.adManager,"ad-stopped",(function(){n.i.stop(),n.g.disabled=!0,ow(n.g,!1),ow(n.h,!1)})),this.eventManager.o(this.g,"click",(function(){n.ad.skip()})),this.ad&&uT(this)}function sT(e){e.g.textContent=e.localization.resolve("SKIP_AD")}function uT(e){e.ad.isSkippable()&&(ow(e.g,!0),ow(e.h,!0),e.h.textContent="",e.i.Qa(),e.i.za(.5))}function lT(e,t){cw.call(this,e,t),this.button.classList.add("shaka-small-play-button"),this.button.classList.add("material-icons-round"),this.button.classList.add("shaka-tooltip"),this.h(),this.g()}function hT(){}function cT(e,t){tw.call(this,e,t),(e=eu("div")).classList.add("shaka-spacer"),e.ariaHidden="true",this.parent.appendChild(e)}function dT(){}function pT(e,t){function n(e){return sw(s.h[e],!1)+" (m)"}function i(e){return Math.round(s.h[e]/1e3)+" (kbits/s)"}function r(e){return s.h[e].toFixed(2)+" (s)"}function a(e){return s.h[e]+" (frames)"}function o(e){return s.h[e]+" (px)"}tw.call(this,e,t);var s=this;this.i=tu(),this.i.classList.add("shaka-statistics-button"),this.j=eu("i"),this.j.classList.add("material-icons-round"),this.j.textContent="insert_chart_outlined",this.i.appendChild(this.j),(e=eu("label")).classList.add("shaka-overflow-button-label"),this.s=eu("span"),e.appendChild(this.s),this.m=eu("span"),this.m.classList.add("shaka-current-selection-span"),e.appendChild(this.m),this.i.appendChild(e),this.parent.appendChild(this.i),this.g=eu("div"),this.g.classList.add("shaka-no-propagation"),this.g.classList.add("shaka-show-controls-on-mouse-over"),this.g.classList.add("shaka-statistics-container"),this.g.classList.add("shaka-hidden"),this.controls.h.appendChild(this.g),this.D=[],this.G=["stateHistory","switchHistory"],this.h=this.player.getStats(),this.u={},this.C={width:o,height:o,completionPercent:function(e){return s.h[e]+" (%)"},bufferingTime:r,drmTimeSeconds:r,licenseTime:r,liveLatency:r,loadLatency:r,manifestTimeSeconds:r,estimatedBandwidth:i,streamBandwidth:i,maxSegmentDuration:n,pauseTime:n,playTime:n,corruptedFrames:a,decodedFrames:a,droppedFrames:a,stallsDetected:function(e){return s.h[e]+" (stalls)"},gapsJumped:function(e){return s.h[e]+" (gaps)"}},this.l=new ln((function(){s.h=s.player.getStats();for(var e=l(s.D),t=e.next();!t.done;t=e.next())t=t.value,s.u[t].textContent=s.C[t](t)})),fT(this),function(e){for(var t=l(e.controls.g.statisticsList),n=t.next();!n.done;n=t.next())if((n=n.value)in e.h&&!e.G.includes(n)){var i=e.g,r=i.appendChild,a=e,o=eu("div"),s=eu("label");s.textContent=n+":",o.appendChild(s),(s=eu("span")).textContent=a.C[n](n),o.appendChild(s),a.u[n]=s,r.call(i,o),e.D.push(n)}else X("Unrecognized statistic element:",n)}(this),this.eventManager.o(this.localization,"locale-updated",(function(){fT(s)})),this.eventManager.o(this.localization,"locale-changed",(function(){fT(s)})),this.eventManager.o(this.i,"click",(function(){ow(s.parent,!1),s.g.classList.contains("shaka-hidden")?(s.j.textContent="insert_chart",s.l.za(.1),ow(s.g,!0)):(s.j.textContent="insert_chart_outlined",s.l.stop(),ow(s.g,!1)),fT(s)}))}function fT(e){e.s.textContent=e.localization.resolve("STATISTICS"),e.i.ariaLabel=e.localization.resolve("STATISTICS"),e.m.textContent=e.localization.resolve(e.g.classList.contains("shaka-hidden")?"OFF":"ON")}function gT(){}function mT(e,t){cS.call(this,e,t,"closed_caption");var n=this;this.button.classList.add("shaka-caption-button"),this.button.classList.add("shaka-tooltip-status"),this.menu.classList.add("shaka-text-languages"),this.player&&this.player.xc()?this.button.ariaPressed="true":this.button.ariaPressed="false",function(e){var t=tu();t.ariaSelected="true",e.menu.appendChild(t),t.appendChild(aw()),e.g=eu("span"),e.g.classList.add("shaka-auto-span"),t.appendChild(e.g)}(this),this.eventManager.o(this.localization,"locale-updated",(function(){bT(n),yT(n)})),this.eventManager.o(this.localization,"locale-changed",(function(){bT(n),yT(n)})),this.eventManager.o(this.player,"texttrackvisibility",(function(){vT(n),yT(n)})),this.eventManager.o(this.player,"textchanged",(function(){yT(n)})),this.eventManager.o(this.player,"trackschanged",(function(){_T(n)})),vT(this),bT(this),yT(this),_T(this)}function vT(e){e.player.xc()?(e.icon.textContent="closed_caption",e.button.ariaPressed="true"):(e.icon.textContent="closed_caption_disabled",e.button.ariaPressed="false"),e.controls.dispatchEvent(new j("captionselectionupdated"))}function yT(e){var t=e.player.bc();lS(t,e.menu,(function(t){return function(e,t){return L((function(n){return e.player.jg(t),_(n,e.player.Oe(!0),0)}))}(e,t)}),e.player.xc(),e.currentSelection,e.localization,e.controls.g.trackLabelFormat,e.controls.g.showAudioChannelCountVariants),(t=tu()).classList.add("shaka-turn-captions-off-button"),e.eventManager.o(t,"click",(function(){e.player.Oe(!1),yT(e)})),t.appendChild(e.g),e.menu.appendChild(t),e.player.xc()||(t.ariaSelected="true",t.appendChild(aw()),e.g.classList.add("shaka-chosen-item"),e.currentSelection.textContent=e.localization.resolve("OFF")),e.button.setAttribute("shaka-status",e.currentSelection.textContent),rw(e.menu),e.controls.dispatchEvent(new j("captionselectionupdated"))}function bT(e){e.button.ariaLabel=e.localization.resolve("CAPTIONS"),e.backButton.ariaLabel=e.localization.resolve("BACK"),e.nameSpan.textContent=e.localization.resolve("CAPTIONS"),e.backSpan.textContent=e.localization.resolve("CAPTIONS"),e.g.textContent=e.localization.resolve("OFF")}function _T(e){var t=0<e.player.bc().length;ow(e.button,t),yT(e)}function wT(){}function ST(e,t){bw.call(this,e,t,["shaka-volume-bar-container"],["shaka-volume-bar"]);var n=this;this.g=this.controls.g,this.setRange(0,100),this.eventManager.o(this.video,"volumechange",(function(){return TT(n)})),this.eventManager.o(this.adManager,"ad-volume-changed",(function(){return AT(n)})),this.eventManager.o(this.adManager,"ad-muted",(function(){return AT(n)})),this.eventManager.o(this.adManager,"ad-stopped",(function(){return TT(n)})),this.eventManager.o(this.localization,"locale-updated",(function(){return CT(n)})),this.eventManager.o(this.localization,"locale-changed",(function(){return CT(n)})),TT(this),CT(this),this.ad&&this.onChange()}function TT(e){e.video.muted?e.setValue(0):e.setValue(100*e.video.volume),ET(e)}function AT(e){var t=e.ad.getVolume();e.setValue(100*t),ET(e)}function ET(e){var t=e.g.volumeBarColors,n=["to right"];n.push(t.level+e.getValue()+"%"),n.push(t.base+e.getValue()+"%"),n.push(t.base+"100%"),e.container.style.background="linear-gradient("+n.join(",")+")"}function CT(e){e.bar.ariaLabel=e.localization.resolve("VOLUME")}function xT(){}tS.FailReasonCode={NO_BROWSER_SUPPORT:sS,PLAYER_FAILED_TO_LOAD:uS},"complete"==document.readyState?L((function(e){if(1==e.g)return _(e,Promise.resolve(),2);iS(),w(e)})):e.addEventListener("load",iS),m(cS,tw),G("shaka.ui.SettingsMenu",cS),m(dS,cS),G("shaka.ui.AudioLanguageSelection",dS),gS.prototype.create=function(e,t){return new dS(e,t)},Kw("language",new gS),Lw("language",new gS),m(mS,tw),G("shaka.ui.CastButton",mS),_S.prototype.create=function(e,t){return new mS(e,t)},Kw("cast",new _S),Lw("cast",new _S),m(wS,tw),G("shaka.ui.FastForwardButton",wS),TS.prototype.create=function(e,t){return new wS(e,t)},Lw("fast_forward",new TS),m(AS,tw),G("shaka.ui.FullscreenButton",AS),xS.prototype.create=function(e,t){return new AS(e,t)},Lw("fullscreen",new xS),m(IS,tw),IS.prototype.release=function(){this.h.stop(),this.h=null,tw.prototype.release.call(this)},G("shaka.ui.LoopButton",IS),MS.prototype.create=function(e,t){return new IS(e,t)},Kw("loop",new MS),Lw("loop",new MS),fw("loop",new MS),m(PS,tw),G("shaka.ui.MuteButton",PS),RS.prototype.create=function(e,t){return new PS(e,t)},Lw("mute",new RS),m(NS,tw),G("shaka.ui.PipButton",NS),GS.prototype.create=function(e,t){return new NS(e,t)},Kw("picture_in_picture",new GS),Lw("picture_in_picture",new GS),fw("picture_in_picture",new GS),m(jS,cS),G("shaka.ui.PlaybackRateSelection",jS),WS.prototype.create=function(e,t){return new jS(e,t)},Kw("playback_rate",new WS),Lw("playback_rate",new WS),m(zS,tw),G("shaka.ui.PresentationTimeTracker",zS),KS.prototype.create=function(e,t){return new zS(e,t)},Lw("time_and_duration",new KS),m(YS,tw),YS.prototype.release=function(){this.video.remote&&-1!=this.h&&this.video.remote.cancelWatchAvailability(this.h).catch((function(){})),tw.prototype.release.call(this)},G("shaka.ui.RemoteButton",YS),JS.prototype.create=function(e,t){return new YS(e,t)},Kw("remote",new JS),Lw("remote",new JS),m(QS,cS),G("shaka.ui.ResolutionSelection",QS),nT.prototype.create=function(e,t){return new QS(e,t)},Kw("quality",new nT),Lw("quality",new nT),m(iT,tw),G("shaka.ui.RewindButton",iT),aT.prototype.create=function(e,t){return new iT(e,t)},Lw("rewind",new aT),m(oT,tw),oT.prototype.release=function(){this.i.stop(),this.i=null,tw.prototype.release.call(this)},G("shaka.ui.SkipAdButton",oT),m(lT,cw),lT.prototype.h=function(){this.isEnded()?this.button.textContent="replay":this.button.textContent=this.isPaused()?"play_arrow":"pause"},lT.prototype.g=function(){if(this.isEnded())this.button.ariaLabel=this.localization.resolve("REPLAY");else{var e=this.isPaused()?"PLAY":"PAUSE";this.button.ariaLabel=this.localization.resolve(e)}},G("shaka.ui.SmallPlayButton",lT),hT.prototype.create=function(e,t){return new lT(e,t)},Lw("play_pause",new hT),m(cT,tw),G("shaka.ui.Spacer",cT),dT.prototype.create=function(e,t){return new cT(e,t)},Lw("spacer",new dT),m(pT,tw),pT.prototype.release=function(){this.l.stop(),this.l=null,tw.prototype.release.call(this)},G("shaka.ui.StatisticsButton",pT),gT.prototype.create=function(e,t){return new pT(e,t)},Kw("statistics",new gT),fw("statistics",new gT),m(mT,cS),G("shaka.ui.TextSelection",mT),wT.prototype.create=function(e,t){return new mT(e,t)},Kw("captions",new wT),Lw("captions",new wT),m(ST,bw),ST.prototype.onChange=function(){this.ad&&this.ad.isLinear()?this.ad.setVolume(this.getValue()/100):(this.video.volume=this.getValue()/100,this.video.muted=0==this.video.volume)},G("shaka.ui.VolumeBar",ST),xT.prototype.create=function(e,t){return new ST(e,t)},Lw("volume",new xT)}.call(i,e,e,void 0),i.shaka)t[r]=i.shaka[r]}()},317:(e,t,n)=>{"use strict";function i(e,t){this._waveformData=e,this._channelIndex=t}n.d(t,{A:()=>c}),i.prototype.min_sample=function(e){var t=2*(e*this._waveformData.channels+this._channelIndex);return this._waveformData._at(t)},i.prototype.max_sample=function(e){var t=2*(e*this._waveformData.channels+this._channelIndex)+1;return this._waveformData._at(t)},i.prototype.set_min_sample=function(e,t){var n=2*(e*this._waveformData.channels+this._channelIndex);return this._waveformData._set_at(n,t)},i.prototype.set_max_sample=function(e,t){var n=2*(e*this._waveformData.channels+this._channelIndex)+1;return this._waveformData._set_at(n,t)},i.prototype.min_array=function(){for(var e=this._waveformData.length,t=[],n=0;n<e;n++)t.push(this.min_sample(n));return t},i.prototype.max_array=function(){for(var e=this._waveformData.length,t=[],n=0;n<e;n++)t.push(this.max_sample(n));return t};var r=127,a=-128,o=32767,s=-32768;function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function l(e,t,n){var i;return function(r){return i=i||function(e,t,n){var i=void 0===t?null:t,r=function(e,t){var n=atob(e);if(t){for(var i=new Uint8Array(n.length),r=0,a=n.length;r<a;++r)i[r]=n.charCodeAt(r);return String.fromCharCode.apply(null,new Uint16Array(i.buffer))}return n}(e,void 0!==n&&n),a=r.indexOf("\n",10)+1,o=r.substring(a)+(i?"//# sourceMappingURL="+i:""),s=new Blob([o],{type:"application/javascript"});return URL.createObjectURL(s)}(e,t,n),new Worker(i,r)}}var h=l("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgLyoqCiAgICogQXVkaW9CdWZmZXItYmFzZWQgV2F2ZWZvcm1EYXRhIGdlbmVyYXRvcgogICAqCiAgICogQWRhcHRlZCBmcm9tIEJsb2NrRmlsZTo6Q2FsY1N1bW1hcnkgaW4gQXVkYWNpdHksIHdpdGggcGVybWlzc2lvbi4KICAgKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2F1ZGFjaXR5L2F1ZGFjaXR5L2Jsb2IvCiAgICogICAxMTA4YzEzNzZjMDkxNjYxNjIzMzVmYWI0NzQzMDA4Y2JhNTdjNGVlL3NyYy9CbG9ja0ZpbGUuY3BwI0wxOTgKICAgKi8KCiAgdmFyIElOVDhfTUFYID0gMTI3OwogIHZhciBJTlQ4X01JTiA9IC0xMjg7CiAgdmFyIElOVDE2X01BWCA9IDMyNzY3OwogIHZhciBJTlQxNl9NSU4gPSAtMzI3Njg7CiAgZnVuY3Rpb24gY2FsY3VsYXRlV2F2ZWZvcm1EYXRhTGVuZ3RoKGF1ZGlvX3NhbXBsZV9jb3VudCwgc2NhbGUpIHsKICAgIHZhciBkYXRhX2xlbmd0aCA9IE1hdGguZmxvb3IoYXVkaW9fc2FtcGxlX2NvdW50IC8gc2NhbGUpOwogICAgdmFyIHNhbXBsZXNfcmVtYWluaW5nID0gYXVkaW9fc2FtcGxlX2NvdW50IC0gZGF0YV9sZW5ndGggKiBzY2FsZTsKICAgIGlmIChzYW1wbGVzX3JlbWFpbmluZyA+IDApIHsKICAgICAgZGF0YV9sZW5ndGgrKzsKICAgIH0KICAgIHJldHVybiBkYXRhX2xlbmd0aDsKICB9CiAgZnVuY3Rpb24gZ2VuZXJhdGVXYXZlZm9ybURhdGEob3B0aW9ucykgewogICAgdmFyIHNjYWxlID0gb3B0aW9ucy5zY2FsZTsKICAgIHZhciBhbXBsaXR1ZGVfc2NhbGUgPSBvcHRpb25zLmFtcGxpdHVkZV9zY2FsZTsKICAgIHZhciBzcGxpdF9jaGFubmVscyA9IG9wdGlvbnMuc3BsaXRfY2hhbm5lbHM7CiAgICB2YXIgbGVuZ3RoID0gb3B0aW9ucy5sZW5ndGg7CiAgICB2YXIgc2FtcGxlX3JhdGUgPSBvcHRpb25zLnNhbXBsZV9yYXRlOwogICAgdmFyIGNoYW5uZWxzID0gb3B0aW9ucy5jaGFubmVscy5tYXAoZnVuY3Rpb24gKGNoYW5uZWwpIHsKICAgICAgcmV0dXJuIG5ldyBGbG9hdDMyQXJyYXkoY2hhbm5lbCk7CiAgICB9KTsKICAgIHZhciBvdXRwdXRfY2hhbm5lbHMgPSBzcGxpdF9jaGFubmVscyA/IGNoYW5uZWxzLmxlbmd0aCA6IDE7CiAgICB2YXIgdmVyc2lvbiA9IG91dHB1dF9jaGFubmVscyA9PT0gMSA/IDEgOiAyOwogICAgdmFyIGhlYWRlcl9zaXplID0gdmVyc2lvbiA9PT0gMSA/IDIwIDogMjQ7CiAgICB2YXIgZGF0YV9sZW5ndGggPSBjYWxjdWxhdGVXYXZlZm9ybURhdGFMZW5ndGgobGVuZ3RoLCBzY2FsZSk7CiAgICB2YXIgYnl0ZXNfcGVyX3NhbXBsZSA9IG9wdGlvbnMuYml0cyA9PT0gOCA/IDEgOiAyOwogICAgdmFyIHRvdGFsX3NpemUgPSBoZWFkZXJfc2l6ZSArIGRhdGFfbGVuZ3RoICogMiAqIGJ5dGVzX3Blcl9zYW1wbGUgKiBvdXRwdXRfY2hhbm5lbHM7CiAgICB2YXIgYnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKHRvdGFsX3NpemUpOwogICAgdmFyIGRhdGFfdmlldyA9IG5ldyBEYXRhVmlldyhidWZmZXIpOwogICAgdmFyIHNjYWxlX2NvdW50ZXIgPSAwOwogICAgdmFyIG9mZnNldCA9IGhlYWRlcl9zaXplOwogICAgdmFyIGNoYW5uZWwsIGk7CiAgICB2YXIgbWluX3ZhbHVlID0gbmV3IEFycmF5KG91dHB1dF9jaGFubmVscyk7CiAgICB2YXIgbWF4X3ZhbHVlID0gbmV3IEFycmF5KG91dHB1dF9jaGFubmVscyk7CiAgICBmb3IgKGNoYW5uZWwgPSAwOyBjaGFubmVsIDwgb3V0cHV0X2NoYW5uZWxzOyBjaGFubmVsKyspIHsKICAgICAgbWluX3ZhbHVlW2NoYW5uZWxdID0gSW5maW5pdHk7CiAgICAgIG1heF92YWx1ZVtjaGFubmVsXSA9IC1JbmZpbml0eTsKICAgIH0KICAgIHZhciByYW5nZV9taW4gPSBvcHRpb25zLmJpdHMgPT09IDggPyBJTlQ4X01JTiA6IElOVDE2X01JTjsKICAgIHZhciByYW5nZV9tYXggPSBvcHRpb25zLmJpdHMgPT09IDggPyBJTlQ4X01BWCA6IElOVDE2X01BWDsKICAgIGRhdGFfdmlldy5zZXRJbnQzMigwLCB2ZXJzaW9uLCB0cnVlKTsgLy8gVmVyc2lvbgogICAgZGF0YV92aWV3LnNldFVpbnQzMig0LCBvcHRpb25zLmJpdHMgPT09IDgsIHRydWUpOyAvLyBJcyA4IGJpdD8KICAgIGRhdGFfdmlldy5zZXRJbnQzMig4LCBzYW1wbGVfcmF0ZSwgdHJ1ZSk7IC8vIFNhbXBsZSByYXRlCiAgICBkYXRhX3ZpZXcuc2V0SW50MzIoMTIsIHNjYWxlLCB0cnVlKTsgLy8gU2NhbGUKICAgIGRhdGFfdmlldy5zZXRJbnQzMigxNiwgZGF0YV9sZW5ndGgsIHRydWUpOyAvLyBMZW5ndGgKCiAgICBpZiAodmVyc2lvbiA9PT0gMikgewogICAgICBkYXRhX3ZpZXcuc2V0SW50MzIoMjAsIG91dHB1dF9jaGFubmVscywgdHJ1ZSk7CiAgICB9CiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIHNhbXBsZSA9IDA7CiAgICAgIGlmIChvdXRwdXRfY2hhbm5lbHMgPT09IDEpIHsKICAgICAgICBmb3IgKGNoYW5uZWwgPSAwOyBjaGFubmVsIDwgY2hhbm5lbHMubGVuZ3RoOyArK2NoYW5uZWwpIHsKICAgICAgICAgIHNhbXBsZSArPSBjaGFubmVsc1tjaGFubmVsXVtpXTsKICAgICAgICB9CiAgICAgICAgc2FtcGxlID0gTWF0aC5mbG9vcihyYW5nZV9tYXggKiBzYW1wbGUgKiBhbXBsaXR1ZGVfc2NhbGUgLyBjaGFubmVscy5sZW5ndGgpOwogICAgICAgIGlmIChzYW1wbGUgPCBtaW5fdmFsdWVbMF0pIHsKICAgICAgICAgIG1pbl92YWx1ZVswXSA9IHNhbXBsZTsKICAgICAgICAgIGlmIChtaW5fdmFsdWVbMF0gPCByYW5nZV9taW4pIHsKICAgICAgICAgICAgbWluX3ZhbHVlWzBdID0gcmFuZ2VfbWluOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoc2FtcGxlID4gbWF4X3ZhbHVlWzBdKSB7CiAgICAgICAgICBtYXhfdmFsdWVbMF0gPSBzYW1wbGU7CiAgICAgICAgICBpZiAobWF4X3ZhbHVlWzBdID4gcmFuZ2VfbWF4KSB7CiAgICAgICAgICAgIG1heF92YWx1ZVswXSA9IHJhbmdlX21heDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9yIChjaGFubmVsID0gMDsgY2hhbm5lbCA8IG91dHB1dF9jaGFubmVsczsgKytjaGFubmVsKSB7CiAgICAgICAgICBzYW1wbGUgPSBNYXRoLmZsb29yKHJhbmdlX21heCAqIGNoYW5uZWxzW2NoYW5uZWxdW2ldICogYW1wbGl0dWRlX3NjYWxlKTsKICAgICAgICAgIGlmIChzYW1wbGUgPCBtaW5fdmFsdWVbY2hhbm5lbF0pIHsKICAgICAgICAgICAgbWluX3ZhbHVlW2NoYW5uZWxdID0gc2FtcGxlOwogICAgICAgICAgICBpZiAobWluX3ZhbHVlW2NoYW5uZWxdIDwgcmFuZ2VfbWluKSB7CiAgICAgICAgICAgICAgbWluX3ZhbHVlW2NoYW5uZWxdID0gcmFuZ2VfbWluOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoc2FtcGxlID4gbWF4X3ZhbHVlW2NoYW5uZWxdKSB7CiAgICAgICAgICAgIG1heF92YWx1ZVtjaGFubmVsXSA9IHNhbXBsZTsKICAgICAgICAgICAgaWYgKG1heF92YWx1ZVtjaGFubmVsXSA+IHJhbmdlX21heCkgewogICAgICAgICAgICAgIG1heF92YWx1ZVtjaGFubmVsXSA9IHJhbmdlX21heDsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoKytzY2FsZV9jb3VudGVyID09PSBzY2FsZSkgewogICAgICAgIGZvciAoY2hhbm5lbCA9IDA7IGNoYW5uZWwgPCBvdXRwdXRfY2hhbm5lbHM7IGNoYW5uZWwrKykgewogICAgICAgICAgaWYgKG9wdGlvbnMuYml0cyA9PT0gOCkgewogICAgICAgICAgICBkYXRhX3ZpZXcuc2V0SW50OChvZmZzZXQrKywgbWluX3ZhbHVlW2NoYW5uZWxdKTsKICAgICAgICAgICAgZGF0YV92aWV3LnNldEludDgob2Zmc2V0KyssIG1heF92YWx1ZVtjaGFubmVsXSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkYXRhX3ZpZXcuc2V0SW50MTYob2Zmc2V0LCBtaW5fdmFsdWVbY2hhbm5lbF0sIHRydWUpOwogICAgICAgICAgICBkYXRhX3ZpZXcuc2V0SW50MTYob2Zmc2V0ICsgMiwgbWF4X3ZhbHVlW2NoYW5uZWxdLCB0cnVlKTsKICAgICAgICAgICAgb2Zmc2V0ICs9IDQ7CiAgICAgICAgICB9CiAgICAgICAgICBtaW5fdmFsdWVbY2hhbm5lbF0gPSBJbmZpbml0eTsKICAgICAgICAgIG1heF92YWx1ZVtjaGFubmVsXSA9IC1JbmZpbml0eTsKICAgICAgICB9CiAgICAgICAgc2NhbGVfY291bnRlciA9IDA7CiAgICAgIH0KICAgIH0KICAgIGlmIChzY2FsZV9jb3VudGVyID4gMCkgewogICAgICBmb3IgKGNoYW5uZWwgPSAwOyBjaGFubmVsIDwgb3V0cHV0X2NoYW5uZWxzOyBjaGFubmVsKyspIHsKICAgICAgICBpZiAob3B0aW9ucy5iaXRzID09PSA4KSB7CiAgICAgICAgICBkYXRhX3ZpZXcuc2V0SW50OChvZmZzZXQrKywgbWluX3ZhbHVlW2NoYW5uZWxdKTsKICAgICAgICAgIGRhdGFfdmlldy5zZXRJbnQ4KG9mZnNldCsrLCBtYXhfdmFsdWVbY2hhbm5lbF0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBkYXRhX3ZpZXcuc2V0SW50MTYob2Zmc2V0LCBtaW5fdmFsdWVbY2hhbm5lbF0sIHRydWUpOwogICAgICAgICAgZGF0YV92aWV3LnNldEludDE2KG9mZnNldCArIDIsIG1heF92YWx1ZVtjaGFubmVsXSwgdHJ1ZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICByZXR1cm4gYnVmZmVyOwogIH0KCiAgb25tZXNzYWdlID0gZnVuY3Rpb24gb25tZXNzYWdlKGV2dCkgewogICAgdmFyIGJ1ZmZlciA9IGdlbmVyYXRlV2F2ZWZvcm1EYXRhKGV2dC5kYXRhKTsKCiAgICAvLyBUcmFuc2ZlciBidWZmZXIgdG8gdGhlIGNhbGxpbmcgdGhyZWFkCiAgICB0aGlzLnBvc3RNZXNzYWdlKGJ1ZmZlciwgW2J1ZmZlcl0pOwogICAgdGhpcy5jbG9zZSgpOwogIH07Cgp9KSgpOwovLyMgc291cmNlTWFwcGluZ1VSTD13YXZlZm9ybS1kYXRhLXdvcmtlci5qcy5tYXAKCg==",null,!1);function c(e){if(function(e){return e&&"object"===u(e)&&"sample_rate"in e&&"samples_per_pixel"in e&&"bits"in e&&"length"in e&&"data"in e}(e)&&(e=function(e){var t=e.data,n=e.channels||1,i=8===e.bits?1:2,r=2*e.length*n;if(t.length!==r)throw new Error("WaveformData.create(): Length mismatch in JSON waveform data");var a=24+t.length*i,o=new ArrayBuffer(a),s=new DataView(o);s.setInt32(0,2,!0),s.setUint32(4,8===e.bits,!0),s.setInt32(8,e.sample_rate,!0),s.setInt32(12,e.samples_per_pixel,!0),s.setInt32(16,e.length,!0),s.setInt32(20,n,!0);var u,l=24;if(8===e.bits)for(u=0;u<t.length;u++)s.setInt8(l++,t[u],!0);else for(u=0;u<t.length;u++)s.setInt16(l,t[u],!0),l+=2;return o}(e)),!function(e){var t=e&&"object"===u(e)&&"byteLength"in e;if(t){var n=new DataView(e).getInt32(0,!0);if(1!==n&&2!==n)throw new TypeError("WaveformData.create(): This waveform data version not supported")}return t}(e))throw new TypeError("WaveformData.create(): Unknown data format");this._data=new DataView(e),this._offset=2===this._version()?24:20,this._channels=[];for(var t=0;t<this.channels;t++)this._channels[t]=new i(this,t)}function d(e,t,n){var i=function(e){for(var t=[],n=0;n<e.numberOfChannels;++n)t.push(e.getChannelData(n).buffer);return t}(e);if(t.disable_worker){var u=function(e){var t,n,i=e.scale,u=e.amplitude_scale,l=e.split_channels,h=e.length,c=e.sample_rate,d=e.channels.map((function(e){return new Float32Array(e)})),p=l?d.length:1,f=1===p?1:2,g=1===f?20:24,m=function(e,t){var n=Math.floor(e/t);return e-n*t>0&&n++,n}(h,i),v=8===e.bits?1:2,y=new ArrayBuffer(g+2*m*v*p),b=new DataView(y),_=0,w=g,S=new Array(p),T=new Array(p);for(t=0;t<p;t++)S[t]=1/0,T[t]=-1/0;var A=8===e.bits?a:s,E=8===e.bits?r:o;for(b.setInt32(0,f,!0),b.setUint32(4,8===e.bits,!0),b.setInt32(8,c,!0),b.setInt32(12,i,!0),b.setInt32(16,m,!0),2===f&&b.setInt32(20,p,!0),n=0;n<h;n++){var C=0;if(1===p){for(t=0;t<d.length;++t)C+=d[t][n];(C=Math.floor(E*C*u/d.length))<S[0]&&(S[0]=C,S[0]<A&&(S[0]=A)),C>T[0]&&(T[0]=C,T[0]>E&&(T[0]=E))}else for(t=0;t<p;++t)(C=Math.floor(E*d[t][n]*u))<S[t]&&(S[t]=C,S[t]<A&&(S[t]=A)),C>T[t]&&(T[t]=C,T[t]>E&&(T[t]=E));if(++_===i){for(t=0;t<p;t++)8===e.bits?(b.setInt8(w++,S[t]),b.setInt8(w++,T[t])):(b.setInt16(w,S[t],!0),b.setInt16(w+2,T[t],!0),w+=4),S[t]=1/0,T[t]=-1/0;_=0}}if(_>0)for(t=0;t<p;t++)8===e.bits?(b.setInt8(w++,S[t]),b.setInt8(w++,T[t])):(b.setInt16(w,S[t],!0),b.setInt16(w+2,T[t],!0));return y}({scale:t.scale,bits:t.bits,amplitude_scale:t.amplitude_scale,split_channels:t.split_channels,length:e.length,sample_rate:e.sampleRate,channels:i});n(null,new c(u),e)}else{var l=new h;l.onmessage=function(t){n(null,new c(t.data),e)},l.postMessage({scale:t.scale,bits:t.bits,amplitude_scale:t.amplitude_scale,split_channels:t.split_channels,length:e.length,sample_rate:e.sampleRate,channels:i},i)}}function p(e){this._inputData=e.waveformData,this._output_samples_per_pixel=e.scale,this._scale=this._inputData.scale,this._input_buffer_size=this._inputData.length;var t=this._input_buffer_size*this._inputData.scale,n=Math.ceil(t/this._output_samples_per_pixel),i=8===this._inputData.bits?1:2,r=24+2*n*this._inputData.channels*i;this._output_data=new ArrayBuffer(r),this.output_dataview=new DataView(this._output_data),this.output_dataview.setInt32(0,2,!0),this.output_dataview.setUint32(4,8===this._inputData.bits,!0),this.output_dataview.setInt32(8,this._inputData.sample_rate,!0),this.output_dataview.setInt32(12,this._output_samples_per_pixel,!0),this.output_dataview.setInt32(16,n,!0),this.output_dataview.setInt32(20,this._inputData.channels,!0),this._outputWaveformData=new c(this._output_data),this._input_index=0,this._output_index=0;var a,o=this._inputData.channels;for(this._min=new Array(o),this._max=new Array(o),a=0;a<o;++a)this._input_buffer_size>0?(this._min[a]=this._inputData.channel(a).min_sample(this._input_index),this._max[a]=this._inputData.channel(a).max_sample(this._input_index)):(this._min[a]=0,this._max[a]=0);this._min_value=8===this._inputData.bits?-128:-32768,this._max_value=8===this._inputData.bits?127:32767,this._where=0,this._prev_where=0,this._stop=0,this._last_input_index=0}c.create=function(e){return new c(e)},c.createFromAudio=function(e,t){var n=function(e){return{scale:e.scale||512,bits:e.bits||8,amplitude_scale:e.amplitude_scale||1,split_channels:e.split_channels||false,disable_worker:e.disable_worker||false}}(e);if(e.audio_context&&e.array_buffer)return function(e,t,n,i){function r(e){e||(e=new DOMException("EncodingError")),i(e),i=function(){}}var a=e.decodeAudioData(t,(function(e){d(e,n,i)}),r);a&&a.catch(r)}(e.audio_context,e.array_buffer,n,t);if(e.audio_buffer)return d(e.audio_buffer,n,t);throw new TypeError("WaveformData.createFromAudio(): Pass either an AudioContext and ArrayBuffer, or an AudioBuffer object")},p.prototype.sample_at_pixel=function(e){return Math.floor(e*this._output_samples_per_pixel)},p.prototype.next=function(){for(var e,t,n,i=0,r=this._inputData.channels;this._input_index<this._input_buffer_size&&i<1e3;){for(;Math.floor(this.sample_at_pixel(this._output_index)/this._scale)===this._input_index;){if(this._output_index>0)for(n=0;n<r;++n)(e=this._outputWaveformData.channel(n)).set_min_sample(this._output_index-1,this._min[n]),e.set_max_sample(this._output_index-1,this._max[n]);if(this._last_input_index=this._input_index,this._output_index++,this._where=this.sample_at_pixel(this._output_index),this._prev_where=this.sample_at_pixel(this._output_index-1),this._where!==this._prev_where)for(n=0;n<r;++n)this._min[n]=this._max_value,this._max[n]=this._min_value}for(this._where=this.sample_at_pixel(this._output_index),this._stop=Math.floor(this._where/this._scale),this._stop>this._input_buffer_size&&(this._stop=this._input_buffer_size);this._input_index<this._stop;){for(n=0;n<r;++n)(t=(e=this._inputData.channel(n)).min_sample(this._input_index))<this._min[n]&&(this._min[n]=t),(t=e.max_sample(this._input_index))>this._max[n]&&(this._max[n]=t);this._input_index++}i++}if(this._input_index<this._input_buffer_size)return!1;if(this._input_index!==this._last_input_index)for(n=0;n<r;++n)(e=this._outputWaveformData.channel(n)).set_min_sample(this._output_index-1,this._min[n]),e.set_max_sample(this._output_index-1,this._max[n]);return!0},p.prototype.getOutputData=function(){return this._output_data},c.prototype={_getResampleOptions:function(e){var t={};if(t.scale=e.scale,t.width=e.width,null!=t.width&&("number"!=typeof t.width||t.width<=0))throw new RangeError("WaveformData.resample(): width should be a positive integer value");if(null!=t.scale&&("number"!=typeof t.scale||t.scale<=0))throw new RangeError("WaveformData.resample(): scale should be a positive integer value");if(!t.scale&&!t.width)throw new Error("WaveformData.resample(): Missing scale or width option");if(t.width&&(t.scale=Math.floor(this.duration*this.sample_rate/t.width)),t.scale<this.scale)throw new Error("WaveformData.resample(): Zoom level "+t.scale+" too low, minimum: "+this.scale);return t.abortSignal=e.abortSignal,t},resample:function(e){(e=this._getResampleOptions(e)).waveformData=this;for(var t=new p(e);!t.next(););return new c(t.getOutputData())},concat:function(){var e=this,t=Array.prototype.slice.call(arguments);t.forEach((function(t){if(e.channels!==t.channels||e.sample_rate!==t.sample_rate||e.bits!==t.bits||e.scale!==t.scale)throw new Error("WaveformData.concat(): Waveforms are incompatible")}));var n=this._concatBuffers.apply(this,t);return c.create(n)},_concatBuffers:function(){var e,t,n=Array.prototype.slice.call(arguments),i=this._offset,r=i,a=0,o=[this].concat(n).map((function(e){return e._data.buffer}));for(e=0;e<o.length;e++){t=o[e];var s=new DataView(t).getInt32(16,!0);r+=t.byteLength-i,a+=s}var u=new ArrayBuffer(r),l=new DataView(o[0]),h=new DataView(u);for(e=0;e<i;e++)h.setUint8(e,l.getUint8(e));h.setInt32(16,a,!0);var c=0,d=new Uint8Array(u,i);for(e=0;e<o.length;e++)t=o[e],d.set(new Uint8Array(t,i),c),c+=t.byteLength-i;return u},slice:function(e){var t=0,n=0;if(null!=e.startIndex&&null!=e.endIndex?(t=e.startIndex,n=e.endIndex):null!=e.startTime&&null!=e.endTime&&(t=this.at_time(e.startTime),n=this.at_time(e.endTime)),t<0)throw new RangeError("startIndex or startTime must not be negative");if(n<0)throw new RangeError("endIndex or endTime must not be negative");t>this.length&&(t=this.length),n>this.length&&(n=this.length),t>n&&(t=n);var i=n-t,r=8===this.bits?1:2,a=24+2*i*this.channels*r,o=new ArrayBuffer(a),s=new DataView(o);s.setInt32(0,2,!0),s.setUint32(4,8===this.bits,!0),s.setInt32(8,this.sample_rate,!0),s.setInt32(12,this.scale,!0),s.setInt32(16,i,!0),s.setInt32(20,this.channels,!0);for(var u=0;u<i*this.channels*2;u++){var l=this._at(t*this.channels*2+u);8===this.bits?s.setInt8(24+u,l):s.setInt16(24+2*u,l,!0)}return new c(o)},_version:function(){return this._data.getInt32(0,!0)},get length(){return this._data.getUint32(16,!0)},get bits(){return Boolean(this._data.getUint32(4,!0))?8:16},get duration(){return this.length*this.scale/this.sample_rate},get pixels_per_second(){return this.sample_rate/this.scale},get seconds_per_pixel(){return this.scale/this.sample_rate},get channels(){return 2===this._version()?this._data.getInt32(20,!0):1},channel:function(e){if(e>=0&&e<this._channels.length)return this._channels[e];throw new RangeError("Invalid channel: "+e)},get sample_rate(){return this._data.getInt32(8,!0)},get scale(){return this._data.getInt32(12,!0)},_at:function(e){return 8===this.bits?this._data.getInt8(this._offset+e):this._data.getInt16(this._offset+2*e,!0)},_set_at:function(e,t){return 8===this.bits?this._data.setInt8(this._offset+e,t):this._data.setInt16(this._offset+2*e,t,!0)},at_time:function(e){return Math.floor(e*this.sample_rate/this.scale)},time:function(e){return e*this.scale/this.sample_rate},toJSON:function(){for(var e={version:2,channels:this.channels,sample_rate:this.sample_rate,samples_per_pixel:this.scale,bits:this.bits,length:this.length,data:[]},t=0;t<this.length;t++)for(var n=0;n<this.channels;n++)e.data.push(this.channel(n).min_sample(t)),e.data.push(this.channel(n).max_sample(t));return e},toArrayBuffer:function(){return this._data.buffer}}}}]);
//# sourceMappingURL=DlfMediaVendor.js.map